function ResolveUrl(n){return n.indexOf("_/index.html")==0&&(n=baseUrl+n.substring(2)),n}function eli18n(n){this.textdomain=function(n){return this.messages[n]?this._domain=n:this._domain},n&&n.messages&&this.load(n.messages),n&&n.textdomain&&this.textdomain(n.textdomain)}function elDialogForm(n){var t=this,i={"class":"el-dialogform",submit:function(n,t){t.close()},form:{action:window.location.href,method:"post"},ajaxForm:null,validate:null,spinner:"Loading",tabs:{active:0,selected:0},tabPrefix:"el-df-tab-",dialog:{title:"dialog",autoOpen:!1,modal:!0,resizable:!1,closeOnEscape:!0,buttons:{Cancel:function(){t.close()},Ok:function(){t.form.trigger("submit")}}}};this.opts=jQuery.extend(!0,{},i,n),this.opts.dialog.close=function(){t.close()},this.opts.rtl&&(this.opts["class"]+=" el-dialogform-rtl"),n&&n.dialog&&n.dialog.buttons&&typeof n.dialog.buttons=="object"&&(this.opts.dialog.buttons=n.dialog.buttons),this.ul=null,this.tabs={},this._table=null,this.dialog=jQuery("<div />").addClass(this.opts["class"]).dialog(this.opts.dialog),this.message=jQuery('<div class="el-dialogform-message rounded-5" />').hide().appendTo(this.dialog),this.error=jQuery('<div class="el-dialogform-error rounded-5" />').hide().appendTo(this.dialog),this.spinner=jQuery('<div class="spinner" />').hide().appendTo(this.dialog),this.content=jQuery('<div class="el-dialogform-content" />').appendTo(this.dialog),this.form=jQuery("<form />").attr(this.opts.form).appendTo(this.content),this.opts.submit&&this.form.bind("submit",function(n){t.opts.submit(n,t)}),this.opts.ajaxForm&&jQuery.fn.ajaxForm&&this.form.ajaxForm(this.opts.ajaxForm),this.opts.validate&&this.form.validate(this.opts.validate),this.option=function(n,t){return this.dialog.dialog("option",n,t)},this.showError=function(n,t){return this.hideMessage(),this.hideSpinner(),this.error.html(n).show(),t&&this.content.hide(),this},this.hideError=function(){return this.error.text("").hide(),this.content.show(),this},this.showSpinner=function(n){return this.error.hide(),this.message.hide(),this.content.hide(),this.spinner.text(n||this.opts.spinner).show(),this.option("buttons",{}),this},this.hideSpinner=function(){return this.content.show(),this.spinner.hide(),this},this.showMessage=function(n,t){return this.hideError(),this.hideSpinner(),this.message.html(n||"").show(),t&&this.content.hide(),this},this.hideMessage=function(){return this.message.hide(),this.content.show(),this},this.tab=function(n,t){return n=this.opts.tabPrefix+n,this.ul||(this.ul=jQuery("<ul />").prependTo(this.form)),jQuery("<li />").append(jQuery("<a />").attr("href","#"+n).html(t)).appendTo(this.ul),this.tabs[n]={tab:jQuery("<div />").attr("id",n).addClass("tab").appendTo(this.form),table:null},this},this.table=function(n){return n=n&&n.indexOf(this.opts.tabPrefix)==-1?this.opts.tabPrefix+n:n,n&&this.tabs&&this.tabs[n]?this.tabs[n].table=jQuery("<table />").appendTo(this.tabs[n].tab):this._table=jQuery("<table />").appendTo(this.form),this},this.append=function(n,t,i){var u,r;if(t=t?"el-df-tab-"+t:"",!n)return this;if(t&&this.tabs[t])if(i)if(this.tabs[t].table||this.table(t),u=jQuery("<tr />").appendTo(this.tabs[t].table),jQuery.isArray(n))for(r=0;r<n.length;r++)u.append(jQuery("<td />").append(n[r]));else u.append(jQuery("<td />").append(n));else if(jQuery.isArray(n))for(r=0;r<n.length;r++)this.tabs[t].tab.append(n[r]);else this.tabs[t].tab.append(n);else if(i)if(this._table||this.table(),u=jQuery("<tr />").appendTo(this._table),jQuery.isArray(n))for(r=0;r<n.length;r++)u.append(jQuery("<td />").append(n[r]));else u.append(jQuery("<td />").append(n));else if(jQuery.isArray(n))for(r=0;r<n.length;r++)this.form.append(n[r]);else this.form.append(n);return this},this.separator=function(n){return n="el-df-tab-"+n,this.tabs&&this.tabs[n]?(this.tabs[n].tab.append(jQuery("<div />").addClass("separator")),this.tabs[n].table&&this.table(n)):this.form.append(jQuery("<div />").addClass("separator")),this},this.open=function(){var n=this;return this.ul&&this.form.tabs(this.opts.tabs),setTimeout(function(){n.dialog.find(":text").keydown(function(t){t.keyCode==13&&(t.preventDefault(),n.form.submit())}).filter(":first")[0].focus()},200),this.dialog.dialog("open"),this},this.close=function(){typeof this.opts.close=="function"&&this.opts.close(),this.dialog.dialog("destroy")}}function eli18n(n){this.textdomain=function(n){return this.messages[n]?this._domain=n:this._domain},n&&n.messages&&this.load(n.messages),n&&n.textdomain&&this.textdomain(n.textdomain)}function elDialogForm(n){var t=this,i={"class":"el-dialogform",submit:function(n,t){t.close()},form:{action:window.location.href,method:"post"},ajaxForm:null,validate:null,spinner:"Loading",tabs:{active:0,selected:0},tabPrefix:"el-df-tab-",dialog:{title:"dialog",autoOpen:!1,modal:!0,resizable:!1,closeOnEscape:!0,buttons:{Cancel:function(){t.close()},Ok:function(){t.form.trigger("submit")}}}};this.opts=jQuery.extend(!0,{},i,n),this.opts.dialog.close=function(){t.close()},this.opts.rtl&&(this.opts["class"]+=" el-dialogform-rtl"),n&&n.dialog&&n.dialog.buttons&&typeof n.dialog.buttons=="object"&&(this.opts.dialog.buttons=n.dialog.buttons),this.ul=null,this.tabs={},this._table=null,this.dialog=jQuery("<div />").addClass(this.opts["class"]).dialog(this.opts.dialog),this.message=jQuery('<div class="el-dialogform-message rounded-5" />').hide().appendTo(this.dialog),this.error=jQuery('<div class="el-dialogform-error rounded-5" />').hide().appendTo(this.dialog),this.spinner=jQuery('<div class="spinner" />').hide().appendTo(this.dialog),this.content=jQuery('<div class="el-dialogform-content" />').appendTo(this.dialog),this.form=jQuery("<form />").attr(this.opts.form).appendTo(this.content),this.opts.submit&&this.form.bind("submit",function(n){t.opts.submit(n,t)}),this.opts.ajaxForm&&jQuery.fn.ajaxForm&&this.form.ajaxForm(this.opts.ajaxForm),this.opts.validate&&this.form.validate(this.opts.validate),this.option=function(n,t){return this.dialog.dialog("option",n,t)},this.showError=function(n,t){return this.hideMessage(),this.hideSpinner(),this.error.html(n).show(),t&&this.content.hide(),this},this.hideError=function(){return this.error.text("").hide(),this.content.show(),this},this.showSpinner=function(n){return this.error.hide(),this.message.hide(),this.content.hide(),this.spinner.text(n||this.opts.spinner).show(),this.option("buttons",{}),this},this.hideSpinner=function(){return this.content.show(),this.spinner.hide(),this},this.showMessage=function(n,t){return this.hideError(),this.hideSpinner(),this.message.html(n||"").show(),t&&this.content.hide(),this},this.hideMessage=function(){return this.message.hide(),this.content.show(),this},this.tab=function(n,t){return n=this.opts.tabPrefix+n,this.ul||(this.ul=jQuery("<ul />").prependTo(this.form)),jQuery("<li />").append(jQuery("<a />").attr("href","#"+n).html(t)).appendTo(this.ul),this.tabs[n]={tab:jQuery("<div />").attr("id",n).addClass("tab").appendTo(this.form),table:null},this},this.table=function(n){return n=n&&n.indexOf(this.opts.tabPrefix)==-1?this.opts.tabPrefix+n:n,n&&this.tabs&&this.tabs[n]?this.tabs[n].table=jQuery("<table />").appendTo(this.tabs[n].tab):this._table=jQuery("<table />").appendTo(this.form),this},this.append=function(n,t,i){var u,r;if(t=t?"el-df-tab-"+t:"",!n)return this;if(t&&this.tabs[t])if(i)if(this.tabs[t].table||this.table(t),u=jQuery("<tr />").appendTo(this.tabs[t].table),jQuery.isArray(n))for(r=0;r<n.length;r++)u.append(jQuery("<td />").append(n[r]));else u.append(jQuery("<td />").append(n));else if(jQuery.isArray(n))for(r=0;r<n.length;r++)this.tabs[t].tab.append(n[r]);else this.tabs[t].tab.append(n);else if(i)if(this._table||this.table(),u=jQuery("<tr />").appendTo(this._table),jQuery.isArray(n))for(r=0;r<n.length;r++)u.append(jQuery("<td />").append(n[r]));else u.append(jQuery("<td />").append(n));else if(jQuery.isArray(n))for(r=0;r<n.length;r++)this.form.append(n[r]);else this.form.append(n);return this},this.separator=function(n){return n="el-df-tab-"+n,this.tabs&&this.tabs[n]?(this.tabs[n].tab.append(jQuery("<div />").addClass("separator")),this.tabs[n].table&&this.table(n)):this.form.append(jQuery("<div />").addClass("separator")),this},this.open=function(){var n=this;return this.ul&&this.form.tabs(this.opts.tabs),setTimeout(function(){n.dialog.find(":text").keydown(function(t){t.keyCode==13&&(t.preventDefault(),n.form.submit())}).filter(":first")[0].focus()},200),this.dialog.dialog("open"),this},this.close=function(){typeof this.opts.close=="function"&&this.opts.close(),this.dialog.dialog("destroy")}}function eli18n(n){this.textdomain=function(n){return this.messages[n]?this._domain=n:this._domain},n&&n.messages&&this.load(n.messages),n&&n.textdomain&&this.textdomain(n.textdomain)}function elDialogForm(n){var t=this,i={"class":"el-dialogform",submit:function(n,t){t.close()},form:{action:window.location.href,method:"post"},ajaxForm:null,validate:null,spinner:"Loading",tabs:{active:0,selected:0},tabPrefix:"el-df-tab-",dialog:{title:"dialog",autoOpen:!1,modal:!0,resizable:!1,closeOnEscape:!0,buttons:{Cancel:function(){t.close()},Ok:function(){t.form.trigger("submit")}}}};this.opts=jQuery.extend(!0,{},i,n),this.opts.dialog.close=function(){t.close()},this.opts.rtl&&(this.opts["class"]+=" el-dialogform-rtl"),n&&n.dialog&&n.dialog.buttons&&typeof n.dialog.buttons=="object"&&(this.opts.dialog.buttons=n.dialog.buttons),this.ul=null,this.tabs={},this._table=null,this.dialog=jQuery("<div />").addClass(this.opts["class"]).dialog(this.opts.dialog),this.message=jQuery('<div class="el-dialogform-message rounded-5" />').hide().appendTo(this.dialog),this.error=jQuery('<div class="el-dialogform-error rounded-5" />').hide().appendTo(this.dialog),this.spinner=jQuery('<div class="spinner" />').hide().appendTo(this.dialog),this.content=jQuery('<div class="el-dialogform-content" />').appendTo(this.dialog),this.form=jQuery("<form />").attr(this.opts.form).appendTo(this.content),this.opts.submit&&this.form.bind("submit",function(n){t.opts.submit(n,t)}),this.opts.ajaxForm&&jQuery.fn.ajaxForm&&this.form.ajaxForm(this.opts.ajaxForm),this.opts.validate&&this.form.validate(this.opts.validate),this.option=function(n,t){return this.dialog.dialog("option",n,t)},this.showError=function(n,t){return this.hideMessage(),this.hideSpinner(),this.error.html(n).show(),t&&this.content.hide(),this},this.hideError=function(){return this.error.text("").hide(),this.content.show(),this},this.showSpinner=function(n){return this.error.hide(),this.message.hide(),this.content.hide(),this.spinner.text(n||this.opts.spinner).show(),this.option("buttons",{}),this},this.hideSpinner=function(){return this.content.show(),this.spinner.hide(),this},this.showMessage=function(n,t){return this.hideError(),this.hideSpinner(),this.message.html(n||"").show(),t&&this.content.hide(),this},this.hideMessage=function(){return this.message.hide(),this.content.show(),this},this.tab=function(n,t){return n=this.opts.tabPrefix+n,this.ul||(this.ul=jQuery("<ul />").prependTo(this.form)),jQuery("<li />").append(jQuery("<a />").attr("href","#"+n).html(t)).appendTo(this.ul),this.tabs[n]={tab:jQuery("<div />").attr("id",n).addClass("tab").appendTo(this.form),table:null},this},this.table=function(n){return n=n&&n.indexOf(this.opts.tabPrefix)==-1?this.opts.tabPrefix+n:n,n&&this.tabs&&this.tabs[n]?this.tabs[n].table=jQuery("<table />").appendTo(this.tabs[n].tab):this._table=jQuery("<table />").appendTo(this.form),this},this.append=function(n,t,i){var u,r;if(t=t?"el-df-tab-"+t:"",!n)return this;if(t&&this.tabs[t])if(i)if(this.tabs[t].table||this.table(t),u=jQuery("<tr />").appendTo(this.tabs[t].table),jQuery.isArray(n))for(r=0;r<n.length;r++)u.append(jQuery("<td />").append(n[r]));else u.append(jQuery("<td />").append(n));else if(jQuery.isArray(n))for(r=0;r<n.length;r++)this.tabs[t].tab.append(n[r]);else this.tabs[t].tab.append(n);else if(i)if(this._table||this.table(),u=jQuery("<tr />").appendTo(this._table),jQuery.isArray(n))for(r=0;r<n.length;r++)u.append(jQuery("<td />").append(n[r]));else u.append(jQuery("<td />").append(n));else if(jQuery.isArray(n))for(r=0;r<n.length;r++)this.form.append(n[r]);else this.form.append(n);return this},this.separator=function(n){return n="el-df-tab-"+n,this.tabs&&this.tabs[n]?(this.tabs[n].tab.append(jQuery("<div />").addClass("separator")),this.tabs[n].table&&this.table(n)):this.form.append(jQuery("<div />").addClass("separator")),this},this.open=function(){var n=this;return this.ul&&this.form.tabs(this.opts.tabs),setTimeout(function(){n.dialog.find(":text").keydown(function(t){t.keyCode==13&&(t.preventDefault(),n.form.submit())}).filter(":first")[0].focus()},200),this.dialog.dialog("open"),this},this.close=function(){typeof this.opts.close=="function"&&this.opts.close(),this.dialog.dialog("destroy")}}function eli18n(n){this.textdomain=function(n){return this.messages[n]?this._domain=n:this._domain},n&&n.messages&&this.load(n.messages),n&&n.textdomain&&this.textdomain(n.textdomain)}function elDialogForm(n){var t=this,i={"class":"el-dialogform",submit:function(n,t){t.close()},form:{action:window.location.href,method:"post"},ajaxForm:null,validate:null,spinner:"Loading",tabs:{active:0,selected:0},tabPrefix:"el-df-tab-",dialog:{title:"dialog",autoOpen:!1,modal:!0,resizable:!1,closeOnEscape:!0,buttons:{Cancel:function(){t.close()},Ok:function(){t.form.trigger("submit")}}}};this.opts=jQuery.extend(!0,{},i,n),this.opts.dialog.close=function(){t.close()},this.opts.rtl&&(this.opts["class"]+=" el-dialogform-rtl"),n&&n.dialog&&n.dialog.buttons&&typeof n.dialog.buttons=="object"&&(this.opts.dialog.buttons=n.dialog.buttons),this.ul=null,this.tabs={},this._table=null,this.dialog=jQuery("<div />").addClass(this.opts["class"]).dialog(this.opts.dialog),this.message=jQuery('<div class="el-dialogform-message rounded-5" />').hide().appendTo(this.dialog),this.error=jQuery('<div class="el-dialogform-error rounded-5" />').hide().appendTo(this.dialog),this.spinner=jQuery('<div class="spinner" />').hide().appendTo(this.dialog),this.content=jQuery('<div class="el-dialogform-content" />').appendTo(this.dialog),this.form=jQuery("<form />").attr(this.opts.form).appendTo(this.content),this.opts.submit&&this.form.bind("submit",function(n){t.opts.submit(n,t)}),this.opts.ajaxForm&&jQuery.fn.ajaxForm&&this.form.ajaxForm(this.opts.ajaxForm),this.opts.validate&&this.form.validate(this.opts.validate),this.option=function(n,t){return this.dialog.dialog("option",n,t)},this.showError=function(n,t){return this.hideMessage(),this.hideSpinner(),this.error.html(n).show(),t&&this.content.hide(),this},this.hideError=function(){return this.error.text("").hide(),this.content.show(),this},this.showSpinner=function(n){return this.error.hide(),this.message.hide(),this.content.hide(),this.spinner.text(n||this.opts.spinner).show(),this.option("buttons",{}),this},this.hideSpinner=function(){return this.content.show(),this.spinner.hide(),this},this.showMessage=function(n,t){return this.hideError(),this.hideSpinner(),this.message.html(n||"").show(),t&&this.content.hide(),this},this.hideMessage=function(){return this.message.hide(),this.content.show(),this},this.tab=function(n,t){return n=this.opts.tabPrefix+n,this.ul||(this.ul=jQuery("<ul />").prependTo(this.form)),jQuery("<li />").append(jQuery("<a />").attr("href","#"+n).html(t)).appendTo(this.ul),this.tabs[n]={tab:jQuery("<div />").attr("id",n).addClass("tab").appendTo(this.form),table:null},this},this.table=function(n){return n=n&&n.indexOf(this.opts.tabPrefix)==-1?this.opts.tabPrefix+n:n,n&&this.tabs&&this.tabs[n]?this.tabs[n].table=jQuery("<table />").appendTo(this.tabs[n].tab):this._table=jQuery("<table />").appendTo(this.form),this},this.append=function(n,t,i){var u,r;if(t=t?"el-df-tab-"+t:"",!n)return this;if(t&&this.tabs[t])if(i)if(this.tabs[t].table||this.table(t),u=jQuery("<tr />").appendTo(this.tabs[t].table),jQuery.isArray(n))for(r=0;r<n.length;r++)u.append(jQuery("<td />").append(n[r]));else u.append(jQuery("<td />").append(n));else if(jQuery.isArray(n))for(r=0;r<n.length;r++)this.tabs[t].tab.append(n[r]);else this.tabs[t].tab.append(n);else if(i)if(this._table||this.table(),u=jQuery("<tr />").appendTo(this._table),jQuery.isArray(n))for(r=0;r<n.length;r++)u.append(jQuery("<td />").append(n[r]));else u.append(jQuery("<td />").append(n));else if(jQuery.isArray(n))for(r=0;r<n.length;r++)this.form.append(n[r]);else this.form.append(n);return this},this.separator=function(n){return n="el-df-tab-"+n,this.tabs&&this.tabs[n]?(this.tabs[n].tab.append(jQuery("<div />").addClass("separator")),this.tabs[n].table&&this.table(n)):this.form.append(jQuery("<div />").addClass("separator")),this},this.open=function(){var n=this;return this.ul&&this.form.tabs(this.opts.tabs),setTimeout(function(){n.dialog.find(":text").keydown(function(t){t.keyCode==13&&(t.preventDefault(),n.form.submit())}).filter(":first")[0].focus()},200),this.dialog.dialog("open"),this},this.close=function(){typeof this.opts.close=="function"&&this.opts.close(),this.dialog.dialog("destroy")}}function eli18n(n){this.textdomain=function(n){return this.messages[n]?this._domain=n:this._domain},n&&n.messages&&this.load(n.messages),n&&n.textdomain&&this.textdomain(n.textdomain)}function elDialogForm(n){var t=this,i={"class":"el-dialogform",submit:function(n,t){t.close()},form:{action:window.location.href,method:"post"},ajaxForm:null,validate:null,spinner:"Loading",tabs:{active:0,selected:0},tabPrefix:"el-df-tab-",dialog:{title:"dialog",autoOpen:!1,modal:!0,resizable:!1,closeOnEscape:!0,buttons:{Cancel:function(){t.close()},Ok:function(){t.form.trigger("submit")}}}};this.opts=jQuery.extend(!0,{},i,n),this.opts.dialog.close=function(){t.close()},this.opts.rtl&&(this.opts["class"]+=" el-dialogform-rtl"),n&&n.dialog&&n.dialog.buttons&&typeof n.dialog.buttons=="object"&&(this.opts.dialog.buttons=n.dialog.buttons),this.ul=null,this.tabs={},this._table=null,this.dialog=jQuery("<div />").addClass(this.opts["class"]).dialog(this.opts.dialog),this.message=jQuery('<div class="el-dialogform-message rounded-5" />').hide().appendTo(this.dialog),this.error=jQuery('<div class="el-dialogform-error rounded-5" />').hide().appendTo(this.dialog),this.spinner=jQuery('<div class="spinner" />').hide().appendTo(this.dialog),this.content=jQuery('<div class="el-dialogform-content" />').appendTo(this.dialog),this.form=jQuery("<form />").attr(this.opts.form).appendTo(this.content),this.opts.submit&&this.form.bind("submit",function(n){t.opts.submit(n,t)}),this.opts.ajaxForm&&jQuery.fn.ajaxForm&&this.form.ajaxForm(this.opts.ajaxForm),this.opts.validate&&this.form.validate(this.opts.validate),this.option=function(n,t){return this.dialog.dialog("option",n,t)},this.showError=function(n,t){return this.hideMessage(),this.hideSpinner(),this.error.html(n).show(),t&&this.content.hide(),this},this.hideError=function(){return this.error.text("").hide(),this.content.show(),this},this.showSpinner=function(n){return this.error.hide(),this.message.hide(),this.content.hide(),this.spinner.text(n||this.opts.spinner).show(),this.option("buttons",{}),this},this.hideSpinner=function(){return this.content.show(),this.spinner.hide(),this},this.showMessage=function(n,t){return this.hideError(),this.hideSpinner(),this.message.html(n||"").show(),t&&this.content.hide(),this},this.hideMessage=function(){return this.message.hide(),this.content.show(),this},this.tab=function(n,t){return n=this.opts.tabPrefix+n,this.ul||(this.ul=jQuery("<ul />").prependTo(this.form)),jQuery("<li />").append(jQuery("<a />").attr("href","#"+n).html(t)).appendTo(this.ul),this.tabs[n]={tab:jQuery("<div />").attr("id",n).addClass("tab").appendTo(this.form),table:null},this},this.table=function(n){return n=n&&n.indexOf(this.opts.tabPrefix)==-1?this.opts.tabPrefix+n:n,n&&this.tabs&&this.tabs[n]?this.tabs[n].table=jQuery("<table />").appendTo(this.tabs[n].tab):this._table=jQuery("<table />").appendTo(this.form),this},this.append=function(n,t,i){var u,r;if(t=t?"el-df-tab-"+t:"",!n)return this;if(t&&this.tabs[t])if(i)if(this.tabs[t].table||this.table(t),u=jQuery("<tr />").appendTo(this.tabs[t].table),jQuery.isArray(n))for(r=0;r<n.length;r++)u.append(jQuery("<td />").append(n[r]));else u.append(jQuery("<td />").append(n));else if(jQuery.isArray(n))for(r=0;r<n.length;r++)this.tabs[t].tab.append(n[r]);else this.tabs[t].tab.append(n);else if(i)if(this._table||this.table(),u=jQuery("<tr />").appendTo(this._table),jQuery.isArray(n))for(r=0;r<n.length;r++)u.append(jQuery("<td />").append(n[r]));else u.append(jQuery("<td />").append(n));else if(jQuery.isArray(n))for(r=0;r<n.length;r++)this.form.append(n[r]);else this.form.append(n);return this},this.separator=function(n){return n="el-df-tab-"+n,this.tabs&&this.tabs[n]?(this.tabs[n].tab.append(jQuery("<div />").addClass("separator")),this.tabs[n].table&&this.table(n)):this.form.append(jQuery("<div />").addClass("separator")),this},this.open=function(){var n=this;return this.ul&&this.form.tabs(this.opts.tabs),setTimeout(function(){n.dialog.find(":text").keydown(function(t){t.keyCode==13&&(t.preventDefault(),n.form.submit())}).filter(":first")[0].focus()},200),this.dialog.dialog("open"),this},this.close=function(){typeof this.opts.close=="function"&&this.opts.close(),this.dialog.dialog("destroy")}}$(document).ready(function(){$(".cboPageList").change(function(){var n=$("select.cboPageList option:selected").val(),t="{'tabID':'"+n+"'}";$.ajax({type:"POST",url:ResolveUrl("~/Webservice/Ajax.aspx/LoadViewLayout"),data:t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var t,i,r;$.each(n,function(n,i){t=i}),i=$.parseJSON(t),$(".cboLayout").empty(),r=$(".cboLayout"),jQuery.each(i,function(){r.append($("<option />").val(this.CategoryID).text(this.CategoryName))})},error:function(n,t,i){alert(n.statusText),alert(i)}})}),$(".cboLayout").change(function(){var n=$("select.cboLayout option:selected").val(),t="{'layoutID':'"+n+"'}";$.ajax({type:"POST",url:ResolveUrl("~/Webservice/Ajax.aspx/LoadModuleList"),data:t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var t,i,r;$.each(n,function(n,i){t=i}),i=$.parseJSON(t),$(".cboModuleListPage").empty(),r=$(".cboModuleListPage"),jQuery.each(i,function(){r.append($("<option />").val(this.CategoryID).text(this.CategoryName))})},error:function(n,t,i){alert(n.statusText),alert(i)}})}),$(".cboModuleListPage").change(function(){var n=$("select.cboModuleListPage option:selected").val(),t="{'moduleID':'"+n+"'}";$.ajax({type:"POST",url:ResolveUrl("~/Webservice/Ajax.aspx/LoadViewer"),data:t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var t,i,r;$.each(n,function(n,i){t=i}),i=$.parseJSON(t),$(".cboViewPage").empty(),r=$(".cboViewPage"),jQuery.each(i,function(){r.append($("<option />").val(this.CategoryID).text(this.CategoryName))})},error:function(n,t,i){alert(n.statusText),alert(i)}})}),$(".cboModuleList").change(function(){var n=$("select.cboModuleList option:selected").val(),t="{'moduleID':'"+n+"'}";$.ajax({type:"POST",url:ResolveUrl("~/Webservice/Ajax.aspx/LoadViewer"),data:t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var t,i,r;$.each(n,function(n,i){t=i}),i=$.parseJSON(t),$(".cboViewer").empty(),r=$(".cboViewer"),jQuery.each(i,function(){r.append($("<option />").val(this.CategoryID).text(this.CategoryName))})},error:function(n,t,i){alert(n.statusText),alert(i)}})})}),function(n){n.extend({tablesorter:new function(){function i(n,t){u(n+","+((new Date).getTime()-t.getTime())+"ms")}function u(n){typeof console!="undefined"&&typeof console.debug!="undefined"?console.log(n):alert(n)}function h(t,i){var o,e,r,f;if(t.config.debug&&(o=""),t.tBodies.length!=0){if(e=t.tBodies[0].rows,e[0]){var s=[],h=e[0].cells,l=h.length;for(r=0;r<l;r++)f=!1,n.metadata&&n(i[r]).metadata()&&n(i[r]).metadata().sorter?f=c(n(i[r]).metadata().sorter):t.config.headers[r]&&t.config.headers[r].sorter&&(f=c(t.config.headers[r].sorter)),f||(f=w(t,e,-1,r)),t.config.debug&&(o+="column:"+r+" parser:"+f.id+"\n"),s.push(f)}return t.config.debug&&u(o),s}}function w(n,i,r,f){for(var c=t.length,o=!1,s=!1,h=!0,e;s==""&&h;)r++,i[r]?(o=b(i,r,f),s=k(n.config,o),n.config.debug&&u("Checking if value was empty on row:"+r)):h=!1;for(e=1;e<c;e++)if(t[e].is(s,n,o))return t[e];return t[0]}function b(n,t,i){return n[t].cells[i]}function k(t,i){return n.trim(e(t,i))}function c(n){for(var r=t.length,i=0;i<r;i++)if(t[i].id.toLowerCase()==n.toLowerCase())return t[i];return!1}function l(t){var h,s,u,o,f;t.config.debug&&(h=new Date);var c=t.tBodies[0]&&t.tBodies[0].rows.length||0,l=t.tBodies[0].rows[0]&&t.tBodies[0].rows[0].cells.length||0,a=t.config.parsers,r={row:[],normalized:[]};for(s=0;s<c;++s){if(u=n(t.tBodies[0].rows[s]),o=[],u.hasClass(t.config.cssChildRow)){r.row[r.row.length-1]=r.row[r.row.length-1].add(u);continue}for(r.row.push(u),f=0;f<l;++f)o.push(a[f].format(e(t.config,u[0].cells[f]),t,u[0].cells[f]));o.push(r.normalized.length),r.normalized.push(o),o=null}return t.config.debug&&i("Building cache for "+c+" rows:",h),r}function e(t,i){return i?(t.supportsTextContent||(t.supportsTextContent=i.textContent||!1),t.textExtraction=="simple"?t.supportsTextContent?i.textContent:i.childNodes[0]&&i.childNodes[0].hasChildNodes()?i.childNodes[0].innerHTML:i.innerHTML:typeof t.textExtraction=="function"?t.textExtraction(i):n(i).text()):""}function o(t,r){var l,u,f,v,e;t.config.debug&&(l=new Date);var a=r,o=a.row,h=a.normalized,y=h.length,p=h[0].length-1,w=n(t.tBodies[0]),c=[];for(u=0;u<y;u++)if(f=h[u][p],c.push(o[f]),!t.config.appender)for(v=o[f].length,e=0;e<v;e++)w[0].appendChild(o[f][e]);t.config.appender&&t.config.appender(t,c),c=null,t.config.debug&&i("Rebuilt table:",l),s(t),setTimeout(function(){n(t).trigger("sortEnd")},0)}function d(t){var r,e,f;return t.config.debug&&(r=new Date),e=n.metadata?!0:!1,f=g(t),$tableHeaders=n(t.config.selectorHeaders,t).each(function(i){if(this.column=f[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=it(t.config.sortInitialOrder),this.count=this.order,(nt(this)||tt(t,i))&&(this.sortDisabled=!0),a(t,i)&&(this.order=this.lockedOrder=a(t,i)),!this.sortDisabled){var r=n(this).addClass(t.config.cssHeader);t.config.onRenderHeader&&t.config.onRenderHeader.apply(r)}t.config.headerList[i]=this}),t.config.debug&&(i("Built headers:",r),u($tableHeaders)),$tableHeaders}function g(n){for(var i=[],c={},v=n.getElementsByTagName("THEAD")[0],l=v.getElementsByTagName("TR"),h,f,t,a,s,u=0;u<l.length;u++)for(h=l[u].cells,f=0;f<h.length;f++){var e=h[f],r=e.parentNode.rowIndex,y=r+"-"+e.cellIndex,p=e.rowSpan||1,w=e.colSpan||1,o;for(typeof i[r]=="undefined"&&(i[r]=[]),t=0;t<i[r].length+1;t++)if(typeof i[r][t]=="undefined"){o=t;break}for(c[y]=o,t=r;t<r+p;t++)for(typeof i[t]=="undefined"&&(i[t]=[]),a=i[t],s=o;s<o+w;s++)a[s]="x"}return c}function nt(t){return n.metadata&&n(t).metadata().sorter===!1?!0:!1}function tt(n,t){return n.config.headers[t]&&n.config.headers[t].sorter===!1?!0:!1}function a(n,t){return n.config.headers[t]&&n.config.headers[t].lockedOrder?n.config.headers[t].lockedOrder:!1}function s(n){for(var i=n.config.widgets,r=i.length,t=0;t<r;t++)v(i[t]).format(n)}function v(n){for(var i=r.length,t=0;t<i;t++)if(r[t].id.toLowerCase()==n.toLowerCase())return r[t]}function it(n){return typeof n!="Number"?n.toLowerCase()=="desc"?1:0:n==1?1:0}function rt(n,t){for(var r=t.length,i=0;i<r;i++)if(t[i][0]==n)return!0;return!1}function y(t,i,r,u){var e,o,f;for(i.removeClass(u[0]).removeClass(u[1]),e=[],i.each(function(){this.sortDisabled||(e[this.column]=n(this))}),o=r.length,f=0;f<o;f++)e[r[f][0]].addClass(u[r[f][1]])}function ut(t){var r=t.config,i;r.widthFixed&&(i=n("<colgroup>"),n("tr:first td",t.tBodies[0]).each(function(){i.append(n("<col>").css("width",n(this).width()))}),n(t).prepend(i))}function ft(n,t){for(var f=n.config,e=t.length,r,u,i=0;i<e;i++)r=t[i],u=f.headerList[r[0]],u.count=r[1],u.count++}function p(n,t,r){var a,u,s,l,e;for(n.config.debug&&(a=new Date),u="var sortWrapper = function(a,b) {",s=t.length,e=0;e<s;e++){var o=t[e][0],h=t[e][1],v=n.config.parsers[o].type=="text"?h==0?f("text","asc",o):f("text","desc",o):h==0?f("numeric","asc",o):f("numeric","desc",o),c="e"+e;u+="var "+c+" = "+v,u+="if("+c+") { return "+c+"; } ",u+="else { "}for(l=r.normalized[0].length-1,u+="return a["+l+"]-b["+l+"];",e=0;e<s;e++)u+="}; ";return u+="return 0; ",u+="}; ",n.config.debug&&i("Evaling expression:"+u,new Date),eval(u),r.normalized.sort(sortWrapper),n.config.debug&&i("Sorting on "+t.toString()+" and dir "+h+" time:",a),r}function f(n,t,i){var r="a["+i+"]",u="b["+i+"]";return n=="text"&&t=="asc"?"("+r+" == "+u+" ? 0 : ("+r+" === null ? Number.POSITIVE_INFINITY : ("+u+" === null ? Number.NEGATIVE_INFINITY : ("+r+" < "+u+") ? -1 : 1 )));":n=="text"&&t=="desc"?"("+r+" == "+u+" ? 0 : ("+r+" === null ? Number.POSITIVE_INFINITY : ("+u+" === null ? Number.NEGATIVE_INFINITY : ("+u+" < "+r+") ? -1 : 1 )));":n=="numeric"&&t=="asc"?"("+r+" === null && "+u+" === null) ? 0 :("+r+" === null ? Number.POSITIVE_INFINITY : ("+u+" === null ? Number.NEGATIVE_INFINITY : "+r+" - "+u+"));":n=="numeric"&&t=="desc"?"("+r+" === null && "+u+" === null) ? 0 :("+r+" === null ? Number.POSITIVE_INFINITY : ("+u+" === null ? Number.NEGATIVE_INFINITY : "+u+" - "+r+"));":void 0}var t=[],r=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:!0,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:!1,cancelSelection:!0,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",debug:!1},this.benchmark=i,this.construct=function(t){return this.each(function(){var r,u,f,i,a,c;this.tHead&&this.tBodies&&(a=0,this.config={},i=n.extend(this.config,n.tablesorter.defaults,t),r=n(this),n.data(this,"tablesorter",i),u=d(this),this.config.parsers=h(this,u),f=l(this),c=[i.cssDesc,i.cssAsc],ut(this),u.click(function(t){var v=r[0].tBodies[0]&&r[0].tBodies[0].rows.length||0,w,s,l,e,h,a;if(!this.sortDisabled&&v>0){if(r.trigger("sortStart"),w=n(this),s=this.column,this.order=this.count++%2,this.lockedOrder&&(this.order=this.lockedOrder),t[i.sortMultiSortKey])if(rt(s,i.sortList))for(e=0;e<i.sortList.length;e++)h=i.sortList[e],a=i.headerList[h[0]],h[0]==s&&(a.count=h[1],a.count++,h[1]=a.count%2);else i.sortList.push([s,this.order]);else{if(i.sortList=[],i.sortForce!=null)for(l=i.sortForce,e=0;e<l.length;e++)l[e][0]!=s&&i.sortList.push(l[e]);i.sortList.push([s,this.order])}return setTimeout(function(){y(r[0],u,i.sortList,c),o(r[0],p(r[0],i.sortList,f))},1),!1}}).mousedown(function(){if(i.cancelSelection)return this.onselectstart=function(){return!1},!1}),r.bind("update",function(){var n=this;setTimeout(function(){n.config.parsers=h(n,u),f=l(n)},1)}).bind("updateCell",function(n,t){var r=this.config,i=[t.parentNode.rowIndex-1,t.cellIndex];f.normalized[i[0]][i[1]]=r.parsers[i[1]].format(e(r,t),t)}).bind("sorton",function(t,r){n(this).trigger("sortStart"),i.sortList=r;var e=i.sortList;ft(this,e),y(this,u,e,c),o(this,p(this,e,f))}).bind("appendCache",function(){o(this,f)}).bind("applyWidgetId",function(n,t){v(t).format(this)}).bind("applyWidgets",function(){s(this)}),n.metadata&&n(this).metadata()&&n(this).metadata().sortlist&&(i.sortList=n(this).metadata().sortlist),i.sortList.length>0&&r.trigger("sorton",[i.sortList]),s(this))})},this.addParser=function(n){for(var u=t.length,r=!0,i=0;i<u;i++)t[i].id.toLowerCase()==n.id.toLowerCase()&&(r=!1);r&&t.push(n)},this.addWidget=function(n){r.push(n)},this.formatFloat=function(n){var t=parseFloat(n);return isNaN(t)?0:t},this.formatInt=function(n){var t=parseInt(n);return isNaN(t)?0:t},this.isDigit=function(t){return/^[-+]?\d*$/.test(n.trim(t.replace(/[,.']/g,"")))},this.clearTableBody=function(t){if(n.browser.msie){function i(){while(this.firstChild)this.removeChild(this.firstChild)}i.apply(t.tBodies[0])}else t.tBodies[0].innerHTML=""}}}),n.fn.extend({tablesorter:n.tablesorter.construct});var t=n.tablesorter;t.addParser({id:"text",is:function(){return!0},format:function(t){return n.trim(t.toLocaleLowerCase())},type:"text"}),t.addParser({id:"digit",is:function(t,i){var r=i.config;return n.tablesorter.isDigit(t,r)},format:function(t){return n.tablesorter.formatFloat(t)},type:"numeric"}),t.addParser({id:"currency",is:function(n){return/^[£$€?.]/.test(n)},format:function(t){return n.tablesorter.formatFloat(t.replace(new RegExp(/[£$€]/g),""))},type:"numeric"}),t.addParser({id:"ipAddress",is:function(n){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(n)},format:function(t){for(var u=t.split("."),f="",e=u.length,r,i=0;i<e;i++)r=u[i],f+=r.length==2?"0"+r:r;return n.tablesorter.formatFloat(f)},type:"numeric"}),t.addParser({id:"url",is:function(n){return/^(https?|ftp|file):\/\/$/.test(n)},format:function(n){return jQuery.trim(n.replace(new RegExp(/(https?|ftp|file):\/\//),""))},type:"text"}),t.addParser({id:"isoDate",is:function(n){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(n)},format:function(t){return n.tablesorter.formatFloat(t!=""?new Date(t.replace(new RegExp(/-/g),"/")).getTime():"0")},type:"numeric"}),t.addParser({id:"percent",is:function(t){return/\%$/.test(n.trim(t))},format:function(t){return n.tablesorter.formatFloat(t.replace(new RegExp(/%/g),""))},type:"numeric"}),t.addParser({id:"usLongDate",is:function(n){return n.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(t){return n.tablesorter.formatFloat(new Date(t).getTime())},type:"numeric"}),t.addParser({id:"shortDate",is:function(n){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(n)},format:function(t,i){var r=i.config;return t=t.replace(/\-/g,"index.html"),r.dateFormat=="us"?t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2"):r.dateFormat=="uk"?t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1"):(r.dateFormat=="dd/mm/yy"||r.dateFormat=="dd-mm-yy")&&(t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3")),n.tablesorter.formatFloat(new Date(t).getTime())},type:"numeric"}),t.addParser({id:"time",is:function(n){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(n)},format:function(t){return n.tablesorter.formatFloat(new Date("2000/01/01 "+t).getTime())},type:"numeric"}),t.addParser({id:"metadata",is:function(){return!1},format:function(t,i,r){var u=i.config,f=u.parserMetadataName?u.parserMetadataName:"sortValue";return n(r).metadata()[f]},type:"numeric"}),t.addWidget({id:"zebra",format:function(t){var f,i,r,u;t.config.debug&&(f=new Date),r=-1,n("tr:visible",t.tBodies[0]).each(function(){i=n(this),i.hasClass(t.config.cssChildRow)||r++,u=r%2==0,i.removeClass(t.config.widgetZebra.css[u?0:1]).addClass(t.config.widgetZebra.css[u?1:0])}),t.config.debug&&n.tablesorter.benchmark("Applying Zebra widget",f)}})}(jQuery),function(n){var t,i=n();n.fn.sortable=function(r){var u=String(r);return r=n.extend({connectWith:!1},r),this.each(function(){var o,s,f,e;if(/^enable|disable|destroy$/.test(u)){f=n(this).children(n(this).data("items")).attr("draggable",u=="enable"),u=="destroy"&&f.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s");return}f=n(this).children(r.items),e=n("<"+(/^ul|ol$/i.test(this.tagName)?"li":"div")+' class="sortable-placeholder">'),f.find(r.handle).mousedown(function(){o=!0}).mouseup(function(){o=!1}),n(this).data("items",r.items),i=i.add(e),r.connectWith&&n(r.connectWith).add(this).data("connectWith",r.connectWith);f.attr("draggable","true").on("dragstart.h5s",function(i){if(r.handle&&!o)return!1;o=!1;var u=i.originalEvent.dataTransfer;u.effectAllowed="move",u.setData("Text","dummy"),s=(t=n(this)).addClass("sortable-dragging").index()}).on("dragend.h5s",function(){t.removeClass("sortable-dragging").show(),i.detach(),s!=t.index()&&f.parent().trigger("sortupdate",{item:t}),t=null}).not("a[href], img").on("selectstart.h5s",function(){return this.dragDrop&&this.dragDrop(),!1}).end().add([this,e]).on("dragover.h5s dragenter.h5s drop.h5s",function(u){return!f.is(t)&&r.connectWith!==n(t).parent().data("connectWith")?!0:u.type=="drop"?(u.stopPropagation(),i.filter(":visible").after(t),!1):(u.preventDefault(),u.originalEvent.dataTransfer.dropEffect="move",f.is(this)?(r.forcePlaceholderSize&&e.height(t.outerHeight()),t.hide(),n(this)[e.index()<n(this).index()?"after":"before"](e),i.not(e).detach()):i.is(this)||n(this).children(r.items).length||(i.detach(),n(this).append(e)),!1)})})}}(jQuery),$(function(){var n,t;$(".ContainerTagDrag").sortable({connectWith:".ContainerTagDrag"}),$(".imgDel").click(function(){var i=confirm("Bạn có chắc chắn muốn xóa module này không?"),t;i&&(t=$(this).parents(".container"),n+=$(t).attr("alt")+";",t.fadeOut("fast").remove())}),n=";",$("#btnupdateStatus").click(function(){var f,t,r,e,u,i,o,s,h;if($.ajaxSetup({cache:!1}),f=confirm("Bạn có chắc chắn cập nhật trạng thái kéo thả?"),f){for(myarrayTag=$(".ContainerTagDrag"),t=0;t<myarrayTag.length;t++){if(r=myarrayTag[t],e=$(r).attr("title"),myarraycontainer=$(r).find(".container"),u=";",myarraycontainer.length>0)for(i=0;i<myarraycontainer.length;i++)o=myarraycontainer[i],u+=$(o).attr("alt")+";";s=JSON.stringify({tagname:e+u,iddel:n}),h="",h=document.domain=="localhost"?"http://"+location.host:"http://"+document.domain,$.ajax({cache:!1,type:"POST",contentType:"application/json; charset=utf-8",url:ResolveUrl("~/Default.aspx/UpdateDrag"),data:s,success:function(){},error:function(){}})}alert("Cập nhật trạng thái thành công.")}}),t=$(".lnkmodeDrag").attr("title"),t=="Không hiển thị kéo thả"?$("#btnupdateStatus").css("display","block"):$("#btnupdateStatus").css("display","none")}),function(n){n.fn.equalHeight=function(){tallest=0,this.each(function(){thisHeight=n(this).height(),thisHeight>tallest&&(tallest=thisHeight)}),this.each(function(){n(this).height(tallest)})}}(jQuery),$(document).ready(function(){var n="+",t="-",i=!1;$(".toggle").prev().prepend(' <a href="#" class="toggleLink">'+t+"<\/a>"),$(".toggle").show(),$("a.toggleLink").click(function(){return i=!i,$(this).text()==n?($(this).text(t),$(this).parent().next(".toggle").slideDown("slow")):($(this).text(n),$(this).parent().next(".toggle").slideUp("slow")),!1})}),eli18n.prototype=new function(){this.messages={},this._domain="",this.load=function(n){var t,i,r;if(typeof n=="object")for(t in n)if(i=n[t],typeof i=="object"){this.messages[t]||(this.messages[t]={});for(r in i)typeof i[r]=="string"&&(this.messages[t][r]=i[r])}return this},this.translate=function(n,t){var t=t&&this.messages[t]?t:this._domain;return this.messages[t]&&this.messages[t][n]?this.messages[t][n]:n},this.format=function(n,t,i){if(n=this.translate(n,i),typeof t=="object")for(var r in t)n=n.replace("%"+r,this.translate(t[r],i));return n}},function(n){n.fn.elColorPicker=function(t){function u(n){i.val(n),r.change&&r.change(i.val()),i.palette.slideUp()}function f(){i.palette=n("<div />").addClass(r.paletteClass+" rounded-3");for(var t=0;t<r.colors.length;t++)n("<div />").addClass("color").css("background-color",r.colors[t]).attr({title:r.colors[t],unselectable:"on"}).appendTo(i.palette).mouseenter(function(){var t=n(this).attr("title");i.input.val(t),i.preview.css("background-color",t)}).click(function(t){t.stopPropagation(),u(n(this).attr("title"))});i.input=n('<input type="text" />').addClass("rounded-3").attr("size",8).click(function(t){t.stopPropagation(),n(this).focus()}).keydown(function(t){var r,f;return t.ctrlKey||t.metaKey?!0:(r=t.keyCode,r==27)?i.mouseleave():r!=8&&r!=13&&r!=46&&r!=37&&r!=39&&(r<48||r>57)&&(r<65||r>70)?!1:(f=n(this).val(),(f.length==7||f.length==0)&&(r==13&&(t.stopPropagation(),t.preventDefault(),u(f),i.palette.slideUp()),t.keyCode!=8&&t.keyCode!=46&&r!=37&&r!=39)?!1:void 0)}).keyup(function(){var t=n(this).val();t.length==7&&/^#[0-9abcdef]{6}$/i.test(t)&&i.val(t)}),i.preview=n("<div />").addClass("preview rounded-3").click(function(n){n.stopPropagation(),u(i.input.val())}),i.palette.append(n("<div />").addClass("clearfix")).append(n("<div />").addClass("panel").append(i.input).append(i.preview)),r.palettePosition=="outer"?(i.palette.hide().appendTo(i.parents("body").eq(0)).mouseleave(function(){i.palette.is(":animated")||(n(this).slideUp(),i.val(i.val()))}),i.mouseleave(function(n){n.relatedTarget!=i.palette.get(0)&&(i.palette.is(":animated")||(i.palette.slideUp(),i.val(i.val())))})):i.append(i.palette.hide()).mouseleave(function(){i.palette.slideUp(),i.val(i.val())}),i.val(i.val())}var i=this,r=n.extend({},n.fn.elColorPicker.defaults,t);return this.hidden=n('<input type="hidden" />').attr("name",r.name).val(r.color||"").appendTo(this),this.palette=null,this.preview=null,this.input=null,this.empty().addClass(r["class"]+" rounded-3").css({position:"relative","background-color":r.color||""}).click(function(){if(!i.hasClass("disabled")){if(i.palette||f(),r.palettePosition=="outer"&&i.palette.css("display")=="none"){var t=n(this).offset(),u=i.palette.width(),e=i.parents("body").width()-t.left>=u?t.left:t.left+n(this).outerWidth()-u;i.palette.css({left:e+"px",top:t.top+n(this).height()+1+"px"})}i.palette.slideToggle()}}),this.val=function(n){if(n||n==="")this.hidden.val(n),r.update?r.update(this.hidden.val()):this.css("background-color",n),i.palette&&(i.preview.css("background-color",n),i.input.val(n));else return this.hidden.val();return this},this},n.fn.elColorPicker.defaults={"class":"el-colorpicker",paletteClass:"el-palette",palettePosition:"inner",name:"color",color:"",update:null,change:function(){},colors:["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ffcccc","#cc9999","#996666","#663333","#330000","#ff9999","#cc6666","#cc3333","#993333","#660000","#ff6666","#ff3333","#ff0000","#cc0000","#990000","#ff9966","#ff6633","#ff3300","#cc3300","#993300","#ffcc99","#cc9966","#cc6633","#996633","#663300","#ff9933","#ff6600","#ff9900","#cc6600","#cc9933","#ffcc66","#ffcc33","#ffcc00","#cc9900","#996600","#ffffcc","#cccc99","#999966","#666633","#333300","#ffff99","#cccc66","#cccc33","#999933","#666600","#ffff66","#ffff33","#ffff00","#cccc00","#999900","#ccff66","#ccff33","#ccff00","#99cc00","#669900","#ccff99","#99cc66","#99cc33","#669933","#336600","#99ff33","#99ff00","#66ff00","#66cc00","#66cc33","#99ff66","#66ff33","#33ff00","#33cc00","#339900","#ccffcc","#99cc99","#669966","#336633","#003300","#99ff99","#66cc66","#33cc33","#339933","#006600","#66ff66","#33ff33","#00ff00","#00cc00","#009900","#66ff99","#33ff66","#00ff33","#00cc33","#009933","#99ffcc","#66cc99","#33cc66","#339966","#006633","#33ff99","#00ff66","#00ff99","#00cc66","#33cc99","#66ffcc","#33ffcc","#00ffcc","#00cc99","#009966","#ccffff","#99cccc","#669999","#336666","#003333","#99ffff","#66cccc","#33cccc","#339999","#006666","#66cccc","#33ffff","#00ffff","#00cccc","#009999","#66ccff","#33ccff","#00ccff","#0099cc","#006699","#99ccff","#6699cc","#3399cc","#336699","#003366","#3399ff","#0099ff","#0066ff","#066ccc","#3366cc","#6699ff","#3366ff","#0033ff","#0033cc","#003399","#ccccff","#9999cc","#666699","#333366","#000033","#9999ff","#6666cc","#3333cc","#333399","#000066","#6666ff","#3333ff","#0000ff","#0000cc","#009999","#9966ff","#6633ff","#3300ff","#3300cc","#330099","#cc99ff","#9966cc","#6633cc","#663399","#330066","#9933ff","#6600ff","#9900ff","#6600cc","#9933cc","#cc66ff","#cc33ff","#cc00ff","#9900cc","#660099","#ffccff","#cc99cc","#996699","#663366","#330033","#ff99ff","#cc66cc","#cc33cc","#993399","#660066","#ff66ff","#ff33ff","#ff00ff","#cc00cc","#990099","#ff66cc","#ff33cc","#ff00cc","#cc0099","#990066","#ff99cc","#cc6699","#cc3399","#993366","#660033","#ff3399","#ff0099","#ff0066","#cc0066","#cc3366","#ff6699","#ff3366","#ff0033","#cc0033","#990033"]}}(jQuery),function(n){n.fn.elBorderSelect=function(t){function s(n){function i(n){return hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n?hexDigits[(n-n%16)/16]+hexDigits[n%16]:"00"}var t=(n||"").match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/);return t?"#"+i(t[1])+i(t[2])+i(t[3]):""}function h(t){var i,r;if(!t)return t;if(i=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/),i&&(t=i[1],unit=i[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t),isNaN(t))return"";r=parseInt(n(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*r);case"pt":return parseInt(t*r/12);case"%":return parseInt(t*r/100)}return t}var r=this,o=this.eq(0),i=n.extend({},n.fn.elBorderSelect.defaults,t),u=n('<input type="text" />').attr({name:i.name+"[width]",size:3}).css("text-align","right").change(function(){r.change()}),f=n("<div />").css("position","relative").elColorPicker({"class":"el-colorpicker ui-icon ui-icon-pencil",name:i.name+"[color]",palettePosition:"outer",change:function(){r.change()}}),e=n("<div />").elSelect({tpl:'<div style="border-bottom:4px %val #000;width:100%;margin:7px 0"> <\/div>',tpls:{"":"%label"},maxHeight:i.styleHeight||null,select:function(){r.change()},src:{"":"none",solid:"solid",dashed:"dashed",dotted:"dotted",double:"double",groove:"groove",ridge:"ridge",inset:"inset",outset:"outset"}});return o.empty().addClass(i["class"]).attr("name",i.name||"").append(n("<table />").attr("cellspacing",0).append(n("<tr />").append(n("<td />").append(u).append(" px")).append(n("<td />").append(e)).append(n("<td />").append(f)))),this.change=function(){i.change&&i.change(this.val())},this.val=function(t){var i,o,r,c,l;return t||t===""?(c="",t.nodeName||t.css?(t.css||(t=n(t)),c=t.css("border"),(c=t.css("border"))?i=o=r=c:(i=t.css("border-width"),o=t.css("border-style"),r=t.css("border-color"))):(i=t.width||"",o=t.style||"",r=t.color||""),u.val(h(i)),l=o?o.match(/(solid|dashed|dotted|double|groove|ridge|inset|outset)/i):"",e.val(l?l[1]:""),f.val(r.indexOf("#")===0?r:s(r)),this):(i=parseInt(u.val()),i=isNaN(i)?"":i+"px",o=e.val(),r=f.val(),{width:i,style:o,color:r,css:n.trim(i+" "+o+" "+r)})},this.val(i.value),this},n.fn.elBorderSelect.defaults={name:"el-borderselect","class":"el-borderselect",value:{},change:null}}(jQuery),function(t){t.fn.elPaddingInput=function(i){function f(i){return i=t.trim(i.toString()),i[0]=="."&&(i="0"+i),n=parseFloat(i),isNaN(n)?i=="auto"?i:"":n}function e(){r.change&&r.change(u)}var u=this,r=t.extend({},t.fn.elPaddingInput.defaults,{name:this.attr("name")},i);return this.regexps={main:new RegExp(r.type=="padding"?'paddings*:s*([^;"]+)':'margins*:s*([^;"]+)',"im"),left:new RegExp(r.type=="padding"?'padding-lefts*:s*([^;"]+)':'margin-lefts*:s*([^;"]+)',"im"),top:new RegExp(r.type=="padding"?'padding-tops*:s*([^;"]+)':'margin-tops*:s*([^;"]+)',"im"),right:new RegExp(r.type=="padding"?'padding-rights*:s*([^;"]+)':'margin-rights*:s*([^;"]+)',"im"),bottom:new RegExp(r.type=="padding"?'padding-bottoms*:s*([^;"]+)':'margin-bottoms*:s*([^;"]+)',"im")},t.each(["left","top","right","bottom"],function(){u[this]=t('<input type="text" />').attr("size",3).css("text-align","right").css("border-"+this,"2px solid red").bind("change",function(){t(this).val(f(t(this).val())),e()}).attr("name",r.name+"["+this+"]")}),t.each(["uleft","utop","uright","ubottom"],function(){u[this]=t("<select />").append('<option value="px">px<\/option>').append('<option value="em">em<\/option>').append('<option value="pt">pt<\/option>').bind("change",function(){e()}).attr("name",r.name+"["+this+"]"),r.percents&&u[this].append('<option value="%">%<\/option>')}),this.empty().addClass(r["class"]).append(this.left).append(this.uleft).append(" x ").append(this.top).append(this.utop).append(" x ").append(this.right).append(this.uright).append(" x ").append(this.bottom).append(this.ubottom),this.val=function(n){var e,o,s,r,n;if(n||n==="")return(n.nodeName||n.css)&&(n.css||(n=t(n)),e={left:"",top:"",right:"",bottom:""},o=(n.attr("style")||"").toLowerCase(),o&&(o=t.trim(o),s=o.match(this.regexps.main),s?(r=t.trim(s[1]).replace(/\s+/g," ").split(" ",4),e.top=r[0],e.right=r[1]&&r[1]!==""?r[1]:e.top,e.bottom=r[2]&&r[2]!==""?r[2]:e.top,e.left=r[3]&&r[3]!==""?r[3]:e.right):t.each(["left","top","right","bottom"],function(){var n=this.toString();s=o.match(u.regexps[n]),s&&(e[n]=s[1])})),n=e),t.each(["left","top","right","bottom"],function(){var t=this.toString(),r,i;u[t].val(""),u["u"+t].val(),typeof n[t]!="undefined"&&n[t]!==null&&(n[t]=n[t].toString(),r=f(n[t]),u[t].val(r),i=n[t].match(/(px|em|pt|%)/i),u["u"+t].val(i?i[1]:"px"))}),this;var h=f(this.left.val()),c=f(this.top.val()),l=f(this.right.val()),a=f(this.bottom.val()),i={left:h=="auto"||h==0?h:h!==""?h+this.uleft.val():"",top:c=="auto"||c==0?c:c!==""?c+this.utop.val():"",right:l=="auto"||l==0?l:l!==""?l+this.uright.val():"",bottom:a=="auto"||a==0?a:a!==""?a+this.ubottom.val():"",css:""};return i.left!==""&&i.right!==""&&i.top!==""&&i.bottom!==""&&(i.css=i.left==i.right&&i.top==i.bottom?i.top+" "+i.left:i.top+" "+i.right+" "+i.bottom+" "+i.left),i},this.val(r.value),this},t.fn.elPaddingInput.defaults={name:"el-paddinginput","class":"el-paddinginput",type:"padding",value:{},percents:!0,change:null}}(jQuery),function(n){n.fn.elSelect=function(t){function l(n){var t=i.labelTpl||i.tpls[n]||i.tpl;s.html(t.replace(/%val/g,n).replace(/%label/,i.src[n])).children().attr({unselectable:"on"})}function a(){var t,s,f,h;r=n("<div />").addClass(i.listClass+" rounded-3").hide().appendTo(u.mouseleave(function(){r.slideUp()}));for(t in i.src)s=i.tpls[t]||i.tpl,n("<div />").attr("name",t).append(n(s.replace(/%val/g,t).replace(/%label/g,i.src[t])).attr({unselectable:"on"})).appendTo(r).hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault();var u=n(this).attr("name");o.val(u),i.select(u),r.slideUp()});f=u.outerWidth(),r.width()<f&&r.width(f),h=r.height(),i.maxHeight>0&&h>i.maxHeight&&r.height(i.maxHeight),o.val(e.val())}var o=this,u=this.eq(0),i=n.extend({},n.fn.elSelect.defaults,t),e=n('<input type="hidden" />').attr("name",i.name),s=n("<label />").attr({unselectable:"on"}).addClass("rounded-left-3"),r=null,f=null,h,c;if(u.get(0).nodeName=="SELECT"&&(i.src={},u.children("option").each(function(){i.src[n(this).val()]=n(this).text()}),i.value=u.val(),i.name=u.attr("name"),u.replaceWith(u=n("<div />"))),!i.value||!i.src[i.val]){i.value=null,h=0;for(c in i.src)h++==0&&(i.value=c)}return this.val=function(t){return t||t===""?(i.src[t]&&(e.val(t),l(t),r&&r.children().each(function(){n(this).attr("name")==t?n(this).addClass("active"):n(this).removeClass("active")})),this):e.val()},u.empty().addClass(i["class"]+" rounded-3").attr({unselectable:"on"}).append(e).append(s).hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(){r||a(),r.slideToggle(),n.browser.msie&&!f&&(r.children().each(function(){f=Math.max(f,n(this).width())}),f>r.width()&&r.width(f+40))}),this.val(i.value),this},n.fn.elSelect.defaults={name:"el-select","class":"el-select",listClass:"list",labelTpl:null,tpl:"<%val>%label<\/%val>",tpls:{},value:null,src:{},select:function(n){window.console&&window.console.log&&window.console.log("selected: "+n)},maxHeight:410}}(jQuery),function(n){elRTE=function(t,i){var r,f,u,e,o;if(!t||!t.nodeName)return alert('elRTE: argument "target" is not DOM Element');if(r=this,this.version="1.3",this.build="2011-06-23",this.options=n.extend(!0,{},this.options,i),this.browser=n.browser,this.target=n(t),this.lang=""+this.options.lang,this._i18n=new eli18n({textdomain:"rte",messages:{rte:this.i18Messages[this.lang]||{}}}),this.rtl=!!(/^(ar|fa|he)$/.test(this.lang)&&this.i18Messages[this.lang]),this.rtl&&(this.options.cssClass+=" el-rte-rtl"),this.toolbar=n('<div class="toolbar"/>'),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("frameborder",0),this.workzone=n('<div class="workzone"/>').append(this.iframe).append(this.source),this.statusbar=n('<div class="statusbar"/>'),this.tabsbar=n('<div class="tabsbar"/>'),this.editor=n('<div class="'+this.options.cssClass+'" />').append(this.toolbar).append(this.workzone).append(this.statusbar).append(this.tabsbar),this.doc=null,this.$doc=null,this.window=null,this.utils=new this.utils(this),this.dom=new this.dom(this),this.filter=new this.filter(this),this.updateHeight=function(){r.workzone.add(r.iframe).add(r.source).height(r.workzone.height())},this.resizable=function(t){var i=this;this.options.resizable&&n.fn.resizable&&(t?this.editor.resizable({handles:"se",alsoResize:this.workzone,minWidth:300,minHeight:200}).bind("resize",i.updateHeight):this.editor.resizable("destroy").unbind("resize",i.updateHeight))},this.editor.insertAfter(t),u="",t.nodeName=="TEXTAREA"?(this.source=this.target,this.source.insertAfter(this.iframe).hide(),u=this.target.val()):(this.source=n("<textarea />").insertAfter(this.iframe).hide(),u=this.target.hide().html()),this.source.attr("name",this.target.attr("name")||this.target.attr("id")),u=n.trim(u),u||(u=" "),this.options.allowSource&&this.tabsbar.append('<div class="tab editor rounded-bottom-7 active">'+r.i18n("Editor")+'<\/div><div class="tab source rounded-bottom-7">'+r.i18n("Source")+'<\/div><div class="clearfix" style="clear:both"/>').children(".tab").click(function(){n(this).hasClass("active")||(r.tabsbar.children(".tab").toggleClass("active"),r.workzone.children().toggle(),n(this).hasClass("editor")?(r.updateEditor(),r.window.focus(),r.ui.update(!0)):(r.updateSource(),r.source.focus(),n.browser.msie||r.source[0].setSelectionRange(0,0),r.ui.disable(),r.statusbar.empty()))}),this.window=this.iframe.contentWindow,this.doc=this.iframe.contentWindow.document,this.$doc=n(this.doc),f='<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',n.each(r.options.cssfiles,function(){f+='<link rel="stylesheet" type="text/css" href="'+this+'" />'}),this.doc.open(),e=this.filter.wysiwyg(u),o=this.rtl?' class="el-rte-rtl"':"",this.doc.write(r.options.doctype+f+"<\/head><body"+o+">"+e+"<\/body><\/html>"),this.doc.close(),n.browser.msie)this.doc.body.contentEditable=!0;else{try{this.doc.designMode="on"}catch(s){}this.doc.execCommand("styleWithCSS",!1,this.options.styleWithCSS)}this.options.height>0&&this.workzone.height(this.options.height),this.options.width>0&&this.editor.width(this.options.width),this.updateHeight(),this.resizable(!0),this.window.focus(),this.history=new this.history(this),this.selection=new this.selection(this),this.ui=new this.ui(this),this.target.parents("form").bind("submit.elfinder",function(){r.source.parents("form").find('[name="el-select"]').remove(),r.beforeSave()}),this.source.bind("keydown",function(t){var r,i,u;t.keyCode==9&&(t.preventDefault(),n.browser.msie?(r=document.selection.createRange(),r.text="\t"+r.text,this.focus()):(i=this.value.substr(0,this.selectionStart),u=this.value.substr(this.selectionEnd),this.value=i+"\t"+u,this.setSelectionRange(i.length+1,i.length+1)))}),n(this.doc.body).bind("dragend",function(){setTimeout(function(){try{r.window.focus();var n=r.selection.getBookmark();r.selection.moveToBookmark(n),r.ui.update()}catch(t){}},200)}),this.typing=!1,this.lastKey=null,this.$doc.bind("mouseup",function(){r.typing=!1,r.lastKey=null,r.ui.update()}).bind("keyup",function(n){(n.keyCode>=8&&n.keyCode<=13||n.keyCode>=32&&n.keyCode<=40||n.keyCode==46||n.keyCode>=96&&n.keyCode<=111)&&r.ui.update()}).bind("keydown",function(t){if((t.metaKey||t.ctrlKey)&&t.keyCode==65)r.ui.update();else if(t.keyCode==13){var i=r.selection.getNode();if(r.dom.selfOrParent(i,/^PRE$/))return r.selection.insertNode(r.doc.createTextNode("\r\n")),!1;if(n.browser.safari&&t.shiftKey)return r.selection.insertNode(r.doc.createElement("br")),!1}return t.keyCode>=48&&t.keyCode<=57||t.keyCode==61||t.keyCode==109||t.keyCode>=65&&t.keyCode<=90||t.keyCode==188||t.keyCode==190||t.keyCode==191||t.keyCode>=219&&t.keyCode<=222?(r.typing||r.history.add(!0),r.typing=!0,r.lastKey=null):(t.keyCode==8||t.keyCode==46||t.keyCode==32||t.keyCode==13)&&(t.keyCode!=r.lastKey&&r.history.add(!0),r.lastKey=t.keyCode,r.typing=!1),t.keyCode==32&&n.browser.opera?(r.selection.insertNode(r.doc.createTextNode(" ")),!1):void 0}).bind("paste",function(t){if(r.options.allowPaste){var i=n(r.dom.create("div"))[0],u=r.doc.createTextNode("_");r.history.add(!0),r.typing=!0,r.lastKey=null,i.appendChild(u),r.selection.deleteContents().insertNode(i),r.selection.select(u),setTimeout(function(){i.parentNode?(n(i).html(r.filter.proccess("paste",n(i).html())),u=i.lastChild,r.dom.unwrap(i),u&&(r.selection.select(u),r.selection.collapse(!1))):(i.parentNode&&i.parentNode.removeChild(i),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(n(r.doc.body).html()))),r.selection.select(r.doc.body.firstChild),r.selection.collapse(!0)),n(r.doc.body).mouseup()},15)}else t.stopPropagation(),t.preventDefault()}),n.browser.msie&&this.$doc.bind("keyup",function(t){t.keyCode==86&&(t.metaKey||t.ctrlKey)&&(r.history.add(!0),r.typing=!0,r.lastKey=null,r.selection.saveIERange(),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(n(r.doc.body).html()))),r.selection.restoreIERange(),n(r.doc.body).mouseup(),this.ui.update())}),n.browser.safari&&this.$doc.bind("click",function(t){n(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl"),t.target.nodeName=="IMG"&&n(t.target).addClass("elrte-webkit-hl")}).bind("keyup",function(){n(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl")}),this.window.focus(),this.destroy=function(){this.updateSource(),this.target.is("textarea")?this.target.val(n.trim(this.source.val())):this.target.html(n.trim(this.source.val())),this.editor.remove(),this.target.show().parents("form").unbind("submit.elfinder")}},elRTE.prototype.i18n=function(n){return this._i18n.translate(n)},elRTE.prototype.open=function(){this.editor.show()},elRTE.prototype.close=function(){this.editor.hide()},elRTE.prototype.updateEditor=function(){this.val(this.source.val())},elRTE.prototype.updateSource=function(){this.source.val(this.filter.source(n(this.doc.body).html()))},elRTE.prototype.val=function(t){if(typeof t=="string")t=""+t,this.source.is(":visible")?this.source.val(this.filter.source2source(t)):n.browser.msie?(this.doc.body.innerHTML="<br />"+this.filter.wysiwyg(t),this.doc.body.removeChild(this.doc.body.firstChild)):this.doc.body.innerHTML=this.filter.wysiwyg(t);else return this.source.is(":visible")?this.filter.source2source(this.source.val()).trim():this.filter.source(n(this.doc.body).html()).trim()},elRTE.prototype.beforeSave=function(){this.source.val(n.trim(this.val())||"")},elRTE.prototype.save=function(){this.beforeSave(),this.editor.parents("form").submit()},elRTE.prototype.log=function(n){window.console&&window.console.log&&window.console.log(n)},elRTE.prototype.i18Messages={},n.fn.elrte=function(n,t){var r=typeof n=="string"?n:"",i;return(this.each(function(){this.elrte||(this.elrte=new elRTE(this,typeof n=="object"?n:{}));switch(r){case"open":case"show":this.elrte.open();break;case"close":case"hide":this.elrte.close();break;case"updateSource":this.elrte.updateSource();break;case"destroy":this.elrte.destroy()}}),r=="val")?this.length?this.length==1?t?this[0].elrte.val(t):this[0].elrte.val():(i={},this.each(function(){i[this.elrte.source.attr("name")]=this.elrte.val()}),i):"":this}}(jQuery),function(n){elRTE.prototype.dom=function(t){this.rte=t;var r=this;this.regExp={textNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TD|TH|TT|VAR)$/,textContainsNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DL|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|OL|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|TT|UL|VAR)$/,block:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|UL)$/,selectionBlock:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TD|TH|TR|UL)$/,header:/^H[1-6]$/,formElement:/^(FORM|INPUT|HIDDEN|TEXTAREA|SELECT|BUTTON)$/},this.root=function(){return this.rte.body},this.create=function(n){return this.rte.doc.createElement(n)},this.createBookmark=function(){var t=this.rte.doc.createElement("span");return t.id="elrte-bm-"+Math.random().toString().substr(2),n(t).addClass("elrtebm elrte-protected"),t},this.indexOf=function(t){var i=0;for(t=n(t);(t=t.prev())&&t.length;)i++;return i},this.attr=function(t,i){var r="";return t.nodeType==1&&(r=n(t).attr(i),r&&i!="src"&&i!="href"&&i!="title"&&i!="alt"&&(r=r.toString().toLowerCase())),r||""},this.findCommonAncestor=function(t,i){var r;if(!t||!i)return this.rte.log("dom.findCommonAncestor invalid arguments");if(t==i)return t;if(t.nodeName=="BODY"||i.nodeName=="BODY")return this.rte.doc.body;var u=n(t).parents(),f=n(i).parents(),e=f.length-1,o=f[e];for(r=u.length-1;r>=0;r--,e--)if(u[r]==f[e])o=u[r];else break;return o},this.isEmpty=function(t){return t.nodeType==1?this.regExp.textNodes.test(t.nodeName)?n.trim(n(t).text()).length==0:!1:t.nodeType==3?/^(TABLE|THEAD|TFOOT|TBODY|TR|UL|OL|DL)$/.test(t.parentNode.nodeName)||t.nodeValue==""||n.trim(t.nodeValue).length==0&&!(t.nextSibling&&t.previousSibling&&t.nextSibling.nodeType==1&&t.previousSibling.nodeType==1&&!this.regExp.block.test(t.nextSibling.nodeName)&&!this.regExp.block.test(t.previousSibling.nodeName)):!0},this.next=function(n){while(n.nextSibling&&(n=n.nextSibling))if(n.nodeType==1||n.nodeType==3&&!this.isEmpty(n))return n;return null},this.prev=function(n){while(n.previousSibling&&(n=n.previousSibling))if(n.nodeType==1||n.nodeType==3&&!this.isEmpty(n))return n;return null},this.isPrev=function(n,t){while(n=this.prev(n))if(n==t)return!0;return!1},this.nextAll=function(n){for(var t=[];n=this.next(n);)t.push(n);return t},this.prevAll=function(n){for(var t=[];n=this.prev(n);)t.push(n);return t},this.toLineEnd=function(n){for(var t=[];(n=this.next(n))&&n.nodeName!="BR"&&n.nodeName!="HR"&&this.isInline(n);)t.push(n);return t},this.toLineStart=function(n){for(var t=[];(n=this.prev(n))&&n.nodeName!="BR"&&n.nodeName!="HR"&&this.isInline(n);)t.unshift(n);return t},this.isFirstNotEmpty=function(t){while(t=this.prev(t))if(t.nodeType==1||t.nodeType==3&&n.trim(t.nodeValue)!="")return!1;return!0},this.isLastNotEmpty=function(n){while(n=this.next(n))if(!this.isEmpty(n))return!1;return!0},this.isOnlyNotEmpty=function(n){return this.isFirstNotEmpty(n)&&this.isLastNotEmpty(n)},this.findLastNotEmpty=function(n){if(this.rte.log("findLastNotEmpty Who is here 0_o"),n.nodeType==1&&(l=n.lastChild)){if(!this.isEmpty(l))return l;while(l.previousSibling&&(l=l.previousSibling))if(!this.isEmpty(l))return l}return!1},this.isInline=function(t){if(t.nodeType==3)return!0;if(t.nodeType==1){t=n(t);var i=t.css("display"),r=t.css("float");return i=="inline"||i=="inline-block"||r=="left"||r=="right"}return!0},this.is=function(n,t){if(n&&n.nodeName){if(typeof t=="string"&&(t=this.regExp[t]||/.?/),t instanceof RegExp&&n.nodeName)return t.test(n.nodeName);if(typeof t=="function")return t(n)}return!1},this.filter=function(n,t){var r=[],i;if(!n.push)return this.is(n,t)?n:null;for(i=0;i<n.length;i++)this.is(n[i],t)&&r.push(n[i]);return r},this.parents=function(n,t){for(var i=[];n&&(n=n.parentNode)&&n.nodeName!="BODY"&&n.nodeName!="HTML";)this.is(n,t)&&i.push(n);return i},this.parent=function(n,t){return this.parents(n,t)[0]||null},this.selfOrParent=function(n,t,i){return this.is(n,t)?n:this.parent(n,i||t)},this.selfOrParentLink=function(n){return n=this.selfOrParent(n,/^A$/),n&&n.href?n:null},this.selfOrParentAnchor=function(n){return n=this.selfOrParent(n,/^A$/),n&&!n.href&&n.name?n:null},this.childLinks=function(t){var i=[];return n("a[href]",t).each(function(){i.push(this)}),i},this.selectionHas=function(n){var t=this.rte.selection.cloneContents(),i;if(t&&t.childNodes&&t.childNodes.length)for(i=0;i<t.childNodes.length;i++)if(typeof n=="function"){if(n(t.childNodes[i]))return!0}else if(t instanceof RegExp&&n.test(t.childNodes[i].nodeName))return!0;return!1},this.wrap=function(t,i){return t=n.isArray(t)?t:[t],i=i.nodeName?i:this.create(i),t[0]&&t[0].nodeType&&t[0].parentNode&&(i=t[0].parentNode.insertBefore(i,t[0]),n(t).each(function(){this!=i&&i.appendChild(this)})),i},this.unwrap=function(n){if(n&&n.parentNode){while(n.firstChild)n.parentNode.insertBefore(n.firstChild,n);n.parentNode.removeChild(n)}},this.wrapContents=function(n,t){t=t.nodeName?t:this.create(t);for(var i=0;i<n.childNodes.length;i++)t.appendChild(n.childNodes[i]);return n.appendChild(t),t},this.cleanNode=function(t){if(t.nodeType==1){if(/^(P|LI)$/.test(t.nodeName)&&(l=this.findLastNotEmpty(t))&&l.nodeName=="BR"&&n(l).remove(),$n=n(t),$n.children().each(function(){this.cleanNode(this)}),t.nodeName!="BODY"&&!/^(TABLE|TR|TD)$/.test(t)&&this.isEmpty(t))return $n.remove();$n.attr("style")===""&&$n.removeAttr("style"),this.rte.browser.safari&&$n.hasClass("Apple-span")&&$n.removeClass("Apple-span"),t.nodeName!="SPAN"||$n.attr("style")||$n.attr("class")||$n.attr("id")||$n.replaceWith($n.html())}},this.cleanChildNodes=function(t){var i=this.cleanNode;n(t).children().each(function(){i(this)})},this.tableMatrix=function(t){var i=[],r;if(t&&t.nodeName=="TABLE"){r=0;function u(n){for(var t=0;t<=r;t++)if(!i[n][t])return t}n(t).find("tr").each(function(t){n.isArray(i[t])||(i[t]=[]),n(this).children("td,th").each(function(){for(var h=parseInt(n(this).attr("colspan")||1),c=parseInt(n(this).attr("rowspan")||1),l=u(t),e,o,s,f=0;f<c;f++)for(e=0;e<h;e++)o=t+f,n.isArray(i[o])||(i[o]=[]),s=e==0&&f==0?this:f==0?e:"-",i[o][l+e]=s;r=Math.max(r,i[t].length)})})}return i},this.indexesOfCell=function(n,t){for(var r,i=0;i<t.length;i++)for(r=0;r<t[i].length;r++)if(t[i][r]==n)return[i,r]},this.fixTable=function(t){var r,f,s,h;if(t&&t.nodeName=="TABLE"){var e=n(t),o=this.tableMatrix(t),u=0;if(n.each(o,function(){u=Math.max(u,this.length)}),u==0)return e.remove();for(r=0;r<o.length;r++)if(f=o[r].length,f==0)e.find("tr").eq(r).remove();else if(f<u)for(s=u-f,h=e.find("tr").eq(r),i=0;i<s;i++)h.append("<td>&nbsp;<\/td>")}},this.tableColumn=function(n,t,i){var h,u,c,f,o,r,s,e;if(n=this.selfOrParent(n,/^TD|TH$/),h=this.selfOrParent(n,/^TABLE$/),ret=[],info={offset:[],delta:[]},n&&h){for(i&&this.fixTable(h),u=this.tableMatrix(h),c=!1,r=0;r<u.length;r++){for(o=0;o<u[r].length;o++)if(u[r][o]==n){f=o,c=!0;break}if(c)break}if(f>=0)for(r=0;r<u.length;r++)s=u[r][f]||null,s&&(s.nodeName?(ret.push(s),t&&(info.delta.push(0),info.offset.push(f))):(e=parseInt(s),!isNaN(e)&&u[r][f-e]&&u[r][f-e].nodeName&&(ret.push(u[r][f-e]),t&&(info.delta.push(e),info.offset.push(f)))))}return t?{column:ret,info:info}:ret}}}(jQuery),function(n){elRTE.prototype.filter=function(t){var i=this,r=n("<span/>").addClass("elrtetesturl").appendTo(document.body)[0];this.url=(typeof r.currentStyle!="undefined"?r.currentStyle.backgroundImage:document.defaultView.getComputedStyle(r,null).backgroundImage).replace(/^url\((['"]?)([\s\S]+\/)[\s\S]+\1\)$/i,"$2"),n(r).remove(),this.rte=t,this.xhtml=/xhtml/i.test(t.options.doctype),this.boolAttrs=t.utils.makeObject("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected".split(",")),this.tagRegExp=/<(\/?)([\w:]+)((?:\s+[a-z\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.openTagRegExp=/<([\w:]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.attrRegExp=/(\w+)(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^\s]+))?/g,this.scriptRegExp=/<script([^>]*)>([\s\S]*?)<\/script>/gi,this.styleRegExp=/(<style([^>]*)>[\s\S]*?<\/style>)/gi,this.linkRegExp=/(<link([^>]+)>)/gi,this.cdataRegExp=/<!\[CDATA\[([\s\S]+)\]\]>/g,this.objRegExp=/<object([^>]*)>([\s\S]*?)<\/object>/gi,this.embRegExp=/<(embed)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.paramRegExp=/<(param)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.iframeRegExp=/<iframe([^>]*)>([\s\S]*?)<\/iframe>/gi,this.yMapsRegExp=/<div\s+([^>]*id\s*=\s*('|")?YMapsID[^>]*)>/gi,this.gMapsRegExp=/<iframe\s+([^>]*src\s*=\s*"http:\/\/maps\.google\.\w+[^>]*)>([\s\S]*?)<\/iframe>/gi,this.videoHostRegExp=/^(http:\/\/[\w\.]*)?(youtube|vimeo|rutube).*/i,this.serviceClassRegExp=/<(\w+)([^>]*class\s*=\s*"[^>]*elrte-[^>]*)>\s*(<\/\1>)?/gi,this.pagebreakRegExp=/<(\w+)([^>]*style\s*=\s*"[^>]*page-break[^>]*)>\s*(<\/\1>)?/gi,this.pbRegExp=new RegExp("<!-- pagebreak -->","gi"),this.allowTags=t.options.allowTags.length?t.utils.makeObject(t.options.allowTags):null,this.denyTags=t.options.denyTags.length?t.utils.makeObject(t.options.denyTags):null,this.denyAttr=t.options.denyAttr?t.utils.makeObject(t.options.denyAttr):null,this.pasteDenyAttr=t.options.pasteDenyAttr?t.utils.makeObject(t.options.pasteDenyAttr):null,this.fontSize=["medium","xx-small","small","medium","large","x-large","xx-large"],this.fontFamily={"sans-serif":/^(arial|tahoma|verdana)$/i,serif:/^(times|times new roman)$/i,monospace:/^courier$/i},this.scripts={},this._chains={},n.each(this.chains,function(t){i._chains[t]=[],n.each(this,function(n,r){typeof i.rules[r]=="function"&&i._chains[t].push(i.rules[r])})}),this.proccess=function(t,r){return r=n.trim(r).replace(/^\s*(&nbsp;)+/gi,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""),n.each(this._chains[t]||[],function(){r=this.call(i,r)}),r=r.replace(/\t/g,"  ").replace(/\r/g,"").replace(/\s*\n\s*\n+/g,"\n")+"  ",n.trim(r)?r:" "},this.wysiwyg=function(n){return this.proccess("wysiwyg",n)},this.source=function(n){return this.proccess("source",n)},this.source2source=function(n){return this.proccess("source2source",n)},this.wysiwyg2wysiwyg=function(n){return this.proccess("wysiwyg2wysiwyg",n)},this.parseAttrs=function(t){var i={},o=this.boolAttrs,e=t.match(this.attrRegExp),r,u,f;return e&&n.each(e,function(t,e){r=e.split("="),u=n.trim(r[0]).toLowerCase(),r.length>2?(r.shift(),f=r.join("=")):f=o[u]||r[1]||"",i[u]=n.trim(f).replace(/^('|")(.*)(\1)$/,"$2")}),i.style=this.rte.utils.parseStyle(i.style),i["class"]=this.rte.utils.parseClass(i["class"]||""),i},this.serializeAttrs=function(t,i){var r=[],u=this;return n.each(t,function(n,t){n=="style"?t=u.rte.utils.serializeStyle(t,i):n=="class"&&(t=u.rte.utils.serializeClass(t)),t&&r.push(n+'="'+t+'"')}),r.join(" ")},this.cleanAttrs=function(t,i){function r(n){return n+(/\d$/.test(n)?"px":"")}var f=this,u=this.replaceAttrs;return n.each(t["class"],function(n){/^(Apple-style-span|mso\w+)$/i.test(n)&&delete t["class"][n]}),n.each(t,function(e,o){u[e]&&u[e].call(f,t,i),e=="style"&&n.each(o,function(n,i){switch(n){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":t.style[n.replace(/^mso-|-alt$/g,"")]=r(i),delete t.style[n];break;case"horiz-align":t.style["text-align"]=i,delete t.style[n];break;case"vert-align":t.style["vertical-align"]=i,delete t.style[n];break;case"font-color":case"mso-foreground":t.style.color=i,delete t.style[n];break;case"mso-background":case"mso-highlight":t.style.background=i,delete t.style[n];break;case"mso-default-height":t.style["min-height"]=r(i),delete t.style[n];break;case"mso-default-width":t.style["min-width"]=r(i),delete t.style[n];break;case"mso-padding-between-alt":t.style["border-collapse"]="separate",t.style["border-spacing"]=r(i),delete t.style[n];break;case"text-line-through":i.match(/(single|double)/i)&&(t.style["text-decoration"]="line-through"),delete t.style[n];break;case"mso-zero-height":i=="yes"&&(t.style.display="none"),delete t.style[n];break;case"font-weight":i==700&&(t.style["font-weight"]="bold");break;default:n.match(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/)&&delete t.style[n]}})}),t}},elRTE.prototype.filter.prototype.replaceTags={b:{tag:"strong"},big:{tag:"span",style:{"font-size":"large"}},center:{tag:"div",style:{"text-align":"center"}},i:{tag:"em"},font:{tag:"span"},nobr:{tag:"span",style:{"white-space":"nowrap"}},menu:{tag:"ul"},plaintext:{tag:"pre"},s:{tag:"strike"},small:{tag:"span",style:{"font-size":"small"}},u:{tag:"span",style:{"text-decoration":"underline"}},xmp:{tag:"pre"}},elRTE.prototype.filter.prototype.replaceAttrs={align:function(n,t){switch(t){case"img":n.style[n.align.match(/(left|right)/)?"float":"vertical-align"]=n.align;break;case"table":n.align=="center"?n.style["margin-left"]=n.style["margin-right"]="auto":n.style.float=n.align;break;default:n.style["text-align"]=n.align}delete n.align},border:function(n){n.style["border-width"]||(n.style["border-width"]=(parseInt(n.border)||1)+"px"),n.style["border-style"]||(n.style["border-style"]="solid"),delete n.border},bordercolor:function(n){n.style["border-color"]||(n.style["border-color"]=n.bordercolor),delete n.bordercolor},background:function(n){n.style["background-image"]||(n.style["background-image"]="url("+n.background+")"),delete n.background},bgcolor:function(n){n.style["background-color"]||(n.style["background-color"]=n.bgcolor),delete n.bgcolor},clear:function(n){n.style.clear=n.clear=="all"?"both":n.clear,delete n.clear},color:function(n){n.style.color||(n.style.color=n.color),delete n.color},face:function(t){var i=t.face.toLowerCase();n.each(this.fontFamily,function(n,r){i.match(r)&&(t.style["font-family"]=i+","+n)}),delete t.face},hspace:function(n,t){if(t=="img"){var i=parseInt(n.hspace)||0;n.style["margin-left"]||(n.style["margin-left"]=i+"px"),n.style["margin-right"]||(n.style["margin-right"]=i+"px"),delete n.hspace}},size:function(n,t){t!="input"&&(n.style["font-size"]=this.fontSize[parseInt(n.size)||0]||"medium",delete n.size)},valign:function(n){n.style["vertical-align"]||(n.style["vertical-align"]=n.valign),delete n.valign},vspace:function(n,t){if(t=="img"){var i=parseInt(n.vspace)||0;n.style["margin-top"]||(n.style["margin-top"]=i+"px"),n.style["margin-bottom"]||(n.style["margin-bottom"]=i+"px"),delete n.hspace}}},elRTE.prototype.filter.prototype.rules={allowedTags:function(n){var t=this.allowTags;return t?n.replace(this.tagRegExp,function(n,i,r){return t[r.toLowerCase()]?n:""}):n},deniedTags:function(n){var t=this.denyTags;return t?n.replace(this.tagRegExp,function(n,i,r){return t[r.toLowerCase()]?"":n}):n},clean:function(t){var i=this,r=this.replaceTags,e=this.replaceAttrs,f=this.denyAttr,u;return t=t.replace(/<!DOCTYPE([\s\S]*)>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1<\/strong><\/p>").replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s&nbsp;]*)<\/span>/gi,"$1").replace(/(<p[^>]*>\s*<\/p>|<p[^>]*\/>)/gi,"<br>").replace(/(<\/p>)(?:\s*<br\s*\/?>\s*|\s*&nbsp;\s*)+\s*(<p[^>]*>)/gi,function(n,t,i){return t+"\n"+i}).replace(this.tagRegExp,function(t,u,e,o){return(e=e.toLowerCase(),u)?"<\/"+(r[e]?r[e].tag:e)+">":(o=i.cleanAttrs(i.parseAttrs(o||""),e),r[e]&&(r[e].style&&n.extend(o.style,r[e].style),e=r[e].tag),f&&n.each(o,function(n){f[n]&&delete o[n]}),o=i.serializeAttrs(o),"<"+e+(o?" ":"")+o+">")}),u=n("<div>"+t+"<\/div>"),u.find("span:not([id]):not([class])").each(function(){var t=n(this);t.attr("style")||(n.trim(t.html()).length?i.rte.dom.unwrap(this):t.remove())}).end().find("span span:only-child").each(function(){var r=n(this),t=r.parent().eq(0),o=r.attr("id"),s=t.attr("id"),u,f,e;!i.rte.dom.isOnlyNotEmpty(this)||o&&s||(e=n.trim(t.attr("class")+" "+r.attr("class")),e&&t.attr("class",e),f=i.rte.utils.serializeStyle(n.extend(i.rte.utils.parseStyle(n(this).attr("style")||""),i.rte.utils.parseStyle(n(t).attr("style")||""))),f&&t.attr("style",f),u=o||s,u&&t.attr("id",u),this.firstChild?n(this.firstChild).unwrap():r.remove())}).end().find("a[name]").each(function(){n(this).addClass("elrte-protected elrte-anchor")}),u.html()},cleanPaste:function(t){var i=this,r=this.pasteDenyAttr;return t=t.replace(this.scriptRegExp,"").replace(this.styleRegExp,"").replace(this.linkRegExp,"").replace(this.cdataRegExp,"").replace(/\<\!--[\s\S]*?--\>/g,""),this.rte.options.pasteOnlyText?t=t.replace(this.tagRegExp,function(n,t,i){return/br/i.test(i)||t&&/h[1-6]|p|ol|ul|li|div|blockquote|tr/i?"<br>":""}).replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""):r&&(t=t.replace(this.openTagRegExp,function(t,u,f){return f=i.parseAttrs(f),n.each(f,function(n){r[n]&&delete f[n]}),f=i.serializeAttrs(f,!0),"<"+u+(f?" ":"")+f+">"})),t},replace:function(t){function e(n,t){function c(){if(n.embed&&n.embed.src)return n.embed.src;if(n.params&&n.params.length)for(u=n.params.length;u--;)if(n.params[u].name=="src"||n.params[u].name=="movie")return n.params[u].value}var r=c(),o=r&&i.videoHostRegExp.test(r)?r.replace(i.videoHostRegExp,"$2"):t.replace(/^\w+\/(.+)/,"$1"),s=parseInt((n.obj?n.obj.width||n.obj.style.width:0)||(n.embed?n.embed.width||n.embed.style.width:0))||150,h=parseInt((n.obj?n.obj.height||n.obj.style.height:0)||(n.embed?n.embed.height||n.embed.style.height:0))||100,f="media"+Math.random().toString().substring(2),e="",u;return n.obj&&n.obj.style&&n.obj.style.float&&(e=' style="float:'+n.obj.style.float+'"'),i.scripts[f]=n,'<img src="'+i.url+'pixel.gif" class="elrte-media elrte-media-'+o+' elrte-protected" title="'+(r?i.rte.utils.encode(r):"")+'" rel="'+f+'" width="'+s+'" height="'+h+'"'+e+">"}var i=this,c=this.rte.options.replace||[],u,f;if(c.length&&n.each(c,function(n,r){typeof r=="function"&&(t=r.call(i,t))}),t=t.replace(this.styleRegExp,"<!-- ELRTE_COMMENT$1 -->").replace(this.linkRegExp,"<!-- ELRTE_COMMENT$1-->").replace(this.cdataRegExp,"<!--[CDATA[$1]]-->").replace(this.scriptRegExp,function(n,t,r){var u;return i.denyTags.script?"":(u="script"+Math.random().toString().substring(2),t=i.parseAttrs(t),t.type||(t.type="text/javascript"),i.scripts[u]="<script "+i.serializeAttrs(t)+">"+r+"<\/script>","<!-- ELRTE_SCRIPT:"+u+" -->")}).replace(this.yMapsRegExp,function(n,t){return t=i.parseAttrs(t),t["class"]["elrte-yandex-maps"]="elrte-yandex-maps",t["class"]["elrte-protected"]="elrte-protected","<div "+i.serializeAttrs(t)+">"}).replace(this.gMapsRegExp,function(n,t){var r="gmaps"+Math.random().toString().substring(2),u,f;return t=i.parseAttrs(t),u=parseInt(t.width||t.style.width||100),f=parseInt(t.height||t.style.height||100),i.scripts[r]=n,'<img src="'+i.url+'pixel.gif" class="elrte-google-maps elrte-protected" id="'+r+'" style="width:'+u+"px;height:"+f+'px">'}).replace(this.objRegExp,function(t,r,u){var o=u.match(i.embRegExp),f={obj:i.parseAttrs(r),embed:o&&o.length?i.parseAttrs(o[0].substring(7)):null,params:[]},s=i.rte.utils.mediaInfo(f.embed?f.embed.type||"":"",f.obj.classid||"");return s?((o=u.match(i.paramRegExp))&&n.each(o,function(n,t){f.params.push(i.parseAttrs(t.substring(6)))}),f.obj.classid||(f.obj.classid=s.classid[0]),f.obj.codebase||(f.obj.codebase=s.codebase),f.embed&&!f.embed.type&&(f.embed.type=s.type),f.obj.width=="1"&&delete f.obj.width,f.obj.height=="1"&&delete f.obj.height,f.embed&&(f.embed.width=="1"&&delete f.embed.width,f.embed.height=="1"&&delete f.embed.height),e(f,s.type)):t}).replace(this.embRegExp,function(n,t,r){var r=i.parseAttrs(r),u=i.rte.utils.mediaInfo(r.type||"");return r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,u?e({embed:r},u.type):n}).replace(this.iframeRegExp,function(n,t){var t=i.parseAttrs(t),u=t.style.width||(parseInt(t.width)>1?parseInt(t.width)+"px":"100px"),f=t.style.height||(parseInt(t.height)>1?parseInt(t.height)+"px":"100px"),r="iframe"+Math.random().toString().substring(2);return i.scripts[r]=n,'<img id="'+r+'" src="'+i.url+'pixel.gif" class="elrte-protected elrte-iframe" style="width:'+u+"; height:"+f+'">'}).replace(this.vimeoRegExp,function(n,t,r){return r=i.parseAttrs(r),delete r.frameborder,r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,r.type="application/x-shockwave-flash",e({embed:r},"application/x-shockwave-flash")}).replace(/<\/(embed|param)>/gi,"").replace(this.pbRegExp,function(){return'<img src="'+i.url+'pixel.gif" class="elrte-protected elrte-pagebreak">'}),u=n("<div>"+t+"<\/div>"),!this.rte.options.allowTextNodes){var o=this.rte.dom,s=[],r=[];if(n.browser.msie)for(f=0;f<u[0].childNodes.length;f++)s.push(u[0].childNodes[f]);else s=Array.prototype.slice.call(u[0].childNodes);function h(){r.length&&o.filter(r,"notEmpty").length&&o.wrap(r,document.createElement("p")),r=[]}n.each(s,function(n,t){o.is(t,"block")?h():(r.length&&t.previousSibling!=r[r.length-1]&&h(),r.push(t))}),h()}return u.html()},restore:function(t){var i=this,r=this.rte.options.restore||[];return r.length&&n.each(r,function(n,r){typeof r=="function"&&(t=r.call(i,t))}),t=t.replace(/\<\!--\[CDATA\[([\s\S]*?)\]\]--\>/gi,"<![CDATA[$1]\]>").replace(/\<\!--\s*ELRTE_SCRIPT\:\s*(script\d+)\s*--\>/gi,function(n,t){return i.scripts[t]&&(n=i.scripts[t],delete i.scripts[t]),n||""}).replace(/\<\!-- ELRTE_COMMENT([\s\S]*?) --\>/gi,"$1").replace(this.serviceClassRegExp,function(t,r,u,f){var u=i.parseAttrs(u),e,o="",t;return u["class"]["elrte-google-maps"]?(t="",i.scripts[u.id]&&(t=i.scripts[u.id],delete i.scripts[u.id]),t):u["class"]["elrte-iframe"]?i.scripts[u.id]||"":u["class"].elrtebm?"":u["class"]["elrte-media"]?(e=i.scripts[u.rel]||{},e.params&&n.each(e.params,function(n,t){o+="<param "+i.serializeAttrs(t)+">\n"}),e.embed&&(o+="<embed "+i.serializeAttrs(e.embed)+">"),e.obj&&(o="<object "+i.serializeAttrs(e.obj)+">\n"+o+"\n<\/object>\n"),o||t):u["class"]["elrte-pagebreak"]?"<!-- pagebreak -->":(n.each(u["class"],function(n){/^elrte-\w+/i.test(n)&&delete u["class"][n]}),"<"+r+" "+i.serializeAttrs(u)+">"+(f||""))})},compactStyles:function(n){var t=this;return n.replace(this.tagRegExp,function(n,i,r,u){return u=!i&&u?t.serializeAttrs(t.parseAttrs(u),!0):"","<"+i+r.toLowerCase()+(u?" ":"")+u+">"})},xhtmlTags:function(n){return this.xhtml?n.replace(/<(img|hr|br|embed|param|link|area)([^>]*\/*)>/gi,"<$1$2 />"):n}},elRTE.prototype.filter.prototype.chains={wysiwyg:["replace","clean","allowedTags","deniedTags","compactStyles"],source:["clean","allowedTags","restore","compactStyles","xhtmlTags"],paste:["clean","allowedTags","cleanPaste","replace","deniedTags","compactStyles"],wysiwyg2wysiwyg:["clean","allowedTags","restore","replace","deniedTags","compactStyles"],source2source:["clean","allowedTags","replace","deniedTags","restore","compactStyles","xhtmlTags"]}}(jQuery),function(n){elRTE.prototype.history=function(t){this.rte=t,this._prev=[],this._next=[],this.add=function(){this.rte.options.historyLength>0&&this._prev.length>=this.rte.options.historyLength&&this._prev.slice(this.rte.options.historyLength);var t=this.rte.selection.getBookmark();this._prev.push([n(this.rte.doc.body).html(),t]),this.rte.selection.moveToBookmark(t),this._next=[]},this.back=function(){if(this._prev.length){var i=this.rte.selection.getBookmark(),t=this._prev.pop();this._next.push([n(this.rte.doc.body).html(),i]),n(this.rte.doc.body).html(t[0]),this.rte.selection.moveToBookmark(t[1])}},this.fwd=function(){if(this._next.length){var i=this.rte.selection.getBookmark(),t=this._next.pop();this._prev.push([n(this.rte.doc.body).html(),i]),n(this.rte.doc.body).html(t[0]),this.rte.selection.moveToBookmark(t[1])}},this.canBack=function(){return this._prev.length},this.canFwd=function(){return this._next.length}}}(jQuery),function(){elRTE.prototype.options={doctype:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">',cssClass:"el-rte",cssfiles:[],height:null,resizable:!0,lang:"en",toolbar:"normal",absoluteURLs:!0,allowSource:!0,stripWhiteSpace:!0,styleWithCSS:!1,fmAllow:!0,fmOpen:null,allowTags:[],denyTags:["applet","base","basefont","bgsound","blink","body","col","colgroup","isindex","frameset","html","head","meta","marquee","noframes","noembed","o:p","title","xml"],denyAttr:[],pasteDenyAttr:["id","name","class","style","language","onclick","ondblclick","onhover","onkeup","onkeydown","onkeypress"],allowTextNodes:!0,allowBrowsersSpecStyles:!1,allowPaste:!0,pasteOnlyText:!1,replace:[],restore:[],pagebreak:'<div style="page-break-after: always;"><\/div>',buttons:{save:"Save",copy:"Copy",cut:"Cut",css:"Css style and class",paste:"Paste",pastetext:"Paste only text",pasteformattext:"Paste formatted text",removeformat:"Clean format",undo:"Undo last action",redo:"Redo previous action",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyleft:"Align left",justifyright:"Ailgn right",justifycenter:"Align center",justifyfull:"Align full",indent:"Indent",outdent:"Outdent",rtl:"Right to left",ltr:"Left to right",forecolor:"Font color",hilitecolor:"Background color",formatblock:"Format",fontsize:"Font size",fontname:"Font",insertorderedlist:"Ordered list",insertunorderedlist:"Unordered list",horizontalrule:"Horizontal rule",blockquote:"Blockquote",div:"Block element (DIV)",link:"Link",unlink:"Delete link",anchor:"Bookmark",image:"Image",pagebreak:"Page break",smiley:"Smiley",flash:"Flash",table:"Table",tablerm:"Delete table",tableprops:"Table properties",tbcellprops:"Table cell properties",tbrowbefore:"Insert row before",tbrowafter:"Insert row after",tbrowrm:"Delete row",tbcolbefore:"Insert column before",tbcolafter:"Insert column after",tbcolrm:"Delete column",tbcellsmerge:"Merge table cells",tbcellsplit:"Split table cell",docstructure:"Toggle display document structure",elfinder:"Open file manager",fullscreen:"Toggle full screen mode",nbsp:"Non breakable space",stopfloat:"Stop element floating",about:"About this software"},panels:{eol:[],save:["save"],copypaste:["copy","cut","paste","pastetext","pasteformattext","removeformat","docstructure"],undoredo:["undo","redo"],style:["bold","italic","underline","strikethrough","subscript","superscript"],colors:["forecolor","hilitecolor"],alignment:["justifyleft","justifycenter","justifyright","justifyfull"],indent:["outdent","indent"],format:["formatblock","fontsize","fontname"],lists:["insertorderedlist","insertunorderedlist"],elements:["horizontalrule","blockquote","div","stopfloat","css","nbsp","smiley","pagebreak"],direction:["ltr","rtl"],links:["link","unlink","anchor"],images:["image"],media:["image","flash"],tables:["table","tableprops","tablerm","tbrowbefore","tbrowafter","tbrowrm","tbcolbefore","tbcolafter","tbcolrm","tbcellprops","tbcellsmerge","tbcellsplit"],elfinder:["elfinder"],fullscreen:["fullscreen","about"]},toolbars:{tiny:["style"],compact:["save","undoredo","style","alignment","lists","links","fullscreen"],normal:["save","copypaste","undoredo","style","alignment","colors","indent","lists","links","elements","images","fullscreen"],complete:["save","copypaste","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","fullscreen"],maxi:["save","copypaste","undoredo","elfinder","style","alignment","direction","colors","format","indent","lists","links","elements","media","tables","fullscreen"],eldorado:["save","copypaste","elfinder","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"]},panelNames:{save:"Save",copypaste:"Copy/Pase",undoredo:"Undo/Redo",style:"Text styles",colors:"Colors",alignment:"Alignment",indent:"Indent/Outdent",format:"Text format",lists:"Lists",elements:"Misc elements",direction:"Script direction",links:"Links",images:"Images",media:"Media",tables:"Tables",elfinder:"File manager (elFinder)"}}}(jQuery),function(n){elRTE.prototype.selection=function(t){function u(){return i.rte.window.getSelection?i.rte.window.getSelection():i.rte.window.document.selection}function s(n,t,r){while(n.nodeName!="BODY"&&n.parentNode&&n.parentNode.nodeName!="BODY"&&(t?n!==t&&n.parentNode!=t:1)&&(r=="left"&&i.rte.dom.isFirstNotEmpty(n)||r=="right"&&i.rte.dom.isLastNotEmpty(n)||i.rte.dom.isFirstNotEmpty(n)&&i.rte.dom.isLastNotEmpty(n)))n=n.parentNode;return n}var i,f,r,e,o;this.rte=t,i=this,this.w3cRange=null,n(this.rte.doc).keyup(function(n){(n.ctrlKey||n.metaKey||n.keyCode>=8&&n.keyCode<=13||n.keyCode>=32&&n.keyCode<=40||n.keyCode==46||n.keyCode>=96&&n.keyCode<=111)&&i.cleanCache()}).mousedown(function(n){f=n.target.nodeName=="HTML"?i.rte.doc.body:n.target,r=e=null}).mouseup(function(n){r=n.target.nodeName=="HTML"?i.rte.doc.body:n.target,r=n.target,e=null}).click(),this.collapsed=function(){return this.getRangeAt().isCollapsed()},this.collapse=function(t){var i=u(),r=this.getRangeAt();return r.collapse(t?!0:!1),n.browser.msie||(i.removeAllRanges(),i.addRange(r)),this},this.getRangeAt=function(n){if(this.rte.browser.msie)return this.w3cRange||(this.w3cRange=new this.rte.w3cRange(this.rte)),n&&this.w3cRange.update(),this.w3cRange;var i=u(),t=i.rangeCount>0?i.getRangeAt(0):this.rte.doc.createRange();return t.getStart=function(){return this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(this.startOffset,this.startContainer.childNodes.length-1)]:this.startContainer},t.getEnd=function(){return this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(this.startOffset==this.endOffset?this.endOffset:this.endOffset-1,this.endContainer.childNodes.length-1)]:this.endContainer},t.isCollapsed=function(){return this.collapsed},t},this.saveIERange=function(){n.browser.msie&&(o=this.getRangeAt().getBookmark())},this.restoreIERange=function(){n.browser.msie&&o&&this.getRangeAt().moveToBookmark(o)},this.cloneContents=function(){var i=this.rte.dom.create("div"),r,u,t;if(n.browser.msie){try{r=this.rte.window.document.selection.createRange()}catch(f){r=this.rte.doc.body.createTextRange()}n(i).html(r.htmlText)}else for(u=this.getRangeAt().cloneContents(),t=0;t<u.childNodes.length;t++)i.appendChild(u.childNodes[t].cloneNode(!0));return i},this.select=function(n,t){var r,i;if(t=t||n,this.rte.browser.msie){var i=this.rte.doc.body.createTextRange(),f=i.duplicate(),e=i.duplicate();f.moveToElementText(n),e.moveToElementText(t),i.setEndPoint("StartToStart",f),i.setEndPoint("EndToEnd",e),i.select()}else r=u(),i=this.getRangeAt(),i.setStartBefore(n),i.setEndAfter(t),r.removeAllRanges(),r.addRange(i);return this.cleanCache()},this.selectContents=function(n){var t=this.getRangeAt(),i;if(n&&n.nodeType==1)if(this.rte.browser.msie)t.range(),t.r.moveToElementText(n.parentNode),t.r.select();else{try{t.selectNodeContents(n)}catch(r){return this.rte.log("unable select node contents "+n)}i=u(),i.removeAllRanges(),i.addRange(t)}return this},this.deleteContents=function(){return n.browser.msie||this.getRangeAt().deleteContents(),this},this.insertNode=function(t,i){var e,r,f;return i&&!this.collapsed()&&this.collapse(),this.rte.browser.msie?(e=t.nodeType==3?t.nodeValue:n(this.rte.dom.create("span")).append(n(t)).html(),r=this.getRangeAt(),r.insertNode(e)):(r=this.getRangeAt(),r.insertNode(t),r.setStartAfter(t),r.setEndAfter(t),f=u(),f.removeAllRanges(),f.addRange(r)),this.cleanCache()},this.insertHtml=function(t,i){if(i&&!this.collapsed()&&this.collapse(),this.rte.browser.msie)this.getRangeAt().range().pasteHTML(t);else{var r=n(this.rte.dom.create("span")).html(t||"").get(0);this.insertNode(r),n(r).replaceWith(n(r).html())}return this.cleanCache()},this.insertText=function(n){var t=this.rte.doc.createTextNode(n);return this.insertHtml(t.nodeValue)},this.getBookmark=function(){var i,r,o,s,f,e,c,h,t;if(this.rte.window.focus(),f=this.rte.dom.createBookmark(),e=this.rte.dom.createBookmark(),n.browser.msie){try{t=this.rte.window.document.selection.createRange()}catch(e){t=this.rte.doc.body.createTextRange()}t.item&&(c=t.item(0),t=this.rte.doc.body.createTextRange(),t.moveToElementText(c)),i=t.duplicate(),r=t.duplicate(),o=this.rte.dom.create("span"),s=this.rte.dom.create("span"),o.appendChild(f),s.appendChild(e),i.collapse(!0),i.pasteHTML(o.innerHTML),r.collapse(!1),r.pasteHTML(s.innerHTML)}else h=u(),t=h.rangeCount>0?h.getRangeAt(0):this.rte.doc.createRange(),i=t.cloneRange(),r=t.cloneRange(),r.collapse(!1),r.insertNode(e),i.collapse(!0),i.insertNode(f),this.select(f,e);return[f.id,e.id]},this.moveToBookmark=function(t){if(this.rte.window.focus(),t&&t.length==2){var i=this.rte.doc.getElementById(t[0]),r=this.rte.doc.getElementById(t[1]),f,e;i&&r&&(this.select(i,r),this.rte.dom.next(i)==r&&this.collapse(!0),n.browser.msie||(f=u(),e=f.rangeCount>0?f.getRangeAt(0):this.rte.doc.createRange(),f.removeAllRanges(),f.addRange(e)),i.parentNode.removeChild(i),r.parentNode.removeChild(r))}return this},this.removeBookmark=function(n){if(this.rte.window.focus(),n.length==2){var t=this.rte.doc.getElementById(n[0]),i=this.rte.doc.getElementById(n[1]);t&&i&&(t.parentNode.removeChild(t),i.parentNode.removeChild(i))}},this.cleanCache=function(){return f=r=e=null,this},this.getStart=function(){if(!f){var n=this.getRangeAt();f=n.getStart()}return f},this.getEnd=function(){if(!r){var n=this.getRangeAt();r=n.getEnd()}return r},this.getNode=function(){return e||(e=this.rte.dom.findCommonAncestor(this.getStart(),this.getEnd())),e},this.selected=function(t){function a(){function t(){for(var t=0;t<o.length;t++)if(o[t].nodeType==1&&(i.rte.dom.selfOrParent(o[t],/^P$/)||n(o[t]).find("p").length>0))return!1;return!0}if(o.length>0){var r=u.tag=="p"&&!t()?"div":u.tag,e=i.rte.dom.wrap(o,r);f[h]=e,h=null,o=[]}}function l(t){var e,t,r;if(t.nodeType==1)if(/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(t.nodeName))n(t).find("td,th").each(function(){var t=u.tag=="p"&&n(this).find("p").length>0?"div":u.tag,r=i.rte.dom.wrapContents(this,t);return f.push(r)});else if(/^(CAPTION|TD|TH|LI|DT|DD)$/.test(t.nodeName))return e=u.tag=="p"&&n(t).find("p").length>0?"div":u.tag,t=i.rte.dom.wrapContents(t,e),f.push(t);r=o.length>0?o[o.length-1]:null,r&&r!=i.rte.dom.prev(t)&&a(),o.push(t),h===null&&(h=f.length,f.push("dummy"))}var u={collapsed:!1,blocks:!1,filter:!1,wrap:"text",tag:"span"},c,s,r;if(u=n.extend({},u,t),u.blocks&&(r=this.getNode(),c=null,c=this.rte.dom.selfOrParent(r,"selectionBlock")))return[c];var e=this.selectedRaw(u.collapsed,u.blocks),f=[],o=[],h=null;if(e.nodes.length>0){for(s=0;s<e.nodes.length;s++){r=e.nodes[s],r.nodeType==3&&(s==0||s==e.nodes.length-1)&&n.trim(r.nodeValue).length>0&&(s==0&&e.so>0&&(r=r.splitText(e.so)),s==e.nodes.length-1&&e.eo>0&&r.splitText(s==0&&e.so>0?e.eo-e.so:e.eo));switch(u.wrap){case"text":r.nodeType==1&&r.nodeName=="BR"||r.nodeType==3&&n.trim(r.nodeValue).length>0?l(r):r.nodeType==1&&f.push(r);break;case"inline":this.rte.dom.isInline(r)?l(r):r.nodeType==1&&f.push(r);break;case"all":r.nodeType!=1&&this.rte.dom.isEmpty(r)||l(r);break;default:r.nodeType!=1&&this.rte.dom.isEmpty(r)||f.push(r)}}a()}return f.length&&(this.rte.window.focus(),this.select(f[0],f[f.length-1])),u.filter?this.rte.dom.filter(f,u.filter):f},this.dump=function(n,t,i,r,u){var f=this.getRangeAt();this.rte.log("commonAncestorContainer"),this.rte.log(n||f.commonAncestorContainer),this.rte.log("startContainer"),this.rte.log(t||f.startContainer),this.rte.log("startOffset: "+(r>=0?r:f.startOffset)),this.rte.log("endContainer"),this.rte.log(i||f.endContainer),this.rte.log("endOffset: "+(u>=0?u:f.endOffset))},this.selectedRaw=function(t,r){function b(t,i,r){return t.nodeType==3?(r=r>=0?r:t.nodeValue.length,i==0&&r==t.nodeValue.length||n.trim(t.nodeValue).length==n.trim(t.nodeValue.substring(i,r)).length):!0}function k(t,r,u){return t.nodeType==1?i.rte.dom.isEmpty(t):t.nodeType==3?n.trim(t.nodeValue.substring(r||0,u>=0?u:t.nodeValue.length)).length==0:!0}var u={so:null,eo:null,nodes:[]},o=this.getRangeAt(!0),v=o.commonAncestorContainer,f,e,p=!1,w=!1,l,a,h,y,c;if(o.startContainer.nodeType==1?o.startOffset<o.startContainer.childNodes.length?(f=o.startContainer.childNodes[o.startOffset],u.so=f.nodeType==1?null:0):(f=o.startContainer.childNodes[o.startOffset-1],u.so=f.nodeType==1?null:f.nodeValue.length):(f=o.startContainer,u.so=o.startOffset),o.collapsed)return t&&(r?(f=s(f),(!this.rte.dom.isEmpty(f)||(f=this.rte.dom.next(f)))&&(u.nodes=[f]),this.rte.dom.isInline(f)&&(u.nodes=this.rte.dom.toLineStart(f).concat(u.nodes,this.rte.dom.toLineEnd(f))),u.nodes.length>0&&(u.so=u.nodes[0].nodeType==1?null:0,u.eo=u.nodes[u.nodes.length-1].nodeType==1?null:u.nodes[u.nodes.length-1].nodeValue.length)):this.rte.dom.isEmpty(f)||(u.nodes=[f])),u;if(o.endContainer.nodeType==1?(e=o.endContainer.childNodes[o.endOffset-1],u.eo=e.nodeType==1?null:e.nodeValue.length):(e=o.endContainer,u.eo=o.endOffset),(f.nodeType==1||r||b(f,u.so,f.nodeValue.length))&&(f=s(f,v,"left"),p=!0,u.so=f.nodeType==1?null:0),(e.nodeType==1||r||b(e,0,u.eo))&&(e=s(e,v,"right"),w=!0,u.eo=e.nodeType==1?null:e.nodeValue.length),r&&(f.nodeType!=1&&f.parentNode!=v&&f.parentNode.nodeName!="BODY"&&(f=f.parentNode,u.so=null),e.nodeType!=1&&e.parentNode!=v&&e.parentNode.nodeName!="BODY"&&(e=e.parentNode,u.eo=null)),f.parentNode==e.parentNode&&f.parentNode.nodeName!="BODY"&&p&&this.rte.dom.isFirstNotEmpty(f)&&w&&this.rte.dom.isLastNotEmpty(e)&&(f=e=f.parentNode,u.so=f.nodeType==1?null:0,u.eo=e.nodeType==1?null:e.nodeValue.length),f==e)return this.rte.dom.isEmpty(f)||u.nodes.push(f),u;for(l=f;l.nodeName!="BODY"&&l.parentNode!==v&&l.parentNode.nodeName!="BODY";)l=l.parentNode;for(a=e;a.nodeName!="BODY"&&a.parentNode!==v&&a.parentNode.nodeName!="BODY";)a=a.parentNode;for(k(f,u.so,f.nodeType==3?f.nodeValue.length:null)||u.nodes.push(f),h=f;h!==l;){for(c=h;c=this.rte.dom.next(c);)u.nodes.push(c);h=h.parentNode}for(h=l;(h=this.rte.dom.next(h))&&h!=a;)u.nodes.push(h);for(y=[],h=e;h!==a;){for(c=h;c=this.rte.dom.prev(c);)y.push(c);h=h.parentNode}return y.length&&(u.nodes=u.nodes.concat(y.reverse())),k(e,0,e.nodeType==3?u.eo:null)||u.nodes.push(e),r&&(this.rte.dom.isInline(f)&&(u.nodes=this.rte.dom.toLineStart(f).concat(u.nodes),u.so=u.nodes[0].nodeType==1?null:0),this.rte.dom.isInline(e)&&(u.nodes=u.nodes.concat(this.rte.dom.toLineEnd(e)),u.eo=u.nodes[u.nodes.length-1].nodeType==1?null:u.nodes[u.nodes.length-1].nodeValue.length)),u}}}(jQuery),function(n){elRTE.prototype.ui=function(t){this.rte=t,this._buttons=[];var l=this,f=this.rte.options.toolbars[t.options.toolbar&&t.options.toolbars[t.options.toolbar]?t.options.toolbar:"normal"],r=f.length,e,i,o,s,h,c,u;for(u in this.buttons)this.buttons.hasOwnProperty(u)&&u!="button"&&(this.buttons[u].prototype=this.buttons.button.prototype);while(r--){if(first=r==0?!0:!1,f[r-1]=="eol"&&(first=!0),i=f[r],i=="eol"){n(this.rte.doc.createElement("br")).prependTo(this.rte.toolbar);continue}for(e=n('<ul class="panel-'+i+(first?" first":"")+'" />').prependTo(this.rte.toolbar),e.bind("mousedown",function(n){n.preventDefault()}),o=this.rte.options.panels[i].length;o--;)s=this.rte.options.panels[i][o],h=this.buttons[s]||this.buttons.button,this._buttons.push(c=new h(this.rte,s)),e.prepend(c.domElem)}this.update(),this.disable=function(){n.each(l._buttons,function(){this.active||this.domElem.addClass("disabled")})}},elRTE.prototype.ui.prototype.update=function(t){function s(t){var i=t.nodeName.toLowerCase();return t=n(t),i=="img"&&(t.hasClass("elrte-media")?i="media":t.hasClass("elrte-google-maps")?i="google map":t.hasClass("elrte-yandex-maps")?i="yandex map":t.hasClass("elrte-pagebreak")&&(i="pagebreak")),i}t&&this.rte.selection.cleanCache();var i=this.rte.selection.getNode(),r=this.rte.dom.parents(i,"*"),f=this.rte.rtl,o=f?" &laquo; ":" &raquo; ",e="",u;for(i&&i.nodeType==1&&i.nodeName!="BODY"&&r.unshift(i),f||(r=r.reverse()),u=0;u<r.length;u++)e+=(u>0?o:"")+s(r[u]);this.rte.statusbar.html(e),n.each(this._buttons,function(){this.update()}),this.rte.window.focus()},elRTE.prototype.ui.prototype.buttons={button:function(t,i){var r=this;this.rte=t,this.active=!1,this.name=i,this.val=null,this.domElem=n('<li style="-moz-user-select:-moz-none" class="'+i+' rounded-3" name="'+i+'" title="'+this.rte.i18n(this.rte.options.buttons[i]||i)+'" unselectable="on" />').hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault(),n(this).hasClass("disabled")||r.command(),r.rte.window.focus()})}},elRTE.prototype.ui.prototype.buttons.button.prototype.command=function(){this.rte.history.add();try{this.rte.doc.execCommand(this.name,!1,this.val)}catch(n){return this.rte.log("commands failed: "+this.name)}this.rte.ui.update(!0)},elRTE.prototype.ui.prototype.buttons.button.prototype.update=function(){try{if(this.rte.doc.queryCommandEnabled(this.name))this.domElem.removeClass("disabled");else return this.domElem.addClass("disabled")}catch(n){return}try{this.rte.doc.queryCommandState(this.name)?this.domElem.addClass("active"):this.domElem.removeClass("active")}catch(n){}}}(jQuery),function(n){elRTE.prototype.utils=function(t){this.rte=t,this.url=null,this.reg=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,this.baseURL="",this.path="",this.entities={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},this.entitiesRegExp=/[<>&\"]/g,this.media=[{type:"application/x-shockwave-flash",classid:["clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"},{type:"application/x-director",classid:["clsid:166b1bca-3f9c-11cf-8075-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0"},{type:"application/x-mplayer2",classid:["clsid:6bf52a52-394a-11d3-b153-00c04f79faa6","clsid:22d6f312-b0f6-11d0-94ab-0080c74c7e95","clsid:05589fa1-c356-11ce-bf01-00aa0055595a"],codebase:"http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"},{type:"video/quicktime",classid:["clsid:02bf25d5-8c17-4b23-bc80-d3488abddc6b"],codebase:"http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"},{type:"audio/x-pn-realaudio-plugin",classid:["clsid:cfcdaa03-8be4-11cf-b84b-0020afbbccfa"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"}],this.rgbRegExp=/\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*/i,this.colorsRegExp=/aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\s*\([^\)]+\)/i,this.colors={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#fffffff",yellow:"#ffff00"};var i=this;this.rgb2hex=function(n){return this.color2Hex(""+n)},this.toPixels=function(t){var r=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/),i;if(r&&(t=r[1],unit=r[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t),isNaN(t))return"";i=parseInt(n(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*i);case"pt":return parseInt(t*i/12);case"%":return parseInt(t*i/100)}return t},this.absoluteURL=function(t){if(this.url||this._url(),t=n.trim(t),!t)return"";if(t[0]=="#")return t;var i=this.parseURL(t);return!i.host&&!i.path&&!i.anchor?"":this.rte.options.absoluteURLs?i.protocol?t:i.host&&(i.host.indexOf(".")!=-1||i.host=="localhost")?this.url.protocol+"://"+t:(t[0]=="/"?t=this.baseURL+t:(t.indexOf("index.html")==0&&(t=t.substring(2)),t=this.baseURL+this.path+t),t):t},this.parseURL=function(t){var r=t.match(this.reg),i={};return n.each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(n){i[this]=r[n]}),i.host.match(/[a-z0-9]/i)||(i.host=""),i},this.trimEventCallback=function(t){return t=t?t.toString():"",n.trim(t.replace(/\r*\n/mg,"").replace(/^function\s*on[a-z]+\s*\(\s*event\s*\)\s*\{(.+)\}$/igm,"$1"))},this._url=function(){this.url=this.parseURL(window.location.href),this.baseURL=this.url.protocol+"://"+(this.url.userInfo?parts.userInfo+"@":"")+this.url.host+(this.url.port?":"+this.url.port:""),this.path=this.url.file?this.url.path.substring(0,this.url.path.length-this.url.file.length):this.url.path},this.makeObject=function(t){var i={};return n.each(t,function(n,t){i[t]=t}),i},this.encode=function(n){var t=this.entities;return(""+n).replace(this.entitiesRegExp,function(n){return t[n]})},this.decode=function(t){return n("<div/>").html(t||"").text()},this.parseStyle=function(t){var f={},e=this.rte.options.allowBrowsersSpecStyles,i,r,u;return typeof t=="string"&&t.length&&n.each(t.replace(/&quot;/gi,"'").split(";"),function(t,o){(u=o.indexOf(":"))!==-1&&(i=n.trim(o.substr(0,u)),r=n.trim(o.substr(u+1)),(i=="color"||i=="background-color")&&(r=r.toLowerCase()),i&&r&&(e||i.substring(0,1)!="-")&&(f[i]=r))}),f},this.compactStyle=function(t){var i=this;return t.border=="medium none"&&delete t.border,n.each(t,function(n,r){/color$/i.test(n)?t[n]=i.color2Hex(r):/^(border|background)$/i.test(n)&&(t[n]=r.replace(i.colorsRegExp,function(n){return i.color2Hex(n)}))}),t["border-width"]&&(t.border=t["border-width"]+" "+(t["border-style"]||"solid")+" "+(t["border-color"]||"#000"),delete t["border-width"],delete t["border-style"],delete t["border-color"]),t["background-image"]&&(t.background=t["background-color"]+" "||""+t["background-image"]+" "+t["background-position"]||"0 0 "+t["background-repeat"]||"repeat",delete t["background-image"],delete["background-image"],delete["background-position"],delete["background-repeat"]),t["margin-top"]&&t["margin-right"]&&t["margin-bottom"]&&t["margin-left"]&&(t.margin=t["margin-top"]+" "+t["margin-right"]+" "+t["margin-bottom"]+" "+t["margin-left"],delete t["margin-top"],delete t["margin-right"],delete t["margin-bottom"],delete t["margin-left"]),t["padding-top"]&&t["padding-right"]&&t["padding-bottom"]&&t["padding-left"]&&(t.padding=t["padding-top"]+" "+t["padding-right"]+" "+t["padding-bottom"]+" "+t["padding-left"],delete t["padding-top"],delete t["padding-right"],delete t["padding-bottom"],delete t["padding-left"]),(t["list-style-type"]||t["list-style-position"]||t["list-style-image"])&&(t["list-style"]=n.trim(t["list-style-type"]||" "+t["list-style-position"]||""+t["list-style-image"]||""),delete t["list-style-type"],delete t["list-style-position"],delete t["list-style-image"]),t},this.serializeStyle=function(t,i){var r=[];return n.each(i?this.compactStyle(t):t,function(n,t){t&&r.push(n+":"+t)}),r.join(";")},this.parseClass=function(t){return t=n.trim(t),t.length?this.makeObject(t.split(/\s+/)):{}},this.serializeClass=function(t){var i=[],r=this.rte;return n.each(t,function(n){i.push(n)}),i.join(" ")},this.mediaInfo=function(t,i){for(var r=this.media.length;r--;)if(t===this.media[r].type||i&&n.inArray(i,this.media[r].classid)!=-1)return this.media[r]},this.color2Hex=function(n){function i(n){return n=parseInt(n).toString(16),n.length>1?n:"0"+n}var t;return(n=n||"",n.indexOf("#")===0)?n:this.colors[n]?this.colors[n]:(t=n.match(this.rgbRegExp))?"#"+i(t[1])+i(t[2])+i(t[3]):""}}}(jQuery),function(){elRTE.prototype.w3cRange=function(n){var t=this;this.rte=n,this.r=null,this.collapsed=!0,this.startContainer=null,this.endContainer=null,this.startOffset=0,this.endOffset=0,this.commonAncestorContainer=null,this.range=function(){try{this.r=this.rte.window.document.selection.createRange()}catch(n){this.r=this.rte.doc.body.createTextRange()}return this.r},this.insertNode=function(n){this.range(),t.r.collapse(!1);var i=t.r.duplicate();i.pasteHTML(n)},this.getBookmark=function(){if(this.range(),this.r.item){var n=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(n)}return this.r.getBookmark()},this.moveToBookmark=function(n){this.rte.window.focus(),this.range().moveToBookmark(n),this.r.select()},this.update=function(){function u(n){var s="﻿",e=offset=0,u=t.r.duplicate(),i,r,f,o;if(u.collapse(n),i=u.parentElement(),!i||i.nodeName=="HTML")return{parent:t.rte.doc.body,ndx:e,offset:offset};for(u.pasteHTML(s),childs=i.childNodes,r=0;r<childs.length;r++)if(f=childs[r],r>0&&(f.nodeType!==3||childs[r-1].nodeType!==3)&&e++,f.nodeType!==3)offset=0;else{if(o=f.nodeValue.indexOf(s),o!==-1){offset+=o;break}offset+=f.nodeValue.length}return u.moveStart("character",-1),u.text="",{parent:i,ndx:Math.min(e,i.childNodes.length-1),offset:offset}}var r,n,i;return this.range(),this.startContainer=this.endContainer=null,this.r.item?(this.collapsed=!1,r=this.r.item(0),this.setStart(r.parentNode,this.rte.dom.indexOf(r)),this.setEnd(r.parentNode,this.startOffset+1)):(this.collapsed=this.r.boundingWidth==0,n=u(!0),i=u(!1),n.parent.normalize(),i.parent.normalize(),n.ndx=Math.min(n.ndx,n.parent.childNodes.length-1),i.ndx=Math.min(i.ndx,i.parent.childNodes.length-1),n.parent.childNodes[n.ndx].nodeType&&n.parent.childNodes[n.ndx].nodeType==1?this.setStart(n.parent,n.ndx):this.setStart(n.parent.childNodes[n.ndx],n.offset),i.parent.childNodes[i.ndx].nodeType&&i.parent.childNodes[i.ndx].nodeType==1?this.setEnd(i.parent,i.ndx):this.setEnd(i.parent.childNodes[i.ndx],i.offset),this.select()),this},this.isCollapsed=function(){return this.range(),this.collapsed=this.r.item?!1:this.r.boundingWidth==0,this.collapsed},this.collapse=function(n){if(this.range(),this.r.item){var t=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(t)}this.r.collapse(n),this.r.select(),this.collapsed=!0},this.getStart=function(){var t,n;return(this.range(),this.r.item)?this.r.item(0):(t=this.r.duplicate(),t.collapse(!0),n=t.parentElement(),n&&n.nodeName=="BODY"?n.firstChild:n)},this.getEnd=function(){var t,n;return(this.range(),this.r.item)?this.r.item(0):(t=this.r.duplicate(),t.collapse(!1),n=t.parentElement(),n&&n.nodeName=="BODY"?n.lastChild:n)},this.setStart=function(n,t){this.startContainer=n,this.startOffset=t,this.endContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setEnd=function(n,t){this.endContainer=n,this.endOffset=t,this.startContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setStartBefore=function(n){n.parentNode&&this.setStart(n.parentNode,this.rte.dom.indexOf(n))},this.setStartAfter=function(n){n.parentNode&&this.setStart(n.parentNode,this.rte.dom.indexOf(n)+1)},this.setEndBefore=function(n){n.parentNode&&this.setEnd(n.parentNode,this.rte.dom.indexOf(n))},this.setEndAfter=function(n){n.parentNode&&this.setEnd(n.parentNode,this.rte.dom.indexOf(n)+1)},this.select=function(){function f(n,i){var e;if(n.nodeType!=3)return-1;var f="﻿",r=n.nodeValue,u=t.rte.doc.body.createTextRange();return n.nodeValue=r.substring(0,i)+f+r.substring(i),u.moveToElementText(n.parentNode),u.findText(f),e=Math.abs(u.moveStart("character",-1048575)),n.nodeValue=r,e}var o;this.r=this.rte.doc.body.createTextRange();var r=this.startOffset,u=this.endOffset,n=this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(r,this.startContainer.childNodes.length-1)]:this.startContainer,e=this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(r==u?u:u-1,this.endContainer.childNodes.length-1)]:this.endContainer;if(this.collapsed)n.nodeType==3?(o=f(n,r),this.r.move("character",o)):(this.r.moveToElementText(n),this.r.collapse(!0));else{var i=this.rte.doc.body.createTextRange(),s=f(n,r),h=f(e,u);n.nodeType==3?this.r.move("character",s):this.r.moveToElementText(n),e.nodeType==3?i.move("character",h):i.moveToElementText(e),this.r.setEndPoint("EndToEnd",i)}try{this.r.select()}catch(e){}i&&(i=null)},this.dump=function(){this.rte.log("collapsed: "+this.collapsed),this.rte.log("startContainer: "+(this.startContainer?this.startContainer.nodeName:"non")),this.rte.log("startOffset: "+this.startOffset),this.rte.log("endContainer: "+(this.endContainer?this.endContainer.nodeName:"none")),this.rte.log("endOffset: "+this.endOffset)}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.about=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.active=!0,this.command=function(){var r,i,u;r={rtl:t.rtl,submit:function(n,t){t.close()},dialog:{width:560,title:this.rte.i18n("About this software"),buttons:{Ok:function(){n(this).dialog("destroy")}}}},u='<div class="elrte-logo"><\/div><h3>'+this.rte.i18n("About elRTE")+'<\/h3><br clear="all"/><div class="elrte-ver">'+this.rte.i18n("Version")+": "+this.rte.version+" ("+this.rte.build+')<\/div><div class="elrte-ver">jQuery: '+n("<div/>").jquery+'<\/div><div class="elrte-ver">jQueryUI: '+n.ui.version+'<\/div><div class="elrte-ver">'+this.rte.i18n("Licence")+": BSD Licence<\/div><p>"+this.rte.i18n("elRTE is an open-source JavaScript based WYSIWYG HTML-editor.")+"<br/>"+this.rte.i18n("Main goal of the editor - simplify work with text and formating (HTML) on sites, blogs, forums and other online services.")+"<br/>"+this.rte.i18n("You can use it in any commercial or non-commercial projects.")+"<\/p><h4>"+this.rte.i18n("Authors")+'<\/h4><table class="elrte-authors"><tr><td>Dmitry (dio) Levashov &lt;dio@std42.ru&gt;<\/td><td>'+this.rte.i18n("Chief developer")+"<\/td><\/tr><tr><td>Troex Nevelin &lt;troex@fury.scancode.ru&gt;<\/td><td>"+this.rte.i18n("Developer, tech support")+"<\/td><\/tr><tr><td>Valentin Razumnyh &lt;content@std42.ru&gt;<\/td><td>"+this.rte.i18n("Interface designer")+"<\/td><\/tr><tr><td>Tawfek Daghistani &lt;tawfekov@gmail.com&gt;<\/td><td>"+this.rte.i18n("RTL support")+"<\/td><\/tr>"+(this.rte.options.lang!="en"?"<tr><td>"+this.rte.i18n("_translator")+"<\/td><td>"+this.rte.i18n("_translation")+"<\/td><\/tr>":"")+'<\/table><div class="elrte-copy">Copyright &copy; 2009-2011, <a href="http://www.std42.ru">Studio 42<\/a><\/div><div class="elrte-copy">'+this.rte.i18n("For more information about this software visit the")+' <a href="http://elrte.org">'+this.rte.i18n("elRTE website")+'.<\/a><\/div><div class="elrte-copy">Twitter: <a href="http://twitter.com/elrte_elfinder">elrte_elfinder<\/a><\/div>',i=new elDialogForm(r),i.append(u),i.open()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.anchor=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.input=n('<input type="text" />').attr("name","anchor").attr("size","16");var r=this;this.command=function(){var u={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Bookmark")}},i;this.anchor=this.rte.dom.selfOrParentAnchor(this.rte.selection.getEnd())||t.dom.create("a"),this.rte.selection.collapsed()||this.rte.selection.collapse(!1),this.input.val(n(this.anchor).addClass("elrte-anchor").attr("name")),this.rte.selection.saveIERange(),i=new elDialogForm(u),i.append([this.rte.i18n("Bookmark name"),this.input],null,!0).open(),setTimeout(function(){r.input.focus()},20)},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.addClass("disabled"):this.rte.dom.selfOrParentAnchor(n)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.removeClass("disabled").removeClass("active")},this.set=function(){var t=n.trim(this.input.val());t?(this.rte.history.add(),this.anchor.parentNode?(this.anchor.name=t,this.anchor.title=this.rte.i18n("Bookmark")+": "+t):this.rte.selection.insertHtml('<a name="'+t+'" title="'+this.rte.i18n("Bookmark")+": "+t+'" class="elrte-anchor"><\/a>')):this.anchor.parentNode&&(this.rte.history.add(),this.anchor.parentNode.removeChild(this.anchor))}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.blockquote=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i,t;this.rte.history.add(),this.rte.selection.collapsed()&&(i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/))?n(i).replaceWith(n(i).html()):(t=this.rte.selection.selected({wrap:"all",tag:"blockquote"}),t.length&&this.rte.selection.select(t[0],t[t.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.copy=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var t,i,r;if(this.rte.browser.mozilla)try{this.rte.doc.execCommand(this.name,!1,null)}catch(u){t=" Ctl + C",this.name=="cut"?t=" Ctl + X":this.name=="paste"&&(t=" Ctl + V"),i={dialog:{title:this.rte.i18n("Warning"),buttons:{Ok:function(){n(this).dialog("close")}}}},r=new elDialogForm(i),r.append(this.rte.i18n("This operation is disabled in your browser on security reason. Use shortcut instead.")+": "+t).open()}else this.constructor.prototype.command.call(this)}},elRTE.prototype.ui.prototype.buttons.cut=elRTE.prototype.ui.prototype.buttons.copy,elRTE.prototype.ui.prototype.buttons.paste=elRTE.prototype.ui.prototype.buttons.copy}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.css=function(t,i){var r=this;this.constructor.prototype.constructor.call(this,t,i),this.cssStyle=n('<input type="text" size="42" name="style" />'),this.cssClass=n('<input type="text" size="42" name="class" />'),this.elementID=n('<input type="text" size="42" name="id" />'),this.command=function(){var i=this.node(),u,t;this.rte.selection.saveIERange(),i&&(u={submit:function(n,t){n.stopPropagation(),n.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Style"),width:450,resizable:!0,modal:!0}},this.cssStyle.val(n(i).attr("style")),this.cssClass.val(n(i).attr("class")),this.elementID.val(n(i).attr("id")),t=new elDialogForm(u),t.append([this.rte.i18n("Css style"),this.cssStyle],null,!0),t.append([this.rte.i18n("Css class"),this.cssClass],null,!0),t.append([this.rte.i18n("ID"),this.elementID],null,!0),t.open(),setTimeout(function(){r.cssStyle.focus()},20))},this.set=function(){var t=this.node();this.rte.selection.restoreIERange(),t&&(n(t).attr("style",this.cssStyle.val()),n(t).attr("class",this.cssClass.val()),n(t).attr("id",this.elementID.val()),this.rte.ui.update())},this.node=function(){var n=this.rte.selection.getNode();return n.nodeType==3&&(n=n.parentNode),n.nodeType==1&&n.nodeName!="BODY"?n:null},this.update=function(){this.domElem.toggleClass("disabled",this.node()?!1:!0)}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.rtl=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),i=this;n(t).attr("dir")=="rtl"||n(t).parents('[dir="rtl"]').length||n(t).find('[dir="rtl"]').length?(n(t).removeAttr("dir"),n(t).parents('[dir="rtl"]').removeAttr("dir"),n(t).find('[dir="rtl"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?n(t).attr("dir","rtl"):n.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(i.rte.dom.is(r,"block"))return n(r).attr("dir","rtl"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),n(t).attr("dir")=="rtl"||n(t).parents('[dir="rtl"]').length||n(t).find('[dir="rtl"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}},elRTE.prototype.ui.prototype.buttons.ltr=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),i=this;n(t).attr("dir")=="ltr"||n(t).parents('[dir="ltr"]').length||n(t).find('[dir="ltr"]').length?(n(t).removeAttr("dir"),n(t).parents('[dir="ltr"]').removeAttr("dir"),n(t).find('[dir="ltr"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?n(t).attr("dir","ltr"):n.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(i.rte.dom.is(r,"block"))return n(r).attr("dir","ltr"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),n(t).attr("dir")=="ltr"||n(t).parents('[dir="ltr"]').length||n(t).find('[dir="ltr"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.div=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i,t;this.rte.history.add(),this.rte.selection.collapsed()?(i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/),i&&n(i).replaceWith(n(i).html())):(t=this.rte.selection.selected({wrap:"all",tag:"div"}),t.length&&this.rte.selection.select(t[0],t[t.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.docstructure=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){this.domElem.toggleClass("active"),n(this.rte.doc.body).toggleClass("el-rte-structure")},this.command(),this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.elfinder=function(n,t){this.constructor.prototype.constructor.call(this,n,t);var i=this,n=this.rte;this.command=function(){i.rte.options.fmAllow&&typeof i.rte.options.fmOpen=="function"&&i.rte.options.fmOpen(function(t){var i=decodeURIComponent(t.split("index.html").pop().replace(/\+/g," "));n.selection.collapsed()?n.selection.insertHtml('<a href="'+t+'" >'+i+"<\/a>"):n.doc.execCommand("createLink",!1,t)})},this.update=function(){i.rte.options.fmAllow&&typeof i.rte.options.fmOpen=="function"?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.flash=function(t,r){this.constructor.prototype.constructor.call(this,t,r);var u=this;this.swf=null,this.placeholder=null,this.src={url:n('<input type="text" name="url" />').css("width","99%"),type:n('<select name="type"/>').append('<option value="application/x-shockwave-flash">Flash<\/option>').append('<option value="video/quicktime">Quicktime movie<\/option>').append('<option value="application/x-mplayer2">Windows media<\/option>'),width:n('<input type="text" />').attr("size",5).css("text-align","right"),height:n('<input type="text" />').attr("size",5).css("text-align","right"),wmode:n("<select />").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("transparent").text(this.rte.i18n("Transparent"))),align:n("<select />").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("left").text(this.rte.i18n("Left"))).append(n("<option />").val("right").text(this.rte.i18n("Right"))).append(n("<option />").val("top").text(this.rte.i18n("Top"))).append(n("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(n("<option />").val("middle").text(this.rte.i18n("middle"))).append(n("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(n("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(n("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))),margin:n("<div />")},this.command=function(){var i=this.rte.selection.getEnd(),e="",o="",s="",h,c,v,t,y,a,r,p,w,f;if(this.rte.selection.saveIERange(),this.src.margin.elPaddingInput({type:"margin"}),this.placeholder=null,this.swf=null,n(i).hasClass("elrte-media")&&(v=n(i).attr("rel"))&&this.rte.filter.scripts[v]){if(this.placeholder=n(i),t=this.rte.filter.scripts[v],e="",t.embed&&t.embed.src&&(e=t.embed.src),t.params&&t.params.length)for(l=t.params.length;l--;)(t.params[l].name=="src"||t.params[l].name=="movie")&&(e=t.params[l].value);t.embed?(o=t.embed.width||parseInt(t.embed.style.width)||"",s=t.embed.height||parseInt(t.embed.style.height)||"",y=t.embed.wmode||""):t.obj&&(o=t.obj.width||parseInt(t.obj.style.width)||"",s=t.obj.height||parseInt(t.obj.style.height)||"",y=t.obj.wmode||""),t.obj?(h=t.obj.style.float||"",c=t.obj.style["vertical-align"]||""):t.embed&&(h=t.embed.style.float||"",c=t.embed.style["vertical-align"]||""),this.src.margin.val(i),this.src.type.val(t.embed?t.embed.type:"")}n(i).hasClass("elrte-swf-placeholder")&&(this.placeholder=n(i),e=n(i).attr("rel"),o=parseInt(n(i).css("width"))||"",s=parseInt(n(i).css("height"))||"",h=n(i).css("float"),c=n(i).css("vertical-align"),this.src.margin.val(i),this.src.wmode.val(n(i).attr("wmode"))),this.src.url.val(e),this.src.width.val(o),this.src.height.val(s),this.src.align.val(h||c),this.src.wmode.val(y),a={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),u.set(),t.close()},dialog:{width:580,position:"top",title:this.rte.i18n("Flash")}},r=new elDialogForm(a),p=this.rte.options.fmAllow&&this.rte.options.fmOpen?n("<span />").append(this.src.url.css("width","85%")).append(n("<span />").addClass("ui-state-default ui-corner-all").css({float:"right","margin-right":"3px"}).attr("title",u.rte.i18n("Open file manger")).append(n("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){u.rte.options.fmOpen(function(n){u.src.url.val(n).change()})}).hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")})):this.src.url,r.append([this.rte.i18n("URL"),p],null,!0),r.append([this.rte.i18n("Type"),this.src.type],null,!0),r.append([this.rte.i18n("Size"),n("<span />").append(this.src.width).append(" x ").append(this.src.height).append(" px")],null,!0),r.append([this.rte.i18n("Wmode"),this.src.wmode],null,!0),r.append([this.rte.i18n("Alignment"),this.src.align],null,!0),r.append([this.rte.i18n("Margins"),this.src.margin],null,!0),r.open(),w=n("<fieldset />").append(n("<legend />").text(this.rte.i18n("Preview"))),r.append(w,"main"),f=document.createElement("iframe"),n(f).attr("src","#").addClass("el-rte-preview").appendTo(w),html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><\/head><body style="padding:0;margin:0;font-size:9px"> Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin<\/body><\/html>',f.contentWindow.document.open(),f.contentWindow.document.write(html),f.contentWindow.document.close(),this.frame=f.contentWindow.document,this.preview=n(f.contentWindow.document.body),this.src.type.change(function(){u.src.url.change()}),this.src.width.change(function(){if(u.swf){var t=parseInt(n(this).val())||"";n(this).val(t),u.swf.css("width",t),u.swf.children("embed").css("width",t)}else n(this).val("")}),this.src.height.change(function(){if(u.swf){var t=parseInt(n(this).val())||"";n(this).val(t),u.swf.css("height",t),u.swf.children("embed").css("height",t)}else n(this).val("")}),this.src.wmode.change(function(){if(u.swf){var t=n(this).val();t?(u.swf.attr("wmode",t),u.swf.children("embed").attr("wmode",t)):(u.swf.removeAttr("wmode"),u.swf.children("embed").removeAttr("wmode"))}}),this.src.align.change(function(){var t=n(this).val(),i=t=="left"||t=="right";u.swf?u.swf.css({float:i?t:"","vertical-align":i?"":t}):n(this).val("")}),this.src.margin.change(function(){if(u.swf){var n=u.src.margin.val();n.css?u.swf.css("margin",n.css):(u.swf.css("margin-top",n.top),u.swf.css("margin-right",n.right),u.swf.css("margin-bottom",n.bottom),u.swf.css("margin-left",n.left))}}),this.src.url.change(function(){var i=u.rte.utils.absoluteURL(n(this).val()),t,r;i?(t=u.rte.utils.mediaInfo(u.src.type.val()),t||(t=u.rte.util.mediaInfo("application/x-shockwave-flash")),r='<object classid="'+t.classid+'" codebase="'+t.codebase+'"><param name="src" value="'+i+'" /><embed quality="high" src="'+i+'" type="'+t.type+'"><\/object>',u.preview.children("object").remove().end().prepend(r),u.swf=u.preview.children("object").eq(0)):u.swf&&(u.swf.remove(),u.swf=null),u.src.width.trigger("change"),u.src.height.trigger("change"),u.src.align.trigger("change")}).trigger("change")},this.set=function(){var l,p;u.swf=null;var f=this.rte.utils.absoluteURL(this.src.url.val()),o=parseInt(this.src.width.val())||"",s=parseInt(this.src.height.val())||"",w=this.src.wmode.val(),r=this.src.align.val(),h=r=="left"||r=="right"?r:"",c=this.placeholder?this.placeholder.attr("rel"):"",t,a,v,e=this.src.margin.val(),y;f?(i=u.rte.utils.mediaInfo(u.src.type.val()),i||(i=u.rte.util.mediaInfo("application/x-shockwave-flash")),v=this.rte.filter.videoHostRegExp.test(f)?f.replace(this.rte.filter.videoHostRegExp,"$2"):i.type.replace(/^\w+\/(.+)/,"$1"),t={obj:{classid:i.classid[0],codebase:i.codebase,style:{}},params:[{name:"src",value:f}],embed:{src:f,type:i.type,quality:"high",wmode:w,style:{}}},o&&(t.obj.width=o,t.embed.width=o),s&&(t.obj.height=s,t.embed.height=s),h?t.obj.style.float=h:r&&(t.obj.style["vertical-align"]=r),y=e.css?{margin:e.css}:{"margin-top":e.top,"margin-right":e.right,"margin-bottom":e.bottom,"margin-left":e.left},t.obj.style=n.extend({},t.obj.style,y),this.placeholder&&c?(a=this.rte.filter.scripts[c]||{},t=n.extend(!0,a,t),delete t.obj.style.width,delete t.obj.style.height,delete t.embed.style.width,delete t.embed.style.height,this.rte.filter.scripts[c]=t,this.placeholder.removeAttr("class")):(l="media"+Math.random().toString().substring(2),this.rte.filter.scripts[l]=t,this.placeholder=n(this.rte.dom.create("img")).attr("rel",l).attr("src",this.rte.filter.url+"pixel.gif"),p=!0),this.placeholder.attr("title",this.rte.utils.encode(f)).attr("width",o||150).attr("height",s||100).addClass("elrte-protected elrte-media elrte-media-"+v).css(t.obj.style),h?this.placeholder.css("float",h).css("vertical-align",""):r?this.placeholder.css("float","").css("vertical-align",r):this.placeholder.css("float","").css("vertical-align",""),p&&(this.rte.window.focus(),this.rte.selection.restoreIERange(),this.rte.selection.insertNode(this.placeholder.get(0)))):this.placeholder&&(this.placeholder.remove(),delete this.rte.filter.scripts[c])},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.domElem.toggleClass("active",t&&t.nodeName=="IMG"&&n(t).hasClass("elrte-media"))}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fontname=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var u=this,r={tpl:'<span style="font-family:%val">%label<\/span>',select:function(n){u.set(n)},src:{"":this.rte.i18n("Font"),"andale mono,sans-serif":"Andale Mono","arial,helvetica,sans-serif":"Arial","arial black,gadget,sans-serif":"Arial Black","book antiqua,palatino,sans-serif":"Book Antiqua","comic sans ms,cursive":"Comic Sans MS","courier new,courier,monospace":"Courier New","georgia,palatino,serif":"Georgia","helvetica,sans-serif":"Helvetica","impact,sans-serif":"Impact","lucida console,monaco,monospace":"Lucida console","lucida sans unicode,lucida grande,sans-serif":"Lucida grande","tahoma,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,lucida grande,verdana,sans-serif":"Trebuchet MS","verdana,geneva,sans-serif":"Verdana"}};this.select=this.domElem.elSelect(r),this.command=function(){},this.set=function(t){this.rte.history.add();var i=this.rte.selection.selected({filter:"textContainsNodes"});n.each(i,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?n(this).find("td,th"):n(this),n(this).css("font-family",t).find("[style]").css("font-family","")}),this.rte.ui.update()},this.update=function(){var i,t;this.domElem.removeClass("disabled"),i=this.rte.selection.getNode(),i.nodeType!=1&&(i=i.parentNode),t=n(i).css("font-family"),t=t?t.toString().toLowerCase().replace(/,\s+/g,",").replace(/'|"/g,""):"",this.select.val(r.src[t]?t:"")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fontsize=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this,u={labelTpl:"%label",tpl:'<span style="font-size:%val;line-height:1.2em">%label<\/span>',select:function(n){r.set(n)},src:{"":this.rte.i18n("Font size"),"xx-small":this.rte.i18n("Small (8pt)"),"x-small":this.rte.i18n("Small (10px)"),small:this.rte.i18n("Small (12pt)"),medium:this.rte.i18n("Normal (14pt)"),large:this.rte.i18n("Large (18pt)"),"x-large":this.rte.i18n("Large (24pt)"),"xx-large":this.rte.i18n("Large (36pt)")}};this.select=this.domElem.elSelect(u),this.command=function(){},this.set=function(t){this.rte.history.add();var i=this.rte.selection.selected({filter:"textContainsNodes"});n.each(i,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?n(this).find("td,th"):n(this),$this.css("font-size",t).find("[style]").css("font-size","")}),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var n=this.rte.selection.getNode();this.select.val((m=this.rte.dom.attr(n,"style").match(/font-size:\s*([^;]+)/i))?m[1]:"")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.forecolor=function(t,i){var r=this,u;this.constructor.prototype.constructor.call(this,t,i),u={"class":"",palettePosition:"outer",color:this.defaultColor,update:function(n){r.indicator.css("background-color",n)},change:function(n){r.set(n)}},this.defaultColor=this.name=="forecolor"?"#000000":"#ffffff",this.picker=this.domElem.elColorPicker(u),this.indicator=n("<div />").addClass("color-indicator").prependTo(this.domElem),this.command=function(){},this.set=function(t){if(!this.rte.selection.collapsed()){this.rte.history.add();var r=this.rte.selection.selected({collapse:!1,wrap:"text"}),i=this.name=="forecolor"?"color":"background-color";n.each(r,function(){/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)?n(this).find("td,th").each(function(){n(this).css(i,t).find("*").css(i,"")}):n(this).css(i,t).find("*").css(i,"")}),this.rte.ui.update(!0)}},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.picker.val(this.rte.utils.rgb2hex(n(t.nodeType!=1?t.parentNode:t).css(this.name=="forecolor"?"color":"background-color"))||this.defaultColor)}},elRTE.prototype.ui.prototype.buttons.hilitecolor=elRTE.prototype.ui.prototype.buttons.forecolor}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.formatblock=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var f=this.rte.browser.msie?function(n){r.val=n,r.constructor.prototype.command.call(r)}:function(n){r.ieCommand(n)},r=this,u={labelTpl:"%label",tpls:{"":"%label"},select:function(n){r.formatBlock(n)},src:{span:this.rte.i18n("Format"),h1:this.rte.i18n("Heading 1"),h2:this.rte.i18n("Heading 2"),h3:this.rte.i18n("Heading 3"),h4:this.rte.i18n("Heading 4"),h5:this.rte.i18n("Heading 5"),h6:this.rte.i18n("Heading 6"),p:this.rte.i18n("Paragraph"),address:this.rte.i18n("Address"),pre:this.rte.i18n("Preformatted"),div:this.rte.i18n("Normal (DIV)")}};this.select=this.domElem.elSelect(u),this.command=function(){},this.formatBlock=function(t){function h(t,i){function u(t){return n(t).find("h1,h2,h3,h4,h5,h6,p,address,pre").each(function(){n(this).replaceWith(n(this).html())}),t}/^(LI|DT|DD|TD|TH|CAPTION)$/.test(t.nodeName)?r.rte.dom.isEmpty(t)||r.rte.dom.wrapContents(u(t),i):/^(UL|OL|DL|TABLE)$/.test(t.nodeName)?r.rte.dom.wrap(t,i):r.rte.dom.isEmpty(t)||n(u(t)).replaceWith(n(r.rte.dom.create(i)).html(n(t).html()))}this.rte.history.add();var u=t.toUpperCase(),i,o,a=this.rte.selection.collapsed(),c=this.rte.selection.getBookmark(),f=this.rte.selection.selected({collapsed:!0,blocks:!0,filter:"textContainsNodes",wrap:"inline",tag:"span"});for(l=f.length,s=n(f[0]).prev(),e=n(f[f.length-1]).next();l--;)i=f[l],o=n(i),u=="DIV"||u=="SPAN"?/^(H[1-6]|P|ADDRESS|PRE)$/.test(i.nodeName)&&o.replaceWith(n(this.rte.dom.create("div")).html(o.html()||"")):/^(THEAD|TBODY|TFOOT|TR)$/.test(i.nodeName)?o.find("td,th").each(function(){h(this,u)}):i.nodeName!=u&&h(i,u);this.rte.selection.moveToBookmark(c),this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled");var n=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(H[1-6]|P|ADDRESS|PRE)$/);this.select.val(n?n.nodeName.toLowerCase():"span")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fullscreen=function(t,i){function u(){r.wz.height(n(window).height()-r.delta),r.rte.updateHeight()}var r=this;this.constructor.prototype.constructor.call(this,t,i),this.active=!0,this.editor=t.editor,this.wz=t.workzone,this.height=0,this.delta=0,this._class="el-fullscreen",setTimeout(function(){r.height=r.wz.height(),r.delta=r.editor.outerHeight()-r.height},50),this.command=function(){function v(){c&&(l=h.getBookmark())}function y(){c&&(r.wz.children().toggle(),r.rte.source.focus(),r.wz.children().toggle(),h.moveToBookmark(l))}var i=n(window),t=this.editor,a=t.parents().filter(function(t,i){return!/^(html|body)$/i.test(i.nodeName)&&n(i).css("position")=="relative"}),o=this.wz,f=this._class,e=t.hasClass(f),s=this.rte,h=this.rte.selection,c=n.browser.mozilla,l;v(),a.css("position",e?"relative":"static"),e?(t.removeClass(f),o.height(this.height),i.unbind("resize",u),this.domElem.removeClass("active")):(t.addClass(f).removeAttr("style"),o.height(i.height()-this.delta).css("width","100%"),i.bind("resize",u),this.domElem.addClass("active")),s.updateHeight(),s.resizable(e),y()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.horizontalrule=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src={width:n('<input type="text" />').attr({name:"width",size:4}).css("text-align","right"),wunit:n("<select />").attr("name","wunit").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")).val("%"),height:n('<input type="text" />').attr({name:"height",size:4}).css("text-align","right"),bg:n("<div />"),border:n("<div />"),"class":n('<input type="text" />').css("width","100%"),style:n('<input type="text" />').css("width","100%")},this.command=function(){var i,u,f,e;this.src.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),i=this.rte.selection.getEnd(),this.hr=i.nodeName=="HR"?n(i):n(t.doc.createElement("hr")).css({width:"100%",height:"1px"}),this.src.border.elBorderSelect({styleHeight:73,value:this.hr}),u=this.hr.css("width")||this.hr.attr("width"),this.src.width.val(parseInt(u)||100),this.src.wunit.val(u.indexOf("px")!=-1?"px":"%"),this.src.height.val(this.rte.utils.toPixels(this.hr.css("height")||this.hr.attr("height"))||1),this.src.bg.val(this.rte.utils.color2Hex(this.hr.css("background-color"))),this.src["class"].val(this.rte.dom.attr(this.hr,"class")),this.src.style.val(this.rte.dom.attr(this.hr,"style")),f={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{title:this.rte.i18n("Horizontal rule")}},e=new elDialogForm(f),e.append([this.rte.i18n("Width"),n("<span />").append(this.src.width).append(this.src.wunit)],null,!0).append([this.rte.i18n("Height"),n("<span />").append(this.src.height).append(" px")],null,!0).append([this.rte.i18n("Border"),this.src.border],null,!0).append([this.rte.i18n("Background"),this.src.bg],null,!0).append([this.rte.i18n("Css class"),this.src["class"]],null,!0).append([this.rte.i18n("Css style"),this.src.style],null,!0).open()},this.update=function(){this.domElem.removeClass("disabled"),this.rte.selection.getEnd().nodeName=="HR"?this.domElem.addClass("active"):this.domElem.removeClass("active")},this.set=function(){this.rte.history.add(),this.hr.parentNode||this.rte.selection.insertNode(this.hr.get(0));var t={noshade:!0,style:this.src.style.val()},n=this.src.border.val(),i={width:(parseInt(this.src.width.val())||100)+this.src.wunit.val(),height:parseInt(this.src.height.val())||1,"background-color":this.src.bg.val(),border:n.width&&n.style?n.width+" "+n.style+" "+n.color:""};this.hr.removeAttr("class").removeAttr("style").removeAttr("width").removeAttr("height").removeAttr("align").attr(t).css(i),this.src["class"].val()&&this.hr.attr("class",this.src["class"].val()),this.rte.ui.update()}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.image=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this,t=r.rte,o=0,u=0,f=0,e=null,s=function(t){n.each(r.src,function(i,r){n.each(r,function(n,i){n=="src"&&t||i.val("")})})},h=function(i){n.each(r.src,function(r,u){n.each(u,function(n,u){var f,o,s,e;n=="width"?f=i.width():n=="height"?f=i.height():n=="border"?(f="",e=i.css("border")||t.utils.parseStyle(i.attr("style")).border||"",e&&(o=e.match(/(\d(px|em|%))/),s=e.match(/(#[a-z0-9]+)/),f={width:o?o[1]:e,style:e,color:t.utils.color2Hex(s?s[1]:e)})):n=="margin"?f=i:n=="align"?(f=i.css("float"),f!="left"&&f!="right"&&(f=i.css("vertical-align"))):f=i.attr(n)||"",r=="events"&&(f=t.utils.trimEventCallback(f)),u.val(f)})})},l=function(){var t=r.src.main.src.val();s(!0),t?(r.prevImg?(r.prevImg.removeAttr("src").removeAttr("style").removeAttr("class").removeAttr("id").removeAttr("title").removeAttr("alt").removeAttr("longdesc"),n.each(r.src.events,function(n){r.prevImg.removeAttr(n)})):r.prevImg=n("<img/>").prependTo(r.preview),r.prevImg.load(function(){r.prevImg.unbind("load"),setTimeout(function(){u=r.prevImg.width(),f=r.prevImg.height(),o=(u/f).toFixed(2),r.src.main.width.val(u),r.src.main.height.val(f)},100)}).attr("src",t)):(r.preview.children("img").remove(),r.prevImg=null)},c=function(n){var t=parseInt(r.src.main.width.val())||0,i=parseInt(r.src.main.height.val())||0;r.prevImg&&(t&&i?n.target===r.src.main.width[0]?i=parseInt(t/o):t=parseInt(i*o):(t=u,i=f),r.src.main.height.val(i),r.src.main.width.val(t),r.prevImg.width(t).height(i),r.src.adv.style.val(r.prevImg.attr("style")))};this.img=null,this.prevImg=null,this.preview=n('<div class="elrte-image-preview"/>').text("Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin"),this.init=function(){this.labels={main:"Properies",link:"Link",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",longdesc:"Detail description URL",href:"URL",target:"Open in",title:"Title"},this.src={main:{src:n('<input type="text" />').css("width","100%").change(l),title:n('<input type="text" />').css("width","100%"),alt:n('<input type="text" />').css("width","100%"),width:n('<input type="text" />').attr("size",5).css("text-align","right").change(c),height:n('<input type="text" />').attr("size",5).css("text-align","right").change(c),margin:n("<div />").elPaddingInput({type:"margin",change:function(){var n=r.src.main.margin.val();r.prevImg&&(n.css?r.prevImg.css("margin",n.css):r.prevImg.css({"margin-left":n.left,"margin-top":n.top,"margin-right":n.right,"margin-bottom":n.bottom}))}}),align:n("<select />").css("width","100%").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("left").text(this.rte.i18n("Left"))).append(n("<option />").val("right").text(this.rte.i18n("Right"))).append(n("<option />").val("top").text(this.rte.i18n("Top"))).append(n("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(n("<option />").val("middle").text(this.rte.i18n("middle"))).append(n("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(n("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(n("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))).change(function(){var t=n(this).val(),i={float:"","vertical-align":""};r.prevImg&&(t=="left"||t=="right"?(i.float=t,i["vertical-align"]=""):t&&(i.float="",i["vertical-align"]=t),r.prevImg.css(i))}),border:n("<div />").elBorderSelect({name:"border",change:function(){var n=r.src.main.border.val();r.prevImg&&r.prevImg.css("border",n.width?n.width+" "+n.style+" "+n.color:"")}})},adv:{},events:{}},n.each(["id","class","style","longdesc"],function(t,i){r.src.adv[i]=n('<input type="text" style="width:100%" />')}),this.src.adv["class"].change(function(){r.prevImg&&r.prevImg.attr("class",n(this).val())}),this.src.adv.style.change(function(){r.prevImg&&(r.prevImg.attr("style",n(this).val()),h(r.prevImg))}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text"  style="width:100%"/>')})},this.command=function(){this.src||this.init();var c,v={rtl:t.rtl,submit:function(n){n.stopPropagation(),n.preventDefault(),r.set(),i.close()},close:function(){e&&t.selection.moveToBookmark(e)},dialog:{autoOpen:!1,width:500,position:"top",title:t.i18n("Image"),resizable:!0,open:function(){n.fn.resizable&&n(this).parents(".ui-dialog:first").resizable("option","alsoResize",".elrte-image-preview")}}},i=new elDialogForm(v),l=!!t.options.fmOpen,a=l?n('<div class="elrte-image-src-fm"><span class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-folder-open"/><\/span><\/div>').append(this.src.main.src.css("width","87%")):this.src.main.src;s(),this.preview.children("img").remove(),this.prevImg=null,c=t.selection.getEnd(),this.img=c.nodeName=="IMG"&&!n(c).is(".elrte-protected")?n(c):n("<img/>"),e=t.selection.getBookmark(),l&&a.children(".ui-state-default").click(function(){t.options.fmOpen(function(n){r.src.main.src.val(n).change()})}).hover(function(){n(this).toggleClass("ui-state-hover")}),i.tab("main",this.rte.i18n("Properies")).append([this.rte.i18n("Image URL"),a],"main",!0).append([this.rte.i18n("Title"),this.src.main.title],"main",!0).append([this.rte.i18n("Alt text"),this.src.main.alt],"main",!0).append([this.rte.i18n("Size"),n("<span />").append(this.src.main.width).append(" x ").append(this.src.main.height).append(" px")],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0),i.append(n("<fieldset><legend>"+this.rte.i18n("Preview")+"<\/legend><\/fieldset>").append(this.preview),"main"),n.each(this.src,function(u,f){u!="main"&&(i.tab(u,t.i18n(r.labels[u])),n.each(f,function(n){r.src[u][n].val(u=="events"?t.utils.trimEventCallback(r.img.attr(n)):r.img.attr(n)||""),i.append([t.i18n(r.labels[n]||n),r.src[u][n]],u,!0)}))}),i.open(),this.img.attr("src")&&(h(this.img),this.prevImg=this.img.clone().prependTo(this.preview),o=(this.img.width()/this.img.height()).toFixed(2),u=parseInt(this.img.width()),f=parseInt(this.img.height()))},this.set=function(){var u=this.src.main.src.val(),i;if(this.rte.history.add(),e&&t.selection.moveToBookmark(e),!u)return i=t.dom.selfOrParentLink(this.img[0]),i&&i.remove(),this.img.remove();this.img[0].parentNode||(this.img=n(this.rte.doc.createElement("img"))),this.img.attr("src",u).attr("style",this.src.adv.style.val()),n.each(this.src,function(t,i){n.each(i,function(t,i){var u=i.val();switch(t){case"width":r.img.css("width",u);break;case"height":r.img.css("height",u);break;case"align":r.img.css(u=="left"||u=="right"?"float":"vertical-align",u);break;case"margin":u.css?r.img.css("margin",u.css):r.img.css({"margin-left":u.left,"margin-top":u.top,"margin-right":u.right,"margin-bottom":u.bottom});break;case"border":if(u.width){u="border:"+u.css+";"+n.trim((r.img.attr("style")||"").replace(/border\-[^;]+;?/ig,"")),t="style",r.img.attr("style",u);return}u="";break;case"src":case"style":return;default:u?r.img.attr(t,u):r.img.removeAttr(t)}})}),this.img[0].parentNode||t.selection.insertNode(this.img[0]),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getEnd(),i=n(t);t.nodeName!="IMG"||i.hasClass("elrte-protected")?this.domElem.removeClass("active"):this.domElem.addClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.indent=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){function f(t){var i=/(IMG|HR|TABLE|EMBED|OBJECT)/.test(t.nodeName)?"margin-left":"padding-left",u=r.rte.dom.attr(t,"style").indexOf(i)!=-1?parseInt(n(t).css(i))||0:0;n(t).css(i,u+40+"px")}var i,t,u;for(this.rte.history.add(),i=this.rte.selection.selected({collapsed:!0,blocks:!0,wrap:"inline",tag:"p"}),t=0;t<i.length;t++)/^(TABLE|THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(i[t].nodeName)?n(i[t]).find("td,th").each(function(){f(this)}):/^LI$/.test(i[t].nodeName)?(u=n(i[t]),n(this.rte.dom.create(i[t].parentNode.nodeName)).append(n(this.rte.dom.create("li")).html(u.html()||"")).appendTo(u.html("&nbsp;"))):f(i[t]);this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.justifyleft=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.align=this.name=="justifyfull"?"justify":this.name.replace("justify",""),this.command=function(){var i=this.rte.selection.selected({collapsed:!0,blocks:!0,tag:"div"}),t=i.length;for(t&&this.rte.history.add();t--;)this.rte.dom.filter(i[t],"textNodes")&&n(i[t]).css("text-align",this.align);this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode(),i=t.nodeName=="BODY"?t:this.rte.dom.selfOrParent(t,"textNodes")||(t.parentNode&&t.parentNode.nodeName=="BODY"?t.parentNode:null);i?this.domElem.removeClass("disabled").toggleClass("active",n(i).css("text-align")==this.align):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.justifycenter=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyright=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyfull=elRTE.prototype.ui.prototype.buttons.justifyleft}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.link=function(t,i){function u(){r.labels={id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language",charset:"Charset",type:"Target MIME type",rel:"Relationship page to target (rel)",rev:"Relationship target to page (rev)",tabindex:"Tab index",accesskey:"Access key"},r.src={main:{href:n('<input type="text" />'),title:n('<input type="text" />'),anchor:n("<select />").attr("name","anchor"),target:n("<select />").append(n("<option />").text(r.rte.i18n("In this window")).val("")).append(n("<option />").text(r.rte.i18n("In new window (_blank)")).val("_blank"))},popup:{use:n('<input type="checkbox" />'),url:n('<input type="text" />').val("http://"),name:n('<input type="text" />'),width:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Width")}).css("text-align","right"),height:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Height")}).css("text-align","right"),left:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Left")}).css("text-align","right"),top:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Top")}).css("text-align","right"),location:n('<input type="checkbox" />'),menubar:n('<input type="checkbox" />'),toolbar:n('<input type="checkbox" />'),scrollbars:n('<input type="checkbox" />'),status:n('<input type="checkbox" />'),resizable:n('<input type="checkbox" />'),dependent:n('<input type="checkbox" />'),retfalse:n('<input type="checkbox" />').attr("checked",!0)},adv:{id:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />'),charset:n('<input type="text" />'),type:n('<input type="text" />'),rel:n('<input type="text" />'),rev:n('<input type="text" />'),tabindex:n('<input type="text" />'),accesskey:n('<input type="text" />')},events:{}},n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />')}),n.each(r.src,function(){var n,t;for(n in this)t=this[n].attr("type"),t&&(t!="text"||this[n].attr("size"))||this[n].css("width","100%")})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.img=!1,this.bm,this.command=function(){function c(n){return n.nodeName=="A"&&n.href}var t=this.rte.selection.getNode(),i,f,l,a,v,e,s,h,o;if(this.src||u(),this.bm=this.rte.selection.getBookmark(),this.link=this.rte.dom.selfOrParentLink(t),!this.link&&(i=n.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1}),i.length)){for(f=0;f<i.length;f++)if(c(i[f])){this.link=i[f];break}this.link||(this.link=this.rte.dom.parent(i[0],c)||this.rte.dom.parent(i[i.length-1],c))}this.link=this.link?n(this.link):n(this.rte.doc.createElement("a")),this.img=t.nodeName=="IMG"?t:null,this.updatePopup(),this.src.main.anchor.empty(),n('a[href!=""][name]',this.rte.doc).each(function(){var t=n(this).attr("name");r.src.main.anchor.append(n("<option />").val(t).text(t))}),this.src.main.anchor.children().length&&this.src.main.anchor.prepend(n("<option />").val("").text(this.rte.i18n("Select bookmark"))).change(function(){var t=n(this).val();t&&r.src.main.href.val("#"+t)}),l={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},tabs:{show:function(n,t){t.index==3&&r.updateOnclick()}},close:function(){r.rte.browser.msie&&r.rte.selection.restoreIERange()},dialog:{width:"auto",width:430,title:this.rte.i18n("Link")}},d=new elDialogForm(l),a=n("<div />").append(n("<label />").append(this.src.popup.location).append(this.rte.i18n("Location bar"))).append(n("<label />").append(this.src.popup.menubar).append(this.rte.i18n("Menu bar"))).append(n("<label />").append(this.src.popup.toolbar).append(this.rte.i18n("Toolbar"))).append(n("<label />").append(this.src.popup.scrollbars).append(this.rte.i18n("Scrollbars"))),v=n("<div />").append(n("<label />").append(this.src.popup.status).append(this.rte.i18n("Status bar"))).append(n("<label />").append(this.src.popup.resizable).append(this.rte.i18n("Resizable"))).append(n("<label />").append(this.src.popup.dependent).append(this.rte.i18n("Depedent"))).append(n("<label />").append(this.src.popup.retfalse).append(this.rte.i18n("Add return false"))),d.tab("main",this.rte.i18n("Properies")).tab("popup",this.rte.i18n("Popup")).tab("adv",this.rte.i18n("Advanced")).tab("events",this.rte.i18n("Events")).append(n("<label />").append(this.src.popup.use).append(this.rte.i18n("Open link in popup window")),"popup").separator("popup").append([this.rte.i18n("URL"),this.src.popup.url],"popup",!0).append([this.rte.i18n("Window name"),this.src.popup.name],"popup",!0).append([this.rte.i18n("Window size"),n("<span />").append(this.src.popup.width).append(" x ").append(this.src.popup.height).append(" px")],"popup",!0).append([this.rte.i18n("Window position"),n("<span />").append(this.src.popup.left).append(" x ").append(this.src.popup.top).append(" px")],"popup",!0).separator("popup").append([a,v],"popup",!0),e=this.link.get(0),s=this.rte.dom.attr(e,"href"),this.src.main.href.val(s).change(function(){n(this).val(r.rte.utils.absoluteURL(n(this).val()))}),this.rte.options.fmAllow&&this.rte.options.fmOpen?(h=n("<span />").append(this.src.main.href.css("width","87%")).append(n("<span />").addClass("ui-state-default ui-corner-all").css({float:"right","margin-right":"3px"}).attr("title",r.rte.i18n("Open file manger")).append(n("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){r.rte.options.fmOpen(function(n){r.src.main.href.val(n).change()})}).hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")})),d.append([this.rte.i18n("Link URL"),h],"main",!0)):d.append([this.rte.i18n("Link URL"),this.src.main.href],"main",!0),this.src.main.href.change(),d.append([this.rte.i18n("Title"),this.src.main.title.val(this.rte.dom.attr(e,"title"))],"main",!0),this.src.main.anchor.children().length&&d.append([this.rte.i18n("Bookmark"),this.src.main.anchor.val(s)],"main",!0),this.rte.options.doctype.match(/xhtml/)&&this.rte.options.doctype.match(/strict/)||d.append([this.rte.i18n("Target"),this.src.main.target.val(this.link.attr("target")||"")],"main",!0);for(t in this.src.adv)this.src.adv[t].val(this.rte.dom.attr(e,t)),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.adv[t]],"adv",!0);for(t in this.src.events)o=this.rte.utils.trimEventCallback(this.rte.dom.attr(e,t)),this.src.events[t].val(o),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.events[t]],"events",!0);this.src.popup.use.change(function(){var t=n(this).attr("checked");n.each(r.src.popup,function(){n(this).attr("name")!="use"&&(t?n(this).removeAttr("disabled"):n(this).attr("disabled",!0))})}),this.src.popup.use.change(),d.open()},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(n){return n.nodeName=="A"&&n.href})?this.domElem.removeClass("disabled").addClass("active"):this.rte.selection.collapsed()&&n.nodeName!="IMG"?this.domElem.addClass("disabled").removeClass("active"):this.domElem.removeClass("disabled active")},this.updatePopup=function(){var t=""+this.link.attr("onclick");t.length>0&&(m=t.match(/window.open\('([^']+)',\s*'([^']*)',\s*'([^']*)'\s*.*\);\s*(return\s+false)?/))?(this.src.popup.use.attr("checked","on"),this.src.popup.url.val(m[1]),this.src.popup.name.val(m[2]),/location=yes/.test(m[3])&&this.src.popup.location.attr("checked",!0),/menubar=yes/.test(m[3])&&this.src.popup.menubar.attr("checked",!0),/toolbar=yes/.test(m[3])&&this.src.popup.toolbar.attr("checked",!0),/scrollbars=yes/.test(m[3])&&this.src.popup.scrollbars.attr("checked",!0),/status=yes/.test(m[3])&&this.src.popup.status.attr("checked",!0),/resizable=yes/.test(m[3])&&this.src.popup.resizable.attr("checked",!0),/dependent=yes/.test(m[3])&&this.src.popup.dependent.attr("checked",!0),(_m=m[3].match(/width=([^,]+)/))&&this.src.popup.width.val(_m[1]),(_m=m[3].match(/height=([^,]+)/))&&this.src.popup.height.val(_m[1]),(_m=m[3].match(/left=([^,]+)/))&&this.src.popup.left.val(_m[1]),(_m=m[3].match(/top=([^,]+)/))&&this.src.popup.top.val(_m[1]),m[4]&&this.src.popup.retfalse.attr("checked",!0)):n.each(this.src.popup,function(){var t=n(this);t.attr("type")=="text"?t.val(t.attr("name")=="url"?"http://":""):t.attr("name")=="retfalse"?this.attr("checked",!0):t.removeAttr("checked")})},this.updateOnclick=function(){var r=this.src.popup.url.val(),t,u,f,i;this.src.popup.use.attr("checked")&&r?(t="",this.src.popup.location.attr("checked")&&(t+="location=yes,"),this.src.popup.menubar.attr("checked")&&(t+="menubar=yes,"),this.src.popup.toolbar.attr("checked")&&(t+="toolbar=yes,"),this.src.popup.scrollbars.attr("checked")&&(t+="scrollbars=yes,"),this.src.popup.status.attr("checked")&&(t+="status=yes,"),this.src.popup.resizable.attr("checked")&&(t+="resizable=yes,"),this.src.popup.dependent.attr("checked")&&(t+="dependent=yes,"),this.src.popup.width.val()&&(t+="width="+this.src.popup.width.val()+","),this.src.popup.height.val()&&(t+="height="+this.src.popup.height.val()+","),this.src.popup.left.val()&&(t+="left="+this.src.popup.left.val()+","),this.src.popup.top.val()&&(t+="top="+this.src.popup.top.val()+","),t.length>0&&(t=t.substring(0,t.length-1)),u=this.src.popup.retfalse.attr("checked")?"return false;":"",f="window.open('"+r+"', '"+n.trim(this.src.popup.name.val())+"', '"+t+"'); "+u,this.src.events.onclick.val(f),this.src.main.href.val()||this.src.main.href.val("#")):(i=this.src.events.onclick.val(),i=i.replace(/window\.open\([^\)]+\)\s*;?\s*return\s*false\s*;?/i,""),this.src.events.onclick.val(i))},this.set=function(){var i,u,e,r,t,f;if(this.updateOnclick(),this.rte.selection.moveToBookmark(this.bm),this.rte.history.add(),i=this.rte.utils.absoluteURL(this.src.main.href.val()),i){this.img&&this.img.parentNode?(this.link=n(this.rte.dom.create("a")).attr("href",i),this.rte.dom.wrap(this.img,this.link[0])):this.link[0].parentNode||(u="#--el-editor---"+Math.random(),this.rte.doc.execCommand("createLink",!1,u),this.link=n('a[href="'+u+'"]',this.rte.doc),this.link.each(function(){var t=n(this);n.trim(t.html())||n.trim(t.text())||t.replaceWith(t.text())})),this.src.main.href.val(i);for(r in this.src)if(r!="popup")for(t in this.src[r])t!="anchors"&&(f=n.trim(this.src[r][t].val()),f?this.link.attr(t,f):this.link.removeAttr(t));this.img&&this.rte.selection.select(this.img)}else e=this.rte.selection.getBookmark(),this.rte.dom.unwrap(this.link[0]),this.rte.selection.moveToBookmark(e);this.rte.ui.update(!0)}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.nbsp=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){this.rte.history.add(),this.rte.selection.insertHtml("&nbsp;",!0),this.rte.window.focus(),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.outdent=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.find();t.node&&(this.rte.history.add(),n(t.node).css(t.type,(t.val>40?t.val-40:0)+"px"),this.rte.ui.update())},this.find=function(t){function u(t){var i={type:"",val:0},u;return(u=r.rte.dom.attr(t,"style"))&&(i.type=u.indexOf("padding-left")!=-1?"padding-left":u.indexOf("margin-left")!=-1?"margin-left":"",i.val=i.type?parseInt(n(t).css(i.type))||0:0),i}var t=this.rte.selection.getNode(),i=u(t);return i.val?i.node=t:n.each(this.rte.dom.parents(t,"*"),function(){return i=u(this),i.val?(i.node=this,i):void 0}),i},this.update=function(){var n=this.find();n.node?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pagebreak=function(t,i){this.constructor.prototype.constructor.call(this,t,i),n(this.rte.doc.body).bind("mousedown",function(t){n(t.target).hasClass("elrte-pagebreak")&&t.preventDefault()}),this.command=function(){this.rte.selection.insertHtml('<img src="'+this.rte.filter.url+'pixel.gif" class="elrte-protected elrte-pagebreak"/>',!1)},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pasteformattext=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.iframe=n(document.createElement("iframe")).addClass("el-rte-paste-input"),this.doc=null;var r=this;this.command=function(){this.rte.selection.saveIERange();var n=this,t={submit:function(t,i){t.stopPropagation(),t.preventDefault(),n.paste(),i.close()},dialog:{width:500,title:this.rte.i18n("Paste formatted text")}},i=new elDialogForm(t);if(i.append(this.iframe).open(),this.doc=this.iframe.get(0).contentWindow.document,html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',html+="<\/head><body> <br /> <\/body><\/html>",this.doc.open(),this.doc.write(html),this.doc.close(),this.rte.browser.msie)this.doc.body.contentEditable=!0;else try{this.doc.designMode="on"}catch(r){}setTimeout(function(){n.iframe[0].contentWindow.focus()},50)},this.paste=function(){n(this.doc.body).find("[class]").removeAttr("class");var t=n.trim(n(this.doc.body).html());t&&(this.rte.history.add(),this.rte.selection.restoreIERange(),this.rte.selection.insertHtml(this.rte.filter.wysiwyg2wysiwyg(this.rte.filter.proccess("paste",t))),this.rte.ui.update(!0))},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pastetext=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.input=n("<textarea />").addClass("el-rte-paste-input");var r=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var n={submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.paste(),t.close()},dialog:{width:500,title:this.rte.i18n("Paste only text")}},t=new elDialogForm(n);t.append(this.input).open()},this.paste=function(){var t=n.trim(this.input.val());t&&(this.rte.history.add(),this.rte.browser.msie&&this.rte.selection.restoreIERange(),this.rte.selection.insertText(t.replace(/\r?\n/g,"<br />"),!0),this.rte.ui.update(!0)),this.input.val("")},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.save=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.active=!0,this.command=function(){this.rte.save()},this.update=function(){}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.smiley=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.img=null,this.url=this.rte.filter.url+"smileys/",this.smileys={smile:"smile.png",happy:"happy.png",tongue:"tongue.png",surprised:"surprised.png",waii:"waii.png",wink:"wink.png",evilgrin:"evilgrin.png",grin:"grin.png",unhappy:"unhappy.png"},this.width=120,this.command=function(){var r=this,u=this.url,t,i;this.rte.browser.msie&&this.rte.selection.saveIERange(),i={dialog:{height:120,width:this.width,title:this.rte.i18n("Smiley"),buttons:{}}},t=new elDialogForm(i),n.each(this.smileys,function(i,f){t.append(n('<img src="'+u+f+'" title="'+i+'" id="'+i+'" class="el-rte-smiley"/>').click(function(){r.set(this.id,t)}))}),t.open()},this.update=function(){this.domElem.removeClass("disabled"),this.domElem.removeClass("active")},this.set=function(t,i){this.rte.browser.msie&&this.rte.selection.restoreIERange(),this.smileys[t]&&(this.img=n(this.rte.doc.createElement("img")),this.img.attr({src:this.url+this.smileys[t],title:t,alt:t}),this.rte.selection.insertNode(this.img.get(0)),this.rte.ui.update()),i.close()}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.stopfloat=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.find=function(){if(this.rte.selection.collapsed()){var t=this.rte.dom.selfOrParent(this.rte.selection.getEnd(),/^DIV$/);if(t&&(this.rte.dom.attr(t,"clear")||n(t).css("clear")!="none"))return t}},this.command=function(){var t;(t=this.find())?(t=n(t),this.rte.history.add(),t.children().length||n.trim(t.text()).length?t.removeAttr("clear").css("clear",""):t.remove()):(this.rte.history.add(),this.rte.selection.insertNode(n(this.rte.dom.create("div")).css("clear","both").get(0),!0)),this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled"),this.find()?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.table=function(t,i){function u(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",summary:"Summary",lang:"Language",href:"URL"},r.src={main:{caption:n('<input type="text" />'),rows:n('<input type="text" />').attr("size",5).val(2),cols:n('<input type="text" />').attr("size",5).val(2),width:n('<input type="text" />').attr("size",5),wunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),height:n('<input type="text" />').attr("size",5),hunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),align:n("<select />").append(n("<option />").val("").text(r.rte.i18n("Not set"))).append(n("<option />").val("left").text(r.rte.i18n("Left"))).append(n("<option />").val("center").text(r.rte.i18n("Center"))).append(n("<option />").val("right").text(r.rte.i18n("Right"))),spacing:n('<input type="text" />').attr("size",5),padding:n('<input type="text" />').attr("size",5),border:n("<div />"),rules:n("<select />").append(n("<option />").val("none").text(r.rte.i18n("No"))).append(n("<option />").val("all").text(r.rte.i18n("Cells"))).append(n("<option />").val("groups").text(r.rte.i18n("Groups"))).append(n("<option />").val("rows").text(r.rte.i18n("Rows"))).append(n("<option />").val("cols").text(r.rte.i18n("Columns"))),margin:n("<div />"),bg:n("<div />"),bgimg:n('<input type="text" />').css("width","90%")},adv:{id:n('<input type="text" />'),summary:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />')},events:{}},n.each(r.src,function(){var n,t;for(n in this)this[n].attr("name",n),t=this[n].get(0).nodeName,t=="INPUT"&&n!="bgimg"?this[n].css(this[n].attr("size")?{"text-align":"right"}:{width:"100%"}):t=="SELECT"&&n!="wunit"&&n!="hunit"&&this[n].css("width","100%")}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />').css("width","100%")}),r.src.main.align.change(function(){var i=n(this).val(),t;i=="center"?r.src.main.margin.val({left:"auto",right:"auto"}):(t=r.src.main.margin.val(),t.left=="auto"&&t.right=="auto"&&r.src.main.margin.val({left:"",right:""}))}),r.src.main.bgimg.change(function(){var t=n(this);t.val(r.rte.utils.absoluteURL(t.val()))})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src=null,this.labels=null,this.command=function(){var l=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/),h,e,o,a,v,c,y,f,t,i,s;this.table=this.name=="table"?n(this.rte.doc.createElement("table")):l?n(l):n(this.rte.doc.createElement("table")),this.src||u(),this.src.main.border.elBorderSelect({styleHeight:117}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.margin.elPaddingInput({type:"margin",value:this.table}),this.table.parents().length?(this.src.main.rows.val("").attr("disabled",!0),this.src.main.cols.val("").attr("disabled",!0)):(this.src.main.rows.val(2).removeAttr("disabled"),this.src.main.cols.val(2).removeAttr("disabled")),h=this.table.css("width")||this.table.attr("width"),this.src.main.width.val(parseInt(h)||""),this.src.main.wunit.val(h.indexOf("px")!=-1?"px":"%"),e=this.table.css("height")||this.table.attr("height"),this.src.main.height.val(parseInt(e)||""),this.src.main.hunit.val(e&&e.indexOf("px")!=-1?"px":"%"),o=this.table.css("float"),this.src.main.align.val(""),o=="left"||o=="right"?this.src.main.align.val(o):(a=this.table.css("margin-left"),v=this.table.css("margin-right"),a=="auto"&&v=="auto"&&this.src.main.align.val("center")),this.src.main.border.val(this.table),this.src.main.rules.val(this.rte.dom.attr(this.table.get(0),"rules")),this.src.main.bg.val(this.table.css("background-color")),c=(this.table.css("background-image")||"").replace(/url\(([^\)]+)\)/i,"$1"),this.src.main.bgimg.val(c!="none"?c:""),y={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{width:530,title:this.rte.i18n("Table")}},f=new elDialogForm(y);for(t in this.src)if(f.tab(t,this.rte.i18n(this.labels[t])),t=="main"){var p=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Rows")+"<\/td>").append(n("<td />").append(this.src.main.rows))).append(n("<tr />").append("<td>"+this.rte.i18n("Columns")+"<\/td>").append(n("<td />").append(this.src.main.cols))),w=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Width")+"<\/td>").append(n("<td />").append(this.src.main.width).append(this.src.main.wunit))).append(n("<tr />").append("<td>"+this.rte.i18n("Height")+"<\/td>").append(n("<td />").append(this.src.main.height).append(this.src.main.hunit))),b=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Spacing")+"<\/td>").append(n("<td />").append(this.src.main.spacing.val(this.table.attr("cellspacing")||"")))).append(n("<tr />").append("<td>"+this.rte.i18n("Padding")+"<\/td>").append(n("<td />").append(this.src.main.padding.val(this.table.attr("cellpadding")||""))));f.append([this.rte.i18n("Caption"),this.src.main.caption.val(this.table.find("caption").eq(0).text()||"")],"main",!0).separator("main").append([p,w,b],"main",!0).separator("main").append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Inner borders"),this.src.main.rules],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Background"),n("<span />").append(n("<span />").css({float:"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0)}else for(i in this.src[t])s=this.rte.dom.attr(this.table,i),t=="events"&&(s=this.rte.utils.trimEventCallback(s)),f.append([this.rte.i18n(this.labels[i]?this.labels[i]:i),this.src[t][i].val(s)],t,!0);f.open()},this.set=function(){var e,o,t,i,s,h,c,u,f,l,a,v,p;if(this.table.parents().length)this.table.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor").removeAttr("cellspacing").removeAttr("cellpadding").removeAttr("frame").removeAttr("rules").removeAttr("style");else{if(e=parseInt(this.src.main.rows.val())||0,o=parseInt(this.src.main.cols.val())||0,e<=0||o<=0)return;for(this.rte.history.add(),t=n(this.rte.doc.createElement("tbody")).appendTo(this.table),i=0;i<e;i++){for(s="<tr>",h=0;h<o;h++)s+="<td>&nbsp;<\/td>";t.append(s+"<\/tr>")}}c=n.trim(this.src.main.caption.val()),c?(this.table.children("caption").length||this.table.prepend("<caption />"),this.table.children("caption").text(c)):this.table.children("caption").remove();for(u in this.src)if(u!="main")for(f in this.src[u])l=n.trim(this.src[u][f].val()),l?this.table.attr(f,l):this.table.removeAttr(f);(a=parseInt(this.src.main.spacing.val()))&&a>=0&&this.table.attr("cellspacing",a),(v=parseInt(this.src.main.padding.val()))&&v>=0&&this.table.attr("cellpadding",v),(p=this.src.main.rules.val())&&this.table.attr("rules",p);var w=parseInt(this.src.main.width.val())||"",b=parseInt(this.src.main.height.val())||"",i=n.trim(this.src.main.bgimg.val()),t=this.src.main.border.val(),r=this.src.main.margin.val(),y=this.src.main.align.val();this.table.css({width:w?w+this.src.main.wunit.val():"",height:b?b+this.src.main.hunit.val():"",border:n.trim(t.width+" "+t.style+" "+t.color),"background-color":this.src.main.bg.val(),"background-image":i?"url("+i+")":""}),r.css?this.table.css("margin",r.css):this.table.css({"margin-top":r.top,"margin-right":r.right,"margin-bottom":r.bottom,"margin-left":r.left}),(y=="left"||y=="right")&&this.table.css("margin-left")!="auto"&&this.table.css("margin-right")!="auto"&&this.table.css("float",y),this.table.attr("style")||this.table.removeAttr("style"),this.table.parents().length||this.rte.selection.insertNode(this.table.get(0),!0),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled"),this.name!="tableprops"||this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/)||this.domElem.addClass("disabled").removeClass("active")}},elRTE.prototype.ui.prototype.buttons.tableprops=elRTE.prototype.ui.prototype.buttons.table}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tablerm=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var t=this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/);t&&(this.rte.history.add(),n(t).remove()),this.rte.ui.update(!0)},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellprops=function(t,i){function u(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language"},r.src={main:{type:n("<select />").css("width","100%").append(n("<option />").val("td").text(r.rte.i18n("Data"))).append(n("<option />").val("th").text(r.rte.i18n("Header"))),width:n('<input type="text" />').attr("size",4),wunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),height:n('<input type="text" />').attr("size",4),hunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),align:n("<select />").css("width","100%").append(n("<option />").val("").text(r.rte.i18n("Not set"))).append(n("<option />").val("left").text(r.rte.i18n("Left"))).append(n("<option />").val("center").text(r.rte.i18n("Center"))).append(n("<option />").val("right").text(r.rte.i18n("Right"))).append(n("<option />").val("justify").text(r.rte.i18n("Justify"))),border:n("<div />"),padding:n("<div />"),bg:n("<div />"),bgimg:n('<input type="text" />').css("width","90%"),apply:n("<select />").css("width","100%").append(n("<option />").val("").text(r.rte.i18n("Current cell"))).append(n("<option />").val("row").text(r.rte.i18n("All cells in row"))).append(n("<option />").val("column").text(r.rte.i18n("All cells in column"))).append(n("<option />").val("table").text(r.rte.i18n("All cells in table")))},adv:{id:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").css("width","100%").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />')},events:{}},n.each(r.src,function(){for(var n in this)this[n].attr("name",n),this[n].attr("type")!="text"||this[n].attr("size")||n=="bgimg"||this[n].css("width","100%")}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />').css("width","100%")})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src=null,this.labels=null,this.command=function(){var s,h,e,c,f,t,i,o;if(this.src||u(),this.cell=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/),this.cell){this.src.main.type.val(this.cell.nodeName.toLowerCase()),this.cell=n(this.cell),this.src.main.border.elBorderSelect({styleHeight:117,value:this.cell}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.padding.elPaddingInput({value:this.cell}),s=this.cell.css("width")||this.cell.attr("width"),this.src.main.width.val(parseInt(s)||""),this.src.main.wunit.val(s.indexOf("px")!=-1?"px":"%"),h=this.cell.css("height")||this.cell.attr("height"),this.src.main.height.val(parseInt(h)||""),this.src.main.hunit.val(h.indexOf("px")!=-1?"px":"%"),this.src.main.align.val(this.cell.attr("align")||this.cell.css("text-align")),this.src.main.bg.val(this.cell.css("background-color")),e=this.cell.css("background-image"),this.src.main.bgimg.val(e&&e!="none"?e.replace(/url\(([^\)]+)\)/i,"$1"):""),this.src.main.apply.val(""),c={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{width:520,title:this.rte.i18n("Table cell properties")}},f=new elDialogForm(c);for(t in this.src)if(f.tab(t,this.rte.i18n(this.labels[t])),t=="main")f.append([this.rte.i18n("Width"),n("<span />").append(this.src.main.width).append(this.src.main.wunit)],"main",!0).append([this.rte.i18n("Height"),n("<span />").append(this.src.main.height).append(this.src.main.hunit)],"main",!0).append([this.rte.i18n("Table cell type"),this.src.main.type],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Paddings"),this.src.main.padding],"main",!0).append([this.rte.i18n("Background"),n("<span />").append(n("<span />").css({float:"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0).append([this.rte.i18n("Apply to"),this.src.main.apply],"main",!0);else for(i in this.src[t])o=this.cell.attr(i)||"",t=="events"&&(o=this.rte.utils.trimEventCallback(o)),f.append([this.rte.i18n(this.labels[i]?this.labels[i]:i),this.src[t][i].val(o)],t,!0);f.open()}},this.set=function(){var t=this.cell,v=this.src.main.apply.val(),f,e,o;switch(this.src.main.apply.val()){case"row":t=this.cell.parent("tr").children("td,th");break;case"column":t=n(this.rte.dom.tableColumn(this.cell.get(0)));break;case"table":t=this.cell.parents("table").find("td,th")}for(f in this.src)if(f!="main")for(e in this.src[f])o=n.trim(this.src[f][e].val()),o?t.attr(e,o):t.removeAttr(e);t.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor");var h=this.src.main.type.val(),c=parseInt(this.src.main.width.val())||"",l=parseInt(this.src.main.height.val())||"",a=n.trim(this.src.main.bgimg.val()),s=this.src.main.border.val(),i={width:c?c+this.src.main.wunit.val():"",height:l?l+this.src.main.hunit.val():"","background-color":this.src.main.bg.val(),"background-image":a?"url("+a+")":"",border:n.trim(s.width+" "+s.style+" "+s.color),"text-align":this.src.main.align.val()||""},u=this.src.main.padding.val();u.css?i.padding=u.css:(i["padding-top"]=u.top,i["padding-right"]=u.right,i["padding-bottom"]=u.bottom,i["padding-left"]=u.left),t=t.get(),n.each(t,function(){var c=this.nodeName.toLowerCase(),t=n(this),f,e,u,o,s;if(c!=h){f={};for(e in r.src.adv)u=t.attr(e),u&&(f[e]=u.toString());for(e in r.src.events)u=t.attr(e),u&&(f[e]=u.toString());o=t.attr("colspan")||1,s=t.attr("rowspan")||1,o>1&&(f.colspan=o),s>1&&(f.rowspan=s),t.replaceWith(n("<"+h+" />").html(t.html()).attr(f).css(i))}else t.css(i)}),this.rte.ui.update()},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellsmerge=function(t,i){function u(){var t=r.rte.dom.selfOrParent(r.rte.selection.getStart(),/^(TD|TH)$/),i=r.rte.dom.selfOrParent(r.rte.selection.getEnd(),/^(TD|TH)$/);return t&&i&&t!=i&&n(t).parents("table").get(0)==n(i).parents("table").get(0)?[t,i]:null}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=u(),w;if(t){var c=this.rte.dom.indexOf(n(t[0]).parent("tr").get(0)),l=this.rte.dom.indexOf(n(t[1]).parent("tr").get(0)),s=Math.min(c,l),h=Math.max(c,l)-s+1,f=this.rte.dom.tableColumn(t[0],!0,!0),e=this.rte.dom.tableColumn(t[1],!0),a=n.inArray(t[0],f.column),v=n.inArray(t[1],e.column),y=f.info.offset[a]<e.info.offset[v]?f:e,p=f.info.offset[a]>=e.info.offset[v]?f:e,o=0,i=null,r="";this.rte.history.add(),w=n(n(t[0]).parents("table").eq(0).find("tr").get().slice(s,s+h)).each(function(t){var f=r.length,u=!1;n(this).children("td,th").each(function(){var f=n(this),h=n.inArray(this,y.column),c=n.inArray(this,p.column),l,s,a,e;h!=-1||c!=-1?(u=h!=-1&&c==-1,l=parseInt(f.attr("colspan")||1),t==0&&(o+=l),h!=-1&&t>0&&(s=y.info.delta[h],s>0&&(f.css("text-align")=="left"?(e=f.clone(!0),f.html("&nbsp;")):e=f.clone().html("&nbsp;"),e.removeAttr("colspan").removeAttr("id").insertBefore(this),s>1&&e.attr("colspan",s))),c!=-1&&(s=p.info.delta[c],l-s>1&&(a=l-s-1,f.css("text-align")=="right"?(e=f.clone(!0),f.html("&nbsp;")):e=f.clone().html("&nbsp;"),e.removeAttr("colspan").removeAttr("id").insertAfter(this),a>1&&e.attr("colspan",a))),i?(r+=f.html(),f.remove()):i=f):u&&(t==0&&(o+=parseInt(f.attr("colspan")||1)),r+=f.html(),f.remove())}),r+=f!=r.length?"<br />":""}),i.removeAttr("colspan").removeAttr("rowspan").html(i.html()+r),o>1&&i.attr("colspan",o),h>1&&i.attr("rowspan",h),this.rte.dom.fixTable(n(t[0]).parents("table").get(0))}},this.update=function(){u()?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellsplit=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/),o,s,r,f,t;if(i&&(this.rte.history.add(),o=parseInt(this.rte.dom.attr(i,"colspan")),s=parseInt(this.rte.dom.attr(i,"rowspan")),o>1||s>1)){var h=o-1,c=s-1,l=this.rte.dom.parent(i,/^TABLE$/),u=this.rte.dom.tableMatrix(l);if(h)for(t=0;t<h;t++)n(this.rte.dom.create(i.nodeName)).html("&nbsp;").insertAfter(i);if(c){var a=this.rte.dom.indexesOfCell(i,u),v=a[0],e=a[1];for(r=v+1;r<v+c+1;r++)if(!u[r][e].nodeName){if(u[r][e-1].nodeName)f=u[r][e-1];else for(t=e-1;t>=0;t--)if(u[r][t].nodeName){f=u[r][t];break}if(f)for(t=0;t<=h;t++)n(this.rte.dom.create(f.nodeName)).html("&nbsp;").insertAfter(f)}}n(i).removeAttr("colspan").removeAttr("rowspan"),this.rte.dom.fixTable(l)}this.rte.ui.update(!0)},this.update=function(){var n=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);n&&(parseInt(this.rte.dom.attr(n,"colspan"))>1||parseInt(this.rte.dom.attr(n,"rowspan"))>1)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcolbefore=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this,i=this.rte.dom.tableColumn(this.rte.selection.getNode(),!1,!0);i.length&&(this.rte.history.add(),n.each(i,function(){var r=n(this),u=parseInt(r.attr("colspan")||1),i;u>1?r.attr("colspan",u+1):(i=n(t.rte.dom.create(this.nodeName)).html("&nbsp;"),t.name=="tbcolbefore"?i.insertBefore(this):i.insertAfter(this))}),this.rte.ui.update())},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbcolafter=elRTE.prototype.ui.prototype.buttons.tbcolbefore}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcolrm=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),r=this.rte.dom.selfOrParent(t,/^(TD|TH)$/),i=n(r).prev("td,th").get(0),u=n(r).next("td,th").get(0),e=this.rte.dom.parent(t,/^TABLE$/),f=this.rte.dom.tableColumn(t,!1,!0);f.length&&(this.rte.history.add(),n.each(f,function(){var t=n(this),i=parseInt(t.attr("colspan")||1);i>1?t.attr("colspan",i-1):t.remove()}),this.rte.dom.fixTable(e),(i||u)&&this.rte.selection.selectContents(i?i:u).collapse(!0),this.rte.ui.update(!0))},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),elRTE.prototype.ui.prototype.buttons.tbrowbefore=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){var l=this.rte.selection.getNode(),e=this.rte.dom.selfOrParent(l,/^(TD|TH)$/),u=this.rte.dom.selfOrParent(e,/^TR$/),t=this.rte.dom.tableMatrix(this.rte.dom.selfOrParent(e,/^TABLE$/)),i,h,f,n;if(e&&u&&t){this.rte.history.add();var c=this.name=="tbrowbefore",r=$(u).prevAll("tr").length,o=0,s=[];function a(n,i){while(i>0)if(i--,t[i]&&t[i][n]&&t[i][n].nodeName)return t[i][n]}for(n=0;n<t[r].length;n++)t[r][n]&&t[r][n].nodeName?(i=$(t[r][n]),h=parseInt(i.attr("colspan")||1),parseInt(i.attr("rowspan")||1)>1?c?o+=h:s.push(i):o+=h):t[r][n]=="-"&&(i=a(n,r),i&&s.push($(i)));for(f=$(this.rte.dom.create("tr")),n=0;n<o;n++)f.append("<td>&nbsp;<\/td>");c?f.insertBefore(u):f.insertAfter(u),$.each(s,function(){$(this).attr("rowspan",parseInt($(this).attr("rowspan")||1)+1)}),this.rte.ui.update()}},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbrowafter=elRTE.prototype.ui.prototype.buttons.tbrowbefore,function(n){elRTE.prototype.ui.prototype.buttons.tbrowrm=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var l=this.rte.selection.getNode(),f=this.rte.dom.selfOrParent(l,/^(TD|TH)$/),e=this.rte.dom.selfOrParent(f,/^TR$/),c=this.rte.dom.selfOrParent(f,/^TABLE$/),t=this.rte.dom.tableMatrix(c),a,i,r,u,o,s,h;if(f&&e&&t.length){if(this.rte.history.add(),t.length==1)return n(c).remove(),this.rte.ui.update();a=[],i=n(e).prevAll("tr").length;function v(n,i){while(i>0)if(i--,t[i]&&t[i][n]&&t[i][n].nodeName)return t[i][n]}function p(r,u){var o,f;if(y=i+1,o=null,t[y]){for(f=0;f<u;f++)t[y][f]&&t[y][f].nodeName&&(o=t[y][f]);r=r.remove(),o?r.insertAfter(o):r.prependTo(n(e).next("tr").eq(0))}}function w(n){for(var t=0;t<n.length;t++)if(n[t]==f)return t<n.length-1?n[t+1]:n[t-1]}for(r=0;r<t[i].length;r++)u=null,o=!1,t[i][r]&&t[i][r].nodeName?(u=t[i][r],o=!0):t[i][r]=="-"&&(u=v(r,i))&&(o=!1),u&&(u=n(u),s=parseInt(u.attr("rowspan")||1),s>1&&(u.attr("rowspan",s-1),o&&p(u,r,i)));h=w(this.rte.dom.tableColumn(f)),h&&this.rte.selection.selectContents(h).collapse(!0),n(e).remove()}this.rte.ui.update()},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.undo=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){this.name=="undo"&&this.rte.history.canBack()?(this.rte.history.back(),this.rte.ui.update()):this.name=="redo"&&this.rte.history.canFwd()&&(this.rte.history.fwd(),this.rte.ui.update())},this.update=function(){this.domElem.toggleClass("disabled",this.name=="undo"?!this.rte.history.canBack():!this.rte.history.canFwd())}},elRTE.prototype.ui.prototype.buttons.redo=elRTE.prototype.ui.prototype.buttons.undo}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.unlink=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){function u(n){return n.nodeName=="A"&&n.href}var f=this.rte.selection.getNode(),i=this.rte.dom.selfOrParentLink(f),t,r;if(!i&&(t=n.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1}),t.length)){for(r=0;r<t.length;r++)if(u(t[r])){i=t[r];break}i||(i=this.rte.dom.parent(t[0],u)||this.rte.dom.parent(t[t.length-1],u))}i&&(this.rte.history.add(),this.rte.selection.select(i),this.rte.doc.execCommand("unlink",!1,null),this.rte.ui.update(!0))},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(n){return n.nodeName=="A"&&n.href})?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active")}}}(jQuery),eli18n.prototype=new function(){this.messages={},this._domain="",this.load=function(n){var t,i,r;if(typeof n=="object")for(t in n)if(i=n[t],typeof i=="object"){this.messages[t]||(this.messages[t]={});for(r in i)typeof i[r]=="string"&&(this.messages[t][r]=i[r])}return this},this.translate=function(n,t){var t=t&&this.messages[t]?t:this._domain;return this.messages[t]&&this.messages[t][n]?this.messages[t][n]:n},this.format=function(n,t,i){if(n=this.translate(n,i),typeof t=="object")for(var r in t)n=n.replace("%"+r,this.translate(t[r],i));return n}},function(n){n.fn.elColorPicker=function(t){function u(n){i.val(n),r.change&&r.change(i.val()),i.palette.slideUp()}function f(){i.palette=n("<div />").addClass(r.paletteClass+" rounded-3");for(var t=0;t<r.colors.length;t++)n("<div />").addClass("color").css("background-color",r.colors[t]).attr({title:r.colors[t],unselectable:"on"}).appendTo(i.palette).mouseenter(function(){var t=n(this).attr("title");i.input.val(t),i.preview.css("background-color",t)}).click(function(t){t.stopPropagation(),u(n(this).attr("title"))});i.input=n('<input type="text" />').addClass("rounded-3").attr("size",8).click(function(t){t.stopPropagation(),n(this).focus()}).keydown(function(t){var r,f;return t.ctrlKey||t.metaKey?!0:(r=t.keyCode,r==27)?i.mouseleave():r!=8&&r!=13&&r!=46&&r!=37&&r!=39&&(r<48||r>57)&&(r<65||r>70)?!1:(f=n(this).val(),(f.length==7||f.length==0)&&(r==13&&(t.stopPropagation(),t.preventDefault(),u(f),i.palette.slideUp()),t.keyCode!=8&&t.keyCode!=46&&r!=37&&r!=39)?!1:void 0)}).keyup(function(){var t=n(this).val();t.length==7&&/^#[0-9abcdef]{6}$/i.test(t)&&i.val(t)}),i.preview=n("<div />").addClass("preview rounded-3").click(function(n){n.stopPropagation(),u(i.input.val())}),i.palette.append(n("<div />").addClass("clearfix")).append(n("<div />").addClass("panel").append(i.input).append(i.preview)),r.palettePosition=="outer"?(i.palette.hide().appendTo(i.parents("body").eq(0)).mouseleave(function(){i.palette.is(":animated")||(n(this).slideUp(),i.val(i.val()))}),i.mouseleave(function(n){n.relatedTarget!=i.palette.get(0)&&(i.palette.is(":animated")||(i.palette.slideUp(),i.val(i.val())))})):i.append(i.palette.hide()).mouseleave(function(){i.palette.slideUp(),i.val(i.val())}),i.val(i.val())}var i=this,r=n.extend({},n.fn.elColorPicker.defaults,t);return this.hidden=n('<input type="hidden" />').attr("name",r.name).val(r.color||"").appendTo(this),this.palette=null,this.preview=null,this.input=null,this.empty().addClass(r["class"]+" rounded-3").css({position:"relative","background-color":r.color||""}).click(function(){if(!i.hasClass("disabled")){if(i.palette||f(),r.palettePosition=="outer"&&i.palette.css("display")=="none"){var t=n(this).offset(),u=i.palette.width(),e=i.parents("body").width()-t.left>=u?t.left:t.left+n(this).outerWidth()-u;i.palette.css({left:e+"px",top:t.top+n(this).height()+1+"px"})}i.palette.slideToggle()}}),this.val=function(n){if(n||n==="")this.hidden.val(n),r.update?r.update(this.hidden.val()):this.css("background-color",n),i.palette&&(i.preview.css("background-color",n),i.input.val(n));else return this.hidden.val();return this},this},n.fn.elColorPicker.defaults={"class":"el-colorpicker",paletteClass:"el-palette",palettePosition:"inner",name:"color",color:"",update:null,change:function(){},colors:["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ffcccc","#cc9999","#996666","#663333","#330000","#ff9999","#cc6666","#cc3333","#993333","#660000","#ff6666","#ff3333","#ff0000","#cc0000","#990000","#ff9966","#ff6633","#ff3300","#cc3300","#993300","#ffcc99","#cc9966","#cc6633","#996633","#663300","#ff9933","#ff6600","#ff9900","#cc6600","#cc9933","#ffcc66","#ffcc33","#ffcc00","#cc9900","#996600","#ffffcc","#cccc99","#999966","#666633","#333300","#ffff99","#cccc66","#cccc33","#999933","#666600","#ffff66","#ffff33","#ffff00","#cccc00","#999900","#ccff66","#ccff33","#ccff00","#99cc00","#669900","#ccff99","#99cc66","#99cc33","#669933","#336600","#99ff33","#99ff00","#66ff00","#66cc00","#66cc33","#99ff66","#66ff33","#33ff00","#33cc00","#339900","#ccffcc","#99cc99","#669966","#336633","#003300","#99ff99","#66cc66","#33cc33","#339933","#006600","#66ff66","#33ff33","#00ff00","#00cc00","#009900","#66ff99","#33ff66","#00ff33","#00cc33","#009933","#99ffcc","#66cc99","#33cc66","#339966","#006633","#33ff99","#00ff66","#00ff99","#00cc66","#33cc99","#66ffcc","#33ffcc","#00ffcc","#00cc99","#009966","#ccffff","#99cccc","#669999","#336666","#003333","#99ffff","#66cccc","#33cccc","#339999","#006666","#66cccc","#33ffff","#00ffff","#00cccc","#009999","#66ccff","#33ccff","#00ccff","#0099cc","#006699","#99ccff","#6699cc","#3399cc","#336699","#003366","#3399ff","#0099ff","#0066ff","#066ccc","#3366cc","#6699ff","#3366ff","#0033ff","#0033cc","#003399","#ccccff","#9999cc","#666699","#333366","#000033","#9999ff","#6666cc","#3333cc","#333399","#000066","#6666ff","#3333ff","#0000ff","#0000cc","#009999","#9966ff","#6633ff","#3300ff","#3300cc","#330099","#cc99ff","#9966cc","#6633cc","#663399","#330066","#9933ff","#6600ff","#9900ff","#6600cc","#9933cc","#cc66ff","#cc33ff","#cc00ff","#9900cc","#660099","#ffccff","#cc99cc","#996699","#663366","#330033","#ff99ff","#cc66cc","#cc33cc","#993399","#660066","#ff66ff","#ff33ff","#ff00ff","#cc00cc","#990099","#ff66cc","#ff33cc","#ff00cc","#cc0099","#990066","#ff99cc","#cc6699","#cc3399","#993366","#660033","#ff3399","#ff0099","#ff0066","#cc0066","#cc3366","#ff6699","#ff3366","#ff0033","#cc0033","#990033"]}}(jQuery),function(n){n.fn.elBorderSelect=function(t){function s(n){function i(n){return hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n?hexDigits[(n-n%16)/16]+hexDigits[n%16]:"00"}var t=(n||"").match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/);return t?"#"+i(t[1])+i(t[2])+i(t[3]):""}function h(t){var i,r;if(!t)return t;if(i=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/),i&&(t=i[1],unit=i[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t),isNaN(t))return"";r=parseInt(n(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*r);case"pt":return parseInt(t*r/12);case"%":return parseInt(t*r/100)}return t}var r=this,o=this.eq(0),i=n.extend({},n.fn.elBorderSelect.defaults,t),u=n('<input type="text" />').attr({name:i.name+"[width]",size:3}).css("text-align","right").change(function(){r.change()}),f=n("<div />").css("position","relative").elColorPicker({"class":"el-colorpicker ui-icon ui-icon-pencil",name:i.name+"[color]",palettePosition:"outer",change:function(){r.change()}}),e=n("<div />").elSelect({tpl:'<div style="border-bottom:4px %val #000;width:100%;margin:7px 0"> <\/div>',tpls:{"":"%label"},maxHeight:i.styleHeight||null,select:function(){r.change()},src:{"":"none",solid:"solid",dashed:"dashed",dotted:"dotted",double:"double",groove:"groove",ridge:"ridge",inset:"inset",outset:"outset"}});return o.empty().addClass(i["class"]).attr("name",i.name||"").append(n("<table />").attr("cellspacing",0).append(n("<tr />").append(n("<td />").append(u).append(" px")).append(n("<td />").append(e)).append(n("<td />").append(f)))),this.change=function(){i.change&&i.change(this.val())},this.val=function(t){var i,o,r,c,l;return t||t===""?(c="",t.nodeName||t.css?(t.css||(t=n(t)),c=t.css("border"),(c=t.css("border"))?i=o=r=c:(i=t.css("border-width"),o=t.css("border-style"),r=t.css("border-color"))):(i=t.width||"",o=t.style||"",r=t.color||""),u.val(h(i)),l=o?o.match(/(solid|dashed|dotted|double|groove|ridge|inset|outset)/i):"",e.val(l?l[1]:""),f.val(r.indexOf("#")===0?r:s(r)),this):(i=parseInt(u.val()),i=isNaN(i)?"":i+"px",o=e.val(),r=f.val(),{width:i,style:o,color:r,css:n.trim(i+" "+o+" "+r)})},this.val(i.value),this},n.fn.elBorderSelect.defaults={name:"el-borderselect","class":"el-borderselect",value:{},change:null}}(jQuery),function(t){t.fn.elPaddingInput=function(i){function f(i){return i=t.trim(i.toString()),i[0]=="."&&(i="0"+i),n=parseFloat(i),isNaN(n)?i=="auto"?i:"":n}function e(){r.change&&r.change(u)}var u=this,r=t.extend({},t.fn.elPaddingInput.defaults,{name:this.attr("name")},i);return this.regexps={main:new RegExp(r.type=="padding"?'paddings*:s*([^;"]+)':'margins*:s*([^;"]+)',"im"),left:new RegExp(r.type=="padding"?'padding-lefts*:s*([^;"]+)':'margin-lefts*:s*([^;"]+)',"im"),top:new RegExp(r.type=="padding"?'padding-tops*:s*([^;"]+)':'margin-tops*:s*([^;"]+)',"im"),right:new RegExp(r.type=="padding"?'padding-rights*:s*([^;"]+)':'margin-rights*:s*([^;"]+)',"im"),bottom:new RegExp(r.type=="padding"?'padding-bottoms*:s*([^;"]+)':'margin-bottoms*:s*([^;"]+)',"im")},t.each(["left","top","right","bottom"],function(){u[this]=t('<input type="text" />').attr("size",3).css("text-align","right").css("border-"+this,"2px solid red").bind("change",function(){t(this).val(f(t(this).val())),e()}).attr("name",r.name+"["+this+"]")}),t.each(["uleft","utop","uright","ubottom"],function(){u[this]=t("<select />").append('<option value="px">px<\/option>').append('<option value="em">em<\/option>').append('<option value="pt">pt<\/option>').bind("change",function(){e()}).attr("name",r.name+"["+this+"]"),r.percents&&u[this].append('<option value="%">%<\/option>')}),this.empty().addClass(r["class"]).append(this.left).append(this.uleft).append(" x ").append(this.top).append(this.utop).append(" x ").append(this.right).append(this.uright).append(" x ").append(this.bottom).append(this.ubottom),this.val=function(n){var e,o,s,r,n;if(n||n==="")return(n.nodeName||n.css)&&(n.css||(n=t(n)),e={left:"",top:"",right:"",bottom:""},o=(n.attr("style")||"").toLowerCase(),o&&(o=t.trim(o),s=o.match(this.regexps.main),s?(r=t.trim(s[1]).replace(/\s+/g," ").split(" ",4),e.top=r[0],e.right=r[1]&&r[1]!==""?r[1]:e.top,e.bottom=r[2]&&r[2]!==""?r[2]:e.top,e.left=r[3]&&r[3]!==""?r[3]:e.right):t.each(["left","top","right","bottom"],function(){var n=this.toString();s=o.match(u.regexps[n]),s&&(e[n]=s[1])})),n=e),t.each(["left","top","right","bottom"],function(){var t=this.toString(),r,i;u[t].val(""),u["u"+t].val(),typeof n[t]!="undefined"&&n[t]!==null&&(n[t]=n[t].toString(),r=f(n[t]),u[t].val(r),i=n[t].match(/(px|em|pt|%)/i),u["u"+t].val(i?i[1]:"px"))}),this;var h=f(this.left.val()),c=f(this.top.val()),l=f(this.right.val()),a=f(this.bottom.val()),i={left:h=="auto"||h==0?h:h!==""?h+this.uleft.val():"",top:c=="auto"||c==0?c:c!==""?c+this.utop.val():"",right:l=="auto"||l==0?l:l!==""?l+this.uright.val():"",bottom:a=="auto"||a==0?a:a!==""?a+this.ubottom.val():"",css:""};return i.left!==""&&i.right!==""&&i.top!==""&&i.bottom!==""&&(i.css=i.left==i.right&&i.top==i.bottom?i.top+" "+i.left:i.top+" "+i.right+" "+i.bottom+" "+i.left),i},this.val(r.value),this},t.fn.elPaddingInput.defaults={name:"el-paddinginput","class":"el-paddinginput",type:"padding",value:{},percents:!0,change:null}}(jQuery),function(n){n.fn.elSelect=function(t){function l(n){var t=i.labelTpl||i.tpls[n]||i.tpl;s.html(t.replace(/%val/g,n).replace(/%label/,i.src[n])).children().attr({unselectable:"on"})}function a(){var t,s,f,h;r=n("<div />").addClass(i.listClass+" rounded-3").hide().appendTo(u.mouseleave(function(){r.slideUp()}));for(t in i.src)s=i.tpls[t]||i.tpl,n("<div />").attr("name",t).append(n(s.replace(/%val/g,t).replace(/%label/g,i.src[t])).attr({unselectable:"on"})).appendTo(r).hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault();var u=n(this).attr("name");o.val(u),i.select(u),r.slideUp()});f=u.outerWidth(),r.width()<f&&r.width(f),h=r.height(),i.maxHeight>0&&h>i.maxHeight&&r.height(i.maxHeight),o.val(e.val())}var o=this,u=this.eq(0),i=n.extend({},n.fn.elSelect.defaults,t),e=n('<input type="hidden" />').attr("name",i.name),s=n("<label />").attr({unselectable:"on"}).addClass("rounded-left-3"),r=null,f=null,h,c;if(u.get(0).nodeName=="SELECT"&&(i.src={},u.children("option").each(function(){i.src[n(this).val()]=n(this).text()}),i.value=u.val(),i.name=u.attr("name"),u.replaceWith(u=n("<div />"))),!i.value||!i.src[i.val]){i.value=null,h=0;for(c in i.src)h++==0&&(i.value=c)}return this.val=function(t){return t||t===""?(i.src[t]&&(e.val(t),l(t),r&&r.children().each(function(){n(this).attr("name")==t?n(this).addClass("active"):n(this).removeClass("active")})),this):e.val()},u.empty().addClass(i["class"]+" rounded-3").attr({unselectable:"on"}).append(e).append(s).hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(){r||a(),r.slideToggle(),n.browser.msie&&!f&&(r.children().each(function(){f=Math.max(f,n(this).width())}),f>r.width()&&r.width(f+40))}),this.val(i.value),this},n.fn.elSelect.defaults={name:"el-select","class":"el-select",listClass:"list",labelTpl:null,tpl:"<%val>%label<\/%val>",tpls:{},value:null,src:{},select:function(n){window.console&&window.console.log&&window.console.log("selected: "+n)},maxHeight:410}}(jQuery),function(n){elRTE=function(t,i){var r,f,u,e,o;if(!t||!t.nodeName)return alert('elRTE: argument "target" is not DOM Element');if(r=this,this.version="1.3",this.build="2011-06-23",this.options=n.extend(!0,{},this.options,i),this.browser=n.browser,this.target=n(t),this.lang=""+this.options.lang,this._i18n=new eli18n({textdomain:"rte",messages:{rte:this.i18Messages[this.lang]||{}}}),this.rtl=!!(/^(ar|fa|he)$/.test(this.lang)&&this.i18Messages[this.lang]),this.rtl&&(this.options.cssClass+=" el-rte-rtl"),this.toolbar=n('<div class="toolbar"/>'),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("frameborder",0),this.workzone=n('<div class="workzone"/>').append(this.iframe).append(this.source),this.statusbar=n('<div class="statusbar"/>'),this.tabsbar=n('<div class="tabsbar"/>'),this.editor=n('<div class="'+this.options.cssClass+'" />').append(this.toolbar).append(this.workzone).append(this.statusbar).append(this.tabsbar),this.doc=null,this.$doc=null,this.window=null,this.utils=new this.utils(this),this.dom=new this.dom(this),this.filter=new this.filter(this),this.updateHeight=function(){r.workzone.add(r.iframe).add(r.source).height(r.workzone.height())},this.resizable=function(t){var i=this;this.options.resizable&&n.fn.resizable&&(t?this.editor.resizable({handles:"se",alsoResize:this.workzone,minWidth:300,minHeight:200}).bind("resize",i.updateHeight):this.editor.resizable("destroy").unbind("resize",i.updateHeight))},this.editor.insertAfter(t),u="",t.nodeName=="TEXTAREA"?(this.source=this.target,this.source.insertAfter(this.iframe).hide(),u=this.target.val()):(this.source=n("<textarea />").insertAfter(this.iframe).hide(),u=this.target.hide().html()),this.source.attr("name",this.target.attr("name")||this.target.attr("id")),u=n.trim(u),u||(u=" "),this.options.allowSource&&this.tabsbar.append('<div class="tab editor rounded-bottom-7 active">'+r.i18n("Editor")+'<\/div><div class="tab source rounded-bottom-7">'+r.i18n("Source")+'<\/div><div class="clearfix" style="clear:both"/>').children(".tab").click(function(){n(this).hasClass("active")||(r.tabsbar.children(".tab").toggleClass("active"),r.workzone.children().toggle(),n(this).hasClass("editor")?(r.updateEditor(),r.window.focus(),r.ui.update(!0)):(r.updateSource(),r.source.focus(),n.browser.msie||r.source[0].setSelectionRange(0,0),r.ui.disable(),r.statusbar.empty()))}),this.window=this.iframe.contentWindow,this.doc=this.iframe.contentWindow.document,this.$doc=n(this.doc),f='<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',n.each(r.options.cssfiles,function(){f+='<link rel="stylesheet" type="text/css" href="'+this+'" />'}),this.doc.open(),e=this.filter.wysiwyg(u),o=this.rtl?' class="el-rte-rtl"':"",this.doc.write(r.options.doctype+f+"<\/head><body"+o+">"+e+"<\/body><\/html>"),this.doc.close(),n.browser.msie)this.doc.body.contentEditable=!0;else{try{this.doc.designMode="on"}catch(s){}this.doc.execCommand("styleWithCSS",!1,this.options.styleWithCSS)}this.options.height>0&&this.workzone.height(this.options.height),this.options.width>0&&this.editor.width(this.options.width),this.updateHeight(),this.resizable(!0),this.window.focus(),this.history=new this.history(this),this.selection=new this.selection(this),this.ui=new this.ui(this),this.target.parents("form").bind("submit.elfinder",function(){r.source.parents("form").find('[name="el-select"]').remove(),r.beforeSave()}),this.source.bind("keydown",function(t){var r,i,u;t.keyCode==9&&(t.preventDefault(),n.browser.msie?(r=document.selection.createRange(),r.text="\t"+r.text,this.focus()):(i=this.value.substr(0,this.selectionStart),u=this.value.substr(this.selectionEnd),this.value=i+"\t"+u,this.setSelectionRange(i.length+1,i.length+1)))}),n(this.doc.body).bind("dragend",function(){setTimeout(function(){try{r.window.focus();var n=r.selection.getBookmark();r.selection.moveToBookmark(n),r.ui.update()}catch(t){}},200)}),this.typing=!1,this.lastKey=null,this.$doc.bind("mouseup",function(){r.typing=!1,r.lastKey=null,r.ui.update()}).bind("keyup",function(n){(n.keyCode>=8&&n.keyCode<=13||n.keyCode>=32&&n.keyCode<=40||n.keyCode==46||n.keyCode>=96&&n.keyCode<=111)&&r.ui.update()}).bind("keydown",function(t){if((t.metaKey||t.ctrlKey)&&t.keyCode==65)r.ui.update();else if(t.keyCode==13){var i=r.selection.getNode();if(r.dom.selfOrParent(i,/^PRE$/))return r.selection.insertNode(r.doc.createTextNode("\r\n")),!1;if(n.browser.safari&&t.shiftKey)return r.selection.insertNode(r.doc.createElement("br")),!1}return t.keyCode>=48&&t.keyCode<=57||t.keyCode==61||t.keyCode==109||t.keyCode>=65&&t.keyCode<=90||t.keyCode==188||t.keyCode==190||t.keyCode==191||t.keyCode>=219&&t.keyCode<=222?(r.typing||r.history.add(!0),r.typing=!0,r.lastKey=null):(t.keyCode==8||t.keyCode==46||t.keyCode==32||t.keyCode==13)&&(t.keyCode!=r.lastKey&&r.history.add(!0),r.lastKey=t.keyCode,r.typing=!1),t.keyCode==32&&n.browser.opera?(r.selection.insertNode(r.doc.createTextNode(" ")),!1):void 0}).bind("paste",function(t){if(r.options.allowPaste){var i=n(r.dom.create("div"))[0],u=r.doc.createTextNode("_");r.history.add(!0),r.typing=!0,r.lastKey=null,i.appendChild(u),r.selection.deleteContents().insertNode(i),r.selection.select(u),setTimeout(function(){i.parentNode?(n(i).html(r.filter.proccess("paste",n(i).html())),u=i.lastChild,r.dom.unwrap(i),u&&(r.selection.select(u),r.selection.collapse(!1))):(i.parentNode&&i.parentNode.removeChild(i),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(n(r.doc.body).html()))),r.selection.select(r.doc.body.firstChild),r.selection.collapse(!0)),n(r.doc.body).mouseup()},15)}else t.stopPropagation(),t.preventDefault()}),n.browser.msie&&this.$doc.bind("keyup",function(t){t.keyCode==86&&(t.metaKey||t.ctrlKey)&&(r.history.add(!0),r.typing=!0,r.lastKey=null,r.selection.saveIERange(),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(n(r.doc.body).html()))),r.selection.restoreIERange(),n(r.doc.body).mouseup(),this.ui.update())}),n.browser.safari&&this.$doc.bind("click",function(t){n(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl"),t.target.nodeName=="IMG"&&n(t.target).addClass("elrte-webkit-hl")}).bind("keyup",function(){n(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl")}),this.window.focus(),this.destroy=function(){this.updateSource(),this.target.is("textarea")?this.target.val(n.trim(this.source.val())):this.target.html(n.trim(this.source.val())),this.editor.remove(),this.target.show().parents("form").unbind("submit.elfinder")}},elRTE.prototype.i18n=function(n){return this._i18n.translate(n)},elRTE.prototype.open=function(){this.editor.show()},elRTE.prototype.close=function(){this.editor.hide()},elRTE.prototype.updateEditor=function(){this.val(this.source.val())},elRTE.prototype.updateSource=function(){this.source.val(this.filter.source(n(this.doc.body).html()))},elRTE.prototype.val=function(t){if(typeof t=="string")t=""+t,this.source.is(":visible")?this.source.val(this.filter.source2source(t)):n.browser.msie?(this.doc.body.innerHTML="<br />"+this.filter.wysiwyg(t),this.doc.body.removeChild(this.doc.body.firstChild)):this.doc.body.innerHTML=this.filter.wysiwyg(t);else return this.source.is(":visible")?this.filter.source2source(this.source.val()).trim():this.filter.source(n(this.doc.body).html()).trim()},elRTE.prototype.beforeSave=function(){this.source.val(n.trim(this.val())||"")},elRTE.prototype.save=function(){this.beforeSave(),this.editor.parents("form").submit()},elRTE.prototype.log=function(n){window.console&&window.console.log&&window.console.log(n)},elRTE.prototype.i18Messages={},n.fn.elrte=function(n,t){var r=typeof n=="string"?n:"",i;return(this.each(function(){this.elrte||(this.elrte=new elRTE(this,typeof n=="object"?n:{}));switch(r){case"open":case"show":this.elrte.open();break;case"close":case"hide":this.elrte.close();break;case"updateSource":this.elrte.updateSource();break;case"destroy":this.elrte.destroy()}}),r=="val")?this.length?this.length==1?t?this[0].elrte.val(t):this[0].elrte.val():(i={},this.each(function(){i[this.elrte.source.attr("name")]=this.elrte.val()}),i):"":this}}(jQuery),function(n){elRTE.prototype.dom=function(t){this.rte=t;var r=this;this.regExp={textNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TD|TH|TT|VAR)$/,textContainsNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DL|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|OL|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|TT|UL|VAR)$/,block:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|UL)$/,selectionBlock:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TD|TH|TR|UL)$/,header:/^H[1-6]$/,formElement:/^(FORM|INPUT|HIDDEN|TEXTAREA|SELECT|BUTTON)$/},this.root=function(){return this.rte.body},this.create=function(n){return this.rte.doc.createElement(n)},this.createBookmark=function(){var t=this.rte.doc.createElement("span");return t.id="elrte-bm-"+Math.random().toString().substr(2),n(t).addClass("elrtebm elrte-protected"),t},this.indexOf=function(t){var i=0;for(t=n(t);(t=t.prev())&&t.length;)i++;return i},this.attr=function(t,i){var r="";return t.nodeType==1&&(r=n(t).attr(i),r&&i!="src"&&i!="href"&&i!="title"&&i!="alt"&&(r=r.toString().toLowerCase())),r||""},this.findCommonAncestor=function(t,i){var r;if(!t||!i)return this.rte.log("dom.findCommonAncestor invalid arguments");if(t==i)return t;if(t.nodeName=="BODY"||i.nodeName=="BODY")return this.rte.doc.body;var u=n(t).parents(),f=n(i).parents(),e=f.length-1,o=f[e];for(r=u.length-1;r>=0;r--,e--)if(u[r]==f[e])o=u[r];else break;return o},this.isEmpty=function(t){return t.nodeType==1?this.regExp.textNodes.test(t.nodeName)?n.trim(n(t).text()).length==0:!1:t.nodeType==3?/^(TABLE|THEAD|TFOOT|TBODY|TR|UL|OL|DL)$/.test(t.parentNode.nodeName)||t.nodeValue==""||n.trim(t.nodeValue).length==0&&!(t.nextSibling&&t.previousSibling&&t.nextSibling.nodeType==1&&t.previousSibling.nodeType==1&&!this.regExp.block.test(t.nextSibling.nodeName)&&!this.regExp.block.test(t.previousSibling.nodeName)):!0},this.next=function(n){while(n.nextSibling&&(n=n.nextSibling))if(n.nodeType==1||n.nodeType==3&&!this.isEmpty(n))return n;return null},this.prev=function(n){while(n.previousSibling&&(n=n.previousSibling))if(n.nodeType==1||n.nodeType==3&&!this.isEmpty(n))return n;return null},this.isPrev=function(n,t){while(n=this.prev(n))if(n==t)return!0;return!1},this.nextAll=function(n){for(var t=[];n=this.next(n);)t.push(n);return t},this.prevAll=function(n){for(var t=[];n=this.prev(n);)t.push(n);return t},this.toLineEnd=function(n){for(var t=[];(n=this.next(n))&&n.nodeName!="BR"&&n.nodeName!="HR"&&this.isInline(n);)t.push(n);return t},this.toLineStart=function(n){for(var t=[];(n=this.prev(n))&&n.nodeName!="BR"&&n.nodeName!="HR"&&this.isInline(n);)t.unshift(n);return t},this.isFirstNotEmpty=function(t){while(t=this.prev(t))if(t.nodeType==1||t.nodeType==3&&n.trim(t.nodeValue)!="")return!1;return!0},this.isLastNotEmpty=function(n){while(n=this.next(n))if(!this.isEmpty(n))return!1;return!0},this.isOnlyNotEmpty=function(n){return this.isFirstNotEmpty(n)&&this.isLastNotEmpty(n)},this.findLastNotEmpty=function(n){if(this.rte.log("findLastNotEmpty Who is here 0_o"),n.nodeType==1&&(l=n.lastChild)){if(!this.isEmpty(l))return l;while(l.previousSibling&&(l=l.previousSibling))if(!this.isEmpty(l))return l}return!1},this.isInline=function(t){if(t.nodeType==3)return!0;if(t.nodeType==1){t=n(t);var i=t.css("display"),r=t.css("float");return i=="inline"||i=="inline-block"||r=="left"||r=="right"}return!0},this.is=function(n,t){if(n&&n.nodeName){if(typeof t=="string"&&(t=this.regExp[t]||/.?/),t instanceof RegExp&&n.nodeName)return t.test(n.nodeName);if(typeof t=="function")return t(n)}return!1},this.filter=function(n,t){var r=[],i;if(!n.push)return this.is(n,t)?n:null;for(i=0;i<n.length;i++)this.is(n[i],t)&&r.push(n[i]);return r},this.parents=function(n,t){for(var i=[];n&&(n=n.parentNode)&&n.nodeName!="BODY"&&n.nodeName!="HTML";)this.is(n,t)&&i.push(n);return i},this.parent=function(n,t){return this.parents(n,t)[0]||null},this.selfOrParent=function(n,t,i){return this.is(n,t)?n:this.parent(n,i||t)},this.selfOrParentLink=function(n){return n=this.selfOrParent(n,/^A$/),n&&n.href?n:null},this.selfOrParentAnchor=function(n){return n=this.selfOrParent(n,/^A$/),n&&!n.href&&n.name?n:null},this.childLinks=function(t){var i=[];return n("a[href]",t).each(function(){i.push(this)}),i},this.selectionHas=function(n){var t=this.rte.selection.cloneContents(),i;if(t&&t.childNodes&&t.childNodes.length)for(i=0;i<t.childNodes.length;i++)if(typeof n=="function"){if(n(t.childNodes[i]))return!0}else if(t instanceof RegExp&&n.test(t.childNodes[i].nodeName))return!0;return!1},this.wrap=function(t,i){return t=n.isArray(t)?t:[t],i=i.nodeName?i:this.create(i),t[0]&&t[0].nodeType&&t[0].parentNode&&(i=t[0].parentNode.insertBefore(i,t[0]),n(t).each(function(){this!=i&&i.appendChild(this)})),i},this.unwrap=function(n){if(n&&n.parentNode){while(n.firstChild)n.parentNode.insertBefore(n.firstChild,n);n.parentNode.removeChild(n)}},this.wrapContents=function(n,t){t=t.nodeName?t:this.create(t);for(var i=0;i<n.childNodes.length;i++)t.appendChild(n.childNodes[i]);return n.appendChild(t),t},this.cleanNode=function(t){if(t.nodeType==1){if(/^(P|LI)$/.test(t.nodeName)&&(l=this.findLastNotEmpty(t))&&l.nodeName=="BR"&&n(l).remove(),$n=n(t),$n.children().each(function(){this.cleanNode(this)}),t.nodeName!="BODY"&&!/^(TABLE|TR|TD)$/.test(t)&&this.isEmpty(t))return $n.remove();$n.attr("style")===""&&$n.removeAttr("style"),this.rte.browser.safari&&$n.hasClass("Apple-span")&&$n.removeClass("Apple-span"),t.nodeName!="SPAN"||$n.attr("style")||$n.attr("class")||$n.attr("id")||$n.replaceWith($n.html())}},this.cleanChildNodes=function(t){var i=this.cleanNode;n(t).children().each(function(){i(this)})},this.tableMatrix=function(t){var i=[],r;if(t&&t.nodeName=="TABLE"){r=0;function u(n){for(var t=0;t<=r;t++)if(!i[n][t])return t}n(t).find("tr").each(function(t){n.isArray(i[t])||(i[t]=[]),n(this).children("td,th").each(function(){for(var h=parseInt(n(this).attr("colspan")||1),c=parseInt(n(this).attr("rowspan")||1),l=u(t),e,o,s,f=0;f<c;f++)for(e=0;e<h;e++)o=t+f,n.isArray(i[o])||(i[o]=[]),s=e==0&&f==0?this:f==0?e:"-",i[o][l+e]=s;r=Math.max(r,i[t].length)})})}return i},this.indexesOfCell=function(n,t){for(var r,i=0;i<t.length;i++)for(r=0;r<t[i].length;r++)if(t[i][r]==n)return[i,r]},this.fixTable=function(t){var r,f,s,h;if(t&&t.nodeName=="TABLE"){var e=n(t),o=this.tableMatrix(t),u=0;if(n.each(o,function(){u=Math.max(u,this.length)}),u==0)return e.remove();for(r=0;r<o.length;r++)if(f=o[r].length,f==0)e.find("tr").eq(r).remove();else if(f<u)for(s=u-f,h=e.find("tr").eq(r),i=0;i<s;i++)h.append("<td>&nbsp;<\/td>")}},this.tableColumn=function(n,t,i){var h,u,c,f,o,r,s,e;if(n=this.selfOrParent(n,/^TD|TH$/),h=this.selfOrParent(n,/^TABLE$/),ret=[],info={offset:[],delta:[]},n&&h){for(i&&this.fixTable(h),u=this.tableMatrix(h),c=!1,r=0;r<u.length;r++){for(o=0;o<u[r].length;o++)if(u[r][o]==n){f=o,c=!0;break}if(c)break}if(f>=0)for(r=0;r<u.length;r++)s=u[r][f]||null,s&&(s.nodeName?(ret.push(s),t&&(info.delta.push(0),info.offset.push(f))):(e=parseInt(s),!isNaN(e)&&u[r][f-e]&&u[r][f-e].nodeName&&(ret.push(u[r][f-e]),t&&(info.delta.push(e),info.offset.push(f)))))}return t?{column:ret,info:info}:ret}}}(jQuery),function(n){elRTE.prototype.filter=function(t){var i=this,r=n("<span/>").addClass("elrtetesturl").appendTo(document.body)[0];this.url=(typeof r.currentStyle!="undefined"?r.currentStyle.backgroundImage:document.defaultView.getComputedStyle(r,null).backgroundImage).replace(/^url\((['"]?)([\s\S]+\/)[\s\S]+\1\)$/i,"$2"),n(r).remove(),this.rte=t,this.xhtml=/xhtml/i.test(t.options.doctype),this.boolAttrs=t.utils.makeObject("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected".split(",")),this.tagRegExp=/<(\/?)([\w:]+)((?:\s+[a-z\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.openTagRegExp=/<([\w:]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.attrRegExp=/(\w+)(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^\s]+))?/g,this.scriptRegExp=/<script([^>]*)>([\s\S]*?)<\/script>/gi,this.styleRegExp=/(<style([^>]*)>[\s\S]*?<\/style>)/gi,this.linkRegExp=/(<link([^>]+)>)/gi,this.cdataRegExp=/<!\[CDATA\[([\s\S]+)\]\]>/g,this.objRegExp=/<object([^>]*)>([\s\S]*?)<\/object>/gi,this.embRegExp=/<(embed)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.paramRegExp=/<(param)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.iframeRegExp=/<iframe([^>]*)>([\s\S]*?)<\/iframe>/gi,this.yMapsRegExp=/<div\s+([^>]*id\s*=\s*('|")?YMapsID[^>]*)>/gi,this.gMapsRegExp=/<iframe\s+([^>]*src\s*=\s*"http:\/\/maps\.google\.\w+[^>]*)>([\s\S]*?)<\/iframe>/gi,this.videoHostRegExp=/^(http:\/\/[\w\.]*)?(youtube|vimeo|rutube).*/i,this.serviceClassRegExp=/<(\w+)([^>]*class\s*=\s*"[^>]*elrte-[^>]*)>\s*(<\/\1>)?/gi,this.pagebreakRegExp=/<(\w+)([^>]*style\s*=\s*"[^>]*page-break[^>]*)>\s*(<\/\1>)?/gi,this.pbRegExp=new RegExp("<!-- pagebreak -->","gi"),this.allowTags=t.options.allowTags.length?t.utils.makeObject(t.options.allowTags):null,this.denyTags=t.options.denyTags.length?t.utils.makeObject(t.options.denyTags):null,this.denyAttr=t.options.denyAttr?t.utils.makeObject(t.options.denyAttr):null,this.pasteDenyAttr=t.options.pasteDenyAttr?t.utils.makeObject(t.options.pasteDenyAttr):null,this.fontSize=["medium","xx-small","small","medium","large","x-large","xx-large"],this.fontFamily={"sans-serif":/^(arial|tahoma|verdana)$/i,serif:/^(times|times new roman)$/i,monospace:/^courier$/i},this.scripts={},this._chains={},n.each(this.chains,function(t){i._chains[t]=[],n.each(this,function(n,r){typeof i.rules[r]=="function"&&i._chains[t].push(i.rules[r])})}),this.proccess=function(t,r){return r=n.trim(r).replace(/^\s*(&nbsp;)+/gi,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""),n.each(this._chains[t]||[],function(){r=this.call(i,r)}),r=r.replace(/\t/g,"  ").replace(/\r/g,"").replace(/\s*\n\s*\n+/g,"\n")+"  ",n.trim(r)?r:" "},this.wysiwyg=function(n){return this.proccess("wysiwyg",n)},this.source=function(n){return this.proccess("source",n)},this.source2source=function(n){return this.proccess("source2source",n)},this.wysiwyg2wysiwyg=function(n){return this.proccess("wysiwyg2wysiwyg",n)},this.parseAttrs=function(t){var i={},o=this.boolAttrs,e=t.match(this.attrRegExp),r,u,f;return e&&n.each(e,function(t,e){r=e.split("="),u=n.trim(r[0]).toLowerCase(),r.length>2?(r.shift(),f=r.join("=")):f=o[u]||r[1]||"",i[u]=n.trim(f).replace(/^('|")(.*)(\1)$/,"$2")}),i.style=this.rte.utils.parseStyle(i.style),i["class"]=this.rte.utils.parseClass(i["class"]||""),i},this.serializeAttrs=function(t,i){var r=[],u=this;return n.each(t,function(n,t){n=="style"?t=u.rte.utils.serializeStyle(t,i):n=="class"&&(t=u.rte.utils.serializeClass(t)),t&&r.push(n+'="'+t+'"')}),r.join(" ")},this.cleanAttrs=function(t,i){function r(n){return n+(/\d$/.test(n)?"px":"")}var f=this,u=this.replaceAttrs;return n.each(t["class"],function(n){/^(Apple-style-span|mso\w+)$/i.test(n)&&delete t["class"][n]}),n.each(t,function(e,o){u[e]&&u[e].call(f,t,i),e=="style"&&n.each(o,function(n,i){switch(n){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":t.style[n.replace(/^mso-|-alt$/g,"")]=r(i),delete t.style[n];break;case"horiz-align":t.style["text-align"]=i,delete t.style[n];break;case"vert-align":t.style["vertical-align"]=i,delete t.style[n];break;case"font-color":case"mso-foreground":t.style.color=i,delete t.style[n];break;case"mso-background":case"mso-highlight":t.style.background=i,delete t.style[n];break;case"mso-default-height":t.style["min-height"]=r(i),delete t.style[n];break;case"mso-default-width":t.style["min-width"]=r(i),delete t.style[n];break;case"mso-padding-between-alt":t.style["border-collapse"]="separate",t.style["border-spacing"]=r(i),delete t.style[n];break;case"text-line-through":i.match(/(single|double)/i)&&(t.style["text-decoration"]="line-through"),delete t.style[n];break;case"mso-zero-height":i=="yes"&&(t.style.display="none"),delete t.style[n];break;case"font-weight":i==700&&(t.style["font-weight"]="bold");break;default:n.match(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/)&&delete t.style[n]}})}),t}},elRTE.prototype.filter.prototype.replaceTags={b:{tag:"strong"},big:{tag:"span",style:{"font-size":"large"}},center:{tag:"div",style:{"text-align":"center"}},i:{tag:"em"},font:{tag:"span"},nobr:{tag:"span",style:{"white-space":"nowrap"}},menu:{tag:"ul"},plaintext:{tag:"pre"},s:{tag:"strike"},small:{tag:"span",style:{"font-size":"small"}},u:{tag:"span",style:{"text-decoration":"underline"}},xmp:{tag:"pre"}},elRTE.prototype.filter.prototype.replaceAttrs={align:function(n,t){switch(t){case"img":n.style[n.align.match(/(left|right)/)?"float":"vertical-align"]=n.align;break;case"table":n.align=="center"?n.style["margin-left"]=n.style["margin-right"]="auto":n.style.float=n.align;break;default:n.style["text-align"]=n.align}delete n.align},border:function(n){n.style["border-width"]||(n.style["border-width"]=(parseInt(n.border)||1)+"px"),n.style["border-style"]||(n.style["border-style"]="solid"),delete n.border},bordercolor:function(n){n.style["border-color"]||(n.style["border-color"]=n.bordercolor),delete n.bordercolor},background:function(n){n.style["background-image"]||(n.style["background-image"]="url("+n.background+")"),delete n.background},bgcolor:function(n){n.style["background-color"]||(n.style["background-color"]=n.bgcolor),delete n.bgcolor},clear:function(n){n.style.clear=n.clear=="all"?"both":n.clear,delete n.clear},color:function(n){n.style.color||(n.style.color=n.color),delete n.color},face:function(t){var i=t.face.toLowerCase();n.each(this.fontFamily,function(n,r){i.match(r)&&(t.style["font-family"]=i+","+n)}),delete t.face},hspace:function(n,t){if(t=="img"){var i=parseInt(n.hspace)||0;n.style["margin-left"]||(n.style["margin-left"]=i+"px"),n.style["margin-right"]||(n.style["margin-right"]=i+"px"),delete n.hspace}},size:function(n,t){t!="input"&&(n.style["font-size"]=this.fontSize[parseInt(n.size)||0]||"medium",delete n.size)},valign:function(n){n.style["vertical-align"]||(n.style["vertical-align"]=n.valign),delete n.valign},vspace:function(n,t){if(t=="img"){var i=parseInt(n.vspace)||0;n.style["margin-top"]||(n.style["margin-top"]=i+"px"),n.style["margin-bottom"]||(n.style["margin-bottom"]=i+"px"),delete n.hspace}}},elRTE.prototype.filter.prototype.rules={allowedTags:function(n){var t=this.allowTags;return t?n.replace(this.tagRegExp,function(n,i,r){return t[r.toLowerCase()]?n:""}):n},deniedTags:function(n){var t=this.denyTags;return t?n.replace(this.tagRegExp,function(n,i,r){return t[r.toLowerCase()]?"":n}):n},clean:function(t){var i=this,r=this.replaceTags,e=this.replaceAttrs,f=this.denyAttr,u;return t=t.replace(/<!DOCTYPE([\s\S]*)>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1<\/strong><\/p>").replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s&nbsp;]*)<\/span>/gi,"$1").replace(/(<p[^>]*>\s*<\/p>|<p[^>]*\/>)/gi,"<br>").replace(/(<\/p>)(?:\s*<br\s*\/?>\s*|\s*&nbsp;\s*)+\s*(<p[^>]*>)/gi,function(n,t,i){return t+"\n"+i}).replace(this.tagRegExp,function(t,u,e,o){return(e=e.toLowerCase(),u)?"<\/"+(r[e]?r[e].tag:e)+">":(o=i.cleanAttrs(i.parseAttrs(o||""),e),r[e]&&(r[e].style&&n.extend(o.style,r[e].style),e=r[e].tag),f&&n.each(o,function(n){f[n]&&delete o[n]}),o=i.serializeAttrs(o),"<"+e+(o?" ":"")+o+">")}),u=n("<div>"+t+"<\/div>"),u.find("span:not([id]):not([class])").each(function(){var t=n(this);t.attr("style")||(n.trim(t.html()).length?i.rte.dom.unwrap(this):t.remove())}).end().find("span span:only-child").each(function(){var r=n(this),t=r.parent().eq(0),o=r.attr("id"),s=t.attr("id"),u,f,e;!i.rte.dom.isOnlyNotEmpty(this)||o&&s||(e=n.trim(t.attr("class")+" "+r.attr("class")),e&&t.attr("class",e),f=i.rte.utils.serializeStyle(n.extend(i.rte.utils.parseStyle(n(this).attr("style")||""),i.rte.utils.parseStyle(n(t).attr("style")||""))),f&&t.attr("style",f),u=o||s,u&&t.attr("id",u),this.firstChild?n(this.firstChild).unwrap():r.remove())}).end().find("a[name]").each(function(){n(this).addClass("elrte-protected elrte-anchor")}),u.html()},cleanPaste:function(t){var i=this,r=this.pasteDenyAttr;return t=t.replace(this.scriptRegExp,"").replace(this.styleRegExp,"").replace(this.linkRegExp,"").replace(this.cdataRegExp,"").replace(/\<\!--[\s\S]*?--\>/g,""),this.rte.options.pasteOnlyText?t=t.replace(this.tagRegExp,function(n,t,i){return/br/i.test(i)||t&&/h[1-6]|p|ol|ul|li|div|blockquote|tr/i?"<br>":""}).replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""):r&&(t=t.replace(this.openTagRegExp,function(t,u,f){return f=i.parseAttrs(f),n.each(f,function(n){r[n]&&delete f[n]}),f=i.serializeAttrs(f,!0),"<"+u+(f?" ":"")+f+">"})),t},replace:function(t){function e(n,t){function c(){if(n.embed&&n.embed.src)return n.embed.src;if(n.params&&n.params.length)for(u=n.params.length;u--;)if(n.params[u].name=="src"||n.params[u].name=="movie")return n.params[u].value}var r=c(),o=r&&i.videoHostRegExp.test(r)?r.replace(i.videoHostRegExp,"$2"):t.replace(/^\w+\/(.+)/,"$1"),s=parseInt((n.obj?n.obj.width||n.obj.style.width:0)||(n.embed?n.embed.width||n.embed.style.width:0))||150,h=parseInt((n.obj?n.obj.height||n.obj.style.height:0)||(n.embed?n.embed.height||n.embed.style.height:0))||100,f="media"+Math.random().toString().substring(2),e="",u;return n.obj&&n.obj.style&&n.obj.style.float&&(e=' style="float:'+n.obj.style.float+'"'),i.scripts[f]=n,'<img src="'+i.url+'pixel.gif" class="elrte-media elrte-media-'+o+' elrte-protected" title="'+(r?i.rte.utils.encode(r):"")+'" rel="'+f+'" width="'+s+'" height="'+h+'"'+e+">"}var i=this,c=this.rte.options.replace||[],u,f;if(c.length&&n.each(c,function(n,r){typeof r=="function"&&(t=r.call(i,t))}),t=t.replace(this.styleRegExp,"<!-- ELRTE_COMMENT$1 -->").replace(this.linkRegExp,"<!-- ELRTE_COMMENT$1-->").replace(this.cdataRegExp,"<!--[CDATA[$1]]-->").replace(this.scriptRegExp,function(n,t,r){var u;return i.denyTags.script?"":(u="script"+Math.random().toString().substring(2),t=i.parseAttrs(t),t.type||(t.type="text/javascript"),i.scripts[u]="<script "+i.serializeAttrs(t)+">"+r+"<\/script>","<!-- ELRTE_SCRIPT:"+u+" -->")}).replace(this.yMapsRegExp,function(n,t){return t=i.parseAttrs(t),t["class"]["elrte-yandex-maps"]="elrte-yandex-maps",t["class"]["elrte-protected"]="elrte-protected","<div "+i.serializeAttrs(t)+">"}).replace(this.gMapsRegExp,function(n,t){var r="gmaps"+Math.random().toString().substring(2),u,f;return t=i.parseAttrs(t),u=parseInt(t.width||t.style.width||100),f=parseInt(t.height||t.style.height||100),i.scripts[r]=n,'<img src="'+i.url+'pixel.gif" class="elrte-google-maps elrte-protected" id="'+r+'" style="width:'+u+"px;height:"+f+'px">'}).replace(this.objRegExp,function(t,r,u){var o=u.match(i.embRegExp),f={obj:i.parseAttrs(r),embed:o&&o.length?i.parseAttrs(o[0].substring(7)):null,params:[]},s=i.rte.utils.mediaInfo(f.embed?f.embed.type||"":"",f.obj.classid||"");return s?((o=u.match(i.paramRegExp))&&n.each(o,function(n,t){f.params.push(i.parseAttrs(t.substring(6)))}),f.obj.classid||(f.obj.classid=s.classid[0]),f.obj.codebase||(f.obj.codebase=s.codebase),f.embed&&!f.embed.type&&(f.embed.type=s.type),f.obj.width=="1"&&delete f.obj.width,f.obj.height=="1"&&delete f.obj.height,f.embed&&(f.embed.width=="1"&&delete f.embed.width,f.embed.height=="1"&&delete f.embed.height),e(f,s.type)):t}).replace(this.embRegExp,function(n,t,r){var r=i.parseAttrs(r),u=i.rte.utils.mediaInfo(r.type||"");return r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,u?e({embed:r},u.type):n}).replace(this.iframeRegExp,function(n,t){var t=i.parseAttrs(t),u=t.style.width||(parseInt(t.width)>1?parseInt(t.width)+"px":"100px"),f=t.style.height||(parseInt(t.height)>1?parseInt(t.height)+"px":"100px"),r="iframe"+Math.random().toString().substring(2);return i.scripts[r]=n,'<img id="'+r+'" src="'+i.url+'pixel.gif" class="elrte-protected elrte-iframe" style="width:'+u+"; height:"+f+'">'}).replace(this.vimeoRegExp,function(n,t,r){return r=i.parseAttrs(r),delete r.frameborder,r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,r.type="application/x-shockwave-flash",e({embed:r},"application/x-shockwave-flash")}).replace(/<\/(embed|param)>/gi,"").replace(this.pbRegExp,function(){return'<img src="'+i.url+'pixel.gif" class="elrte-protected elrte-pagebreak">'}),u=n("<div>"+t+"<\/div>"),!this.rte.options.allowTextNodes){var o=this.rte.dom,s=[],r=[];if(n.browser.msie)for(f=0;f<u[0].childNodes.length;f++)s.push(u[0].childNodes[f]);else s=Array.prototype.slice.call(u[0].childNodes);function h(){r.length&&o.filter(r,"notEmpty").length&&o.wrap(r,document.createElement("p")),r=[]}n.each(s,function(n,t){o.is(t,"block")?h():(r.length&&t.previousSibling!=r[r.length-1]&&h(),r.push(t))}),h()}return u.html()},restore:function(t){var i=this,r=this.rte.options.restore||[];return r.length&&n.each(r,function(n,r){typeof r=="function"&&(t=r.call(i,t))}),t=t.replace(/\<\!--\[CDATA\[([\s\S]*?)\]\]--\>/gi,"<![CDATA[$1]\]>").replace(/\<\!--\s*ELRTE_SCRIPT\:\s*(script\d+)\s*--\>/gi,function(n,t){return i.scripts[t]&&(n=i.scripts[t],delete i.scripts[t]),n||""}).replace(/\<\!-- ELRTE_COMMENT([\s\S]*?) --\>/gi,"$1").replace(this.serviceClassRegExp,function(t,r,u,f){var u=i.parseAttrs(u),e,o="",t;return u["class"]["elrte-google-maps"]?(t="",i.scripts[u.id]&&(t=i.scripts[u.id],delete i.scripts[u.id]),t):u["class"]["elrte-iframe"]?i.scripts[u.id]||"":u["class"].elrtebm?"":u["class"]["elrte-media"]?(e=i.scripts[u.rel]||{},e.params&&n.each(e.params,function(n,t){o+="<param "+i.serializeAttrs(t)+">\n"}),e.embed&&(o+="<embed "+i.serializeAttrs(e.embed)+">"),e.obj&&(o="<object "+i.serializeAttrs(e.obj)+">\n"+o+"\n<\/object>\n"),o||t):u["class"]["elrte-pagebreak"]?"<!-- pagebreak -->":(n.each(u["class"],function(n){/^elrte-\w+/i.test(n)&&delete u["class"][n]}),"<"+r+" "+i.serializeAttrs(u)+">"+(f||""))})},compactStyles:function(n){var t=this;return n.replace(this.tagRegExp,function(n,i,r,u){return u=!i&&u?t.serializeAttrs(t.parseAttrs(u),!0):"","<"+i+r.toLowerCase()+(u?" ":"")+u+">"})},xhtmlTags:function(n){return this.xhtml?n.replace(/<(img|hr|br|embed|param|link|area)([^>]*\/*)>/gi,"<$1$2 />"):n}},elRTE.prototype.filter.prototype.chains={wysiwyg:["replace","clean","allowedTags","deniedTags","compactStyles"],source:["clean","allowedTags","restore","compactStyles","xhtmlTags"],paste:["clean","allowedTags","cleanPaste","replace","deniedTags","compactStyles"],wysiwyg2wysiwyg:["clean","allowedTags","restore","replace","deniedTags","compactStyles"],source2source:["clean","allowedTags","replace","deniedTags","restore","compactStyles","xhtmlTags"]}}(jQuery),function(n){elRTE.prototype.history=function(t){this.rte=t,this._prev=[],this._next=[],this.add=function(){this.rte.options.historyLength>0&&this._prev.length>=this.rte.options.historyLength&&this._prev.slice(this.rte.options.historyLength);var t=this.rte.selection.getBookmark();this._prev.push([n(this.rte.doc.body).html(),t]),this.rte.selection.moveToBookmark(t),this._next=[]},this.back=function(){if(this._prev.length){var i=this.rte.selection.getBookmark(),t=this._prev.pop();this._next.push([n(this.rte.doc.body).html(),i]),n(this.rte.doc.body).html(t[0]),this.rte.selection.moveToBookmark(t[1])}},this.fwd=function(){if(this._next.length){var i=this.rte.selection.getBookmark(),t=this._next.pop();this._prev.push([n(this.rte.doc.body).html(),i]),n(this.rte.doc.body).html(t[0]),this.rte.selection.moveToBookmark(t[1])}},this.canBack=function(){return this._prev.length},this.canFwd=function(){return this._next.length}}}(jQuery),function(){elRTE.prototype.options={doctype:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">',cssClass:"el-rte",cssfiles:[],height:null,resizable:!0,lang:"en",toolbar:"normal",absoluteURLs:!0,allowSource:!0,stripWhiteSpace:!0,styleWithCSS:!1,fmAllow:!0,fmOpen:null,allowTags:[],denyTags:["applet","base","basefont","bgsound","blink","body","col","colgroup","isindex","frameset","html","head","meta","marquee","noframes","noembed","o:p","title","xml"],denyAttr:[],pasteDenyAttr:["id","name","class","style","language","onclick","ondblclick","onhover","onkeup","onkeydown","onkeypress"],allowTextNodes:!0,allowBrowsersSpecStyles:!1,allowPaste:!0,pasteOnlyText:!1,replace:[],restore:[],pagebreak:'<div style="page-break-after: always;"><\/div>',buttons:{save:"Save",copy:"Copy",cut:"Cut",css:"Css style and class",paste:"Paste",pastetext:"Paste only text",pasteformattext:"Paste formatted text",removeformat:"Clean format",undo:"Undo last action",redo:"Redo previous action",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyleft:"Align left",justifyright:"Ailgn right",justifycenter:"Align center",justifyfull:"Align full",indent:"Indent",outdent:"Outdent",rtl:"Right to left",ltr:"Left to right",forecolor:"Font color",hilitecolor:"Background color",formatblock:"Format",fontsize:"Font size",fontname:"Font",insertorderedlist:"Ordered list",insertunorderedlist:"Unordered list",horizontalrule:"Horizontal rule",blockquote:"Blockquote",div:"Block element (DIV)",link:"Link",unlink:"Delete link",anchor:"Bookmark",image:"Image",pagebreak:"Page break",smiley:"Smiley",flash:"Flash",table:"Table",tablerm:"Delete table",tableprops:"Table properties",tbcellprops:"Table cell properties",tbrowbefore:"Insert row before",tbrowafter:"Insert row after",tbrowrm:"Delete row",tbcolbefore:"Insert column before",tbcolafter:"Insert column after",tbcolrm:"Delete column",tbcellsmerge:"Merge table cells",tbcellsplit:"Split table cell",docstructure:"Toggle display document structure",elfinder:"Open file manager",fullscreen:"Toggle full screen mode",nbsp:"Non breakable space",stopfloat:"Stop element floating",about:"About this software"},panels:{eol:[],save:["save"],copypaste:["copy","cut","paste","pastetext","pasteformattext","removeformat","docstructure"],undoredo:["undo","redo"],style:["bold","italic","underline","strikethrough","subscript","superscript"],colors:["forecolor","hilitecolor"],alignment:["justifyleft","justifycenter","justifyright","justifyfull"],indent:["outdent","indent"],format:["formatblock","fontsize","fontname"],lists:["insertorderedlist","insertunorderedlist"],elements:["horizontalrule","blockquote","div","stopfloat","css","nbsp","smiley","pagebreak"],direction:["ltr","rtl"],links:["link","unlink","anchor"],images:["image"],media:["image","flash"],tables:["table","tableprops","tablerm","tbrowbefore","tbrowafter","tbrowrm","tbcolbefore","tbcolafter","tbcolrm","tbcellprops","tbcellsmerge","tbcellsplit"],elfinder:["elfinder"],fullscreen:["fullscreen","about"]},toolbars:{tiny:["style"],compact:["save","undoredo","style","alignment","lists","links","fullscreen"],normal:["save","copypaste","undoredo","style","alignment","colors","indent","lists","links","elements","images","fullscreen"],complete:["save","copypaste","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","fullscreen"],maxi:["save","copypaste","undoredo","elfinder","style","alignment","direction","colors","format","indent","lists","links","elements","media","tables","fullscreen"],eldorado:["save","copypaste","elfinder","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"]},panelNames:{save:"Save",copypaste:"Copy/Pase",undoredo:"Undo/Redo",style:"Text styles",colors:"Colors",alignment:"Alignment",indent:"Indent/Outdent",format:"Text format",lists:"Lists",elements:"Misc elements",direction:"Script direction",links:"Links",images:"Images",media:"Media",tables:"Tables",elfinder:"File manager (elFinder)"}}}(jQuery),function(n){elRTE.prototype.selection=function(t){function u(){return i.rte.window.getSelection?i.rte.window.getSelection():i.rte.window.document.selection}function s(n,t,r){while(n.nodeName!="BODY"&&n.parentNode&&n.parentNode.nodeName!="BODY"&&(t?n!==t&&n.parentNode!=t:1)&&(r=="left"&&i.rte.dom.isFirstNotEmpty(n)||r=="right"&&i.rte.dom.isLastNotEmpty(n)||i.rte.dom.isFirstNotEmpty(n)&&i.rte.dom.isLastNotEmpty(n)))n=n.parentNode;return n}var i,f,r,e,o;this.rte=t,i=this,this.w3cRange=null,n(this.rte.doc).keyup(function(n){(n.ctrlKey||n.metaKey||n.keyCode>=8&&n.keyCode<=13||n.keyCode>=32&&n.keyCode<=40||n.keyCode==46||n.keyCode>=96&&n.keyCode<=111)&&i.cleanCache()}).mousedown(function(n){f=n.target.nodeName=="HTML"?i.rte.doc.body:n.target,r=e=null}).mouseup(function(n){r=n.target.nodeName=="HTML"?i.rte.doc.body:n.target,r=n.target,e=null}).click(),this.collapsed=function(){return this.getRangeAt().isCollapsed()},this.collapse=function(t){var i=u(),r=this.getRangeAt();return r.collapse(t?!0:!1),n.browser.msie||(i.removeAllRanges(),i.addRange(r)),this},this.getRangeAt=function(n){if(this.rte.browser.msie)return this.w3cRange||(this.w3cRange=new this.rte.w3cRange(this.rte)),n&&this.w3cRange.update(),this.w3cRange;var i=u(),t=i.rangeCount>0?i.getRangeAt(0):this.rte.doc.createRange();return t.getStart=function(){return this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(this.startOffset,this.startContainer.childNodes.length-1)]:this.startContainer},t.getEnd=function(){return this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(this.startOffset==this.endOffset?this.endOffset:this.endOffset-1,this.endContainer.childNodes.length-1)]:this.endContainer},t.isCollapsed=function(){return this.collapsed},t},this.saveIERange=function(){n.browser.msie&&(o=this.getRangeAt().getBookmark())},this.restoreIERange=function(){n.browser.msie&&o&&this.getRangeAt().moveToBookmark(o)},this.cloneContents=function(){var i=this.rte.dom.create("div"),r,u,t;if(n.browser.msie){try{r=this.rte.window.document.selection.createRange()}catch(f){r=this.rte.doc.body.createTextRange()}n(i).html(r.htmlText)}else for(u=this.getRangeAt().cloneContents(),t=0;t<u.childNodes.length;t++)i.appendChild(u.childNodes[t].cloneNode(!0));return i},this.select=function(n,t){var r,i;if(t=t||n,this.rte.browser.msie){var i=this.rte.doc.body.createTextRange(),f=i.duplicate(),e=i.duplicate();f.moveToElementText(n),e.moveToElementText(t),i.setEndPoint("StartToStart",f),i.setEndPoint("EndToEnd",e),i.select()}else r=u(),i=this.getRangeAt(),i.setStartBefore(n),i.setEndAfter(t),r.removeAllRanges(),r.addRange(i);return this.cleanCache()},this.selectContents=function(n){var t=this.getRangeAt(),i;if(n&&n.nodeType==1)if(this.rte.browser.msie)t.range(),t.r.moveToElementText(n.parentNode),t.r.select();else{try{t.selectNodeContents(n)}catch(r){return this.rte.log("unable select node contents "+n)}i=u(),i.removeAllRanges(),i.addRange(t)}return this},this.deleteContents=function(){return n.browser.msie||this.getRangeAt().deleteContents(),this},this.insertNode=function(t,i){var e,r,f;return i&&!this.collapsed()&&this.collapse(),this.rte.browser.msie?(e=t.nodeType==3?t.nodeValue:n(this.rte.dom.create("span")).append(n(t)).html(),r=this.getRangeAt(),r.insertNode(e)):(r=this.getRangeAt(),r.insertNode(t),r.setStartAfter(t),r.setEndAfter(t),f=u(),f.removeAllRanges(),f.addRange(r)),this.cleanCache()},this.insertHtml=function(t,i){if(i&&!this.collapsed()&&this.collapse(),this.rte.browser.msie)this.getRangeAt().range().pasteHTML(t);else{var r=n(this.rte.dom.create("span")).html(t||"").get(0);this.insertNode(r),n(r).replaceWith(n(r).html())}return this.cleanCache()},this.insertText=function(n){var t=this.rte.doc.createTextNode(n);return this.insertHtml(t.nodeValue)},this.getBookmark=function(){var i,r,o,s,f,e,c,h,t;if(this.rte.window.focus(),f=this.rte.dom.createBookmark(),e=this.rte.dom.createBookmark(),n.browser.msie){try{t=this.rte.window.document.selection.createRange()}catch(e){t=this.rte.doc.body.createTextRange()}t.item&&(c=t.item(0),t=this.rte.doc.body.createTextRange(),t.moveToElementText(c)),i=t.duplicate(),r=t.duplicate(),o=this.rte.dom.create("span"),s=this.rte.dom.create("span"),o.appendChild(f),s.appendChild(e),i.collapse(!0),i.pasteHTML(o.innerHTML),r.collapse(!1),r.pasteHTML(s.innerHTML)}else h=u(),t=h.rangeCount>0?h.getRangeAt(0):this.rte.doc.createRange(),i=t.cloneRange(),r=t.cloneRange(),r.collapse(!1),r.insertNode(e),i.collapse(!0),i.insertNode(f),this.select(f,e);return[f.id,e.id]},this.moveToBookmark=function(t){if(this.rte.window.focus(),t&&t.length==2){var i=this.rte.doc.getElementById(t[0]),r=this.rte.doc.getElementById(t[1]),f,e;i&&r&&(this.select(i,r),this.rte.dom.next(i)==r&&this.collapse(!0),n.browser.msie||(f=u(),e=f.rangeCount>0?f.getRangeAt(0):this.rte.doc.createRange(),f.removeAllRanges(),f.addRange(e)),i.parentNode.removeChild(i),r.parentNode.removeChild(r))}return this},this.removeBookmark=function(n){if(this.rte.window.focus(),n.length==2){var t=this.rte.doc.getElementById(n[0]),i=this.rte.doc.getElementById(n[1]);t&&i&&(t.parentNode.removeChild(t),i.parentNode.removeChild(i))}},this.cleanCache=function(){return f=r=e=null,this},this.getStart=function(){if(!f){var n=this.getRangeAt();f=n.getStart()}return f},this.getEnd=function(){if(!r){var n=this.getRangeAt();r=n.getEnd()}return r},this.getNode=function(){return e||(e=this.rte.dom.findCommonAncestor(this.getStart(),this.getEnd())),e},this.selected=function(t){function a(){function t(){for(var t=0;t<o.length;t++)if(o[t].nodeType==1&&(i.rte.dom.selfOrParent(o[t],/^P$/)||n(o[t]).find("p").length>0))return!1;return!0}if(o.length>0){var r=u.tag=="p"&&!t()?"div":u.tag,e=i.rte.dom.wrap(o,r);f[h]=e,h=null,o=[]}}function l(t){var e,t,r;if(t.nodeType==1)if(/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(t.nodeName))n(t).find("td,th").each(function(){var t=u.tag=="p"&&n(this).find("p").length>0?"div":u.tag,r=i.rte.dom.wrapContents(this,t);return f.push(r)});else if(/^(CAPTION|TD|TH|LI|DT|DD)$/.test(t.nodeName))return e=u.tag=="p"&&n(t).find("p").length>0?"div":u.tag,t=i.rte.dom.wrapContents(t,e),f.push(t);r=o.length>0?o[o.length-1]:null,r&&r!=i.rte.dom.prev(t)&&a(),o.push(t),h===null&&(h=f.length,f.push("dummy"))}var u={collapsed:!1,blocks:!1,filter:!1,wrap:"text",tag:"span"},c,s,r;if(u=n.extend({},u,t),u.blocks&&(r=this.getNode(),c=null,c=this.rte.dom.selfOrParent(r,"selectionBlock")))return[c];var e=this.selectedRaw(u.collapsed,u.blocks),f=[],o=[],h=null;if(e.nodes.length>0){for(s=0;s<e.nodes.length;s++){r=e.nodes[s],r.nodeType==3&&(s==0||s==e.nodes.length-1)&&n.trim(r.nodeValue).length>0&&(s==0&&e.so>0&&(r=r.splitText(e.so)),s==e.nodes.length-1&&e.eo>0&&r.splitText(s==0&&e.so>0?e.eo-e.so:e.eo));switch(u.wrap){case"text":r.nodeType==1&&r.nodeName=="BR"||r.nodeType==3&&n.trim(r.nodeValue).length>0?l(r):r.nodeType==1&&f.push(r);break;case"inline":this.rte.dom.isInline(r)?l(r):r.nodeType==1&&f.push(r);break;case"all":r.nodeType!=1&&this.rte.dom.isEmpty(r)||l(r);break;default:r.nodeType!=1&&this.rte.dom.isEmpty(r)||f.push(r)}}a()}return f.length&&(this.rte.window.focus(),this.select(f[0],f[f.length-1])),u.filter?this.rte.dom.filter(f,u.filter):f},this.dump=function(n,t,i,r,u){var f=this.getRangeAt();this.rte.log("commonAncestorContainer"),this.rte.log(n||f.commonAncestorContainer),this.rte.log("startContainer"),this.rte.log(t||f.startContainer),this.rte.log("startOffset: "+(r>=0?r:f.startOffset)),this.rte.log("endContainer"),this.rte.log(i||f.endContainer),this.rte.log("endOffset: "+(u>=0?u:f.endOffset))},this.selectedRaw=function(t,r){function b(t,i,r){return t.nodeType==3?(r=r>=0?r:t.nodeValue.length,i==0&&r==t.nodeValue.length||n.trim(t.nodeValue).length==n.trim(t.nodeValue.substring(i,r)).length):!0}function k(t,r,u){return t.nodeType==1?i.rte.dom.isEmpty(t):t.nodeType==3?n.trim(t.nodeValue.substring(r||0,u>=0?u:t.nodeValue.length)).length==0:!0}var u={so:null,eo:null,nodes:[]},o=this.getRangeAt(!0),v=o.commonAncestorContainer,f,e,p=!1,w=!1,l,a,h,y,c;if(o.startContainer.nodeType==1?o.startOffset<o.startContainer.childNodes.length?(f=o.startContainer.childNodes[o.startOffset],u.so=f.nodeType==1?null:0):(f=o.startContainer.childNodes[o.startOffset-1],u.so=f.nodeType==1?null:f.nodeValue.length):(f=o.startContainer,u.so=o.startOffset),o.collapsed)return t&&(r?(f=s(f),(!this.rte.dom.isEmpty(f)||(f=this.rte.dom.next(f)))&&(u.nodes=[f]),this.rte.dom.isInline(f)&&(u.nodes=this.rte.dom.toLineStart(f).concat(u.nodes,this.rte.dom.toLineEnd(f))),u.nodes.length>0&&(u.so=u.nodes[0].nodeType==1?null:0,u.eo=u.nodes[u.nodes.length-1].nodeType==1?null:u.nodes[u.nodes.length-1].nodeValue.length)):this.rte.dom.isEmpty(f)||(u.nodes=[f])),u;if(o.endContainer.nodeType==1?(e=o.endContainer.childNodes[o.endOffset-1],u.eo=e.nodeType==1?null:e.nodeValue.length):(e=o.endContainer,u.eo=o.endOffset),(f.nodeType==1||r||b(f,u.so,f.nodeValue.length))&&(f=s(f,v,"left"),p=!0,u.so=f.nodeType==1?null:0),(e.nodeType==1||r||b(e,0,u.eo))&&(e=s(e,v,"right"),w=!0,u.eo=e.nodeType==1?null:e.nodeValue.length),r&&(f.nodeType!=1&&f.parentNode!=v&&f.parentNode.nodeName!="BODY"&&(f=f.parentNode,u.so=null),e.nodeType!=1&&e.parentNode!=v&&e.parentNode.nodeName!="BODY"&&(e=e.parentNode,u.eo=null)),f.parentNode==e.parentNode&&f.parentNode.nodeName!="BODY"&&p&&this.rte.dom.isFirstNotEmpty(f)&&w&&this.rte.dom.isLastNotEmpty(e)&&(f=e=f.parentNode,u.so=f.nodeType==1?null:0,u.eo=e.nodeType==1?null:e.nodeValue.length),f==e)return this.rte.dom.isEmpty(f)||u.nodes.push(f),u;for(l=f;l.nodeName!="BODY"&&l.parentNode!==v&&l.parentNode.nodeName!="BODY";)l=l.parentNode;for(a=e;a.nodeName!="BODY"&&a.parentNode!==v&&a.parentNode.nodeName!="BODY";)a=a.parentNode;for(k(f,u.so,f.nodeType==3?f.nodeValue.length:null)||u.nodes.push(f),h=f;h!==l;){for(c=h;c=this.rte.dom.next(c);)u.nodes.push(c);h=h.parentNode}for(h=l;(h=this.rte.dom.next(h))&&h!=a;)u.nodes.push(h);for(y=[],h=e;h!==a;){for(c=h;c=this.rte.dom.prev(c);)y.push(c);h=h.parentNode}return y.length&&(u.nodes=u.nodes.concat(y.reverse())),k(e,0,e.nodeType==3?u.eo:null)||u.nodes.push(e),r&&(this.rte.dom.isInline(f)&&(u.nodes=this.rte.dom.toLineStart(f).concat(u.nodes),u.so=u.nodes[0].nodeType==1?null:0),this.rte.dom.isInline(e)&&(u.nodes=u.nodes.concat(this.rte.dom.toLineEnd(e)),u.eo=u.nodes[u.nodes.length-1].nodeType==1?null:u.nodes[u.nodes.length-1].nodeValue.length)),u}}}(jQuery),function(n){elRTE.prototype.ui=function(t){this.rte=t,this._buttons=[];var l=this,f=this.rte.options.toolbars[t.options.toolbar&&t.options.toolbars[t.options.toolbar]?t.options.toolbar:"normal"],r=f.length,e,i,o,s,h,c,u;for(u in this.buttons)this.buttons.hasOwnProperty(u)&&u!="button"&&(this.buttons[u].prototype=this.buttons.button.prototype);while(r--){if(first=r==0?!0:!1,f[r-1]=="eol"&&(first=!0),i=f[r],i=="eol"){n(this.rte.doc.createElement("br")).prependTo(this.rte.toolbar);continue}for(e=n('<ul class="panel-'+i+(first?" first":"")+'" />').prependTo(this.rte.toolbar),e.bind("mousedown",function(n){n.preventDefault()}),o=this.rte.options.panels[i].length;o--;)s=this.rte.options.panels[i][o],h=this.buttons[s]||this.buttons.button,this._buttons.push(c=new h(this.rte,s)),e.prepend(c.domElem)}this.update(),this.disable=function(){n.each(l._buttons,function(){this.active||this.domElem.addClass("disabled")})}},elRTE.prototype.ui.prototype.update=function(t){function s(t){var i=t.nodeName.toLowerCase();return t=n(t),i=="img"&&(t.hasClass("elrte-media")?i="media":t.hasClass("elrte-google-maps")?i="google map":t.hasClass("elrte-yandex-maps")?i="yandex map":t.hasClass("elrte-pagebreak")&&(i="pagebreak")),i}t&&this.rte.selection.cleanCache();var i=this.rte.selection.getNode(),r=this.rte.dom.parents(i,"*"),f=this.rte.rtl,o=f?" &laquo; ":" &raquo; ",e="",u;for(i&&i.nodeType==1&&i.nodeName!="BODY"&&r.unshift(i),f||(r=r.reverse()),u=0;u<r.length;u++)e+=(u>0?o:"")+s(r[u]);this.rte.statusbar.html(e),n.each(this._buttons,function(){this.update()}),this.rte.window.focus()},elRTE.prototype.ui.prototype.buttons={button:function(t,i){var r=this;this.rte=t,this.active=!1,this.name=i,this.val=null,this.domElem=n('<li style="-moz-user-select:-moz-none" class="'+i+' rounded-3" name="'+i+'" title="'+this.rte.i18n(this.rte.options.buttons[i]||i)+'" unselectable="on" />').hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault(),n(this).hasClass("disabled")||r.command(),r.rte.window.focus()})}},elRTE.prototype.ui.prototype.buttons.button.prototype.command=function(){this.rte.history.add();try{this.rte.doc.execCommand(this.name,!1,this.val)}catch(n){return this.rte.log("commands failed: "+this.name)}this.rte.ui.update(!0)},elRTE.prototype.ui.prototype.buttons.button.prototype.update=function(){try{if(this.rte.doc.queryCommandEnabled(this.name))this.domElem.removeClass("disabled");else return this.domElem.addClass("disabled")}catch(n){return}try{this.rte.doc.queryCommandState(this.name)?this.domElem.addClass("active"):this.domElem.removeClass("active")}catch(n){}}}(jQuery),function(n){elRTE.prototype.utils=function(t){this.rte=t,this.url=null,this.reg=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,this.baseURL="",this.path="",this.entities={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},this.entitiesRegExp=/[<>&\"]/g,this.media=[{type:"application/x-shockwave-flash",classid:["clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"},{type:"application/x-director",classid:["clsid:166b1bca-3f9c-11cf-8075-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0"},{type:"application/x-mplayer2",classid:["clsid:6bf52a52-394a-11d3-b153-00c04f79faa6","clsid:22d6f312-b0f6-11d0-94ab-0080c74c7e95","clsid:05589fa1-c356-11ce-bf01-00aa0055595a"],codebase:"http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"},{type:"video/quicktime",classid:["clsid:02bf25d5-8c17-4b23-bc80-d3488abddc6b"],codebase:"http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"},{type:"audio/x-pn-realaudio-plugin",classid:["clsid:cfcdaa03-8be4-11cf-b84b-0020afbbccfa"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"}],this.rgbRegExp=/\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*/i,this.colorsRegExp=/aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\s*\([^\)]+\)/i,this.colors={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#fffffff",yellow:"#ffff00"};var i=this;this.rgb2hex=function(n){return this.color2Hex(""+n)},this.toPixels=function(t){var r=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/),i;if(r&&(t=r[1],unit=r[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t),isNaN(t))return"";i=parseInt(n(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*i);case"pt":return parseInt(t*i/12);case"%":return parseInt(t*i/100)}return t},this.absoluteURL=function(t){if(this.url||this._url(),t=n.trim(t),!t)return"";if(t[0]=="#")return t;var i=this.parseURL(t);return!i.host&&!i.path&&!i.anchor?"":this.rte.options.absoluteURLs?i.protocol?t:i.host&&(i.host.indexOf(".")!=-1||i.host=="localhost")?this.url.protocol+"://"+t:(t[0]=="/"?t=this.baseURL+t:(t.indexOf("./")==0&&(t=t.substring(2)),t=this.baseURL+this.path+t),t):t},this.parseURL=function(t){var r=t.match(this.reg),i={};return n.each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(n){i[this]=r[n]}),i.host.match(/[a-z0-9]/i)||(i.host=""),i},this.trimEventCallback=function(t){return t=t?t.toString():"",n.trim(t.replace(/\r*\n/mg,"").replace(/^function\s*on[a-z]+\s*\(\s*event\s*\)\s*\{(.+)\}$/igm,"$1"))},this._url=function(){this.url=this.parseURL(window.location.href),this.baseURL=this.url.protocol+"://"+(this.url.userInfo?parts.userInfo+"@":"")+this.url.host+(this.url.port?":"+this.url.port:""),this.path=this.url.file?this.url.path.substring(0,this.url.path.length-this.url.file.length):this.url.path},this.makeObject=function(t){var i={};return n.each(t,function(n,t){i[t]=t}),i},this.encode=function(n){var t=this.entities;return(""+n).replace(this.entitiesRegExp,function(n){return t[n]})},this.decode=function(t){return n("<div/>").html(t||"").text()},this.parseStyle=function(t){var f={},e=this.rte.options.allowBrowsersSpecStyles,i,r,u;return typeof t=="string"&&t.length&&n.each(t.replace(/&quot;/gi,"'").split(";"),function(t,o){(u=o.indexOf(":"))!==-1&&(i=n.trim(o.substr(0,u)),r=n.trim(o.substr(u+1)),(i=="color"||i=="background-color")&&(r=r.toLowerCase()),i&&r&&(e||i.substring(0,1)!="-")&&(f[i]=r))}),f},this.compactStyle=function(t){var i=this;return t.border=="medium none"&&delete t.border,n.each(t,function(n,r){/color$/i.test(n)?t[n]=i.color2Hex(r):/^(border|background)$/i.test(n)&&(t[n]=r.replace(i.colorsRegExp,function(n){return i.color2Hex(n)}))}),t["border-width"]&&(t.border=t["border-width"]+" "+(t["border-style"]||"solid")+" "+(t["border-color"]||"#000"),delete t["border-width"],delete t["border-style"],delete t["border-color"]),t["background-image"]&&(t.background=t["background-color"]+" "||""+t["background-image"]+" "+t["background-position"]||"0 0 "+t["background-repeat"]||"repeat",delete t["background-image"],delete["background-image"],delete["background-position"],delete["background-repeat"]),t["margin-top"]&&t["margin-right"]&&t["margin-bottom"]&&t["margin-left"]&&(t.margin=t["margin-top"]+" "+t["margin-right"]+" "+t["margin-bottom"]+" "+t["margin-left"],delete t["margin-top"],delete t["margin-right"],delete t["margin-bottom"],delete t["margin-left"]),t["padding-top"]&&t["padding-right"]&&t["padding-bottom"]&&t["padding-left"]&&(t.padding=t["padding-top"]+" "+t["padding-right"]+" "+t["padding-bottom"]+" "+t["padding-left"],delete t["padding-top"],delete t["padding-right"],delete t["padding-bottom"],delete t["padding-left"]),(t["list-style-type"]||t["list-style-position"]||t["list-style-image"])&&(t["list-style"]=n.trim(t["list-style-type"]||" "+t["list-style-position"]||""+t["list-style-image"]||""),delete t["list-style-type"],delete t["list-style-position"],delete t["list-style-image"]),t},this.serializeStyle=function(t,i){var r=[];return n.each(i?this.compactStyle(t):t,function(n,t){t&&r.push(n+":"+t)}),r.join(";")},this.parseClass=function(t){return t=n.trim(t),t.length?this.makeObject(t.split(/\s+/)):{}},this.serializeClass=function(t){var i=[],r=this.rte;return n.each(t,function(n){i.push(n)}),i.join(" ")},this.mediaInfo=function(t,i){for(var r=this.media.length;r--;)if(t===this.media[r].type||i&&n.inArray(i,this.media[r].classid)!=-1)return this.media[r]},this.color2Hex=function(n){function i(n){return n=parseInt(n).toString(16),n.length>1?n:"0"+n}var t;return(n=n||"",n.indexOf("#")===0)?n:this.colors[n]?this.colors[n]:(t=n.match(this.rgbRegExp))?"#"+i(t[1])+i(t[2])+i(t[3]):""}}}(jQuery),function(){elRTE.prototype.w3cRange=function(n){var t=this;this.rte=n,this.r=null,this.collapsed=!0,this.startContainer=null,this.endContainer=null,this.startOffset=0,this.endOffset=0,this.commonAncestorContainer=null,this.range=function(){try{this.r=this.rte.window.document.selection.createRange()}catch(n){this.r=this.rte.doc.body.createTextRange()}return this.r},this.insertNode=function(n){this.range(),t.r.collapse(!1);var i=t.r.duplicate();i.pasteHTML(n)},this.getBookmark=function(){if(this.range(),this.r.item){var n=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(n)}return this.r.getBookmark()},this.moveToBookmark=function(n){this.rte.window.focus(),this.range().moveToBookmark(n),this.r.select()},this.update=function(){function u(n){var s="﻿",e=offset=0,u=t.r.duplicate(),i,r,f,o;if(u.collapse(n),i=u.parentElement(),!i||i.nodeName=="HTML")return{parent:t.rte.doc.body,ndx:e,offset:offset};for(u.pasteHTML(s),childs=i.childNodes,r=0;r<childs.length;r++)if(f=childs[r],r>0&&(f.nodeType!==3||childs[r-1].nodeType!==3)&&e++,f.nodeType!==3)offset=0;else{if(o=f.nodeValue.indexOf(s),o!==-1){offset+=o;break}offset+=f.nodeValue.length}return u.moveStart("character",-1),u.text="",{parent:i,ndx:Math.min(e,i.childNodes.length-1),offset:offset}}var r,n,i;return this.range(),this.startContainer=this.endContainer=null,this.r.item?(this.collapsed=!1,r=this.r.item(0),this.setStart(r.parentNode,this.rte.dom.indexOf(r)),this.setEnd(r.parentNode,this.startOffset+1)):(this.collapsed=this.r.boundingWidth==0,n=u(!0),i=u(!1),n.parent.normalize(),i.parent.normalize(),n.ndx=Math.min(n.ndx,n.parent.childNodes.length-1),i.ndx=Math.min(i.ndx,i.parent.childNodes.length-1),n.parent.childNodes[n.ndx].nodeType&&n.parent.childNodes[n.ndx].nodeType==1?this.setStart(n.parent,n.ndx):this.setStart(n.parent.childNodes[n.ndx],n.offset),i.parent.childNodes[i.ndx].nodeType&&i.parent.childNodes[i.ndx].nodeType==1?this.setEnd(i.parent,i.ndx):this.setEnd(i.parent.childNodes[i.ndx],i.offset),this.select()),this},this.isCollapsed=function(){return this.range(),this.collapsed=this.r.item?!1:this.r.boundingWidth==0,this.collapsed},this.collapse=function(n){if(this.range(),this.r.item){var t=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(t)}this.r.collapse(n),this.r.select(),this.collapsed=!0},this.getStart=function(){var t,n;return(this.range(),this.r.item)?this.r.item(0):(t=this.r.duplicate(),t.collapse(!0),n=t.parentElement(),n&&n.nodeName=="BODY"?n.firstChild:n)},this.getEnd=function(){var t,n;return(this.range(),this.r.item)?this.r.item(0):(t=this.r.duplicate(),t.collapse(!1),n=t.parentElement(),n&&n.nodeName=="BODY"?n.lastChild:n)},this.setStart=function(n,t){this.startContainer=n,this.startOffset=t,this.endContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setEnd=function(n,t){this.endContainer=n,this.endOffset=t,this.startContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setStartBefore=function(n){n.parentNode&&this.setStart(n.parentNode,this.rte.dom.indexOf(n))},this.setStartAfter=function(n){n.parentNode&&this.setStart(n.parentNode,this.rte.dom.indexOf(n)+1)},this.setEndBefore=function(n){n.parentNode&&this.setEnd(n.parentNode,this.rte.dom.indexOf(n))},this.setEndAfter=function(n){n.parentNode&&this.setEnd(n.parentNode,this.rte.dom.indexOf(n)+1)},this.select=function(){function f(n,i){var e;if(n.nodeType!=3)return-1;var f="﻿",r=n.nodeValue,u=t.rte.doc.body.createTextRange();return n.nodeValue=r.substring(0,i)+f+r.substring(i),u.moveToElementText(n.parentNode),u.findText(f),e=Math.abs(u.moveStart("character",-1048575)),n.nodeValue=r,e}var o;this.r=this.rte.doc.body.createTextRange();var r=this.startOffset,u=this.endOffset,n=this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(r,this.startContainer.childNodes.length-1)]:this.startContainer,e=this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(r==u?u:u-1,this.endContainer.childNodes.length-1)]:this.endContainer;if(this.collapsed)n.nodeType==3?(o=f(n,r),this.r.move("character",o)):(this.r.moveToElementText(n),this.r.collapse(!0));else{var i=this.rte.doc.body.createTextRange(),s=f(n,r),h=f(e,u);n.nodeType==3?this.r.move("character",s):this.r.moveToElementText(n),e.nodeType==3?i.move("character",h):i.moveToElementText(e),this.r.setEndPoint("EndToEnd",i)}try{this.r.select()}catch(e){}i&&(i=null)},this.dump=function(){this.rte.log("collapsed: "+this.collapsed),this.rte.log("startContainer: "+(this.startContainer?this.startContainer.nodeName:"non")),this.rte.log("startOffset: "+this.startOffset),this.rte.log("endContainer: "+(this.endContainer?this.endContainer.nodeName:"none")),this.rte.log("endOffset: "+this.endOffset)}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.about=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.active=!0,this.command=function(){var r,i,u;r={rtl:t.rtl,submit:function(n,t){t.close()},dialog:{width:560,title:this.rte.i18n("About this software"),buttons:{Ok:function(){n(this).dialog("destroy")}}}},u='<div class="elrte-logo"><\/div><h3>'+this.rte.i18n("About elRTE")+'<\/h3><br clear="all"/><div class="elrte-ver">'+this.rte.i18n("Version")+": "+this.rte.version+" ("+this.rte.build+')<\/div><div class="elrte-ver">jQuery: '+n("<div/>").jquery+'<\/div><div class="elrte-ver">jQueryUI: '+n.ui.version+'<\/div><div class="elrte-ver">'+this.rte.i18n("Licence")+": BSD Licence<\/div><p>"+this.rte.i18n("elRTE is an open-source JavaScript based WYSIWYG HTML-editor.")+"<br/>"+this.rte.i18n("Main goal of the editor - simplify work with text and formating (HTML) on sites, blogs, forums and other online services.")+"<br/>"+this.rte.i18n("You can use it in any commercial or non-commercial projects.")+"<\/p><h4>"+this.rte.i18n("Authors")+'<\/h4><table class="elrte-authors"><tr><td>Dmitry (dio) Levashov &lt;dio@std42.ru&gt;<\/td><td>'+this.rte.i18n("Chief developer")+"<\/td><\/tr><tr><td>Troex Nevelin &lt;troex@fury.scancode.ru&gt;<\/td><td>"+this.rte.i18n("Developer, tech support")+"<\/td><\/tr><tr><td>Valentin Razumnyh &lt;content@std42.ru&gt;<\/td><td>"+this.rte.i18n("Interface designer")+"<\/td><\/tr><tr><td>Tawfek Daghistani &lt;tawfekov@gmail.com&gt;<\/td><td>"+this.rte.i18n("RTL support")+"<\/td><\/tr>"+(this.rte.options.lang!="en"?"<tr><td>"+this.rte.i18n("_translator")+"<\/td><td>"+this.rte.i18n("_translation")+"<\/td><\/tr>":"")+'<\/table><div class="elrte-copy">Copyright &copy; 2009-2011, <a href="http://www.std42.ru">Studio 42<\/a><\/div><div class="elrte-copy">'+this.rte.i18n("For more information about this software visit the")+' <a href="http://elrte.org">'+this.rte.i18n("elRTE website")+'.<\/a><\/div><div class="elrte-copy">Twitter: <a href="http://twitter.com/elrte_elfinder">elrte_elfinder<\/a><\/div>',i=new elDialogForm(r),i.append(u),i.open()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.anchor=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.input=n('<input type="text" />').attr("name","anchor").attr("size","16");var r=this;this.command=function(){var u={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Bookmark")}},i;this.anchor=this.rte.dom.selfOrParentAnchor(this.rte.selection.getEnd())||t.dom.create("a"),this.rte.selection.collapsed()||this.rte.selection.collapse(!1),this.input.val(n(this.anchor).addClass("elrte-anchor").attr("name")),this.rte.selection.saveIERange(),i=new elDialogForm(u),i.append([this.rte.i18n("Bookmark name"),this.input],null,!0).open(),setTimeout(function(){r.input.focus()},20)},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.addClass("disabled"):this.rte.dom.selfOrParentAnchor(n)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.removeClass("disabled").removeClass("active")},this.set=function(){var t=n.trim(this.input.val());t?(this.rte.history.add(),this.anchor.parentNode?(this.anchor.name=t,this.anchor.title=this.rte.i18n("Bookmark")+": "+t):this.rte.selection.insertHtml('<a name="'+t+'" title="'+this.rte.i18n("Bookmark")+": "+t+'" class="elrte-anchor"><\/a>')):this.anchor.parentNode&&(this.rte.history.add(),this.anchor.parentNode.removeChild(this.anchor))}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.blockquote=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i,t;this.rte.history.add(),this.rte.selection.collapsed()&&(i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/))?n(i).replaceWith(n(i).html()):(t=this.rte.selection.selected({wrap:"all",tag:"blockquote"}),t.length&&this.rte.selection.select(t[0],t[t.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.copy=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var t,i,r;if(this.rte.browser.mozilla)try{this.rte.doc.execCommand(this.name,!1,null)}catch(u){t=" Ctl + C",this.name=="cut"?t=" Ctl + X":this.name=="paste"&&(t=" Ctl + V"),i={dialog:{title:this.rte.i18n("Warning"),buttons:{Ok:function(){n(this).dialog("close")}}}},r=new elDialogForm(i),r.append(this.rte.i18n("This operation is disabled in your browser on security reason. Use shortcut instead.")+": "+t).open()}else this.constructor.prototype.command.call(this)}},elRTE.prototype.ui.prototype.buttons.cut=elRTE.prototype.ui.prototype.buttons.copy,elRTE.prototype.ui.prototype.buttons.paste=elRTE.prototype.ui.prototype.buttons.copy}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.css=function(t,i){var r=this;this.constructor.prototype.constructor.call(this,t,i),this.cssStyle=n('<input type="text" size="42" name="style" />'),this.cssClass=n('<input type="text" size="42" name="class" />'),this.elementID=n('<input type="text" size="42" name="id" />'),this.command=function(){var i=this.node(),u,t;this.rte.selection.saveIERange(),i&&(u={submit:function(n,t){n.stopPropagation(),n.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Style"),width:450,resizable:!0,modal:!0}},this.cssStyle.val(n(i).attr("style")),this.cssClass.val(n(i).attr("class")),this.elementID.val(n(i).attr("id")),t=new elDialogForm(u),t.append([this.rte.i18n("Css style"),this.cssStyle],null,!0),t.append([this.rte.i18n("Css class"),this.cssClass],null,!0),t.append([this.rte.i18n("ID"),this.elementID],null,!0),t.open(),setTimeout(function(){r.cssStyle.focus()},20))},this.set=function(){var t=this.node();this.rte.selection.restoreIERange(),t&&(n(t).attr("style",this.cssStyle.val()),n(t).attr("class",this.cssClass.val()),n(t).attr("id",this.elementID.val()),this.rte.ui.update())},this.node=function(){var n=this.rte.selection.getNode();return n.nodeType==3&&(n=n.parentNode),n.nodeType==1&&n.nodeName!="BODY"?n:null},this.update=function(){this.domElem.toggleClass("disabled",this.node()?!1:!0)}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.rtl=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),i=this;n(t).attr("dir")=="rtl"||n(t).parents('[dir="rtl"]').length||n(t).find('[dir="rtl"]').length?(n(t).removeAttr("dir"),n(t).parents('[dir="rtl"]').removeAttr("dir"),n(t).find('[dir="rtl"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?n(t).attr("dir","rtl"):n.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(i.rte.dom.is(r,"block"))return n(r).attr("dir","rtl"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),n(t).attr("dir")=="rtl"||n(t).parents('[dir="rtl"]').length||n(t).find('[dir="rtl"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}},elRTE.prototype.ui.prototype.buttons.ltr=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),i=this;n(t).attr("dir")=="ltr"||n(t).parents('[dir="ltr"]').length||n(t).find('[dir="ltr"]').length?(n(t).removeAttr("dir"),n(t).parents('[dir="ltr"]').removeAttr("dir"),n(t).find('[dir="ltr"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?n(t).attr("dir","ltr"):n.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(i.rte.dom.is(r,"block"))return n(r).attr("dir","ltr"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),n(t).attr("dir")=="ltr"||n(t).parents('[dir="ltr"]').length||n(t).find('[dir="ltr"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.div=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i,t;this.rte.history.add(),this.rte.selection.collapsed()?(i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/),i&&n(i).replaceWith(n(i).html())):(t=this.rte.selection.selected({wrap:"all",tag:"div"}),t.length&&this.rte.selection.select(t[0],t[t.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.docstructure=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){this.domElem.toggleClass("active"),n(this.rte.doc.body).toggleClass("el-rte-structure")},this.command(),this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.elfinder=function(n,t){this.constructor.prototype.constructor.call(this,n,t);var i=this,n=this.rte;this.command=function(){i.rte.options.fmAllow&&typeof i.rte.options.fmOpen=="function"&&i.rte.options.fmOpen(function(t){var i=decodeURIComponent(t.split("/").pop().replace(/\+/g," "));n.selection.collapsed()?n.selection.insertHtml('<a href="'+t+'" >'+i+"<\/a>"):n.doc.execCommand("createLink",!1,t)})},this.update=function(){i.rte.options.fmAllow&&typeof i.rte.options.fmOpen=="function"?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.flash=function(t,r){this.constructor.prototype.constructor.call(this,t,r);var u=this;this.swf=null,this.placeholder=null,this.src={url:n('<input type="text" name="url" />').css("width","99%"),type:n('<select name="type"/>').append('<option value="application/x-shockwave-flash">Flash<\/option>').append('<option value="video/quicktime">Quicktime movie<\/option>').append('<option value="application/x-mplayer2">Windows media<\/option>'),width:n('<input type="text" />').attr("size",5).css("text-align","right"),height:n('<input type="text" />').attr("size",5).css("text-align","right"),wmode:n("<select />").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("transparent").text(this.rte.i18n("Transparent"))),align:n("<select />").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("left").text(this.rte.i18n("Left"))).append(n("<option />").val("right").text(this.rte.i18n("Right"))).append(n("<option />").val("top").text(this.rte.i18n("Top"))).append(n("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(n("<option />").val("middle").text(this.rte.i18n("middle"))).append(n("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(n("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(n("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))),margin:n("<div />")},this.command=function(){var i=this.rte.selection.getEnd(),e="",o="",s="",h,c,v,t,y,a,r,p,w,f;if(this.rte.selection.saveIERange(),this.src.margin.elPaddingInput({type:"margin"}),this.placeholder=null,this.swf=null,n(i).hasClass("elrte-media")&&(v=n(i).attr("rel"))&&this.rte.filter.scripts[v]){if(this.placeholder=n(i),t=this.rte.filter.scripts[v],e="",t.embed&&t.embed.src&&(e=t.embed.src),t.params&&t.params.length)for(l=t.params.length;l--;)(t.params[l].name=="src"||t.params[l].name=="movie")&&(e=t.params[l].value);t.embed?(o=t.embed.width||parseInt(t.embed.style.width)||"",s=t.embed.height||parseInt(t.embed.style.height)||"",y=t.embed.wmode||""):t.obj&&(o=t.obj.width||parseInt(t.obj.style.width)||"",s=t.obj.height||parseInt(t.obj.style.height)||"",y=t.obj.wmode||""),t.obj?(h=t.obj.style.float||"",c=t.obj.style["vertical-align"]||""):t.embed&&(h=t.embed.style.float||"",c=t.embed.style["vertical-align"]||""),this.src.margin.val(i),this.src.type.val(t.embed?t.embed.type:"")}n(i).hasClass("elrte-swf-placeholder")&&(this.placeholder=n(i),e=n(i).attr("rel"),o=parseInt(n(i).css("width"))||"",s=parseInt(n(i).css("height"))||"",h=n(i).css("float"),c=n(i).css("vertical-align"),this.src.margin.val(i),this.src.wmode.val(n(i).attr("wmode"))),this.src.url.val(e),this.src.width.val(o),this.src.height.val(s),this.src.align.val(h||c),this.src.wmode.val(y),a={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),u.set(),t.close()},dialog:{width:580,position:"top",title:this.rte.i18n("Flash")}},r=new elDialogForm(a),p=this.rte.options.fmAllow&&this.rte.options.fmOpen?n("<span />").append(this.src.url.css("width","85%")).append(n("<span />").addClass("ui-state-default ui-corner-all").css({float:"right","margin-right":"3px"}).attr("title",u.rte.i18n("Open file manger")).append(n("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){u.rte.options.fmOpen(function(n){u.src.url.val(n).change()})}).hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")})):this.src.url,r.append([this.rte.i18n("URL"),p],null,!0),r.append([this.rte.i18n("Type"),this.src.type],null,!0),r.append([this.rte.i18n("Size"),n("<span />").append(this.src.width).append(" x ").append(this.src.height).append(" px")],null,!0),r.append([this.rte.i18n("Wmode"),this.src.wmode],null,!0),r.append([this.rte.i18n("Alignment"),this.src.align],null,!0),r.append([this.rte.i18n("Margins"),this.src.margin],null,!0),r.open(),w=n("<fieldset />").append(n("<legend />").text(this.rte.i18n("Preview"))),r.append(w,"main"),f=document.createElement("iframe"),n(f).attr("src","#").addClass("el-rte-preview").appendTo(w),html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><\/head><body style="padding:0;margin:0;font-size:9px"> Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin<\/body><\/html>',f.contentWindow.document.open(),f.contentWindow.document.write(html),f.contentWindow.document.close(),this.frame=f.contentWindow.document,this.preview=n(f.contentWindow.document.body),this.src.type.change(function(){u.src.url.change()}),this.src.width.change(function(){if(u.swf){var t=parseInt(n(this).val())||"";n(this).val(t),u.swf.css("width",t),u.swf.children("embed").css("width",t)}else n(this).val("")}),this.src.height.change(function(){if(u.swf){var t=parseInt(n(this).val())||"";n(this).val(t),u.swf.css("height",t),u.swf.children("embed").css("height",t)}else n(this).val("")}),this.src.wmode.change(function(){if(u.swf){var t=n(this).val();t?(u.swf.attr("wmode",t),u.swf.children("embed").attr("wmode",t)):(u.swf.removeAttr("wmode"),u.swf.children("embed").removeAttr("wmode"))}}),this.src.align.change(function(){var t=n(this).val(),i=t=="left"||t=="right";u.swf?u.swf.css({float:i?t:"","vertical-align":i?"":t}):n(this).val("")}),this.src.margin.change(function(){if(u.swf){var n=u.src.margin.val();n.css?u.swf.css("margin",n.css):(u.swf.css("margin-top",n.top),u.swf.css("margin-right",n.right),u.swf.css("margin-bottom",n.bottom),u.swf.css("margin-left",n.left))}}),this.src.url.change(function(){var i=u.rte.utils.absoluteURL(n(this).val()),t,r;i?(t=u.rte.utils.mediaInfo(u.src.type.val()),t||(t=u.rte.util.mediaInfo("application/x-shockwave-flash")),r='<object classid="'+t.classid+'" codebase="'+t.codebase+'"><param name="src" value="'+i+'" /><embed quality="high" src="'+i+'" type="'+t.type+'"><\/object>',u.preview.children("object").remove().end().prepend(r),u.swf=u.preview.children("object").eq(0)):u.swf&&(u.swf.remove(),u.swf=null),u.src.width.trigger("change"),u.src.height.trigger("change"),u.src.align.trigger("change")}).trigger("change")},this.set=function(){var l,p;u.swf=null;var f=this.rte.utils.absoluteURL(this.src.url.val()),o=parseInt(this.src.width.val())||"",s=parseInt(this.src.height.val())||"",w=this.src.wmode.val(),r=this.src.align.val(),h=r=="left"||r=="right"?r:"",c=this.placeholder?this.placeholder.attr("rel"):"",t,a,v,e=this.src.margin.val(),y;f?(i=u.rte.utils.mediaInfo(u.src.type.val()),i||(i=u.rte.util.mediaInfo("application/x-shockwave-flash")),v=this.rte.filter.videoHostRegExp.test(f)?f.replace(this.rte.filter.videoHostRegExp,"$2"):i.type.replace(/^\w+\/(.+)/,"$1"),t={obj:{classid:i.classid[0],codebase:i.codebase,style:{}},params:[{name:"src",value:f}],embed:{src:f,type:i.type,quality:"high",wmode:w,style:{}}},o&&(t.obj.width=o,t.embed.width=o),s&&(t.obj.height=s,t.embed.height=s),h?t.obj.style.float=h:r&&(t.obj.style["vertical-align"]=r),y=e.css?{margin:e.css}:{"margin-top":e.top,"margin-right":e.right,"margin-bottom":e.bottom,"margin-left":e.left},t.obj.style=n.extend({},t.obj.style,y),this.placeholder&&c?(a=this.rte.filter.scripts[c]||{},t=n.extend(!0,a,t),delete t.obj.style.width,delete t.obj.style.height,delete t.embed.style.width,delete t.embed.style.height,this.rte.filter.scripts[c]=t,this.placeholder.removeAttr("class")):(l="media"+Math.random().toString().substring(2),this.rte.filter.scripts[l]=t,this.placeholder=n(this.rte.dom.create("img")).attr("rel",l).attr("src",this.rte.filter.url+"pixel.gif"),p=!0),this.placeholder.attr("title",this.rte.utils.encode(f)).attr("width",o||150).attr("height",s||100).addClass("elrte-protected elrte-media elrte-media-"+v).css(t.obj.style),h?this.placeholder.css("float",h).css("vertical-align",""):r?this.placeholder.css("float","").css("vertical-align",r):this.placeholder.css("float","").css("vertical-align",""),p&&(this.rte.window.focus(),this.rte.selection.restoreIERange(),this.rte.selection.insertNode(this.placeholder.get(0)))):this.placeholder&&(this.placeholder.remove(),delete this.rte.filter.scripts[c])},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.domElem.toggleClass("active",t&&t.nodeName=="IMG"&&n(t).hasClass("elrte-media"))}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fontname=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var u=this,r={tpl:'<span style="font-family:%val">%label<\/span>',select:function(n){u.set(n)},src:{"":this.rte.i18n("Font"),"andale mono,sans-serif":"Andale Mono","arial,helvetica,sans-serif":"Arial","arial black,gadget,sans-serif":"Arial Black","book antiqua,palatino,sans-serif":"Book Antiqua","comic sans ms,cursive":"Comic Sans MS","courier new,courier,monospace":"Courier New","georgia,palatino,serif":"Georgia","helvetica,sans-serif":"Helvetica","impact,sans-serif":"Impact","lucida console,monaco,monospace":"Lucida console","lucida sans unicode,lucida grande,sans-serif":"Lucida grande","tahoma,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,lucida grande,verdana,sans-serif":"Trebuchet MS","verdana,geneva,sans-serif":"Verdana"}};this.select=this.domElem.elSelect(r),this.command=function(){},this.set=function(t){this.rte.history.add();var i=this.rte.selection.selected({filter:"textContainsNodes"});n.each(i,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?n(this).find("td,th"):n(this),n(this).css("font-family",t).find("[style]").css("font-family","")}),this.rte.ui.update()},this.update=function(){var i,t;this.domElem.removeClass("disabled"),i=this.rte.selection.getNode(),i.nodeType!=1&&(i=i.parentNode),t=n(i).css("font-family"),t=t?t.toString().toLowerCase().replace(/,\s+/g,",").replace(/'|"/g,""):"",this.select.val(r.src[t]?t:"")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fontsize=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this,u={labelTpl:"%label",tpl:'<span style="font-size:%val;line-height:1.2em">%label<\/span>',select:function(n){r.set(n)},src:{"":this.rte.i18n("Font size"),"xx-small":this.rte.i18n("Small (8pt)"),"x-small":this.rte.i18n("Small (10px)"),small:this.rte.i18n("Small (12pt)"),medium:this.rte.i18n("Normal (14pt)"),large:this.rte.i18n("Large (18pt)"),"x-large":this.rte.i18n("Large (24pt)"),"xx-large":this.rte.i18n("Large (36pt)")}};this.select=this.domElem.elSelect(u),this.command=function(){},this.set=function(t){this.rte.history.add();var i=this.rte.selection.selected({filter:"textContainsNodes"});n.each(i,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?n(this).find("td,th"):n(this),$this.css("font-size",t).find("[style]").css("font-size","")}),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var n=this.rte.selection.getNode();this.select.val((m=this.rte.dom.attr(n,"style").match(/font-size:\s*([^;]+)/i))?m[1]:"")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.forecolor=function(t,i){var r=this,u;this.constructor.prototype.constructor.call(this,t,i),u={"class":"",palettePosition:"outer",color:this.defaultColor,update:function(n){r.indicator.css("background-color",n)},change:function(n){r.set(n)}},this.defaultColor=this.name=="forecolor"?"#000000":"#ffffff",this.picker=this.domElem.elColorPicker(u),this.indicator=n("<div />").addClass("color-indicator").prependTo(this.domElem),this.command=function(){},this.set=function(t){if(!this.rte.selection.collapsed()){this.rte.history.add();var r=this.rte.selection.selected({collapse:!1,wrap:"text"}),i=this.name=="forecolor"?"color":"background-color";n.each(r,function(){/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)?n(this).find("td,th").each(function(){n(this).css(i,t).find("*").css(i,"")}):n(this).css(i,t).find("*").css(i,"")}),this.rte.ui.update(!0)}},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.picker.val(this.rte.utils.rgb2hex(n(t.nodeType!=1?t.parentNode:t).css(this.name=="forecolor"?"color":"background-color"))||this.defaultColor)}},elRTE.prototype.ui.prototype.buttons.hilitecolor=elRTE.prototype.ui.prototype.buttons.forecolor}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.formatblock=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var f=this.rte.browser.msie?function(n){r.val=n,r.constructor.prototype.command.call(r)}:function(n){r.ieCommand(n)},r=this,u={labelTpl:"%label",tpls:{"":"%label"},select:function(n){r.formatBlock(n)},src:{span:this.rte.i18n("Format"),h1:this.rte.i18n("Heading 1"),h2:this.rte.i18n("Heading 2"),h3:this.rte.i18n("Heading 3"),h4:this.rte.i18n("Heading 4"),h5:this.rte.i18n("Heading 5"),h6:this.rte.i18n("Heading 6"),p:this.rte.i18n("Paragraph"),address:this.rte.i18n("Address"),pre:this.rte.i18n("Preformatted"),div:this.rte.i18n("Normal (DIV)")}};this.select=this.domElem.elSelect(u),this.command=function(){},this.formatBlock=function(t){function h(t,i){function u(t){return n(t).find("h1,h2,h3,h4,h5,h6,p,address,pre").each(function(){n(this).replaceWith(n(this).html())}),t}/^(LI|DT|DD|TD|TH|CAPTION)$/.test(t.nodeName)?r.rte.dom.isEmpty(t)||r.rte.dom.wrapContents(u(t),i):/^(UL|OL|DL|TABLE)$/.test(t.nodeName)?r.rte.dom.wrap(t,i):r.rte.dom.isEmpty(t)||n(u(t)).replaceWith(n(r.rte.dom.create(i)).html(n(t).html()))}this.rte.history.add();var u=t.toUpperCase(),i,o,a=this.rte.selection.collapsed(),c=this.rte.selection.getBookmark(),f=this.rte.selection.selected({collapsed:!0,blocks:!0,filter:"textContainsNodes",wrap:"inline",tag:"span"});for(l=f.length,s=n(f[0]).prev(),e=n(f[f.length-1]).next();l--;)i=f[l],o=n(i),u=="DIV"||u=="SPAN"?/^(H[1-6]|P|ADDRESS|PRE)$/.test(i.nodeName)&&o.replaceWith(n(this.rte.dom.create("div")).html(o.html()||"")):/^(THEAD|TBODY|TFOOT|TR)$/.test(i.nodeName)?o.find("td,th").each(function(){h(this,u)}):i.nodeName!=u&&h(i,u);this.rte.selection.moveToBookmark(c),this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled");var n=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(H[1-6]|P|ADDRESS|PRE)$/);this.select.val(n?n.nodeName.toLowerCase():"span")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fullscreen=function(t,i){function u(){r.wz.height(n(window).height()-r.delta),r.rte.updateHeight()}var r=this;this.constructor.prototype.constructor.call(this,t,i),this.active=!0,this.editor=t.editor,this.wz=t.workzone,this.height=0,this.delta=0,this._class="el-fullscreen",setTimeout(function(){r.height=r.wz.height(),r.delta=r.editor.outerHeight()-r.height},50),this.command=function(){function v(){c&&(l=h.getBookmark())}function y(){c&&(r.wz.children().toggle(),r.rte.source.focus(),r.wz.children().toggle(),h.moveToBookmark(l))}var i=n(window),t=this.editor,a=t.parents().filter(function(t,i){return!/^(html|body)$/i.test(i.nodeName)&&n(i).css("position")=="relative"}),o=this.wz,f=this._class,e=t.hasClass(f),s=this.rte,h=this.rte.selection,c=n.browser.mozilla,l;v(),a.css("position",e?"relative":"static"),e?(t.removeClass(f),o.height(this.height),i.unbind("resize",u),this.domElem.removeClass("active")):(t.addClass(f).removeAttr("style"),o.height(i.height()-this.delta).css("width","100%"),i.bind("resize",u),this.domElem.addClass("active")),s.updateHeight(),s.resizable(e),y()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.horizontalrule=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src={width:n('<input type="text" />').attr({name:"width",size:4}).css("text-align","right"),wunit:n("<select />").attr("name","wunit").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")).val("%"),height:n('<input type="text" />').attr({name:"height",size:4}).css("text-align","right"),bg:n("<div />"),border:n("<div />"),"class":n('<input type="text" />').css("width","100%"),style:n('<input type="text" />').css("width","100%")},this.command=function(){var i,u,f,e;this.src.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),i=this.rte.selection.getEnd(),this.hr=i.nodeName=="HR"?n(i):n(t.doc.createElement("hr")).css({width:"100%",height:"1px"}),this.src.border.elBorderSelect({styleHeight:73,value:this.hr}),u=this.hr.css("width")||this.hr.attr("width"),this.src.width.val(parseInt(u)||100),this.src.wunit.val(u.indexOf("px")!=-1?"px":"%"),this.src.height.val(this.rte.utils.toPixels(this.hr.css("height")||this.hr.attr("height"))||1),this.src.bg.val(this.rte.utils.color2Hex(this.hr.css("background-color"))),this.src["class"].val(this.rte.dom.attr(this.hr,"class")),this.src.style.val(this.rte.dom.attr(this.hr,"style")),f={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{title:this.rte.i18n("Horizontal rule")}},e=new elDialogForm(f),e.append([this.rte.i18n("Width"),n("<span />").append(this.src.width).append(this.src.wunit)],null,!0).append([this.rte.i18n("Height"),n("<span />").append(this.src.height).append(" px")],null,!0).append([this.rte.i18n("Border"),this.src.border],null,!0).append([this.rte.i18n("Background"),this.src.bg],null,!0).append([this.rte.i18n("Css class"),this.src["class"]],null,!0).append([this.rte.i18n("Css style"),this.src.style],null,!0).open()},this.update=function(){this.domElem.removeClass("disabled"),this.rte.selection.getEnd().nodeName=="HR"?this.domElem.addClass("active"):this.domElem.removeClass("active")},this.set=function(){this.rte.history.add(),this.hr.parentNode||this.rte.selection.insertNode(this.hr.get(0));var t={noshade:!0,style:this.src.style.val()},n=this.src.border.val(),i={width:(parseInt(this.src.width.val())||100)+this.src.wunit.val(),height:parseInt(this.src.height.val())||1,"background-color":this.src.bg.val(),border:n.width&&n.style?n.width+" "+n.style+" "+n.color:""};this.hr.removeAttr("class").removeAttr("style").removeAttr("width").removeAttr("height").removeAttr("align").attr(t).css(i),this.src["class"].val()&&this.hr.attr("class",this.src["class"].val()),this.rte.ui.update()}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.image=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this,t=r.rte,o=0,u=0,f=0,e=null,s=function(t){n.each(r.src,function(i,r){n.each(r,function(n,i){n=="src"&&t||i.val("")})})},h=function(i){n.each(r.src,function(r,u){n.each(u,function(n,u){var f,o,s,e;n=="width"?f=i.width():n=="height"?f=i.height():n=="border"?(f="",e=i.css("border")||t.utils.parseStyle(i.attr("style")).border||"",e&&(o=e.match(/(\d(px|em|%))/),s=e.match(/(#[a-z0-9]+)/),f={width:o?o[1]:e,style:e,color:t.utils.color2Hex(s?s[1]:e)})):n=="margin"?f=i:n=="align"?(f=i.css("float"),f!="left"&&f!="right"&&(f=i.css("vertical-align"))):f=i.attr(n)||"",r=="events"&&(f=t.utils.trimEventCallback(f)),u.val(f)})})},l=function(){var t=r.src.main.src.val();s(!0),t?(r.prevImg?(r.prevImg.removeAttr("src").removeAttr("style").removeAttr("class").removeAttr("id").removeAttr("title").removeAttr("alt").removeAttr("longdesc"),n.each(r.src.events,function(n){r.prevImg.removeAttr(n)})):r.prevImg=n("<img/>").prependTo(r.preview),r.prevImg.load(function(){r.prevImg.unbind("load"),setTimeout(function(){u=r.prevImg.width(),f=r.prevImg.height(),o=(u/f).toFixed(2),r.src.main.width.val(u),r.src.main.height.val(f)},100)}).attr("src",t)):(r.preview.children("img").remove(),r.prevImg=null)},c=function(n){var t=parseInt(r.src.main.width.val())||0,i=parseInt(r.src.main.height.val())||0;r.prevImg&&(t&&i?n.target===r.src.main.width[0]?i=parseInt(t/o):t=parseInt(i*o):(t=u,i=f),r.src.main.height.val(i),r.src.main.width.val(t),r.prevImg.width(t).height(i),r.src.adv.style.val(r.prevImg.attr("style")))};this.img=null,this.prevImg=null,this.preview=n('<div class="elrte-image-preview"/>').text("Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin"),this.init=function(){this.labels={main:"Properies",link:"Link",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",longdesc:"Detail description URL",href:"URL",target:"Open in",title:"Title"},this.src={main:{src:n('<input type="text" />').css("width","100%").change(l),title:n('<input type="text" />').css("width","100%"),alt:n('<input type="text" />').css("width","100%"),width:n('<input type="text" />').attr("size",5).css("text-align","right").change(c),height:n('<input type="text" />').attr("size",5).css("text-align","right").change(c),margin:n("<div />").elPaddingInput({type:"margin",change:function(){var n=r.src.main.margin.val();r.prevImg&&(n.css?r.prevImg.css("margin",n.css):r.prevImg.css({"margin-left":n.left,"margin-top":n.top,"margin-right":n.right,"margin-bottom":n.bottom}))}}),align:n("<select />").css("width","100%").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("left").text(this.rte.i18n("Left"))).append(n("<option />").val("right").text(this.rte.i18n("Right"))).append(n("<option />").val("top").text(this.rte.i18n("Top"))).append(n("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(n("<option />").val("middle").text(this.rte.i18n("middle"))).append(n("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(n("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(n("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))).change(function(){var t=n(this).val(),i={float:"","vertical-align":""};r.prevImg&&(t=="left"||t=="right"?(i.float=t,i["vertical-align"]=""):t&&(i.float="",i["vertical-align"]=t),r.prevImg.css(i))}),border:n("<div />").elBorderSelect({name:"border",change:function(){var n=r.src.main.border.val();r.prevImg&&r.prevImg.css("border",n.width?n.width+" "+n.style+" "+n.color:"")}})},adv:{},events:{}},n.each(["id","class","style","longdesc"],function(t,i){r.src.adv[i]=n('<input type="text" style="width:100%" />')}),this.src.adv["class"].change(function(){r.prevImg&&r.prevImg.attr("class",n(this).val())}),this.src.adv.style.change(function(){r.prevImg&&(r.prevImg.attr("style",n(this).val()),h(r.prevImg))}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text"  style="width:100%"/>')})},this.command=function(){this.src||this.init();var c,v={rtl:t.rtl,submit:function(n){n.stopPropagation(),n.preventDefault(),r.set(),i.close()},close:function(){e&&t.selection.moveToBookmark(e)},dialog:{autoOpen:!1,width:500,position:"top",title:t.i18n("Image"),resizable:!0,open:function(){n.fn.resizable&&n(this).parents(".ui-dialog:first").resizable("option","alsoResize",".elrte-image-preview")}}},i=new elDialogForm(v),l=!!t.options.fmOpen,a=l?n('<div class="elrte-image-src-fm"><span class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-folder-open"/><\/span><\/div>').append(this.src.main.src.css("width","87%")):this.src.main.src;s(),this.preview.children("img").remove(),this.prevImg=null,c=t.selection.getEnd(),this.img=c.nodeName=="IMG"&&!n(c).is(".elrte-protected")?n(c):n("<img/>"),e=t.selection.getBookmark(),l&&a.children(".ui-state-default").click(function(){t.options.fmOpen(function(n){r.src.main.src.val(n).change()})}).hover(function(){n(this).toggleClass("ui-state-hover")}),i.tab("main",this.rte.i18n("Properies")).append([this.rte.i18n("Image URL"),a],"main",!0).append([this.rte.i18n("Title"),this.src.main.title],"main",!0).append([this.rte.i18n("Alt text"),this.src.main.alt],"main",!0).append([this.rte.i18n("Size"),n("<span />").append(this.src.main.width).append(" x ").append(this.src.main.height).append(" px")],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0),i.append(n("<fieldset><legend>"+this.rte.i18n("Preview")+"<\/legend><\/fieldset>").append(this.preview),"main"),n.each(this.src,function(u,f){u!="main"&&(i.tab(u,t.i18n(r.labels[u])),n.each(f,function(n){r.src[u][n].val(u=="events"?t.utils.trimEventCallback(r.img.attr(n)):r.img.attr(n)||""),i.append([t.i18n(r.labels[n]||n),r.src[u][n]],u,!0)}))}),i.open(),this.img.attr("src")&&(h(this.img),this.prevImg=this.img.clone().prependTo(this.preview),o=(this.img.width()/this.img.height()).toFixed(2),u=parseInt(this.img.width()),f=parseInt(this.img.height()))},this.set=function(){var u=this.src.main.src.val(),i;if(this.rte.history.add(),e&&t.selection.moveToBookmark(e),!u)return i=t.dom.selfOrParentLink(this.img[0]),i&&i.remove(),this.img.remove();this.img[0].parentNode||(this.img=n(this.rte.doc.createElement("img"))),this.img.attr("src",u).attr("style",this.src.adv.style.val()),n.each(this.src,function(t,i){n.each(i,function(t,i){var u=i.val();switch(t){case"width":r.img.css("width",u);break;case"height":r.img.css("height",u);break;case"align":r.img.css(u=="left"||u=="right"?"float":"vertical-align",u);break;case"margin":u.css?r.img.css("margin",u.css):r.img.css({"margin-left":u.left,"margin-top":u.top,"margin-right":u.right,"margin-bottom":u.bottom});break;case"border":if(u.width){u="border:"+u.css+";"+n.trim((r.img.attr("style")||"").replace(/border\-[^;]+;?/ig,"")),t="style",r.img.attr("style",u);return}u="";break;case"src":case"style":return;default:u?r.img.attr(t,u):r.img.removeAttr(t)}})}),this.img[0].parentNode||t.selection.insertNode(this.img[0]),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getEnd(),i=n(t);t.nodeName!="IMG"||i.hasClass("elrte-protected")?this.domElem.removeClass("active"):this.domElem.addClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.indent=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){function f(t){var i=/(IMG|HR|TABLE|EMBED|OBJECT)/.test(t.nodeName)?"margin-left":"padding-left",u=r.rte.dom.attr(t,"style").indexOf(i)!=-1?parseInt(n(t).css(i))||0:0;n(t).css(i,u+40+"px")}var i,t,u;for(this.rte.history.add(),i=this.rte.selection.selected({collapsed:!0,blocks:!0,wrap:"inline",tag:"p"}),t=0;t<i.length;t++)/^(TABLE|THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(i[t].nodeName)?n(i[t]).find("td,th").each(function(){f(this)}):/^LI$/.test(i[t].nodeName)?(u=n(i[t]),n(this.rte.dom.create(i[t].parentNode.nodeName)).append(n(this.rte.dom.create("li")).html(u.html()||"")).appendTo(u.html("&nbsp;"))):f(i[t]);this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.justifyleft=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.align=this.name=="justifyfull"?"justify":this.name.replace("justify",""),this.command=function(){var i=this.rte.selection.selected({collapsed:!0,blocks:!0,tag:"div"}),t=i.length;for(t&&this.rte.history.add();t--;)this.rte.dom.filter(i[t],"textNodes")&&n(i[t]).css("text-align",this.align);this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode(),i=t.nodeName=="BODY"?t:this.rte.dom.selfOrParent(t,"textNodes")||(t.parentNode&&t.parentNode.nodeName=="BODY"?t.parentNode:null);i?this.domElem.removeClass("disabled").toggleClass("active",n(i).css("text-align")==this.align):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.justifycenter=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyright=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyfull=elRTE.prototype.ui.prototype.buttons.justifyleft}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.link=function(t,i){function u(){r.labels={id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language",charset:"Charset",type:"Target MIME type",rel:"Relationship page to target (rel)",rev:"Relationship target to page (rev)",tabindex:"Tab index",accesskey:"Access key"},r.src={main:{href:n('<input type="text" />'),title:n('<input type="text" />'),anchor:n("<select />").attr("name","anchor"),target:n("<select />").append(n("<option />").text(r.rte.i18n("In this window")).val("")).append(n("<option />").text(r.rte.i18n("In new window (_blank)")).val("_blank"))},popup:{use:n('<input type="checkbox" />'),url:n('<input type="text" />').val("http://"),name:n('<input type="text" />'),width:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Width")}).css("text-align","right"),height:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Height")}).css("text-align","right"),left:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Left")}).css("text-align","right"),top:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Top")}).css("text-align","right"),location:n('<input type="checkbox" />'),menubar:n('<input type="checkbox" />'),toolbar:n('<input type="checkbox" />'),scrollbars:n('<input type="checkbox" />'),status:n('<input type="checkbox" />'),resizable:n('<input type="checkbox" />'),dependent:n('<input type="checkbox" />'),retfalse:n('<input type="checkbox" />').attr("checked",!0)},adv:{id:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />'),charset:n('<input type="text" />'),type:n('<input type="text" />'),rel:n('<input type="text" />'),rev:n('<input type="text" />'),tabindex:n('<input type="text" />'),accesskey:n('<input type="text" />')},events:{}},n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />')}),n.each(r.src,function(){var n,t;for(n in this)t=this[n].attr("type"),t&&(t!="text"||this[n].attr("size"))||this[n].css("width","100%")})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.img=!1,this.bm,this.command=function(){function c(n){return n.nodeName=="A"&&n.href}var t=this.rte.selection.getNode(),i,f,l,a,v,e,s,h,o;if(this.src||u(),this.bm=this.rte.selection.getBookmark(),this.link=this.rte.dom.selfOrParentLink(t),!this.link&&(i=n.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1}),i.length)){for(f=0;f<i.length;f++)if(c(i[f])){this.link=i[f];break}this.link||(this.link=this.rte.dom.parent(i[0],c)||this.rte.dom.parent(i[i.length-1],c))}this.link=this.link?n(this.link):n(this.rte.doc.createElement("a")),this.img=t.nodeName=="IMG"?t:null,this.updatePopup(),this.src.main.anchor.empty(),n('a[href!=""][name]',this.rte.doc).each(function(){var t=n(this).attr("name");r.src.main.anchor.append(n("<option />").val(t).text(t))}),this.src.main.anchor.children().length&&this.src.main.anchor.prepend(n("<option />").val("").text(this.rte.i18n("Select bookmark"))).change(function(){var t=n(this).val();t&&r.src.main.href.val("#"+t)}),l={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},tabs:{show:function(n,t){t.index==3&&r.updateOnclick()}},close:function(){r.rte.browser.msie&&r.rte.selection.restoreIERange()},dialog:{width:"auto",width:430,title:this.rte.i18n("Link")}},d=new elDialogForm(l),a=n("<div />").append(n("<label />").append(this.src.popup.location).append(this.rte.i18n("Location bar"))).append(n("<label />").append(this.src.popup.menubar).append(this.rte.i18n("Menu bar"))).append(n("<label />").append(this.src.popup.toolbar).append(this.rte.i18n("Toolbar"))).append(n("<label />").append(this.src.popup.scrollbars).append(this.rte.i18n("Scrollbars"))),v=n("<div />").append(n("<label />").append(this.src.popup.status).append(this.rte.i18n("Status bar"))).append(n("<label />").append(this.src.popup.resizable).append(this.rte.i18n("Resizable"))).append(n("<label />").append(this.src.popup.dependent).append(this.rte.i18n("Depedent"))).append(n("<label />").append(this.src.popup.retfalse).append(this.rte.i18n("Add return false"))),d.tab("main",this.rte.i18n("Properies")).tab("popup",this.rte.i18n("Popup")).tab("adv",this.rte.i18n("Advanced")).tab("events",this.rte.i18n("Events")).append(n("<label />").append(this.src.popup.use).append(this.rte.i18n("Open link in popup window")),"popup").separator("popup").append([this.rte.i18n("URL"),this.src.popup.url],"popup",!0).append([this.rte.i18n("Window name"),this.src.popup.name],"popup",!0).append([this.rte.i18n("Window size"),n("<span />").append(this.src.popup.width).append(" x ").append(this.src.popup.height).append(" px")],"popup",!0).append([this.rte.i18n("Window position"),n("<span />").append(this.src.popup.left).append(" x ").append(this.src.popup.top).append(" px")],"popup",!0).separator("popup").append([a,v],"popup",!0),e=this.link.get(0),s=this.rte.dom.attr(e,"href"),this.src.main.href.val(s).change(function(){n(this).val(r.rte.utils.absoluteURL(n(this).val()))}),this.rte.options.fmAllow&&this.rte.options.fmOpen?(h=n("<span />").append(this.src.main.href.css("width","87%")).append(n("<span />").addClass("ui-state-default ui-corner-all").css({float:"right","margin-right":"3px"}).attr("title",r.rte.i18n("Open file manger")).append(n("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){r.rte.options.fmOpen(function(n){r.src.main.href.val(n).change()})}).hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")})),d.append([this.rte.i18n("Link URL"),h],"main",!0)):d.append([this.rte.i18n("Link URL"),this.src.main.href],"main",!0),this.src.main.href.change(),d.append([this.rte.i18n("Title"),this.src.main.title.val(this.rte.dom.attr(e,"title"))],"main",!0),this.src.main.anchor.children().length&&d.append([this.rte.i18n("Bookmark"),this.src.main.anchor.val(s)],"main",!0),this.rte.options.doctype.match(/xhtml/)&&this.rte.options.doctype.match(/strict/)||d.append([this.rte.i18n("Target"),this.src.main.target.val(this.link.attr("target")||"")],"main",!0);for(t in this.src.adv)this.src.adv[t].val(this.rte.dom.attr(e,t)),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.adv[t]],"adv",!0);for(t in this.src.events)o=this.rte.utils.trimEventCallback(this.rte.dom.attr(e,t)),this.src.events[t].val(o),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.events[t]],"events",!0);this.src.popup.use.change(function(){var t=n(this).attr("checked");n.each(r.src.popup,function(){n(this).attr("name")!="use"&&(t?n(this).removeAttr("disabled"):n(this).attr("disabled",!0))})}),this.src.popup.use.change(),d.open()},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(n){return n.nodeName=="A"&&n.href})?this.domElem.removeClass("disabled").addClass("active"):this.rte.selection.collapsed()&&n.nodeName!="IMG"?this.domElem.addClass("disabled").removeClass("active"):this.domElem.removeClass("disabled active")},this.updatePopup=function(){var t=""+this.link.attr("onclick");t.length>0&&(m=t.match(/window.open\('([^']+)',\s*'([^']*)',\s*'([^']*)'\s*.*\);\s*(return\s+false)?/))?(this.src.popup.use.attr("checked","on"),this.src.popup.url.val(m[1]),this.src.popup.name.val(m[2]),/location=yes/.test(m[3])&&this.src.popup.location.attr("checked",!0),/menubar=yes/.test(m[3])&&this.src.popup.menubar.attr("checked",!0),/toolbar=yes/.test(m[3])&&this.src.popup.toolbar.attr("checked",!0),/scrollbars=yes/.test(m[3])&&this.src.popup.scrollbars.attr("checked",!0),/status=yes/.test(m[3])&&this.src.popup.status.attr("checked",!0),/resizable=yes/.test(m[3])&&this.src.popup.resizable.attr("checked",!0),/dependent=yes/.test(m[3])&&this.src.popup.dependent.attr("checked",!0),(_m=m[3].match(/width=([^,]+)/))&&this.src.popup.width.val(_m[1]),(_m=m[3].match(/height=([^,]+)/))&&this.src.popup.height.val(_m[1]),(_m=m[3].match(/left=([^,]+)/))&&this.src.popup.left.val(_m[1]),(_m=m[3].match(/top=([^,]+)/))&&this.src.popup.top.val(_m[1]),m[4]&&this.src.popup.retfalse.attr("checked",!0)):n.each(this.src.popup,function(){var t=n(this);t.attr("type")=="text"?t.val(t.attr("name")=="url"?"http://":""):t.attr("name")=="retfalse"?this.attr("checked",!0):t.removeAttr("checked")})},this.updateOnclick=function(){var r=this.src.popup.url.val(),t,u,f,i;this.src.popup.use.attr("checked")&&r?(t="",this.src.popup.location.attr("checked")&&(t+="location=yes,"),this.src.popup.menubar.attr("checked")&&(t+="menubar=yes,"),this.src.popup.toolbar.attr("checked")&&(t+="toolbar=yes,"),this.src.popup.scrollbars.attr("checked")&&(t+="scrollbars=yes,"),this.src.popup.status.attr("checked")&&(t+="status=yes,"),this.src.popup.resizable.attr("checked")&&(t+="resizable=yes,"),this.src.popup.dependent.attr("checked")&&(t+="dependent=yes,"),this.src.popup.width.val()&&(t+="width="+this.src.popup.width.val()+","),this.src.popup.height.val()&&(t+="height="+this.src.popup.height.val()+","),this.src.popup.left.val()&&(t+="left="+this.src.popup.left.val()+","),this.src.popup.top.val()&&(t+="top="+this.src.popup.top.val()+","),t.length>0&&(t=t.substring(0,t.length-1)),u=this.src.popup.retfalse.attr("checked")?"return false;":"",f="window.open('"+r+"', '"+n.trim(this.src.popup.name.val())+"', '"+t+"'); "+u,this.src.events.onclick.val(f),this.src.main.href.val()||this.src.main.href.val("#")):(i=this.src.events.onclick.val(),i=i.replace(/window\.open\([^\)]+\)\s*;?\s*return\s*false\s*;?/i,""),this.src.events.onclick.val(i))},this.set=function(){var i,u,e,r,t,f;if(this.updateOnclick(),this.rte.selection.moveToBookmark(this.bm),this.rte.history.add(),i=this.rte.utils.absoluteURL(this.src.main.href.val()),i){this.img&&this.img.parentNode?(this.link=n(this.rte.dom.create("a")).attr("href",i),this.rte.dom.wrap(this.img,this.link[0])):this.link[0].parentNode||(u="#--el-editor---"+Math.random(),this.rte.doc.execCommand("createLink",!1,u),this.link=n('a[href="'+u+'"]',this.rte.doc),this.link.each(function(){var t=n(this);n.trim(t.html())||n.trim(t.text())||t.replaceWith(t.text())})),this.src.main.href.val(i);for(r in this.src)if(r!="popup")for(t in this.src[r])t!="anchors"&&(f=n.trim(this.src[r][t].val()),f?this.link.attr(t,f):this.link.removeAttr(t));this.img&&this.rte.selection.select(this.img)}else e=this.rte.selection.getBookmark(),this.rte.dom.unwrap(this.link[0]),this.rte.selection.moveToBookmark(e);this.rte.ui.update(!0)}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.nbsp=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){this.rte.history.add(),this.rte.selection.insertHtml("&nbsp;",!0),this.rte.window.focus(),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.outdent=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.find();t.node&&(this.rte.history.add(),n(t.node).css(t.type,(t.val>40?t.val-40:0)+"px"),this.rte.ui.update())},this.find=function(t){function u(t){var i={type:"",val:0},u;return(u=r.rte.dom.attr(t,"style"))&&(i.type=u.indexOf("padding-left")!=-1?"padding-left":u.indexOf("margin-left")!=-1?"margin-left":"",i.val=i.type?parseInt(n(t).css(i.type))||0:0),i}var t=this.rte.selection.getNode(),i=u(t);return i.val?i.node=t:n.each(this.rte.dom.parents(t,"*"),function(){return i=u(this),i.val?(i.node=this,i):void 0}),i},this.update=function(){var n=this.find();n.node?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pagebreak=function(t,i){this.constructor.prototype.constructor.call(this,t,i),n(this.rte.doc.body).bind("mousedown",function(t){n(t.target).hasClass("elrte-pagebreak")&&t.preventDefault()}),this.command=function(){this.rte.selection.insertHtml('<img src="'+this.rte.filter.url+'pixel.gif" class="elrte-protected elrte-pagebreak"/>',!1)},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pasteformattext=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.iframe=n(document.createElement("iframe")).addClass("el-rte-paste-input"),this.doc=null;var r=this;this.command=function(){this.rte.selection.saveIERange();var n=this,t={submit:function(t,i){t.stopPropagation(),t.preventDefault(),n.paste(),i.close()},dialog:{width:500,title:this.rte.i18n("Paste formatted text")}},i=new elDialogForm(t);if(i.append(this.iframe).open(),this.doc=this.iframe.get(0).contentWindow.document,html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',html+="<\/head><body> <br /> <\/body><\/html>",this.doc.open(),this.doc.write(html),this.doc.close(),this.rte.browser.msie)this.doc.body.contentEditable=!0;else try{this.doc.designMode="on"}catch(r){}setTimeout(function(){n.iframe[0].contentWindow.focus()},50)},this.paste=function(){n(this.doc.body).find("[class]").removeAttr("class");var t=n.trim(n(this.doc.body).html());t&&(this.rte.history.add(),this.rte.selection.restoreIERange(),this.rte.selection.insertHtml(this.rte.filter.wysiwyg2wysiwyg(this.rte.filter.proccess("paste",t))),this.rte.ui.update(!0))},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pastetext=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.input=n("<textarea />").addClass("el-rte-paste-input");var r=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var n={submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.paste(),t.close()},dialog:{width:500,title:this.rte.i18n("Paste only text")}},t=new elDialogForm(n);t.append(this.input).open()},this.paste=function(){var t=n.trim(this.input.val());t&&(this.rte.history.add(),this.rte.browser.msie&&this.rte.selection.restoreIERange(),this.rte.selection.insertText(t.replace(/\r?\n/g,"<br />"),!0),this.rte.ui.update(!0)),this.input.val("")},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.save=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.active=!0,this.command=function(){this.rte.save()},this.update=function(){}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.smiley=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.img=null,this.url=this.rte.filter.url+"smileys/",this.smileys={smile:"smile.png",happy:"happy.png",tongue:"tongue.png",surprised:"surprised.png",waii:"waii.png",wink:"wink.png",evilgrin:"evilgrin.png",grin:"grin.png",unhappy:"unhappy.png"},this.width=120,this.command=function(){var r=this,u=this.url,t,i;this.rte.browser.msie&&this.rte.selection.saveIERange(),i={dialog:{height:120,width:this.width,title:this.rte.i18n("Smiley"),buttons:{}}},t=new elDialogForm(i),n.each(this.smileys,function(i,f){t.append(n('<img src="'+u+f+'" title="'+i+'" id="'+i+'" class="el-rte-smiley"/>').click(function(){r.set(this.id,t)}))}),t.open()},this.update=function(){this.domElem.removeClass("disabled"),this.domElem.removeClass("active")},this.set=function(t,i){this.rte.browser.msie&&this.rte.selection.restoreIERange(),this.smileys[t]&&(this.img=n(this.rte.doc.createElement("img")),this.img.attr({src:this.url+this.smileys[t],title:t,alt:t}),this.rte.selection.insertNode(this.img.get(0)),this.rte.ui.update()),i.close()}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.stopfloat=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.find=function(){if(this.rte.selection.collapsed()){var t=this.rte.dom.selfOrParent(this.rte.selection.getEnd(),/^DIV$/);if(t&&(this.rte.dom.attr(t,"clear")||n(t).css("clear")!="none"))return t}},this.command=function(){var t;(t=this.find())?(t=n(t),this.rte.history.add(),t.children().length||n.trim(t.text()).length?t.removeAttr("clear").css("clear",""):t.remove()):(this.rte.history.add(),this.rte.selection.insertNode(n(this.rte.dom.create("div")).css("clear","both").get(0),!0)),this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled"),this.find()?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.table=function(t,i){function u(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",summary:"Summary",lang:"Language",href:"URL"},r.src={main:{caption:n('<input type="text" />'),rows:n('<input type="text" />').attr("size",5).val(2),cols:n('<input type="text" />').attr("size",5).val(2),width:n('<input type="text" />').attr("size",5),wunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),height:n('<input type="text" />').attr("size",5),hunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),align:n("<select />").append(n("<option />").val("").text(r.rte.i18n("Not set"))).append(n("<option />").val("left").text(r.rte.i18n("Left"))).append(n("<option />").val("center").text(r.rte.i18n("Center"))).append(n("<option />").val("right").text(r.rte.i18n("Right"))),spacing:n('<input type="text" />').attr("size",5),padding:n('<input type="text" />').attr("size",5),border:n("<div />"),rules:n("<select />").append(n("<option />").val("none").text(r.rte.i18n("No"))).append(n("<option />").val("all").text(r.rte.i18n("Cells"))).append(n("<option />").val("groups").text(r.rte.i18n("Groups"))).append(n("<option />").val("rows").text(r.rte.i18n("Rows"))).append(n("<option />").val("cols").text(r.rte.i18n("Columns"))),margin:n("<div />"),bg:n("<div />"),bgimg:n('<input type="text" />').css("width","90%")},adv:{id:n('<input type="text" />'),summary:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />')},events:{}},n.each(r.src,function(){var n,t;for(n in this)this[n].attr("name",n),t=this[n].get(0).nodeName,t=="INPUT"&&n!="bgimg"?this[n].css(this[n].attr("size")?{"text-align":"right"}:{width:"100%"}):t=="SELECT"&&n!="wunit"&&n!="hunit"&&this[n].css("width","100%")}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />').css("width","100%")}),r.src.main.align.change(function(){var i=n(this).val(),t;i=="center"?r.src.main.margin.val({left:"auto",right:"auto"}):(t=r.src.main.margin.val(),t.left=="auto"&&t.right=="auto"&&r.src.main.margin.val({left:"",right:""}))}),r.src.main.bgimg.change(function(){var t=n(this);t.val(r.rte.utils.absoluteURL(t.val()))})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src=null,this.labels=null,this.command=function(){var l=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/),h,e,o,a,v,c,y,f,t,i,s;this.table=this.name=="table"?n(this.rte.doc.createElement("table")):l?n(l):n(this.rte.doc.createElement("table")),this.src||u(),this.src.main.border.elBorderSelect({styleHeight:117}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.margin.elPaddingInput({type:"margin",value:this.table}),this.table.parents().length?(this.src.main.rows.val("").attr("disabled",!0),this.src.main.cols.val("").attr("disabled",!0)):(this.src.main.rows.val(2).removeAttr("disabled"),this.src.main.cols.val(2).removeAttr("disabled")),h=this.table.css("width")||this.table.attr("width"),this.src.main.width.val(parseInt(h)||""),this.src.main.wunit.val(h.indexOf("px")!=-1?"px":"%"),e=this.table.css("height")||this.table.attr("height"),this.src.main.height.val(parseInt(e)||""),this.src.main.hunit.val(e&&e.indexOf("px")!=-1?"px":"%"),o=this.table.css("float"),this.src.main.align.val(""),o=="left"||o=="right"?this.src.main.align.val(o):(a=this.table.css("margin-left"),v=this.table.css("margin-right"),a=="auto"&&v=="auto"&&this.src.main.align.val("center")),this.src.main.border.val(this.table),this.src.main.rules.val(this.rte.dom.attr(this.table.get(0),"rules")),this.src.main.bg.val(this.table.css("background-color")),c=(this.table.css("background-image")||"").replace(/url\(([^\)]+)\)/i,"$1"),this.src.main.bgimg.val(c!="none"?c:""),y={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{width:530,title:this.rte.i18n("Table")}},f=new elDialogForm(y);for(t in this.src)if(f.tab(t,this.rte.i18n(this.labels[t])),t=="main"){var p=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Rows")+"<\/td>").append(n("<td />").append(this.src.main.rows))).append(n("<tr />").append("<td>"+this.rte.i18n("Columns")+"<\/td>").append(n("<td />").append(this.src.main.cols))),w=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Width")+"<\/td>").append(n("<td />").append(this.src.main.width).append(this.src.main.wunit))).append(n("<tr />").append("<td>"+this.rte.i18n("Height")+"<\/td>").append(n("<td />").append(this.src.main.height).append(this.src.main.hunit))),b=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Spacing")+"<\/td>").append(n("<td />").append(this.src.main.spacing.val(this.table.attr("cellspacing")||"")))).append(n("<tr />").append("<td>"+this.rte.i18n("Padding")+"<\/td>").append(n("<td />").append(this.src.main.padding.val(this.table.attr("cellpadding")||""))));f.append([this.rte.i18n("Caption"),this.src.main.caption.val(this.table.find("caption").eq(0).text()||"")],"main",!0).separator("main").append([p,w,b],"main",!0).separator("main").append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Inner borders"),this.src.main.rules],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Background"),n("<span />").append(n("<span />").css({float:"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0)}else for(i in this.src[t])s=this.rte.dom.attr(this.table,i),t=="events"&&(s=this.rte.utils.trimEventCallback(s)),f.append([this.rte.i18n(this.labels[i]?this.labels[i]:i),this.src[t][i].val(s)],t,!0);f.open()},this.set=function(){var e,o,t,i,s,h,c,u,f,l,a,v,p;if(this.table.parents().length)this.table.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor").removeAttr("cellspacing").removeAttr("cellpadding").removeAttr("frame").removeAttr("rules").removeAttr("style");else{if(e=parseInt(this.src.main.rows.val())||0,o=parseInt(this.src.main.cols.val())||0,e<=0||o<=0)return;for(this.rte.history.add(),t=n(this.rte.doc.createElement("tbody")).appendTo(this.table),i=0;i<e;i++){for(s="<tr>",h=0;h<o;h++)s+="<td>&nbsp;<\/td>";t.append(s+"<\/tr>")}}c=n.trim(this.src.main.caption.val()),c?(this.table.children("caption").length||this.table.prepend("<caption />"),this.table.children("caption").text(c)):this.table.children("caption").remove();for(u in this.src)if(u!="main")for(f in this.src[u])l=n.trim(this.src[u][f].val()),l?this.table.attr(f,l):this.table.removeAttr(f);(a=parseInt(this.src.main.spacing.val()))&&a>=0&&this.table.attr("cellspacing",a),(v=parseInt(this.src.main.padding.val()))&&v>=0&&this.table.attr("cellpadding",v),(p=this.src.main.rules.val())&&this.table.attr("rules",p);var w=parseInt(this.src.main.width.val())||"",b=parseInt(this.src.main.height.val())||"",i=n.trim(this.src.main.bgimg.val()),t=this.src.main.border.val(),r=this.src.main.margin.val(),y=this.src.main.align.val();this.table.css({width:w?w+this.src.main.wunit.val():"",height:b?b+this.src.main.hunit.val():"",border:n.trim(t.width+" "+t.style+" "+t.color),"background-color":this.src.main.bg.val(),"background-image":i?"url("+i+")":""}),r.css?this.table.css("margin",r.css):this.table.css({"margin-top":r.top,"margin-right":r.right,"margin-bottom":r.bottom,"margin-left":r.left}),(y=="left"||y=="right")&&this.table.css("margin-left")!="auto"&&this.table.css("margin-right")!="auto"&&this.table.css("float",y),this.table.attr("style")||this.table.removeAttr("style"),this.table.parents().length||this.rte.selection.insertNode(this.table.get(0),!0),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled"),this.name!="tableprops"||this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/)||this.domElem.addClass("disabled").removeClass("active")}},elRTE.prototype.ui.prototype.buttons.tableprops=elRTE.prototype.ui.prototype.buttons.table}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tablerm=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var t=this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/);t&&(this.rte.history.add(),n(t).remove()),this.rte.ui.update(!0)},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellprops=function(t,i){function u(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language"},r.src={main:{type:n("<select />").css("width","100%").append(n("<option />").val("td").text(r.rte.i18n("Data"))).append(n("<option />").val("th").text(r.rte.i18n("Header"))),width:n('<input type="text" />').attr("size",4),wunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),height:n('<input type="text" />').attr("size",4),hunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),align:n("<select />").css("width","100%").append(n("<option />").val("").text(r.rte.i18n("Not set"))).append(n("<option />").val("left").text(r.rte.i18n("Left"))).append(n("<option />").val("center").text(r.rte.i18n("Center"))).append(n("<option />").val("right").text(r.rte.i18n("Right"))).append(n("<option />").val("justify").text(r.rte.i18n("Justify"))),border:n("<div />"),padding:n("<div />"),bg:n("<div />"),bgimg:n('<input type="text" />').css("width","90%"),apply:n("<select />").css("width","100%").append(n("<option />").val("").text(r.rte.i18n("Current cell"))).append(n("<option />").val("row").text(r.rte.i18n("All cells in row"))).append(n("<option />").val("column").text(r.rte.i18n("All cells in column"))).append(n("<option />").val("table").text(r.rte.i18n("All cells in table")))},adv:{id:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").css("width","100%").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />')},events:{}},n.each(r.src,function(){for(var n in this)this[n].attr("name",n),this[n].attr("type")!="text"||this[n].attr("size")||n=="bgimg"||this[n].css("width","100%")}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />').css("width","100%")})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src=null,this.labels=null,this.command=function(){var s,h,e,c,f,t,i,o;if(this.src||u(),this.cell=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/),this.cell){this.src.main.type.val(this.cell.nodeName.toLowerCase()),this.cell=n(this.cell),this.src.main.border.elBorderSelect({styleHeight:117,value:this.cell}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.padding.elPaddingInput({value:this.cell}),s=this.cell.css("width")||this.cell.attr("width"),this.src.main.width.val(parseInt(s)||""),this.src.main.wunit.val(s.indexOf("px")!=-1?"px":"%"),h=this.cell.css("height")||this.cell.attr("height"),this.src.main.height.val(parseInt(h)||""),this.src.main.hunit.val(h.indexOf("px")!=-1?"px":"%"),this.src.main.align.val(this.cell.attr("align")||this.cell.css("text-align")),this.src.main.bg.val(this.cell.css("background-color")),e=this.cell.css("background-image"),this.src.main.bgimg.val(e&&e!="none"?e.replace(/url\(([^\)]+)\)/i,"$1"):""),this.src.main.apply.val(""),c={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{width:520,title:this.rte.i18n("Table cell properties")}},f=new elDialogForm(c);for(t in this.src)if(f.tab(t,this.rte.i18n(this.labels[t])),t=="main")f.append([this.rte.i18n("Width"),n("<span />").append(this.src.main.width).append(this.src.main.wunit)],"main",!0).append([this.rte.i18n("Height"),n("<span />").append(this.src.main.height).append(this.src.main.hunit)],"main",!0).append([this.rte.i18n("Table cell type"),this.src.main.type],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Paddings"),this.src.main.padding],"main",!0).append([this.rte.i18n("Background"),n("<span />").append(n("<span />").css({float:"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0).append([this.rte.i18n("Apply to"),this.src.main.apply],"main",!0);else for(i in this.src[t])o=this.cell.attr(i)||"",t=="events"&&(o=this.rte.utils.trimEventCallback(o)),f.append([this.rte.i18n(this.labels[i]?this.labels[i]:i),this.src[t][i].val(o)],t,!0);f.open()}},this.set=function(){var t=this.cell,v=this.src.main.apply.val(),f,e,o;switch(this.src.main.apply.val()){case"row":t=this.cell.parent("tr").children("td,th");break;case"column":t=n(this.rte.dom.tableColumn(this.cell.get(0)));break;case"table":t=this.cell.parents("table").find("td,th")}for(f in this.src)if(f!="main")for(e in this.src[f])o=n.trim(this.src[f][e].val()),o?t.attr(e,o):t.removeAttr(e);t.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor");var h=this.src.main.type.val(),c=parseInt(this.src.main.width.val())||"",l=parseInt(this.src.main.height.val())||"",a=n.trim(this.src.main.bgimg.val()),s=this.src.main.border.val(),i={width:c?c+this.src.main.wunit.val():"",height:l?l+this.src.main.hunit.val():"","background-color":this.src.main.bg.val(),"background-image":a?"url("+a+")":"",border:n.trim(s.width+" "+s.style+" "+s.color),"text-align":this.src.main.align.val()||""},u=this.src.main.padding.val();u.css?i.padding=u.css:(i["padding-top"]=u.top,i["padding-right"]=u.right,i["padding-bottom"]=u.bottom,i["padding-left"]=u.left),t=t.get(),n.each(t,function(){var c=this.nodeName.toLowerCase(),t=n(this),f,e,u,o,s;if(c!=h){f={};for(e in r.src.adv)u=t.attr(e),u&&(f[e]=u.toString());for(e in r.src.events)u=t.attr(e),u&&(f[e]=u.toString());o=t.attr("colspan")||1,s=t.attr("rowspan")||1,o>1&&(f.colspan=o),s>1&&(f.rowspan=s),t.replaceWith(n("<"+h+" />").html(t.html()).attr(f).css(i))}else t.css(i)}),this.rte.ui.update()},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellsmerge=function(t,i){function u(){var t=r.rte.dom.selfOrParent(r.rte.selection.getStart(),/^(TD|TH)$/),i=r.rte.dom.selfOrParent(r.rte.selection.getEnd(),/^(TD|TH)$/);return t&&i&&t!=i&&n(t).parents("table").get(0)==n(i).parents("table").get(0)?[t,i]:null}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=u(),w;if(t){var c=this.rte.dom.indexOf(n(t[0]).parent("tr").get(0)),l=this.rte.dom.indexOf(n(t[1]).parent("tr").get(0)),s=Math.min(c,l),h=Math.max(c,l)-s+1,f=this.rte.dom.tableColumn(t[0],!0,!0),e=this.rte.dom.tableColumn(t[1],!0),a=n.inArray(t[0],f.column),v=n.inArray(t[1],e.column),y=f.info.offset[a]<e.info.offset[v]?f:e,p=f.info.offset[a]>=e.info.offset[v]?f:e,o=0,i=null,r="";this.rte.history.add(),w=n(n(t[0]).parents("table").eq(0).find("tr").get().slice(s,s+h)).each(function(t){var f=r.length,u=!1;n(this).children("td,th").each(function(){var f=n(this),h=n.inArray(this,y.column),c=n.inArray(this,p.column),l,s,a,e;h!=-1||c!=-1?(u=h!=-1&&c==-1,l=parseInt(f.attr("colspan")||1),t==0&&(o+=l),h!=-1&&t>0&&(s=y.info.delta[h],s>0&&(f.css("text-align")=="left"?(e=f.clone(!0),f.html("&nbsp;")):e=f.clone().html("&nbsp;"),e.removeAttr("colspan").removeAttr("id").insertBefore(this),s>1&&e.attr("colspan",s))),c!=-1&&(s=p.info.delta[c],l-s>1&&(a=l-s-1,f.css("text-align")=="right"?(e=f.clone(!0),f.html("&nbsp;")):e=f.clone().html("&nbsp;"),e.removeAttr("colspan").removeAttr("id").insertAfter(this),a>1&&e.attr("colspan",a))),i?(r+=f.html(),f.remove()):i=f):u&&(t==0&&(o+=parseInt(f.attr("colspan")||1)),r+=f.html(),f.remove())}),r+=f!=r.length?"<br />":""}),i.removeAttr("colspan").removeAttr("rowspan").html(i.html()+r),o>1&&i.attr("colspan",o),h>1&&i.attr("rowspan",h),this.rte.dom.fixTable(n(t[0]).parents("table").get(0))}},this.update=function(){u()?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellsplit=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/),o,s,r,f,t;if(i&&(this.rte.history.add(),o=parseInt(this.rte.dom.attr(i,"colspan")),s=parseInt(this.rte.dom.attr(i,"rowspan")),o>1||s>1)){var h=o-1,c=s-1,l=this.rte.dom.parent(i,/^TABLE$/),u=this.rte.dom.tableMatrix(l);if(h)for(t=0;t<h;t++)n(this.rte.dom.create(i.nodeName)).html("&nbsp;").insertAfter(i);if(c){var a=this.rte.dom.indexesOfCell(i,u),v=a[0],e=a[1];for(r=v+1;r<v+c+1;r++)if(!u[r][e].nodeName){if(u[r][e-1].nodeName)f=u[r][e-1];else for(t=e-1;t>=0;t--)if(u[r][t].nodeName){f=u[r][t];break}if(f)for(t=0;t<=h;t++)n(this.rte.dom.create(f.nodeName)).html("&nbsp;").insertAfter(f)}}n(i).removeAttr("colspan").removeAttr("rowspan"),this.rte.dom.fixTable(l)}this.rte.ui.update(!0)},this.update=function(){var n=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);n&&(parseInt(this.rte.dom.attr(n,"colspan"))>1||parseInt(this.rte.dom.attr(n,"rowspan"))>1)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcolbefore=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this,i=this.rte.dom.tableColumn(this.rte.selection.getNode(),!1,!0);i.length&&(this.rte.history.add(),n.each(i,function(){var r=n(this),u=parseInt(r.attr("colspan")||1),i;u>1?r.attr("colspan",u+1):(i=n(t.rte.dom.create(this.nodeName)).html("&nbsp;"),t.name=="tbcolbefore"?i.insertBefore(this):i.insertAfter(this))}),this.rte.ui.update())},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbcolafter=elRTE.prototype.ui.prototype.buttons.tbcolbefore}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcolrm=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),r=this.rte.dom.selfOrParent(t,/^(TD|TH)$/),i=n(r).prev("td,th").get(0),u=n(r).next("td,th").get(0),e=this.rte.dom.parent(t,/^TABLE$/),f=this.rte.dom.tableColumn(t,!1,!0);f.length&&(this.rte.history.add(),n.each(f,function(){var t=n(this),i=parseInt(t.attr("colspan")||1);i>1?t.attr("colspan",i-1):t.remove()}),this.rte.dom.fixTable(e),(i||u)&&this.rte.selection.selectContents(i?i:u).collapse(!0),this.rte.ui.update(!0))},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),elRTE.prototype.ui.prototype.buttons.tbrowbefore=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){var l=this.rte.selection.getNode(),e=this.rte.dom.selfOrParent(l,/^(TD|TH)$/),u=this.rte.dom.selfOrParent(e,/^TR$/),t=this.rte.dom.tableMatrix(this.rte.dom.selfOrParent(e,/^TABLE$/)),i,h,f,n;if(e&&u&&t){this.rte.history.add();var c=this.name=="tbrowbefore",r=$(u).prevAll("tr").length,o=0,s=[];function a(n,i){while(i>0)if(i--,t[i]&&t[i][n]&&t[i][n].nodeName)return t[i][n]}for(n=0;n<t[r].length;n++)t[r][n]&&t[r][n].nodeName?(i=$(t[r][n]),h=parseInt(i.attr("colspan")||1),parseInt(i.attr("rowspan")||1)>1?c?o+=h:s.push(i):o+=h):t[r][n]=="-"&&(i=a(n,r),i&&s.push($(i)));for(f=$(this.rte.dom.create("tr")),n=0;n<o;n++)f.append("<td>&nbsp;<\/td>");c?f.insertBefore(u):f.insertAfter(u),$.each(s,function(){$(this).attr("rowspan",parseInt($(this).attr("rowspan")||1)+1)}),this.rte.ui.update()}},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbrowafter=elRTE.prototype.ui.prototype.buttons.tbrowbefore,function(n){elRTE.prototype.ui.prototype.buttons.tbrowrm=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var l=this.rte.selection.getNode(),f=this.rte.dom.selfOrParent(l,/^(TD|TH)$/),e=this.rte.dom.selfOrParent(f,/^TR$/),c=this.rte.dom.selfOrParent(f,/^TABLE$/),t=this.rte.dom.tableMatrix(c),a,i,r,u,o,s,h;if(f&&e&&t.length){if(this.rte.history.add(),t.length==1)return n(c).remove(),this.rte.ui.update();a=[],i=n(e).prevAll("tr").length;function v(n,i){while(i>0)if(i--,t[i]&&t[i][n]&&t[i][n].nodeName)return t[i][n]}function p(r,u){var o,f;if(y=i+1,o=null,t[y]){for(f=0;f<u;f++)t[y][f]&&t[y][f].nodeName&&(o=t[y][f]);r=r.remove(),o?r.insertAfter(o):r.prependTo(n(e).next("tr").eq(0))}}function w(n){for(var t=0;t<n.length;t++)if(n[t]==f)return t<n.length-1?n[t+1]:n[t-1]}for(r=0;r<t[i].length;r++)u=null,o=!1,t[i][r]&&t[i][r].nodeName?(u=t[i][r],o=!0):t[i][r]=="-"&&(u=v(r,i))&&(o=!1),u&&(u=n(u),s=parseInt(u.attr("rowspan")||1),s>1&&(u.attr("rowspan",s-1),o&&p(u,r,i)));h=w(this.rte.dom.tableColumn(f)),h&&this.rte.selection.selectContents(h).collapse(!0),n(e).remove()}this.rte.ui.update()},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.undo=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){this.name=="undo"&&this.rte.history.canBack()?(this.rte.history.back(),this.rte.ui.update()):this.name=="redo"&&this.rte.history.canFwd()&&(this.rte.history.fwd(),this.rte.ui.update())},this.update=function(){this.domElem.toggleClass("disabled",this.name=="undo"?!this.rte.history.canBack():!this.rte.history.canFwd())}},elRTE.prototype.ui.prototype.buttons.redo=elRTE.prototype.ui.prototype.buttons.undo}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.unlink=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){function u(n){return n.nodeName=="A"&&n.href}var f=this.rte.selection.getNode(),i=this.rte.dom.selfOrParentLink(f),t,r;if(!i&&(t=n.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1}),t.length)){for(r=0;r<t.length;r++)if(u(t[r])){i=t[r];break}i||(i=this.rte.dom.parent(t[0],u)||this.rte.dom.parent(t[t.length-1],u))}i&&(this.rte.history.add(),this.rte.selection.select(i),this.rte.doc.execCommand("unlink",!1,null),this.rte.ui.update(!0))},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(n){return n.nodeName=="A"&&n.href})?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active")}}}(jQuery),eli18n.prototype=new function(){this.messages={},this._domain="",this.load=function(n){var t,i,r;if(typeof n=="object")for(t in n)if(i=n[t],typeof i=="object"){this.messages[t]||(this.messages[t]={});for(r in i)typeof i[r]=="string"&&(this.messages[t][r]=i[r])}return this},this.translate=function(n,t){var t=t&&this.messages[t]?t:this._domain;return this.messages[t]&&this.messages[t][n]?this.messages[t][n]:n},this.format=function(n,t,i){if(n=this.translate(n,i),typeof t=="object")for(var r in t)n=n.replace("%"+r,this.translate(t[r],i));return n}},function(n){n.fn.elColorPicker=function(t){function u(n){i.val(n),r.change&&r.change(i.val()),i.palette.slideUp()}function f(){i.palette=n("<div />").addClass(r.paletteClass+" rounded-3");for(var t=0;t<r.colors.length;t++)n("<div />").addClass("color").css("background-color",r.colors[t]).attr({title:r.colors[t],unselectable:"on"}).appendTo(i.palette).mouseenter(function(){var t=n(this).attr("title");i.input.val(t),i.preview.css("background-color",t)}).click(function(t){t.stopPropagation(),u(n(this).attr("title"))});i.input=n('<input type="text" />').addClass("rounded-3").attr("size",8).click(function(t){t.stopPropagation(),n(this).focus()}).keydown(function(t){var r,f;return t.ctrlKey||t.metaKey?!0:(r=t.keyCode,r==27)?i.mouseleave():r!=8&&r!=13&&r!=46&&r!=37&&r!=39&&(r<48||r>57)&&(r<65||r>70)?!1:(f=n(this).val(),(f.length==7||f.length==0)&&(r==13&&(t.stopPropagation(),t.preventDefault(),u(f),i.palette.slideUp()),t.keyCode!=8&&t.keyCode!=46&&r!=37&&r!=39)?!1:void 0)}).keyup(function(){var t=n(this).val();t.length==7&&/^#[0-9abcdef]{6}$/i.test(t)&&i.val(t)}),i.preview=n("<div />").addClass("preview rounded-3").click(function(n){n.stopPropagation(),u(i.input.val())}),i.palette.append(n("<div />").addClass("clearfix")).append(n("<div />").addClass("panel").append(i.input).append(i.preview)),r.palettePosition=="outer"?(i.palette.hide().appendTo(i.parents("body").eq(0)).mouseleave(function(){i.palette.is(":animated")||(n(this).slideUp(),i.val(i.val()))}),i.mouseleave(function(n){n.relatedTarget!=i.palette.get(0)&&(i.palette.is(":animated")||(i.palette.slideUp(),i.val(i.val())))})):i.append(i.palette.hide()).mouseleave(function(){i.palette.slideUp(),i.val(i.val())}),i.val(i.val())}var i=this,r=n.extend({},n.fn.elColorPicker.defaults,t);return this.hidden=n('<input type="hidden" />').attr("name",r.name).val(r.color||"").appendTo(this),this.palette=null,this.preview=null,this.input=null,this.empty().addClass(r["class"]+" rounded-3").css({position:"relative","background-color":r.color||""}).click(function(){if(!i.hasClass("disabled")){if(i.palette||f(),r.palettePosition=="outer"&&i.palette.css("display")=="none"){var t=n(this).offset(),u=i.palette.width(),e=i.parents("body").width()-t.left>=u?t.left:t.left+n(this).outerWidth()-u;i.palette.css({left:e+"px",top:t.top+n(this).height()+1+"px"})}i.palette.slideToggle()}}),this.val=function(n){if(n||n==="")this.hidden.val(n),r.update?r.update(this.hidden.val()):this.css("background-color",n),i.palette&&(i.preview.css("background-color",n),i.input.val(n));else return this.hidden.val();return this},this},n.fn.elColorPicker.defaults={"class":"el-colorpicker",paletteClass:"el-palette",palettePosition:"inner",name:"color",color:"",update:null,change:function(){},colors:["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ffcccc","#cc9999","#996666","#663333","#330000","#ff9999","#cc6666","#cc3333","#993333","#660000","#ff6666","#ff3333","#ff0000","#cc0000","#990000","#ff9966","#ff6633","#ff3300","#cc3300","#993300","#ffcc99","#cc9966","#cc6633","#996633","#663300","#ff9933","#ff6600","#ff9900","#cc6600","#cc9933","#ffcc66","#ffcc33","#ffcc00","#cc9900","#996600","#ffffcc","#cccc99","#999966","#666633","#333300","#ffff99","#cccc66","#cccc33","#999933","#666600","#ffff66","#ffff33","#ffff00","#cccc00","#999900","#ccff66","#ccff33","#ccff00","#99cc00","#669900","#ccff99","#99cc66","#99cc33","#669933","#336600","#99ff33","#99ff00","#66ff00","#66cc00","#66cc33","#99ff66","#66ff33","#33ff00","#33cc00","#339900","#ccffcc","#99cc99","#669966","#336633","#003300","#99ff99","#66cc66","#33cc33","#339933","#006600","#66ff66","#33ff33","#00ff00","#00cc00","#009900","#66ff99","#33ff66","#00ff33","#00cc33","#009933","#99ffcc","#66cc99","#33cc66","#339966","#006633","#33ff99","#00ff66","#00ff99","#00cc66","#33cc99","#66ffcc","#33ffcc","#00ffcc","#00cc99","#009966","#ccffff","#99cccc","#669999","#336666","#003333","#99ffff","#66cccc","#33cccc","#339999","#006666","#66cccc","#33ffff","#00ffff","#00cccc","#009999","#66ccff","#33ccff","#00ccff","#0099cc","#006699","#99ccff","#6699cc","#3399cc","#336699","#003366","#3399ff","#0099ff","#0066ff","#066ccc","#3366cc","#6699ff","#3366ff","#0033ff","#0033cc","#003399","#ccccff","#9999cc","#666699","#333366","#000033","#9999ff","#6666cc","#3333cc","#333399","#000066","#6666ff","#3333ff","#0000ff","#0000cc","#009999","#9966ff","#6633ff","#3300ff","#3300cc","#330099","#cc99ff","#9966cc","#6633cc","#663399","#330066","#9933ff","#6600ff","#9900ff","#6600cc","#9933cc","#cc66ff","#cc33ff","#cc00ff","#9900cc","#660099","#ffccff","#cc99cc","#996699","#663366","#330033","#ff99ff","#cc66cc","#cc33cc","#993399","#660066","#ff66ff","#ff33ff","#ff00ff","#cc00cc","#990099","#ff66cc","#ff33cc","#ff00cc","#cc0099","#990066","#ff99cc","#cc6699","#cc3399","#993366","#660033","#ff3399","#ff0099","#ff0066","#cc0066","#cc3366","#ff6699","#ff3366","#ff0033","#cc0033","#990033"]}}(jQuery),function(n){n.fn.elBorderSelect=function(t){function s(n){function i(n){return hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n?hexDigits[(n-n%16)/16]+hexDigits[n%16]:"00"}var t=(n||"").match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/);return t?"#"+i(t[1])+i(t[2])+i(t[3]):""}function h(t){var i,r;if(!t)return t;if(i=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/),i&&(t=i[1],unit=i[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t),isNaN(t))return"";r=parseInt(n(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*r);case"pt":return parseInt(t*r/12);case"%":return parseInt(t*r/100)}return t}var r=this,o=this.eq(0),i=n.extend({},n.fn.elBorderSelect.defaults,t),u=n('<input type="text" />').attr({name:i.name+"[width]",size:3}).css("text-align","right").change(function(){r.change()}),f=n("<div />").css("position","relative").elColorPicker({"class":"el-colorpicker ui-icon ui-icon-pencil",name:i.name+"[color]",palettePosition:"outer",change:function(){r.change()}}),e=n("<div />").elSelect({tpl:'<div style="border-bottom:4px %val #000;width:100%;margin:7px 0"> <\/div>',tpls:{"":"%label"},maxHeight:i.styleHeight||null,select:function(){r.change()},src:{"":"none",solid:"solid",dashed:"dashed",dotted:"dotted",double:"double",groove:"groove",ridge:"ridge",inset:"inset",outset:"outset"}});return o.empty().addClass(i["class"]).attr("name",i.name||"").append(n("<table />").attr("cellspacing",0).append(n("<tr />").append(n("<td />").append(u).append(" px")).append(n("<td />").append(e)).append(n("<td />").append(f)))),this.change=function(){i.change&&i.change(this.val())},this.val=function(t){var i,o,r,c,l;return t||t===""?(c="",t.nodeName||t.css?(t.css||(t=n(t)),c=t.css("border"),(c=t.css("border"))?i=o=r=c:(i=t.css("border-width"),o=t.css("border-style"),r=t.css("border-color"))):(i=t.width||"",o=t.style||"",r=t.color||""),u.val(h(i)),l=o?o.match(/(solid|dashed|dotted|double|groove|ridge|inset|outset)/i):"",e.val(l?l[1]:""),f.val(r.indexOf("#")===0?r:s(r)),this):(i=parseInt(u.val()),i=isNaN(i)?"":i+"px",o=e.val(),r=f.val(),{width:i,style:o,color:r,css:n.trim(i+" "+o+" "+r)})},this.val(i.value),this},n.fn.elBorderSelect.defaults={name:"el-borderselect","class":"el-borderselect",value:{},change:null}}(jQuery),function(t){t.fn.elPaddingInput=function(i){function f(i){return i=t.trim(i.toString()),i[0]=="."&&(i="0"+i),n=parseFloat(i),isNaN(n)?i=="auto"?i:"":n}function e(){r.change&&r.change(u)}var u=this,r=t.extend({},t.fn.elPaddingInput.defaults,{name:this.attr("name")},i);return this.regexps={main:new RegExp(r.type=="padding"?'paddings*:s*([^;"]+)':'margins*:s*([^;"]+)',"im"),left:new RegExp(r.type=="padding"?'padding-lefts*:s*([^;"]+)':'margin-lefts*:s*([^;"]+)',"im"),top:new RegExp(r.type=="padding"?'padding-tops*:s*([^;"]+)':'margin-tops*:s*([^;"]+)',"im"),right:new RegExp(r.type=="padding"?'padding-rights*:s*([^;"]+)':'margin-rights*:s*([^;"]+)',"im"),bottom:new RegExp(r.type=="padding"?'padding-bottoms*:s*([^;"]+)':'margin-bottoms*:s*([^;"]+)',"im")},t.each(["left","top","right","bottom"],function(){u[this]=t('<input type="text" />').attr("size",3).css("text-align","right").css("border-"+this,"2px solid red").bind("change",function(){t(this).val(f(t(this).val())),e()}).attr("name",r.name+"["+this+"]")}),t.each(["uleft","utop","uright","ubottom"],function(){u[this]=t("<select />").append('<option value="px">px<\/option>').append('<option value="em">em<\/option>').append('<option value="pt">pt<\/option>').bind("change",function(){e()}).attr("name",r.name+"["+this+"]"),r.percents&&u[this].append('<option value="%">%<\/option>')}),this.empty().addClass(r["class"]).append(this.left).append(this.uleft).append(" x ").append(this.top).append(this.utop).append(" x ").append(this.right).append(this.uright).append(" x ").append(this.bottom).append(this.ubottom),this.val=function(n){var e,o,s,r,n;if(n||n==="")return(n.nodeName||n.css)&&(n.css||(n=t(n)),e={left:"",top:"",right:"",bottom:""},o=(n.attr("style")||"").toLowerCase(),o&&(o=t.trim(o),s=o.match(this.regexps.main),s?(r=t.trim(s[1]).replace(/\s+/g," ").split(" ",4),e.top=r[0],e.right=r[1]&&r[1]!==""?r[1]:e.top,e.bottom=r[2]&&r[2]!==""?r[2]:e.top,e.left=r[3]&&r[3]!==""?r[3]:e.right):t.each(["left","top","right","bottom"],function(){var n=this.toString();s=o.match(u.regexps[n]),s&&(e[n]=s[1])})),n=e),t.each(["left","top","right","bottom"],function(){var t=this.toString(),r,i;u[t].val(""),u["u"+t].val(),typeof n[t]!="undefined"&&n[t]!==null&&(n[t]=n[t].toString(),r=f(n[t]),u[t].val(r),i=n[t].match(/(px|em|pt|%)/i),u["u"+t].val(i?i[1]:"px"))}),this;var h=f(this.left.val()),c=f(this.top.val()),l=f(this.right.val()),a=f(this.bottom.val()),i={left:h=="auto"||h==0?h:h!==""?h+this.uleft.val():"",top:c=="auto"||c==0?c:c!==""?c+this.utop.val():"",right:l=="auto"||l==0?l:l!==""?l+this.uright.val():"",bottom:a=="auto"||a==0?a:a!==""?a+this.ubottom.val():"",css:""};return i.left!==""&&i.right!==""&&i.top!==""&&i.bottom!==""&&(i.css=i.left==i.right&&i.top==i.bottom?i.top+" "+i.left:i.top+" "+i.right+" "+i.bottom+" "+i.left),i},this.val(r.value),this},t.fn.elPaddingInput.defaults={name:"el-paddinginput","class":"el-paddinginput",type:"padding",value:{},percents:!0,change:null}}(jQuery),function(n){n.fn.elSelect=function(t){function l(n){var t=i.labelTpl||i.tpls[n]||i.tpl;s.html(t.replace(/%val/g,n).replace(/%label/,i.src[n])).children().attr({unselectable:"on"})}function a(){var t,s,f,h;r=n("<div />").addClass(i.listClass+" rounded-3").hide().appendTo(u.mouseleave(function(){r.slideUp()}));for(t in i.src)s=i.tpls[t]||i.tpl,n("<div />").attr("name",t).append(n(s.replace(/%val/g,t).replace(/%label/g,i.src[t])).attr({unselectable:"on"})).appendTo(r).hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault();var u=n(this).attr("name");o.val(u),i.select(u),r.slideUp()});f=u.outerWidth(),r.width()<f&&r.width(f),h=r.height(),i.maxHeight>0&&h>i.maxHeight&&r.height(i.maxHeight),o.val(e.val())}var o=this,u=this.eq(0),i=n.extend({},n.fn.elSelect.defaults,t),e=n('<input type="hidden" />').attr("name",i.name),s=n("<label />").attr({unselectable:"on"}).addClass("rounded-left-3"),r=null,f=null,h,c;if(u.get(0).nodeName=="SELECT"&&(i.src={},u.children("option").each(function(){i.src[n(this).val()]=n(this).text()}),i.value=u.val(),i.name=u.attr("name"),u.replaceWith(u=n("<div />"))),!i.value||!i.src[i.val]){i.value=null,h=0;for(c in i.src)h++==0&&(i.value=c)}return this.val=function(t){return t||t===""?(i.src[t]&&(e.val(t),l(t),r&&r.children().each(function(){n(this).attr("name")==t?n(this).addClass("active"):n(this).removeClass("active")})),this):e.val()},u.empty().addClass(i["class"]+" rounded-3").attr({unselectable:"on"}).append(e).append(s).hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(){r||a(),r.slideToggle(),n.browser.msie&&!f&&(r.children().each(function(){f=Math.max(f,n(this).width())}),f>r.width()&&r.width(f+40))}),this.val(i.value),this},n.fn.elSelect.defaults={name:"el-select","class":"el-select",listClass:"list",labelTpl:null,tpl:"<%val>%label<\/%val>",tpls:{},value:null,src:{},select:function(n){window.console&&window.console.log&&window.console.log("selected: "+n)},maxHeight:410}}(jQuery),function(n){elRTE=function(t,i){var r,f,u,e,o;if(!t||!t.nodeName)return alert('elRTE: argument "target" is not DOM Element');if(r=this,this.version="1.3",this.build="2011-06-23",this.options=n.extend(!0,{},this.options,i),this.browser=n.browser,this.target=n(t),this.lang=""+this.options.lang,this._i18n=new eli18n({textdomain:"rte",messages:{rte:this.i18Messages[this.lang]||{}}}),this.rtl=!!(/^(ar|fa|he)$/.test(this.lang)&&this.i18Messages[this.lang]),this.rtl&&(this.options.cssClass+=" el-rte-rtl"),this.toolbar=n('<div class="toolbar"/>'),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("frameborder",0),this.workzone=n('<div class="workzone"/>').append(this.iframe).append(this.source),this.statusbar=n('<div class="statusbar"/>'),this.tabsbar=n('<div class="tabsbar"/>'),this.editor=n('<div class="'+this.options.cssClass+'" />').append(this.toolbar).append(this.workzone).append(this.statusbar).append(this.tabsbar),this.doc=null,this.$doc=null,this.window=null,this.utils=new this.utils(this),this.dom=new this.dom(this),this.filter=new this.filter(this),this.updateHeight=function(){r.workzone.add(r.iframe).add(r.source).height(r.workzone.height())},this.resizable=function(t){var i=this;this.options.resizable&&n.fn.resizable&&(t?this.editor.resizable({handles:"se",alsoResize:this.workzone,minWidth:300,minHeight:200}).bind("resize",i.updateHeight):this.editor.resizable("destroy").unbind("resize",i.updateHeight))},this.editor.insertAfter(t),u="",t.nodeName=="TEXTAREA"?(this.source=this.target,this.source.insertAfter(this.iframe).hide(),u=this.target.val()):(this.source=n("<textarea />").insertAfter(this.iframe).hide(),u=this.target.hide().html()),this.source.attr("name",this.target.attr("name")||this.target.attr("id")),u=n.trim(u),u||(u=" "),this.options.allowSource&&this.tabsbar.append('<div class="tab editor rounded-bottom-7 active">'+r.i18n("Editor")+'<\/div><div class="tab source rounded-bottom-7">'+r.i18n("Source")+'<\/div><div class="clearfix" style="clear:both"/>').children(".tab").click(function(){n(this).hasClass("active")||(r.tabsbar.children(".tab").toggleClass("active"),r.workzone.children().toggle(),n(this).hasClass("editor")?(r.updateEditor(),r.window.focus(),r.ui.update(!0)):(r.updateSource(),r.source.focus(),n.browser.msie||r.source[0].setSelectionRange(0,0),r.ui.disable(),r.statusbar.empty()))}),this.window=this.iframe.contentWindow,this.doc=this.iframe.contentWindow.document,this.$doc=n(this.doc),f='<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',n.each(r.options.cssfiles,function(){f+='<link rel="stylesheet" type="text/css" href="'+this+'" />'}),this.doc.open(),e=this.filter.wysiwyg(u),o=this.rtl?' class="el-rte-rtl"':"",this.doc.write(r.options.doctype+f+"<\/head><body"+o+">"+e+"<\/body><\/html>"),this.doc.close(),n.browser.msie)this.doc.body.contentEditable=!0;else{try{this.doc.designMode="on"}catch(s){}this.doc.execCommand("styleWithCSS",!1,this.options.styleWithCSS)}this.options.height>0&&this.workzone.height(this.options.height),this.options.width>0&&this.editor.width(this.options.width),this.updateHeight(),this.resizable(!0),this.window.focus(),this.history=new this.history(this),this.selection=new this.selection(this),this.ui=new this.ui(this),this.target.parents("form").bind("submit.elfinder",function(){r.source.parents("form").find('[name="el-select"]').remove(),r.beforeSave()}),this.source.bind("keydown",function(t){var r,i,u;t.keyCode==9&&(t.preventDefault(),n.browser.msie?(r=document.selection.createRange(),r.text="\t"+r.text,this.focus()):(i=this.value.substr(0,this.selectionStart),u=this.value.substr(this.selectionEnd),this.value=i+"\t"+u,this.setSelectionRange(i.length+1,i.length+1)))}),n(this.doc.body).bind("dragend",function(){setTimeout(function(){try{r.window.focus();var n=r.selection.getBookmark();r.selection.moveToBookmark(n),r.ui.update()}catch(t){}},200)}),this.typing=!1,this.lastKey=null,this.$doc.bind("mouseup",function(){r.typing=!1,r.lastKey=null,r.ui.update()}).bind("keyup",function(n){(n.keyCode>=8&&n.keyCode<=13||n.keyCode>=32&&n.keyCode<=40||n.keyCode==46||n.keyCode>=96&&n.keyCode<=111)&&r.ui.update()}).bind("keydown",function(t){if((t.metaKey||t.ctrlKey)&&t.keyCode==65)r.ui.update();else if(t.keyCode==13){var i=r.selection.getNode();if(r.dom.selfOrParent(i,/^PRE$/))return r.selection.insertNode(r.doc.createTextNode("\r\n")),!1;if(n.browser.safari&&t.shiftKey)return r.selection.insertNode(r.doc.createElement("br")),!1}return t.keyCode>=48&&t.keyCode<=57||t.keyCode==61||t.keyCode==109||t.keyCode>=65&&t.keyCode<=90||t.keyCode==188||t.keyCode==190||t.keyCode==191||t.keyCode>=219&&t.keyCode<=222?(r.typing||r.history.add(!0),r.typing=!0,r.lastKey=null):(t.keyCode==8||t.keyCode==46||t.keyCode==32||t.keyCode==13)&&(t.keyCode!=r.lastKey&&r.history.add(!0),r.lastKey=t.keyCode,r.typing=!1),t.keyCode==32&&n.browser.opera?(r.selection.insertNode(r.doc.createTextNode(" ")),!1):void 0}).bind("paste",function(t){if(r.options.allowPaste){var i=n(r.dom.create("div"))[0],u=r.doc.createTextNode("_");r.history.add(!0),r.typing=!0,r.lastKey=null,i.appendChild(u),r.selection.deleteContents().insertNode(i),r.selection.select(u),setTimeout(function(){i.parentNode?(n(i).html(r.filter.proccess("paste",n(i).html())),u=i.lastChild,r.dom.unwrap(i),u&&(r.selection.select(u),r.selection.collapse(!1))):(i.parentNode&&i.parentNode.removeChild(i),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(n(r.doc.body).html()))),r.selection.select(r.doc.body.firstChild),r.selection.collapse(!0)),n(r.doc.body).mouseup()},15)}else t.stopPropagation(),t.preventDefault()}),n.browser.msie&&this.$doc.bind("keyup",function(t){t.keyCode==86&&(t.metaKey||t.ctrlKey)&&(r.history.add(!0),r.typing=!0,r.lastKey=null,r.selection.saveIERange(),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(n(r.doc.body).html()))),r.selection.restoreIERange(),n(r.doc.body).mouseup(),this.ui.update())}),n.browser.safari&&this.$doc.bind("click",function(t){n(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl"),t.target.nodeName=="IMG"&&n(t.target).addClass("elrte-webkit-hl")}).bind("keyup",function(){n(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl")}),this.window.focus(),this.destroy=function(){this.updateSource(),this.target.is("textarea")?this.target.val(n.trim(this.source.val())):this.target.html(n.trim(this.source.val())),this.editor.remove(),this.target.show().parents("form").unbind("submit.elfinder")}},elRTE.prototype.i18n=function(n){return this._i18n.translate(n)},elRTE.prototype.open=function(){this.editor.show()},elRTE.prototype.close=function(){this.editor.hide()},elRTE.prototype.updateEditor=function(){this.val(this.source.val())},elRTE.prototype.updateSource=function(){this.source.val(this.filter.source(n(this.doc.body).html()))},elRTE.prototype.val=function(t){if(typeof t=="string")t=""+t,this.source.is(":visible")?this.source.val(this.filter.source2source(t)):n.browser.msie?(this.doc.body.innerHTML="<br />"+this.filter.wysiwyg(t),this.doc.body.removeChild(this.doc.body.firstChild)):this.doc.body.innerHTML=this.filter.wysiwyg(t);else return this.source.is(":visible")?this.filter.source2source(this.source.val()).trim():this.filter.source(n(this.doc.body).html()).trim()},elRTE.prototype.beforeSave=function(){this.source.val(n.trim(this.val())||"")},elRTE.prototype.save=function(){this.beforeSave(),this.editor.parents("form").submit()},elRTE.prototype.log=function(n){window.console&&window.console.log&&window.console.log(n)},elRTE.prototype.i18Messages={},n.fn.elrte=function(n,t){var r=typeof n=="string"?n:"",i;return(this.each(function(){this.elrte||(this.elrte=new elRTE(this,typeof n=="object"?n:{}));switch(r){case"open":case"show":this.elrte.open();break;case"close":case"hide":this.elrte.close();break;case"updateSource":this.elrte.updateSource();break;case"destroy":this.elrte.destroy()}}),r=="val")?this.length?this.length==1?t?this[0].elrte.val(t):this[0].elrte.val():(i={},this.each(function(){i[this.elrte.source.attr("name")]=this.elrte.val()}),i):"":this}}(jQuery),function(n){elRTE.prototype.dom=function(t){this.rte=t;var r=this;this.regExp={textNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TD|TH|TT|VAR)$/,textContainsNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DL|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|OL|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|TT|UL|VAR)$/,block:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|UL)$/,selectionBlock:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TD|TH|TR|UL)$/,header:/^H[1-6]$/,formElement:/^(FORM|INPUT|HIDDEN|TEXTAREA|SELECT|BUTTON)$/},this.root=function(){return this.rte.body},this.create=function(n){return this.rte.doc.createElement(n)},this.createBookmark=function(){var t=this.rte.doc.createElement("span");return t.id="elrte-bm-"+Math.random().toString().substr(2),n(t).addClass("elrtebm elrte-protected"),t},this.indexOf=function(t){var i=0;for(t=n(t);(t=t.prev())&&t.length;)i++;return i},this.attr=function(t,i){var r="";return t.nodeType==1&&(r=n(t).attr(i),r&&i!="src"&&i!="href"&&i!="title"&&i!="alt"&&(r=r.toString().toLowerCase())),r||""},this.findCommonAncestor=function(t,i){var r;if(!t||!i)return this.rte.log("dom.findCommonAncestor invalid arguments");if(t==i)return t;if(t.nodeName=="BODY"||i.nodeName=="BODY")return this.rte.doc.body;var u=n(t).parents(),f=n(i).parents(),e=f.length-1,o=f[e];for(r=u.length-1;r>=0;r--,e--)if(u[r]==f[e])o=u[r];else break;return o},this.isEmpty=function(t){return t.nodeType==1?this.regExp.textNodes.test(t.nodeName)?n.trim(n(t).text()).length==0:!1:t.nodeType==3?/^(TABLE|THEAD|TFOOT|TBODY|TR|UL|OL|DL)$/.test(t.parentNode.nodeName)||t.nodeValue==""||n.trim(t.nodeValue).length==0&&!(t.nextSibling&&t.previousSibling&&t.nextSibling.nodeType==1&&t.previousSibling.nodeType==1&&!this.regExp.block.test(t.nextSibling.nodeName)&&!this.regExp.block.test(t.previousSibling.nodeName)):!0},this.next=function(n){while(n.nextSibling&&(n=n.nextSibling))if(n.nodeType==1||n.nodeType==3&&!this.isEmpty(n))return n;return null},this.prev=function(n){while(n.previousSibling&&(n=n.previousSibling))if(n.nodeType==1||n.nodeType==3&&!this.isEmpty(n))return n;return null},this.isPrev=function(n,t){while(n=this.prev(n))if(n==t)return!0;return!1},this.nextAll=function(n){for(var t=[];n=this.next(n);)t.push(n);return t},this.prevAll=function(n){for(var t=[];n=this.prev(n);)t.push(n);return t},this.toLineEnd=function(n){for(var t=[];(n=this.next(n))&&n.nodeName!="BR"&&n.nodeName!="HR"&&this.isInline(n);)t.push(n);return t},this.toLineStart=function(n){for(var t=[];(n=this.prev(n))&&n.nodeName!="BR"&&n.nodeName!="HR"&&this.isInline(n);)t.unshift(n);return t},this.isFirstNotEmpty=function(t){while(t=this.prev(t))if(t.nodeType==1||t.nodeType==3&&n.trim(t.nodeValue)!="")return!1;return!0},this.isLastNotEmpty=function(n){while(n=this.next(n))if(!this.isEmpty(n))return!1;return!0},this.isOnlyNotEmpty=function(n){return this.isFirstNotEmpty(n)&&this.isLastNotEmpty(n)},this.findLastNotEmpty=function(n){if(this.rte.log("findLastNotEmpty Who is here 0_o"),n.nodeType==1&&(l=n.lastChild)){if(!this.isEmpty(l))return l;while(l.previousSibling&&(l=l.previousSibling))if(!this.isEmpty(l))return l}return!1},this.isInline=function(t){if(t.nodeType==3)return!0;if(t.nodeType==1){t=n(t);var i=t.css("display"),r=t.css("float");return i=="inline"||i=="inline-block"||r=="left"||r=="right"}return!0},this.is=function(n,t){if(n&&n.nodeName){if(typeof t=="string"&&(t=this.regExp[t]||/.?/),t instanceof RegExp&&n.nodeName)return t.test(n.nodeName);if(typeof t=="function")return t(n)}return!1},this.filter=function(n,t){var r=[],i;if(!n.push)return this.is(n,t)?n:null;for(i=0;i<n.length;i++)this.is(n[i],t)&&r.push(n[i]);return r},this.parents=function(n,t){for(var i=[];n&&(n=n.parentNode)&&n.nodeName!="BODY"&&n.nodeName!="HTML";)this.is(n,t)&&i.push(n);return i},this.parent=function(n,t){return this.parents(n,t)[0]||null},this.selfOrParent=function(n,t,i){return this.is(n,t)?n:this.parent(n,i||t)},this.selfOrParentLink=function(n){return n=this.selfOrParent(n,/^A$/),n&&n.href?n:null},this.selfOrParentAnchor=function(n){return n=this.selfOrParent(n,/^A$/),n&&!n.href&&n.name?n:null},this.childLinks=function(t){var i=[];return n("a[href]",t).each(function(){i.push(this)}),i},this.selectionHas=function(n){var t=this.rte.selection.cloneContents(),i;if(t&&t.childNodes&&t.childNodes.length)for(i=0;i<t.childNodes.length;i++)if(typeof n=="function"){if(n(t.childNodes[i]))return!0}else if(t instanceof RegExp&&n.test(t.childNodes[i].nodeName))return!0;return!1},this.wrap=function(t,i){return t=n.isArray(t)?t:[t],i=i.nodeName?i:this.create(i),t[0]&&t[0].nodeType&&t[0].parentNode&&(i=t[0].parentNode.insertBefore(i,t[0]),n(t).each(function(){this!=i&&i.appendChild(this)})),i},this.unwrap=function(n){if(n&&n.parentNode){while(n.firstChild)n.parentNode.insertBefore(n.firstChild,n);n.parentNode.removeChild(n)}},this.wrapContents=function(n,t){t=t.nodeName?t:this.create(t);for(var i=0;i<n.childNodes.length;i++)t.appendChild(n.childNodes[i]);return n.appendChild(t),t},this.cleanNode=function(t){if(t.nodeType==1){if(/^(P|LI)$/.test(t.nodeName)&&(l=this.findLastNotEmpty(t))&&l.nodeName=="BR"&&n(l).remove(),$n=n(t),$n.children().each(function(){this.cleanNode(this)}),t.nodeName!="BODY"&&!/^(TABLE|TR|TD)$/.test(t)&&this.isEmpty(t))return $n.remove();$n.attr("style")===""&&$n.removeAttr("style"),this.rte.browser.safari&&$n.hasClass("Apple-span")&&$n.removeClass("Apple-span"),t.nodeName!="SPAN"||$n.attr("style")||$n.attr("class")||$n.attr("id")||$n.replaceWith($n.html())}},this.cleanChildNodes=function(t){var i=this.cleanNode;n(t).children().each(function(){i(this)})},this.tableMatrix=function(t){var i=[],r;if(t&&t.nodeName=="TABLE"){r=0;function u(n){for(var t=0;t<=r;t++)if(!i[n][t])return t}n(t).find("tr").each(function(t){n.isArray(i[t])||(i[t]=[]),n(this).children("td,th").each(function(){for(var h=parseInt(n(this).attr("colspan")||1),c=parseInt(n(this).attr("rowspan")||1),l=u(t),e,o,s,f=0;f<c;f++)for(e=0;e<h;e++)o=t+f,n.isArray(i[o])||(i[o]=[]),s=e==0&&f==0?this:f==0?e:"-",i[o][l+e]=s;r=Math.max(r,i[t].length)})})}return i},this.indexesOfCell=function(n,t){for(var r,i=0;i<t.length;i++)for(r=0;r<t[i].length;r++)if(t[i][r]==n)return[i,r]},this.fixTable=function(t){var r,f,s,h;if(t&&t.nodeName=="TABLE"){var e=n(t),o=this.tableMatrix(t),u=0;if(n.each(o,function(){u=Math.max(u,this.length)}),u==0)return e.remove();for(r=0;r<o.length;r++)if(f=o[r].length,f==0)e.find("tr").eq(r).remove();else if(f<u)for(s=u-f,h=e.find("tr").eq(r),i=0;i<s;i++)h.append("<td>&nbsp;<\/td>")}},this.tableColumn=function(n,t,i){var h,u,c,f,o,r,s,e;if(n=this.selfOrParent(n,/^TD|TH$/),h=this.selfOrParent(n,/^TABLE$/),ret=[],info={offset:[],delta:[]},n&&h){for(i&&this.fixTable(h),u=this.tableMatrix(h),c=!1,r=0;r<u.length;r++){for(o=0;o<u[r].length;o++)if(u[r][o]==n){f=o,c=!0;break}if(c)break}if(f>=0)for(r=0;r<u.length;r++)s=u[r][f]||null,s&&(s.nodeName?(ret.push(s),t&&(info.delta.push(0),info.offset.push(f))):(e=parseInt(s),!isNaN(e)&&u[r][f-e]&&u[r][f-e].nodeName&&(ret.push(u[r][f-e]),t&&(info.delta.push(e),info.offset.push(f)))))}return t?{column:ret,info:info}:ret}}}(jQuery),function(n){elRTE.prototype.filter=function(t){var i=this,r=n("<span/>").addClass("elrtetesturl").appendTo(document.body)[0];this.url=(typeof r.currentStyle!="undefined"?r.currentStyle.backgroundImage:document.defaultView.getComputedStyle(r,null).backgroundImage).replace(/^url\((['"]?)([\s\S]+\/)[\s\S]+\1\)$/i,"$2"),n(r).remove(),this.rte=t,this.xhtml=/xhtml/i.test(t.options.doctype),this.boolAttrs=t.utils.makeObject("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected".split(",")),this.tagRegExp=/<(\/?)([\w:]+)((?:\s+[a-z\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.openTagRegExp=/<([\w:]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.attrRegExp=/(\w+)(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^\s]+))?/g,this.scriptRegExp=/<script([^>]*)>([\s\S]*?)<\/script>/gi,this.styleRegExp=/(<style([^>]*)>[\s\S]*?<\/style>)/gi,this.linkRegExp=/(<link([^>]+)>)/gi,this.cdataRegExp=/<!\[CDATA\[([\s\S]+)\]\]>/g,this.objRegExp=/<object([^>]*)>([\s\S]*?)<\/object>/gi,this.embRegExp=/<(embed)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.paramRegExp=/<(param)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.iframeRegExp=/<iframe([^>]*)>([\s\S]*?)<\/iframe>/gi,this.yMapsRegExp=/<div\s+([^>]*id\s*=\s*('|")?YMapsID[^>]*)>/gi,this.gMapsRegExp=/<iframe\s+([^>]*src\s*=\s*"http:\/\/maps\.google\.\w+[^>]*)>([\s\S]*?)<\/iframe>/gi,this.videoHostRegExp=/^(http:\/\/[\w\.]*)?(youtube|vimeo|rutube).*/i,this.serviceClassRegExp=/<(\w+)([^>]*class\s*=\s*"[^>]*elrte-[^>]*)>\s*(<\/\1>)?/gi,this.pagebreakRegExp=/<(\w+)([^>]*style\s*=\s*"[^>]*page-break[^>]*)>\s*(<\/\1>)?/gi,this.pbRegExp=new RegExp("<!-- pagebreak -->","gi"),this.allowTags=t.options.allowTags.length?t.utils.makeObject(t.options.allowTags):null,this.denyTags=t.options.denyTags.length?t.utils.makeObject(t.options.denyTags):null,this.denyAttr=t.options.denyAttr?t.utils.makeObject(t.options.denyAttr):null,this.pasteDenyAttr=t.options.pasteDenyAttr?t.utils.makeObject(t.options.pasteDenyAttr):null,this.fontSize=["medium","xx-small","small","medium","large","x-large","xx-large"],this.fontFamily={"sans-serif":/^(arial|tahoma|verdana)$/i,serif:/^(times|times new roman)$/i,monospace:/^courier$/i},this.scripts={},this._chains={},n.each(this.chains,function(t){i._chains[t]=[],n.each(this,function(n,r){typeof i.rules[r]=="function"&&i._chains[t].push(i.rules[r])})}),this.proccess=function(t,r){return r=n.trim(r).replace(/^\s*(&nbsp;)+/gi,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""),n.each(this._chains[t]||[],function(){r=this.call(i,r)}),r=r.replace(/\t/g,"  ").replace(/\r/g,"").replace(/\s*\n\s*\n+/g,"\n")+"  ",n.trim(r)?r:" "},this.wysiwyg=function(n){return this.proccess("wysiwyg",n)},this.source=function(n){return this.proccess("source",n)},this.source2source=function(n){return this.proccess("source2source",n)},this.wysiwyg2wysiwyg=function(n){return this.proccess("wysiwyg2wysiwyg",n)},this.parseAttrs=function(t){var i={},o=this.boolAttrs,e=t.match(this.attrRegExp),r,u,f;return e&&n.each(e,function(t,e){r=e.split("="),u=n.trim(r[0]).toLowerCase(),r.length>2?(r.shift(),f=r.join("=")):f=o[u]||r[1]||"",i[u]=n.trim(f).replace(/^('|")(.*)(\1)$/,"$2")}),i.style=this.rte.utils.parseStyle(i.style),i["class"]=this.rte.utils.parseClass(i["class"]||""),i},this.serializeAttrs=function(t,i){var r=[],u=this;return n.each(t,function(n,t){n=="style"?t=u.rte.utils.serializeStyle(t,i):n=="class"&&(t=u.rte.utils.serializeClass(t)),t&&r.push(n+'="'+t+'"')}),r.join(" ")},this.cleanAttrs=function(t,i){function r(n){return n+(/\d$/.test(n)?"px":"")}var f=this,u=this.replaceAttrs;return n.each(t["class"],function(n){/^(Apple-style-span|mso\w+)$/i.test(n)&&delete t["class"][n]}),n.each(t,function(e,o){u[e]&&u[e].call(f,t,i),e=="style"&&n.each(o,function(n,i){switch(n){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":t.style[n.replace(/^mso-|-alt$/g,"")]=r(i),delete t.style[n];break;case"horiz-align":t.style["text-align"]=i,delete t.style[n];break;case"vert-align":t.style["vertical-align"]=i,delete t.style[n];break;case"font-color":case"mso-foreground":t.style.color=i,delete t.style[n];break;case"mso-background":case"mso-highlight":t.style.background=i,delete t.style[n];break;case"mso-default-height":t.style["min-height"]=r(i),delete t.style[n];break;case"mso-default-width":t.style["min-width"]=r(i),delete t.style[n];break;case"mso-padding-between-alt":t.style["border-collapse"]="separate",t.style["border-spacing"]=r(i),delete t.style[n];break;case"text-line-through":i.match(/(single|double)/i)&&(t.style["text-decoration"]="line-through"),delete t.style[n];break;case"mso-zero-height":i=="yes"&&(t.style.display="none"),delete t.style[n];break;case"font-weight":i==700&&(t.style["font-weight"]="bold");break;default:n.match(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/)&&delete t.style[n]}})}),t}},elRTE.prototype.filter.prototype.replaceTags={b:{tag:"strong"},big:{tag:"span",style:{"font-size":"large"}},center:{tag:"div",style:{"text-align":"center"}},i:{tag:"em"},font:{tag:"span"},nobr:{tag:"span",style:{"white-space":"nowrap"}},menu:{tag:"ul"},plaintext:{tag:"pre"},s:{tag:"strike"},small:{tag:"span",style:{"font-size":"small"}},u:{tag:"span",style:{"text-decoration":"underline"}},xmp:{tag:"pre"}},elRTE.prototype.filter.prototype.replaceAttrs={align:function(n,t){switch(t){case"img":n.style[n.align.match(/(left|right)/)?"float":"vertical-align"]=n.align;break;case"table":n.align=="center"?n.style["margin-left"]=n.style["margin-right"]="auto":n.style.float=n.align;break;default:n.style["text-align"]=n.align}delete n.align},border:function(n){n.style["border-width"]||(n.style["border-width"]=(parseInt(n.border)||1)+"px"),n.style["border-style"]||(n.style["border-style"]="solid"),delete n.border},bordercolor:function(n){n.style["border-color"]||(n.style["border-color"]=n.bordercolor),delete n.bordercolor},background:function(n){n.style["background-image"]||(n.style["background-image"]="url("+n.background+")"),delete n.background},bgcolor:function(n){n.style["background-color"]||(n.style["background-color"]=n.bgcolor),delete n.bgcolor},clear:function(n){n.style.clear=n.clear=="all"?"both":n.clear,delete n.clear},color:function(n){n.style.color||(n.style.color=n.color),delete n.color},face:function(t){var i=t.face.toLowerCase();n.each(this.fontFamily,function(n,r){i.match(r)&&(t.style["font-family"]=i+","+n)}),delete t.face},hspace:function(n,t){if(t=="img"){var i=parseInt(n.hspace)||0;n.style["margin-left"]||(n.style["margin-left"]=i+"px"),n.style["margin-right"]||(n.style["margin-right"]=i+"px"),delete n.hspace}},size:function(n,t){t!="input"&&(n.style["font-size"]=this.fontSize[parseInt(n.size)||0]||"medium",delete n.size)},valign:function(n){n.style["vertical-align"]||(n.style["vertical-align"]=n.valign),delete n.valign},vspace:function(n,t){if(t=="img"){var i=parseInt(n.vspace)||0;n.style["margin-top"]||(n.style["margin-top"]=i+"px"),n.style["margin-bottom"]||(n.style["margin-bottom"]=i+"px"),delete n.hspace}}},elRTE.prototype.filter.prototype.rules={allowedTags:function(n){var t=this.allowTags;return t?n.replace(this.tagRegExp,function(n,i,r){return t[r.toLowerCase()]?n:""}):n},deniedTags:function(n){var t=this.denyTags;return t?n.replace(this.tagRegExp,function(n,i,r){return t[r.toLowerCase()]?"":n}):n},clean:function(t){var i=this,r=this.replaceTags,e=this.replaceAttrs,f=this.denyAttr,u;return t=t.replace(/<!DOCTYPE([\s\S]*)>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1<\/strong><\/p>").replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s&nbsp;]*)<\/span>/gi,"$1").replace(/(<p[^>]*>\s*<\/p>|<p[^>]*\/>)/gi,"<br>").replace(/(<\/p>)(?:\s*<br\s*\/?>\s*|\s*&nbsp;\s*)+\s*(<p[^>]*>)/gi,function(n,t,i){return t+"\n"+i}).replace(this.tagRegExp,function(t,u,e,o){return(e=e.toLowerCase(),u)?"<\/"+(r[e]?r[e].tag:e)+">":(o=i.cleanAttrs(i.parseAttrs(o||""),e),r[e]&&(r[e].style&&n.extend(o.style,r[e].style),e=r[e].tag),f&&n.each(o,function(n){f[n]&&delete o[n]}),o=i.serializeAttrs(o),"<"+e+(o?" ":"")+o+">")}),u=n("<div>"+t+"<\/div>"),u.find("span:not([id]):not([class])").each(function(){var t=n(this);t.attr("style")||(n.trim(t.html()).length?i.rte.dom.unwrap(this):t.remove())}).end().find("span span:only-child").each(function(){var r=n(this),t=r.parent().eq(0),o=r.attr("id"),s=t.attr("id"),u,f,e;!i.rte.dom.isOnlyNotEmpty(this)||o&&s||(e=n.trim(t.attr("class")+" "+r.attr("class")),e&&t.attr("class",e),f=i.rte.utils.serializeStyle(n.extend(i.rte.utils.parseStyle(n(this).attr("style")||""),i.rte.utils.parseStyle(n(t).attr("style")||""))),f&&t.attr("style",f),u=o||s,u&&t.attr("id",u),this.firstChild?n(this.firstChild).unwrap():r.remove())}).end().find("a[name]").each(function(){n(this).addClass("elrte-protected elrte-anchor")}),u.html()},cleanPaste:function(t){var i=this,r=this.pasteDenyAttr;return t=t.replace(this.scriptRegExp,"").replace(this.styleRegExp,"").replace(this.linkRegExp,"").replace(this.cdataRegExp,"").replace(/\<\!--[\s\S]*?--\>/g,""),this.rte.options.pasteOnlyText?t=t.replace(this.tagRegExp,function(n,t,i){return/br/i.test(i)||t&&/h[1-6]|p|ol|ul|li|div|blockquote|tr/i?"<br>":""}).replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""):r&&(t=t.replace(this.openTagRegExp,function(t,u,f){return f=i.parseAttrs(f),n.each(f,function(n){r[n]&&delete f[n]}),f=i.serializeAttrs(f,!0),"<"+u+(f?" ":"")+f+">"})),t},replace:function(t){function e(n,t){function c(){if(n.embed&&n.embed.src)return n.embed.src;if(n.params&&n.params.length)for(u=n.params.length;u--;)if(n.params[u].name=="src"||n.params[u].name=="movie")return n.params[u].value}var r=c(),o=r&&i.videoHostRegExp.test(r)?r.replace(i.videoHostRegExp,"$2"):t.replace(/^\w+\/(.+)/,"$1"),s=parseInt((n.obj?n.obj.width||n.obj.style.width:0)||(n.embed?n.embed.width||n.embed.style.width:0))||150,h=parseInt((n.obj?n.obj.height||n.obj.style.height:0)||(n.embed?n.embed.height||n.embed.style.height:0))||100,f="media"+Math.random().toString().substring(2),e="",u;return n.obj&&n.obj.style&&n.obj.style.float&&(e=' style="float:'+n.obj.style.float+'"'),i.scripts[f]=n,'<img src="'+i.url+'pixel.gif" class="elrte-media elrte-media-'+o+' elrte-protected" title="'+(r?i.rte.utils.encode(r):"")+'" rel="'+f+'" width="'+s+'" height="'+h+'"'+e+">"}var i=this,c=this.rte.options.replace||[],u,f;if(c.length&&n.each(c,function(n,r){typeof r=="function"&&(t=r.call(i,t))}),t=t.replace(this.styleRegExp,"<!-- ELRTE_COMMENT$1 -->").replace(this.linkRegExp,"<!-- ELRTE_COMMENT$1-->").replace(this.cdataRegExp,"<!--[CDATA[$1]]-->").replace(this.scriptRegExp,function(n,t,r){var u;return i.denyTags.script?"":(u="script"+Math.random().toString().substring(2),t=i.parseAttrs(t),t.type||(t.type="text/javascript"),i.scripts[u]="<script "+i.serializeAttrs(t)+">"+r+"<\/script>","<!-- ELRTE_SCRIPT:"+u+" -->")}).replace(this.yMapsRegExp,function(n,t){return t=i.parseAttrs(t),t["class"]["elrte-yandex-maps"]="elrte-yandex-maps",t["class"]["elrte-protected"]="elrte-protected","<div "+i.serializeAttrs(t)+">"}).replace(this.gMapsRegExp,function(n,t){var r="gmaps"+Math.random().toString().substring(2),u,f;return t=i.parseAttrs(t),u=parseInt(t.width||t.style.width||100),f=parseInt(t.height||t.style.height||100),i.scripts[r]=n,'<img src="'+i.url+'pixel.gif" class="elrte-google-maps elrte-protected" id="'+r+'" style="width:'+u+"px;height:"+f+'px">'}).replace(this.objRegExp,function(t,r,u){var o=u.match(i.embRegExp),f={obj:i.parseAttrs(r),embed:o&&o.length?i.parseAttrs(o[0].substring(7)):null,params:[]},s=i.rte.utils.mediaInfo(f.embed?f.embed.type||"":"",f.obj.classid||"");return s?((o=u.match(i.paramRegExp))&&n.each(o,function(n,t){f.params.push(i.parseAttrs(t.substring(6)))}),f.obj.classid||(f.obj.classid=s.classid[0]),f.obj.codebase||(f.obj.codebase=s.codebase),f.embed&&!f.embed.type&&(f.embed.type=s.type),f.obj.width=="1"&&delete f.obj.width,f.obj.height=="1"&&delete f.obj.height,f.embed&&(f.embed.width=="1"&&delete f.embed.width,f.embed.height=="1"&&delete f.embed.height),e(f,s.type)):t}).replace(this.embRegExp,function(n,t,r){var r=i.parseAttrs(r),u=i.rte.utils.mediaInfo(r.type||"");return r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,u?e({embed:r},u.type):n}).replace(this.iframeRegExp,function(n,t){var t=i.parseAttrs(t),u=t.style.width||(parseInt(t.width)>1?parseInt(t.width)+"px":"100px"),f=t.style.height||(parseInt(t.height)>1?parseInt(t.height)+"px":"100px"),r="iframe"+Math.random().toString().substring(2);return i.scripts[r]=n,'<img id="'+r+'" src="'+i.url+'pixel.gif" class="elrte-protected elrte-iframe" style="width:'+u+"; height:"+f+'">'}).replace(this.vimeoRegExp,function(n,t,r){return r=i.parseAttrs(r),delete r.frameborder,r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,r.type="application/x-shockwave-flash",e({embed:r},"application/x-shockwave-flash")}).replace(/<\/(embed|param)>/gi,"").replace(this.pbRegExp,function(){return'<img src="'+i.url+'pixel.gif" class="elrte-protected elrte-pagebreak">'}),u=n("<div>"+t+"<\/div>"),!this.rte.options.allowTextNodes){var o=this.rte.dom,s=[],r=[];if(n.browser.msie)for(f=0;f<u[0].childNodes.length;f++)s.push(u[0].childNodes[f]);else s=Array.prototype.slice.call(u[0].childNodes);function h(){r.length&&o.filter(r,"notEmpty").length&&o.wrap(r,document.createElement("p")),r=[]}n.each(s,function(n,t){o.is(t,"block")?h():(r.length&&t.previousSibling!=r[r.length-1]&&h(),r.push(t))}),h()}return u.html()},restore:function(t){var i=this,r=this.rte.options.restore||[];return r.length&&n.each(r,function(n,r){typeof r=="function"&&(t=r.call(i,t))}),t=t.replace(/\<\!--\[CDATA\[([\s\S]*?)\]\]--\>/gi,"<![CDATA[$1]\]>").replace(/\<\!--\s*ELRTE_SCRIPT\:\s*(script\d+)\s*--\>/gi,function(n,t){return i.scripts[t]&&(n=i.scripts[t],delete i.scripts[t]),n||""}).replace(/\<\!-- ELRTE_COMMENT([\s\S]*?) --\>/gi,"$1").replace(this.serviceClassRegExp,function(t,r,u,f){var u=i.parseAttrs(u),e,o="",t;return u["class"]["elrte-google-maps"]?(t="",i.scripts[u.id]&&(t=i.scripts[u.id],delete i.scripts[u.id]),t):u["class"]["elrte-iframe"]?i.scripts[u.id]||"":u["class"].elrtebm?"":u["class"]["elrte-media"]?(e=i.scripts[u.rel]||{},e.params&&n.each(e.params,function(n,t){o+="<param "+i.serializeAttrs(t)+">\n"}),e.embed&&(o+="<embed "+i.serializeAttrs(e.embed)+">"),e.obj&&(o="<object "+i.serializeAttrs(e.obj)+">\n"+o+"\n<\/object>\n"),o||t):u["class"]["elrte-pagebreak"]?"<!-- pagebreak -->":(n.each(u["class"],function(n){/^elrte-\w+/i.test(n)&&delete u["class"][n]}),"<"+r+" "+i.serializeAttrs(u)+">"+(f||""))})},compactStyles:function(n){var t=this;return n.replace(this.tagRegExp,function(n,i,r,u){return u=!i&&u?t.serializeAttrs(t.parseAttrs(u),!0):"","<"+i+r.toLowerCase()+(u?" ":"")+u+">"})},xhtmlTags:function(n){return this.xhtml?n.replace(/<(img|hr|br|embed|param|link|area)([^>]*\/*)>/gi,"<$1$2 />"):n}},elRTE.prototype.filter.prototype.chains={wysiwyg:["replace","clean","allowedTags","deniedTags","compactStyles"],source:["clean","allowedTags","restore","compactStyles","xhtmlTags"],paste:["clean","allowedTags","cleanPaste","replace","deniedTags","compactStyles"],wysiwyg2wysiwyg:["clean","allowedTags","restore","replace","deniedTags","compactStyles"],source2source:["clean","allowedTags","replace","deniedTags","restore","compactStyles","xhtmlTags"]}}(jQuery),function(n){elRTE.prototype.history=function(t){this.rte=t,this._prev=[],this._next=[],this.add=function(){this.rte.options.historyLength>0&&this._prev.length>=this.rte.options.historyLength&&this._prev.slice(this.rte.options.historyLength);var t=this.rte.selection.getBookmark();this._prev.push([n(this.rte.doc.body).html(),t]),this.rte.selection.moveToBookmark(t),this._next=[]},this.back=function(){if(this._prev.length){var i=this.rte.selection.getBookmark(),t=this._prev.pop();this._next.push([n(this.rte.doc.body).html(),i]),n(this.rte.doc.body).html(t[0]),this.rte.selection.moveToBookmark(t[1])}},this.fwd=function(){if(this._next.length){var i=this.rte.selection.getBookmark(),t=this._next.pop();this._prev.push([n(this.rte.doc.body).html(),i]),n(this.rte.doc.body).html(t[0]),this.rte.selection.moveToBookmark(t[1])}},this.canBack=function(){return this._prev.length},this.canFwd=function(){return this._next.length}}}(jQuery),function(){elRTE.prototype.options={doctype:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">',cssClass:"el-rte",cssfiles:[],height:null,resizable:!0,lang:"en",toolbar:"normal",absoluteURLs:!0,allowSource:!0,stripWhiteSpace:!0,styleWithCSS:!1,fmAllow:!0,fmOpen:null,allowTags:[],denyTags:["applet","base","basefont","bgsound","blink","body","col","colgroup","isindex","frameset","html","head","meta","marquee","noframes","noembed","o:p","title","xml"],denyAttr:[],pasteDenyAttr:["id","name","class","style","language","onclick","ondblclick","onhover","onkeup","onkeydown","onkeypress"],allowTextNodes:!0,allowBrowsersSpecStyles:!1,allowPaste:!0,pasteOnlyText:!1,replace:[],restore:[],pagebreak:'<div style="page-break-after: always;"><\/div>',buttons:{save:"Save",copy:"Copy",cut:"Cut",css:"Css style and class",paste:"Paste",pastetext:"Paste only text",pasteformattext:"Paste formatted text",removeformat:"Clean format",undo:"Undo last action",redo:"Redo previous action",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyleft:"Align left",justifyright:"Ailgn right",justifycenter:"Align center",justifyfull:"Align full",indent:"Indent",outdent:"Outdent",rtl:"Right to left",ltr:"Left to right",forecolor:"Font color",hilitecolor:"Background color",formatblock:"Format",fontsize:"Font size",fontname:"Font",insertorderedlist:"Ordered list",insertunorderedlist:"Unordered list",horizontalrule:"Horizontal rule",blockquote:"Blockquote",div:"Block element (DIV)",link:"Link",unlink:"Delete link",anchor:"Bookmark",image:"Image",pagebreak:"Page break",smiley:"Smiley",flash:"Flash",table:"Table",tablerm:"Delete table",tableprops:"Table properties",tbcellprops:"Table cell properties",tbrowbefore:"Insert row before",tbrowafter:"Insert row after",tbrowrm:"Delete row",tbcolbefore:"Insert column before",tbcolafter:"Insert column after",tbcolrm:"Delete column",tbcellsmerge:"Merge table cells",tbcellsplit:"Split table cell",docstructure:"Toggle display document structure",elfinder:"Open file manager",fullscreen:"Toggle full screen mode",nbsp:"Non breakable space",stopfloat:"Stop element floating",about:"About this software"},panels:{eol:[],save:["save"],copypaste:["copy","cut","paste","pastetext","pasteformattext","removeformat","docstructure"],undoredo:["undo","redo"],style:["bold","italic","underline","strikethrough","subscript","superscript"],colors:["forecolor","hilitecolor"],alignment:["justifyleft","justifycenter","justifyright","justifyfull"],indent:["outdent","indent"],format:["formatblock","fontsize","fontname"],lists:["insertorderedlist","insertunorderedlist"],elements:["horizontalrule","blockquote","div","stopfloat","css","nbsp","smiley","pagebreak"],direction:["ltr","rtl"],links:["link","unlink","anchor"],images:["image"],media:["image","flash"],tables:["table","tableprops","tablerm","tbrowbefore","tbrowafter","tbrowrm","tbcolbefore","tbcolafter","tbcolrm","tbcellprops","tbcellsmerge","tbcellsplit"],elfinder:["elfinder"],fullscreen:["fullscreen","about"]},toolbars:{tiny:["style"],compact:["save","undoredo","style","alignment","lists","links","fullscreen"],normal:["save","copypaste","undoredo","style","alignment","colors","indent","lists","links","elements","images","fullscreen"],complete:["save","copypaste","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","fullscreen"],maxi:["save","copypaste","undoredo","elfinder","style","alignment","direction","colors","format","indent","lists","links","elements","media","tables","fullscreen"],eldorado:["save","copypaste","elfinder","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"]},panelNames:{save:"Save",copypaste:"Copy/Pase",undoredo:"Undo/Redo",style:"Text styles",colors:"Colors",alignment:"Alignment",indent:"Indent/Outdent",format:"Text format",lists:"Lists",elements:"Misc elements",direction:"Script direction",links:"Links",images:"Images",media:"Media",tables:"Tables",elfinder:"File manager (elFinder)"}}}(jQuery),function(n){elRTE.prototype.selection=function(t){function u(){return i.rte.window.getSelection?i.rte.window.getSelection():i.rte.window.document.selection}function s(n,t,r){while(n.nodeName!="BODY"&&n.parentNode&&n.parentNode.nodeName!="BODY"&&(t?n!==t&&n.parentNode!=t:1)&&(r=="left"&&i.rte.dom.isFirstNotEmpty(n)||r=="right"&&i.rte.dom.isLastNotEmpty(n)||i.rte.dom.isFirstNotEmpty(n)&&i.rte.dom.isLastNotEmpty(n)))n=n.parentNode;return n}var i,f,r,e,o;this.rte=t,i=this,this.w3cRange=null,n(this.rte.doc).keyup(function(n){(n.ctrlKey||n.metaKey||n.keyCode>=8&&n.keyCode<=13||n.keyCode>=32&&n.keyCode<=40||n.keyCode==46||n.keyCode>=96&&n.keyCode<=111)&&i.cleanCache()}).mousedown(function(n){f=n.target.nodeName=="HTML"?i.rte.doc.body:n.target,r=e=null}).mouseup(function(n){r=n.target.nodeName=="HTML"?i.rte.doc.body:n.target,r=n.target,e=null}).click(),this.collapsed=function(){return this.getRangeAt().isCollapsed()},this.collapse=function(t){var i=u(),r=this.getRangeAt();return r.collapse(t?!0:!1),n.browser.msie||(i.removeAllRanges(),i.addRange(r)),this},this.getRangeAt=function(n){if(this.rte.browser.msie)return this.w3cRange||(this.w3cRange=new this.rte.w3cRange(this.rte)),n&&this.w3cRange.update(),this.w3cRange;var i=u(),t=i.rangeCount>0?i.getRangeAt(0):this.rte.doc.createRange();return t.getStart=function(){return this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(this.startOffset,this.startContainer.childNodes.length-1)]:this.startContainer},t.getEnd=function(){return this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(this.startOffset==this.endOffset?this.endOffset:this.endOffset-1,this.endContainer.childNodes.length-1)]:this.endContainer},t.isCollapsed=function(){return this.collapsed},t},this.saveIERange=function(){n.browser.msie&&(o=this.getRangeAt().getBookmark())},this.restoreIERange=function(){n.browser.msie&&o&&this.getRangeAt().moveToBookmark(o)},this.cloneContents=function(){var i=this.rte.dom.create("div"),r,u,t;if(n.browser.msie){try{r=this.rte.window.document.selection.createRange()}catch(f){r=this.rte.doc.body.createTextRange()}n(i).html(r.htmlText)}else for(u=this.getRangeAt().cloneContents(),t=0;t<u.childNodes.length;t++)i.appendChild(u.childNodes[t].cloneNode(!0));return i},this.select=function(n,t){var r,i;if(t=t||n,this.rte.browser.msie){var i=this.rte.doc.body.createTextRange(),f=i.duplicate(),e=i.duplicate();f.moveToElementText(n),e.moveToElementText(t),i.setEndPoint("StartToStart",f),i.setEndPoint("EndToEnd",e),i.select()}else r=u(),i=this.getRangeAt(),i.setStartBefore(n),i.setEndAfter(t),r.removeAllRanges(),r.addRange(i);return this.cleanCache()},this.selectContents=function(n){var t=this.getRangeAt(),i;if(n&&n.nodeType==1)if(this.rte.browser.msie)t.range(),t.r.moveToElementText(n.parentNode),t.r.select();else{try{t.selectNodeContents(n)}catch(r){return this.rte.log("unable select node contents "+n)}i=u(),i.removeAllRanges(),i.addRange(t)}return this},this.deleteContents=function(){return n.browser.msie||this.getRangeAt().deleteContents(),this},this.insertNode=function(t,i){var e,r,f;return i&&!this.collapsed()&&this.collapse(),this.rte.browser.msie?(e=t.nodeType==3?t.nodeValue:n(this.rte.dom.create("span")).append(n(t)).html(),r=this.getRangeAt(),r.insertNode(e)):(r=this.getRangeAt(),r.insertNode(t),r.setStartAfter(t),r.setEndAfter(t),f=u(),f.removeAllRanges(),f.addRange(r)),this.cleanCache()},this.insertHtml=function(t,i){if(i&&!this.collapsed()&&this.collapse(),this.rte.browser.msie)this.getRangeAt().range().pasteHTML(t);else{var r=n(this.rte.dom.create("span")).html(t||"").get(0);this.insertNode(r),n(r).replaceWith(n(r).html())}return this.cleanCache()},this.insertText=function(n){var t=this.rte.doc.createTextNode(n);return this.insertHtml(t.nodeValue)},this.getBookmark=function(){var i,r,o,s,f,e,c,h,t;if(this.rte.window.focus(),f=this.rte.dom.createBookmark(),e=this.rte.dom.createBookmark(),n.browser.msie){try{t=this.rte.window.document.selection.createRange()}catch(e){t=this.rte.doc.body.createTextRange()}t.item&&(c=t.item(0),t=this.rte.doc.body.createTextRange(),t.moveToElementText(c)),i=t.duplicate(),r=t.duplicate(),o=this.rte.dom.create("span"),s=this.rte.dom.create("span"),o.appendChild(f),s.appendChild(e),i.collapse(!0),i.pasteHTML(o.innerHTML),r.collapse(!1),r.pasteHTML(s.innerHTML)}else h=u(),t=h.rangeCount>0?h.getRangeAt(0):this.rte.doc.createRange(),i=t.cloneRange(),r=t.cloneRange(),r.collapse(!1),r.insertNode(e),i.collapse(!0),i.insertNode(f),this.select(f,e);return[f.id,e.id]},this.moveToBookmark=function(t){if(this.rte.window.focus(),t&&t.length==2){var i=this.rte.doc.getElementById(t[0]),r=this.rte.doc.getElementById(t[1]),f,e;i&&r&&(this.select(i,r),this.rte.dom.next(i)==r&&this.collapse(!0),n.browser.msie||(f=u(),e=f.rangeCount>0?f.getRangeAt(0):this.rte.doc.createRange(),f.removeAllRanges(),f.addRange(e)),i.parentNode.removeChild(i),r.parentNode.removeChild(r))}return this},this.removeBookmark=function(n){if(this.rte.window.focus(),n.length==2){var t=this.rte.doc.getElementById(n[0]),i=this.rte.doc.getElementById(n[1]);t&&i&&(t.parentNode.removeChild(t),i.parentNode.removeChild(i))}},this.cleanCache=function(){return f=r=e=null,this},this.getStart=function(){if(!f){var n=this.getRangeAt();f=n.getStart()}return f},this.getEnd=function(){if(!r){var n=this.getRangeAt();r=n.getEnd()}return r},this.getNode=function(){return e||(e=this.rte.dom.findCommonAncestor(this.getStart(),this.getEnd())),e},this.selected=function(t){function a(){function t(){for(var t=0;t<o.length;t++)if(o[t].nodeType==1&&(i.rte.dom.selfOrParent(o[t],/^P$/)||n(o[t]).find("p").length>0))return!1;return!0}if(o.length>0){var r=u.tag=="p"&&!t()?"div":u.tag,e=i.rte.dom.wrap(o,r);f[h]=e,h=null,o=[]}}function l(t){var e,t,r;if(t.nodeType==1)if(/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(t.nodeName))n(t).find("td,th").each(function(){var t=u.tag=="p"&&n(this).find("p").length>0?"div":u.tag,r=i.rte.dom.wrapContents(this,t);return f.push(r)});else if(/^(CAPTION|TD|TH|LI|DT|DD)$/.test(t.nodeName))return e=u.tag=="p"&&n(t).find("p").length>0?"div":u.tag,t=i.rte.dom.wrapContents(t,e),f.push(t);r=o.length>0?o[o.length-1]:null,r&&r!=i.rte.dom.prev(t)&&a(),o.push(t),h===null&&(h=f.length,f.push("dummy"))}var u={collapsed:!1,blocks:!1,filter:!1,wrap:"text",tag:"span"},c,s,r;if(u=n.extend({},u,t),u.blocks&&(r=this.getNode(),c=null,c=this.rte.dom.selfOrParent(r,"selectionBlock")))return[c];var e=this.selectedRaw(u.collapsed,u.blocks),f=[],o=[],h=null;if(e.nodes.length>0){for(s=0;s<e.nodes.length;s++){r=e.nodes[s],r.nodeType==3&&(s==0||s==e.nodes.length-1)&&n.trim(r.nodeValue).length>0&&(s==0&&e.so>0&&(r=r.splitText(e.so)),s==e.nodes.length-1&&e.eo>0&&r.splitText(s==0&&e.so>0?e.eo-e.so:e.eo));switch(u.wrap){case"text":r.nodeType==1&&r.nodeName=="BR"||r.nodeType==3&&n.trim(r.nodeValue).length>0?l(r):r.nodeType==1&&f.push(r);break;case"inline":this.rte.dom.isInline(r)?l(r):r.nodeType==1&&f.push(r);break;case"all":r.nodeType!=1&&this.rte.dom.isEmpty(r)||l(r);break;default:r.nodeType!=1&&this.rte.dom.isEmpty(r)||f.push(r)}}a()}return f.length&&(this.rte.window.focus(),this.select(f[0],f[f.length-1])),u.filter?this.rte.dom.filter(f,u.filter):f},this.dump=function(n,t,i,r,u){var f=this.getRangeAt();this.rte.log("commonAncestorContainer"),this.rte.log(n||f.commonAncestorContainer),this.rte.log("startContainer"),this.rte.log(t||f.startContainer),this.rte.log("startOffset: "+(r>=0?r:f.startOffset)),this.rte.log("endContainer"),this.rte.log(i||f.endContainer),this.rte.log("endOffset: "+(u>=0?u:f.endOffset))},this.selectedRaw=function(t,r){function b(t,i,r){return t.nodeType==3?(r=r>=0?r:t.nodeValue.length,i==0&&r==t.nodeValue.length||n.trim(t.nodeValue).length==n.trim(t.nodeValue.substring(i,r)).length):!0}function k(t,r,u){return t.nodeType==1?i.rte.dom.isEmpty(t):t.nodeType==3?n.trim(t.nodeValue.substring(r||0,u>=0?u:t.nodeValue.length)).length==0:!0}var u={so:null,eo:null,nodes:[]},o=this.getRangeAt(!0),v=o.commonAncestorContainer,f,e,p=!1,w=!1,l,a,h,y,c;if(o.startContainer.nodeType==1?o.startOffset<o.startContainer.childNodes.length?(f=o.startContainer.childNodes[o.startOffset],u.so=f.nodeType==1?null:0):(f=o.startContainer.childNodes[o.startOffset-1],u.so=f.nodeType==1?null:f.nodeValue.length):(f=o.startContainer,u.so=o.startOffset),o.collapsed)return t&&(r?(f=s(f),(!this.rte.dom.isEmpty(f)||(f=this.rte.dom.next(f)))&&(u.nodes=[f]),this.rte.dom.isInline(f)&&(u.nodes=this.rte.dom.toLineStart(f).concat(u.nodes,this.rte.dom.toLineEnd(f))),u.nodes.length>0&&(u.so=u.nodes[0].nodeType==1?null:0,u.eo=u.nodes[u.nodes.length-1].nodeType==1?null:u.nodes[u.nodes.length-1].nodeValue.length)):this.rte.dom.isEmpty(f)||(u.nodes=[f])),u;if(o.endContainer.nodeType==1?(e=o.endContainer.childNodes[o.endOffset-1],u.eo=e.nodeType==1?null:e.nodeValue.length):(e=o.endContainer,u.eo=o.endOffset),(f.nodeType==1||r||b(f,u.so,f.nodeValue.length))&&(f=s(f,v,"left"),p=!0,u.so=f.nodeType==1?null:0),(e.nodeType==1||r||b(e,0,u.eo))&&(e=s(e,v,"right"),w=!0,u.eo=e.nodeType==1?null:e.nodeValue.length),r&&(f.nodeType!=1&&f.parentNode!=v&&f.parentNode.nodeName!="BODY"&&(f=f.parentNode,u.so=null),e.nodeType!=1&&e.parentNode!=v&&e.parentNode.nodeName!="BODY"&&(e=e.parentNode,u.eo=null)),f.parentNode==e.parentNode&&f.parentNode.nodeName!="BODY"&&p&&this.rte.dom.isFirstNotEmpty(f)&&w&&this.rte.dom.isLastNotEmpty(e)&&(f=e=f.parentNode,u.so=f.nodeType==1?null:0,u.eo=e.nodeType==1?null:e.nodeValue.length),f==e)return this.rte.dom.isEmpty(f)||u.nodes.push(f),u;for(l=f;l.nodeName!="BODY"&&l.parentNode!==v&&l.parentNode.nodeName!="BODY";)l=l.parentNode;for(a=e;a.nodeName!="BODY"&&a.parentNode!==v&&a.parentNode.nodeName!="BODY";)a=a.parentNode;for(k(f,u.so,f.nodeType==3?f.nodeValue.length:null)||u.nodes.push(f),h=f;h!==l;){for(c=h;c=this.rte.dom.next(c);)u.nodes.push(c);h=h.parentNode}for(h=l;(h=this.rte.dom.next(h))&&h!=a;)u.nodes.push(h);for(y=[],h=e;h!==a;){for(c=h;c=this.rte.dom.prev(c);)y.push(c);h=h.parentNode}return y.length&&(u.nodes=u.nodes.concat(y.reverse())),k(e,0,e.nodeType==3?u.eo:null)||u.nodes.push(e),r&&(this.rte.dom.isInline(f)&&(u.nodes=this.rte.dom.toLineStart(f).concat(u.nodes),u.so=u.nodes[0].nodeType==1?null:0),this.rte.dom.isInline(e)&&(u.nodes=u.nodes.concat(this.rte.dom.toLineEnd(e)),u.eo=u.nodes[u.nodes.length-1].nodeType==1?null:u.nodes[u.nodes.length-1].nodeValue.length)),u}}}(jQuery),function(n){elRTE.prototype.ui=function(t){this.rte=t,this._buttons=[];var l=this,f=this.rte.options.toolbars[t.options.toolbar&&t.options.toolbars[t.options.toolbar]?t.options.toolbar:"normal"],r=f.length,e,i,o,s,h,c,u;for(u in this.buttons)this.buttons.hasOwnProperty(u)&&u!="button"&&(this.buttons[u].prototype=this.buttons.button.prototype);while(r--){if(first=r==0?!0:!1,f[r-1]=="eol"&&(first=!0),i=f[r],i=="eol"){n(this.rte.doc.createElement("br")).prependTo(this.rte.toolbar);continue}for(e=n('<ul class="panel-'+i+(first?" first":"")+'" />').prependTo(this.rte.toolbar),e.bind("mousedown",function(n){n.preventDefault()}),o=this.rte.options.panels[i].length;o--;)s=this.rte.options.panels[i][o],h=this.buttons[s]||this.buttons.button,this._buttons.push(c=new h(this.rte,s)),e.prepend(c.domElem)}this.update(),this.disable=function(){n.each(l._buttons,function(){this.active||this.domElem.addClass("disabled")})}},elRTE.prototype.ui.prototype.update=function(t){function s(t){var i=t.nodeName.toLowerCase();return t=n(t),i=="img"&&(t.hasClass("elrte-media")?i="media":t.hasClass("elrte-google-maps")?i="google map":t.hasClass("elrte-yandex-maps")?i="yandex map":t.hasClass("elrte-pagebreak")&&(i="pagebreak")),i}t&&this.rte.selection.cleanCache();var i=this.rte.selection.getNode(),r=this.rte.dom.parents(i,"*"),f=this.rte.rtl,o=f?" &laquo; ":" &raquo; ",e="",u;for(i&&i.nodeType==1&&i.nodeName!="BODY"&&r.unshift(i),f||(r=r.reverse()),u=0;u<r.length;u++)e+=(u>0?o:"")+s(r[u]);this.rte.statusbar.html(e),n.each(this._buttons,function(){this.update()}),this.rte.window.focus()},elRTE.prototype.ui.prototype.buttons={button:function(t,i){var r=this;this.rte=t,this.active=!1,this.name=i,this.val=null,this.domElem=n('<li style="-moz-user-select:-moz-none" class="'+i+' rounded-3" name="'+i+'" title="'+this.rte.i18n(this.rte.options.buttons[i]||i)+'" unselectable="on" />').hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault(),n(this).hasClass("disabled")||r.command(),r.rte.window.focus()})}},elRTE.prototype.ui.prototype.buttons.button.prototype.command=function(){this.rte.history.add();try{this.rte.doc.execCommand(this.name,!1,this.val)}catch(n){return this.rte.log("commands failed: "+this.name)}this.rte.ui.update(!0)},elRTE.prototype.ui.prototype.buttons.button.prototype.update=function(){try{if(this.rte.doc.queryCommandEnabled(this.name))this.domElem.removeClass("disabled");else return this.domElem.addClass("disabled")}catch(n){return}try{this.rte.doc.queryCommandState(this.name)?this.domElem.addClass("active"):this.domElem.removeClass("active")}catch(n){}}}(jQuery),function(n){elRTE.prototype.utils=function(t){this.rte=t,this.url=null,this.reg=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,this.baseURL="",this.path="",this.entities={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},this.entitiesRegExp=/[<>&\"]/g,this.media=[{type:"application/x-shockwave-flash",classid:["clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"},{type:"application/x-director",classid:["clsid:166b1bca-3f9c-11cf-8075-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0"},{type:"application/x-mplayer2",classid:["clsid:6bf52a52-394a-11d3-b153-00c04f79faa6","clsid:22d6f312-b0f6-11d0-94ab-0080c74c7e95","clsid:05589fa1-c356-11ce-bf01-00aa0055595a"],codebase:"http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"},{type:"video/quicktime",classid:["clsid:02bf25d5-8c17-4b23-bc80-d3488abddc6b"],codebase:"http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"},{type:"audio/x-pn-realaudio-plugin",classid:["clsid:cfcdaa03-8be4-11cf-b84b-0020afbbccfa"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"}],this.rgbRegExp=/\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*/i,this.colorsRegExp=/aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\s*\([^\)]+\)/i,this.colors={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#fffffff",yellow:"#ffff00"};var i=this;this.rgb2hex=function(n){return this.color2Hex(""+n)},this.toPixels=function(t){var r=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/),i;if(r&&(t=r[1],unit=r[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t),isNaN(t))return"";i=parseInt(n(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*i);case"pt":return parseInt(t*i/12);case"%":return parseInt(t*i/100)}return t},this.absoluteURL=function(t){if(this.url||this._url(),t=n.trim(t),!t)return"";if(t[0]=="#")return t;var i=this.parseURL(t);return!i.host&&!i.path&&!i.anchor?"":this.rte.options.absoluteURLs?i.protocol?t:i.host&&(i.host.indexOf(".")!=-1||i.host=="localhost")?this.url.protocol+"://"+t:(t[0]=="/"?t=this.baseURL+t:(t.indexOf("./")==0&&(t=t.substring(2)),t=this.baseURL+this.path+t),t):t},this.parseURL=function(t){var r=t.match(this.reg),i={};return n.each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(n){i[this]=r[n]}),i.host.match(/[a-z0-9]/i)||(i.host=""),i},this.trimEventCallback=function(t){return t=t?t.toString():"",n.trim(t.replace(/\r*\n/mg,"").replace(/^function\s*on[a-z]+\s*\(\s*event\s*\)\s*\{(.+)\}$/igm,"$1"))},this._url=function(){this.url=this.parseURL(window.location.href),this.baseURL=this.url.protocol+"://"+(this.url.userInfo?parts.userInfo+"@":"")+this.url.host+(this.url.port?":"+this.url.port:""),this.path=this.url.file?this.url.path.substring(0,this.url.path.length-this.url.file.length):this.url.path},this.makeObject=function(t){var i={};return n.each(t,function(n,t){i[t]=t}),i},this.encode=function(n){var t=this.entities;return(""+n).replace(this.entitiesRegExp,function(n){return t[n]})},this.decode=function(t){return n("<div/>").html(t||"").text()},this.parseStyle=function(t){var f={},e=this.rte.options.allowBrowsersSpecStyles,i,r,u;return typeof t=="string"&&t.length&&n.each(t.replace(/&quot;/gi,"'").split(";"),function(t,o){(u=o.indexOf(":"))!==-1&&(i=n.trim(o.substr(0,u)),r=n.trim(o.substr(u+1)),(i=="color"||i=="background-color")&&(r=r.toLowerCase()),i&&r&&(e||i.substring(0,1)!="-")&&(f[i]=r))}),f},this.compactStyle=function(t){var i=this;return t.border=="medium none"&&delete t.border,n.each(t,function(n,r){/color$/i.test(n)?t[n]=i.color2Hex(r):/^(border|background)$/i.test(n)&&(t[n]=r.replace(i.colorsRegExp,function(n){return i.color2Hex(n)}))}),t["border-width"]&&(t.border=t["border-width"]+" "+(t["border-style"]||"solid")+" "+(t["border-color"]||"#000"),delete t["border-width"],delete t["border-style"],delete t["border-color"]),t["background-image"]&&(t.background=t["background-color"]+" "||""+t["background-image"]+" "+t["background-position"]||"0 0 "+t["background-repeat"]||"repeat",delete t["background-image"],delete["background-image"],delete["background-position"],delete["background-repeat"]),t["margin-top"]&&t["margin-right"]&&t["margin-bottom"]&&t["margin-left"]&&(t.margin=t["margin-top"]+" "+t["margin-right"]+" "+t["margin-bottom"]+" "+t["margin-left"],delete t["margin-top"],delete t["margin-right"],delete t["margin-bottom"],delete t["margin-left"]),t["padding-top"]&&t["padding-right"]&&t["padding-bottom"]&&t["padding-left"]&&(t.padding=t["padding-top"]+" "+t["padding-right"]+" "+t["padding-bottom"]+" "+t["padding-left"],delete t["padding-top"],delete t["padding-right"],delete t["padding-bottom"],delete t["padding-left"]),(t["list-style-type"]||t["list-style-position"]||t["list-style-image"])&&(t["list-style"]=n.trim(t["list-style-type"]||" "+t["list-style-position"]||""+t["list-style-image"]||""),delete t["list-style-type"],delete t["list-style-position"],delete t["list-style-image"]),t},this.serializeStyle=function(t,i){var r=[];return n.each(i?this.compactStyle(t):t,function(n,t){t&&r.push(n+":"+t)}),r.join(";")},this.parseClass=function(t){return t=n.trim(t),t.length?this.makeObject(t.split(/\s+/)):{}},this.serializeClass=function(t){var i=[],r=this.rte;return n.each(t,function(n){i.push(n)}),i.join(" ")},this.mediaInfo=function(t,i){for(var r=this.media.length;r--;)if(t===this.media[r].type||i&&n.inArray(i,this.media[r].classid)!=-1)return this.media[r]},this.color2Hex=function(n){function i(n){return n=parseInt(n).toString(16),n.length>1?n:"0"+n}var t;return(n=n||"",n.indexOf("#")===0)?n:this.colors[n]?this.colors[n]:(t=n.match(this.rgbRegExp))?"#"+i(t[1])+i(t[2])+i(t[3]):""}}}(jQuery),function(){elRTE.prototype.w3cRange=function(n){var t=this;this.rte=n,this.r=null,this.collapsed=!0,this.startContainer=null,this.endContainer=null,this.startOffset=0,this.endOffset=0,this.commonAncestorContainer=null,this.range=function(){try{this.r=this.rte.window.document.selection.createRange()}catch(n){this.r=this.rte.doc.body.createTextRange()}return this.r},this.insertNode=function(n){this.range(),t.r.collapse(!1);var i=t.r.duplicate();i.pasteHTML(n)},this.getBookmark=function(){if(this.range(),this.r.item){var n=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(n)}return this.r.getBookmark()},this.moveToBookmark=function(n){this.rte.window.focus(),this.range().moveToBookmark(n),this.r.select()},this.update=function(){function u(n){var s="﻿",e=offset=0,u=t.r.duplicate(),i,r,f,o;if(u.collapse(n),i=u.parentElement(),!i||i.nodeName=="HTML")return{parent:t.rte.doc.body,ndx:e,offset:offset};for(u.pasteHTML(s),childs=i.childNodes,r=0;r<childs.length;r++)if(f=childs[r],r>0&&(f.nodeType!==3||childs[r-1].nodeType!==3)&&e++,f.nodeType!==3)offset=0;else{if(o=f.nodeValue.indexOf(s),o!==-1){offset+=o;break}offset+=f.nodeValue.length}return u.moveStart("character",-1),u.text="",{parent:i,ndx:Math.min(e,i.childNodes.length-1),offset:offset}}var r,n,i;return this.range(),this.startContainer=this.endContainer=null,this.r.item?(this.collapsed=!1,r=this.r.item(0),this.setStart(r.parentNode,this.rte.dom.indexOf(r)),this.setEnd(r.parentNode,this.startOffset+1)):(this.collapsed=this.r.boundingWidth==0,n=u(!0),i=u(!1),n.parent.normalize(),i.parent.normalize(),n.ndx=Math.min(n.ndx,n.parent.childNodes.length-1),i.ndx=Math.min(i.ndx,i.parent.childNodes.length-1),n.parent.childNodes[n.ndx].nodeType&&n.parent.childNodes[n.ndx].nodeType==1?this.setStart(n.parent,n.ndx):this.setStart(n.parent.childNodes[n.ndx],n.offset),i.parent.childNodes[i.ndx].nodeType&&i.parent.childNodes[i.ndx].nodeType==1?this.setEnd(i.parent,i.ndx):this.setEnd(i.parent.childNodes[i.ndx],i.offset),this.select()),this},this.isCollapsed=function(){return this.range(),this.collapsed=this.r.item?!1:this.r.boundingWidth==0,this.collapsed},this.collapse=function(n){if(this.range(),this.r.item){var t=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(t)}this.r.collapse(n),this.r.select(),this.collapsed=!0},this.getStart=function(){var t,n;return(this.range(),this.r.item)?this.r.item(0):(t=this.r.duplicate(),t.collapse(!0),n=t.parentElement(),n&&n.nodeName=="BODY"?n.firstChild:n)},this.getEnd=function(){var t,n;return(this.range(),this.r.item)?this.r.item(0):(t=this.r.duplicate(),t.collapse(!1),n=t.parentElement(),n&&n.nodeName=="BODY"?n.lastChild:n)},this.setStart=function(n,t){this.startContainer=n,this.startOffset=t,this.endContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setEnd=function(n,t){this.endContainer=n,this.endOffset=t,this.startContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setStartBefore=function(n){n.parentNode&&this.setStart(n.parentNode,this.rte.dom.indexOf(n))},this.setStartAfter=function(n){n.parentNode&&this.setStart(n.parentNode,this.rte.dom.indexOf(n)+1)},this.setEndBefore=function(n){n.parentNode&&this.setEnd(n.parentNode,this.rte.dom.indexOf(n))},this.setEndAfter=function(n){n.parentNode&&this.setEnd(n.parentNode,this.rte.dom.indexOf(n)+1)},this.select=function(){function f(n,i){var e;if(n.nodeType!=3)return-1;var f="﻿",r=n.nodeValue,u=t.rte.doc.body.createTextRange();return n.nodeValue=r.substring(0,i)+f+r.substring(i),u.moveToElementText(n.parentNode),u.findText(f),e=Math.abs(u.moveStart("character",-1048575)),n.nodeValue=r,e}var o;this.r=this.rte.doc.body.createTextRange();var r=this.startOffset,u=this.endOffset,n=this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(r,this.startContainer.childNodes.length-1)]:this.startContainer,e=this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(r==u?u:u-1,this.endContainer.childNodes.length-1)]:this.endContainer;if(this.collapsed)n.nodeType==3?(o=f(n,r),this.r.move("character",o)):(this.r.moveToElementText(n),this.r.collapse(!0));else{var i=this.rte.doc.body.createTextRange(),s=f(n,r),h=f(e,u);n.nodeType==3?this.r.move("character",s):this.r.moveToElementText(n),e.nodeType==3?i.move("character",h):i.moveToElementText(e),this.r.setEndPoint("EndToEnd",i)}try{this.r.select()}catch(e){}i&&(i=null)},this.dump=function(){this.rte.log("collapsed: "+this.collapsed),this.rte.log("startContainer: "+(this.startContainer?this.startContainer.nodeName:"non")),this.rte.log("startOffset: "+this.startOffset),this.rte.log("endContainer: "+(this.endContainer?this.endContainer.nodeName:"none")),this.rte.log("endOffset: "+this.endOffset)}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.about=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.active=!0,this.command=function(){var r,i,u;r={rtl:t.rtl,submit:function(n,t){t.close()},dialog:{width:560,title:this.rte.i18n("About this software"),buttons:{Ok:function(){n(this).dialog("destroy")}}}},u='<div class="elrte-logo"><\/div><h3>'+this.rte.i18n("About elRTE")+'<\/h3><br clear="all"/><div class="elrte-ver">'+this.rte.i18n("Version")+": "+this.rte.version+" ("+this.rte.build+')<\/div><div class="elrte-ver">jQuery: '+n("<div/>").jquery+'<\/div><div class="elrte-ver">jQueryUI: '+n.ui.version+'<\/div><div class="elrte-ver">'+this.rte.i18n("Licence")+": BSD Licence<\/div><p>"+this.rte.i18n("elRTE is an open-source JavaScript based WYSIWYG HTML-editor.")+"<br/>"+this.rte.i18n("Main goal of the editor - simplify work with text and formating (HTML) on sites, blogs, forums and other online services.")+"<br/>"+this.rte.i18n("You can use it in any commercial or non-commercial projects.")+"<\/p><h4>"+this.rte.i18n("Authors")+'<\/h4><table class="elrte-authors"><tr><td>Dmitry (dio) Levashov &lt;dio@std42.ru&gt;<\/td><td>'+this.rte.i18n("Chief developer")+"<\/td><\/tr><tr><td>Troex Nevelin &lt;troex@fury.scancode.ru&gt;<\/td><td>"+this.rte.i18n("Developer, tech support")+"<\/td><\/tr><tr><td>Valentin Razumnyh &lt;content@std42.ru&gt;<\/td><td>"+this.rte.i18n("Interface designer")+"<\/td><\/tr><tr><td>Tawfek Daghistani &lt;tawfekov@gmail.com&gt;<\/td><td>"+this.rte.i18n("RTL support")+"<\/td><\/tr>"+(this.rte.options.lang!="en"?"<tr><td>"+this.rte.i18n("_translator")+"<\/td><td>"+this.rte.i18n("_translation")+"<\/td><\/tr>":"")+'<\/table><div class="elrte-copy">Copyright &copy; 2009-2011, <a href="http://www.std42.ru">Studio 42<\/a><\/div><div class="elrte-copy">'+this.rte.i18n("For more information about this software visit the")+' <a href="http://elrte.org">'+this.rte.i18n("elRTE website")+'.<\/a><\/div><div class="elrte-copy">Twitter: <a href="http://twitter.com/elrte_elfinder">elrte_elfinder<\/a><\/div>',i=new elDialogForm(r),i.append(u),i.open()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.anchor=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.input=n('<input type="text" />').attr("name","anchor").attr("size","16");var r=this;this.command=function(){var u={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Bookmark")}},i;this.anchor=this.rte.dom.selfOrParentAnchor(this.rte.selection.getEnd())||t.dom.create("a"),this.rte.selection.collapsed()||this.rte.selection.collapse(!1),this.input.val(n(this.anchor).addClass("elrte-anchor").attr("name")),this.rte.selection.saveIERange(),i=new elDialogForm(u),i.append([this.rte.i18n("Bookmark name"),this.input],null,!0).open(),setTimeout(function(){r.input.focus()},20)},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.addClass("disabled"):this.rte.dom.selfOrParentAnchor(n)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.removeClass("disabled").removeClass("active")},this.set=function(){var t=n.trim(this.input.val());t?(this.rte.history.add(),this.anchor.parentNode?(this.anchor.name=t,this.anchor.title=this.rte.i18n("Bookmark")+": "+t):this.rte.selection.insertHtml('<a name="'+t+'" title="'+this.rte.i18n("Bookmark")+": "+t+'" class="elrte-anchor"><\/a>')):this.anchor.parentNode&&(this.rte.history.add(),this.anchor.parentNode.removeChild(this.anchor))}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.blockquote=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i,t;this.rte.history.add(),this.rte.selection.collapsed()&&(i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/))?n(i).replaceWith(n(i).html()):(t=this.rte.selection.selected({wrap:"all",tag:"blockquote"}),t.length&&this.rte.selection.select(t[0],t[t.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.copy=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var t,i,r;if(this.rte.browser.mozilla)try{this.rte.doc.execCommand(this.name,!1,null)}catch(u){t=" Ctl + C",this.name=="cut"?t=" Ctl + X":this.name=="paste"&&(t=" Ctl + V"),i={dialog:{title:this.rte.i18n("Warning"),buttons:{Ok:function(){n(this).dialog("close")}}}},r=new elDialogForm(i),r.append(this.rte.i18n("This operation is disabled in your browser on security reason. Use shortcut instead.")+": "+t).open()}else this.constructor.prototype.command.call(this)}},elRTE.prototype.ui.prototype.buttons.cut=elRTE.prototype.ui.prototype.buttons.copy,elRTE.prototype.ui.prototype.buttons.paste=elRTE.prototype.ui.prototype.buttons.copy}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.css=function(t,i){var r=this;this.constructor.prototype.constructor.call(this,t,i),this.cssStyle=n('<input type="text" size="42" name="style" />'),this.cssClass=n('<input type="text" size="42" name="class" />'),this.elementID=n('<input type="text" size="42" name="id" />'),this.command=function(){var i=this.node(),u,t;this.rte.selection.saveIERange(),i&&(u={submit:function(n,t){n.stopPropagation(),n.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Style"),width:450,resizable:!0,modal:!0}},this.cssStyle.val(n(i).attr("style")),this.cssClass.val(n(i).attr("class")),this.elementID.val(n(i).attr("id")),t=new elDialogForm(u),t.append([this.rte.i18n("Css style"),this.cssStyle],null,!0),t.append([this.rte.i18n("Css class"),this.cssClass],null,!0),t.append([this.rte.i18n("ID"),this.elementID],null,!0),t.open(),setTimeout(function(){r.cssStyle.focus()},20))},this.set=function(){var t=this.node();this.rte.selection.restoreIERange(),t&&(n(t).attr("style",this.cssStyle.val()),n(t).attr("class",this.cssClass.val()),n(t).attr("id",this.elementID.val()),this.rte.ui.update())},this.node=function(){var n=this.rte.selection.getNode();return n.nodeType==3&&(n=n.parentNode),n.nodeType==1&&n.nodeName!="BODY"?n:null},this.update=function(){this.domElem.toggleClass("disabled",this.node()?!1:!0)}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.rtl=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),i=this;n(t).attr("dir")=="rtl"||n(t).parents('[dir="rtl"]').length||n(t).find('[dir="rtl"]').length?(n(t).removeAttr("dir"),n(t).parents('[dir="rtl"]').removeAttr("dir"),n(t).find('[dir="rtl"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?n(t).attr("dir","rtl"):n.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(i.rte.dom.is(r,"block"))return n(r).attr("dir","rtl"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),n(t).attr("dir")=="rtl"||n(t).parents('[dir="rtl"]').length||n(t).find('[dir="rtl"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}},elRTE.prototype.ui.prototype.buttons.ltr=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),i=this;n(t).attr("dir")=="ltr"||n(t).parents('[dir="ltr"]').length||n(t).find('[dir="ltr"]').length?(n(t).removeAttr("dir"),n(t).parents('[dir="ltr"]').removeAttr("dir"),n(t).find('[dir="ltr"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?n(t).attr("dir","ltr"):n.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(i.rte.dom.is(r,"block"))return n(r).attr("dir","ltr"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),n(t).attr("dir")=="ltr"||n(t).parents('[dir="ltr"]').length||n(t).find('[dir="ltr"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.div=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i,t;this.rte.history.add(),this.rte.selection.collapsed()?(i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/),i&&n(i).replaceWith(n(i).html())):(t=this.rte.selection.selected({wrap:"all",tag:"div"}),t.length&&this.rte.selection.select(t[0],t[t.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.docstructure=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){this.domElem.toggleClass("active"),n(this.rte.doc.body).toggleClass("el-rte-structure")},this.command(),this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.elfinder=function(n,t){this.constructor.prototype.constructor.call(this,n,t);var i=this,n=this.rte;this.command=function(){i.rte.options.fmAllow&&typeof i.rte.options.fmOpen=="function"&&i.rte.options.fmOpen(function(t){var i=decodeURIComponent(t.split("/").pop().replace(/\+/g," "));n.selection.collapsed()?n.selection.insertHtml('<a href="'+t+'" >'+i+"<\/a>"):n.doc.execCommand("createLink",!1,t)})},this.update=function(){i.rte.options.fmAllow&&typeof i.rte.options.fmOpen=="function"?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.flash=function(t,r){this.constructor.prototype.constructor.call(this,t,r);var u=this;this.swf=null,this.placeholder=null,this.src={url:n('<input type="text" name="url" />').css("width","99%"),type:n('<select name="type"/>').append('<option value="application/x-shockwave-flash">Flash<\/option>').append('<option value="video/quicktime">Quicktime movie<\/option>').append('<option value="application/x-mplayer2">Windows media<\/option>'),width:n('<input type="text" />').attr("size",5).css("text-align","right"),height:n('<input type="text" />').attr("size",5).css("text-align","right"),wmode:n("<select />").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("transparent").text(this.rte.i18n("Transparent"))),align:n("<select />").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("left").text(this.rte.i18n("Left"))).append(n("<option />").val("right").text(this.rte.i18n("Right"))).append(n("<option />").val("top").text(this.rte.i18n("Top"))).append(n("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(n("<option />").val("middle").text(this.rte.i18n("middle"))).append(n("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(n("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(n("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))),margin:n("<div />")},this.command=function(){var i=this.rte.selection.getEnd(),e="",o="",s="",h,c,v,t,y,a,r,p,w,f;if(this.rte.selection.saveIERange(),this.src.margin.elPaddingInput({type:"margin"}),this.placeholder=null,this.swf=null,n(i).hasClass("elrte-media")&&(v=n(i).attr("rel"))&&this.rte.filter.scripts[v]){if(this.placeholder=n(i),t=this.rte.filter.scripts[v],e="",t.embed&&t.embed.src&&(e=t.embed.src),t.params&&t.params.length)for(l=t.params.length;l--;)(t.params[l].name=="src"||t.params[l].name=="movie")&&(e=t.params[l].value);t.embed?(o=t.embed.width||parseInt(t.embed.style.width)||"",s=t.embed.height||parseInt(t.embed.style.height)||"",y=t.embed.wmode||""):t.obj&&(o=t.obj.width||parseInt(t.obj.style.width)||"",s=t.obj.height||parseInt(t.obj.style.height)||"",y=t.obj.wmode||""),t.obj?(h=t.obj.style.float||"",c=t.obj.style["vertical-align"]||""):t.embed&&(h=t.embed.style.float||"",c=t.embed.style["vertical-align"]||""),this.src.margin.val(i),this.src.type.val(t.embed?t.embed.type:"")}n(i).hasClass("elrte-swf-placeholder")&&(this.placeholder=n(i),e=n(i).attr("rel"),o=parseInt(n(i).css("width"))||"",s=parseInt(n(i).css("height"))||"",h=n(i).css("float"),c=n(i).css("vertical-align"),this.src.margin.val(i),this.src.wmode.val(n(i).attr("wmode"))),this.src.url.val(e),this.src.width.val(o),this.src.height.val(s),this.src.align.val(h||c),this.src.wmode.val(y),a={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),u.set(),t.close()},dialog:{width:580,position:"top",title:this.rte.i18n("Flash")}},r=new elDialogForm(a),p=this.rte.options.fmAllow&&this.rte.options.fmOpen?n("<span />").append(this.src.url.css("width","85%")).append(n("<span />").addClass("ui-state-default ui-corner-all").css({float:"right","margin-right":"3px"}).attr("title",u.rte.i18n("Open file manger")).append(n("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){u.rte.options.fmOpen(function(n){u.src.url.val(n).change()})}).hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")})):this.src.url,r.append([this.rte.i18n("URL"),p],null,!0),r.append([this.rte.i18n("Type"),this.src.type],null,!0),r.append([this.rte.i18n("Size"),n("<span />").append(this.src.width).append(" x ").append(this.src.height).append(" px")],null,!0),r.append([this.rte.i18n("Wmode"),this.src.wmode],null,!0),r.append([this.rte.i18n("Alignment"),this.src.align],null,!0),r.append([this.rte.i18n("Margins"),this.src.margin],null,!0),r.open(),w=n("<fieldset />").append(n("<legend />").text(this.rte.i18n("Preview"))),r.append(w,"main"),f=document.createElement("iframe"),n(f).attr("src","#").addClass("el-rte-preview").appendTo(w),html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><\/head><body style="padding:0;margin:0;font-size:9px"> Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin<\/body><\/html>',f.contentWindow.document.open(),f.contentWindow.document.write(html),f.contentWindow.document.close(),this.frame=f.contentWindow.document,this.preview=n(f.contentWindow.document.body),this.src.type.change(function(){u.src.url.change()}),this.src.width.change(function(){if(u.swf){var t=parseInt(n(this).val())||"";n(this).val(t),u.swf.css("width",t),u.swf.children("embed").css("width",t)}else n(this).val("")}),this.src.height.change(function(){if(u.swf){var t=parseInt(n(this).val())||"";n(this).val(t),u.swf.css("height",t),u.swf.children("embed").css("height",t)}else n(this).val("")}),this.src.wmode.change(function(){if(u.swf){var t=n(this).val();t?(u.swf.attr("wmode",t),u.swf.children("embed").attr("wmode",t)):(u.swf.removeAttr("wmode"),u.swf.children("embed").removeAttr("wmode"))}}),this.src.align.change(function(){var t=n(this).val(),i=t=="left"||t=="right";u.swf?u.swf.css({float:i?t:"","vertical-align":i?"":t}):n(this).val("")}),this.src.margin.change(function(){if(u.swf){var n=u.src.margin.val();n.css?u.swf.css("margin",n.css):(u.swf.css("margin-top",n.top),u.swf.css("margin-right",n.right),u.swf.css("margin-bottom",n.bottom),u.swf.css("margin-left",n.left))}}),this.src.url.change(function(){var i=u.rte.utils.absoluteURL(n(this).val()),t,r;i?(t=u.rte.utils.mediaInfo(u.src.type.val()),t||(t=u.rte.util.mediaInfo("application/x-shockwave-flash")),r='<object classid="'+t.classid+'" codebase="'+t.codebase+'"><param name="src" value="'+i+'" /><embed quality="high" src="'+i+'" type="'+t.type+'"><\/object>',u.preview.children("object").remove().end().prepend(r),u.swf=u.preview.children("object").eq(0)):u.swf&&(u.swf.remove(),u.swf=null),u.src.width.trigger("change"),u.src.height.trigger("change"),u.src.align.trigger("change")}).trigger("change")},this.set=function(){var l,p;u.swf=null;var f=this.rte.utils.absoluteURL(this.src.url.val()),o=parseInt(this.src.width.val())||"",s=parseInt(this.src.height.val())||"",w=this.src.wmode.val(),r=this.src.align.val(),h=r=="left"||r=="right"?r:"",c=this.placeholder?this.placeholder.attr("rel"):"",t,a,v,e=this.src.margin.val(),y;f?(i=u.rte.utils.mediaInfo(u.src.type.val()),i||(i=u.rte.util.mediaInfo("application/x-shockwave-flash")),v=this.rte.filter.videoHostRegExp.test(f)?f.replace(this.rte.filter.videoHostRegExp,"$2"):i.type.replace(/^\w+\/(.+)/,"$1"),t={obj:{classid:i.classid[0],codebase:i.codebase,style:{}},params:[{name:"src",value:f}],embed:{src:f,type:i.type,quality:"high",wmode:w,style:{}}},o&&(t.obj.width=o,t.embed.width=o),s&&(t.obj.height=s,t.embed.height=s),h?t.obj.style.float=h:r&&(t.obj.style["vertical-align"]=r),y=e.css?{margin:e.css}:{"margin-top":e.top,"margin-right":e.right,"margin-bottom":e.bottom,"margin-left":e.left},t.obj.style=n.extend({},t.obj.style,y),this.placeholder&&c?(a=this.rte.filter.scripts[c]||{},t=n.extend(!0,a,t),delete t.obj.style.width,delete t.obj.style.height,delete t.embed.style.width,delete t.embed.style.height,this.rte.filter.scripts[c]=t,this.placeholder.removeAttr("class")):(l="media"+Math.random().toString().substring(2),this.rte.filter.scripts[l]=t,this.placeholder=n(this.rte.dom.create("img")).attr("rel",l).attr("src",this.rte.filter.url+"pixel.gif"),p=!0),this.placeholder.attr("title",this.rte.utils.encode(f)).attr("width",o||150).attr("height",s||100).addClass("elrte-protected elrte-media elrte-media-"+v).css(t.obj.style),h?this.placeholder.css("float",h).css("vertical-align",""):r?this.placeholder.css("float","").css("vertical-align",r):this.placeholder.css("float","").css("vertical-align",""),p&&(this.rte.window.focus(),this.rte.selection.restoreIERange(),this.rte.selection.insertNode(this.placeholder.get(0)))):this.placeholder&&(this.placeholder.remove(),delete this.rte.filter.scripts[c])},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.domElem.toggleClass("active",t&&t.nodeName=="IMG"&&n(t).hasClass("elrte-media"))}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fontname=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var u=this,r={tpl:'<span style="font-family:%val">%label<\/span>',select:function(n){u.set(n)},src:{"":this.rte.i18n("Font"),"andale mono,sans-serif":"Andale Mono","arial,helvetica,sans-serif":"Arial","arial black,gadget,sans-serif":"Arial Black","book antiqua,palatino,sans-serif":"Book Antiqua","comic sans ms,cursive":"Comic Sans MS","courier new,courier,monospace":"Courier New","georgia,palatino,serif":"Georgia","helvetica,sans-serif":"Helvetica","impact,sans-serif":"Impact","lucida console,monaco,monospace":"Lucida console","lucida sans unicode,lucida grande,sans-serif":"Lucida grande","tahoma,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,lucida grande,verdana,sans-serif":"Trebuchet MS","verdana,geneva,sans-serif":"Verdana"}};this.select=this.domElem.elSelect(r),this.command=function(){},this.set=function(t){this.rte.history.add();var i=this.rte.selection.selected({filter:"textContainsNodes"});n.each(i,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?n(this).find("td,th"):n(this),n(this).css("font-family",t).find("[style]").css("font-family","")}),this.rte.ui.update()},this.update=function(){var i,t;this.domElem.removeClass("disabled"),i=this.rte.selection.getNode(),i.nodeType!=1&&(i=i.parentNode),t=n(i).css("font-family"),t=t?t.toString().toLowerCase().replace(/,\s+/g,",").replace(/'|"/g,""):"",this.select.val(r.src[t]?t:"")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fontsize=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this,u={labelTpl:"%label",tpl:'<span style="font-size:%val;line-height:1.2em">%label<\/span>',select:function(n){r.set(n)},src:{"":this.rte.i18n("Font size"),"xx-small":this.rte.i18n("Small (8pt)"),"x-small":this.rte.i18n("Small (10px)"),small:this.rte.i18n("Small (12pt)"),medium:this.rte.i18n("Normal (14pt)"),large:this.rte.i18n("Large (18pt)"),"x-large":this.rte.i18n("Large (24pt)"),"xx-large":this.rte.i18n("Large (36pt)")}};this.select=this.domElem.elSelect(u),this.command=function(){},this.set=function(t){this.rte.history.add();var i=this.rte.selection.selected({filter:"textContainsNodes"});n.each(i,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?n(this).find("td,th"):n(this),$this.css("font-size",t).find("[style]").css("font-size","")}),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var n=this.rte.selection.getNode();this.select.val((m=this.rte.dom.attr(n,"style").match(/font-size:\s*([^;]+)/i))?m[1]:"")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.forecolor=function(t,i){var r=this,u;this.constructor.prototype.constructor.call(this,t,i),u={"class":"",palettePosition:"outer",color:this.defaultColor,update:function(n){r.indicator.css("background-color",n)},change:function(n){r.set(n)}},this.defaultColor=this.name=="forecolor"?"#000000":"#ffffff",this.picker=this.domElem.elColorPicker(u),this.indicator=n("<div />").addClass("color-indicator").prependTo(this.domElem),this.command=function(){},this.set=function(t){if(!this.rte.selection.collapsed()){this.rte.history.add();var r=this.rte.selection.selected({collapse:!1,wrap:"text"}),i=this.name=="forecolor"?"color":"background-color";n.each(r,function(){/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)?n(this).find("td,th").each(function(){n(this).css(i,t).find("*").css(i,"")}):n(this).css(i,t).find("*").css(i,"")}),this.rte.ui.update(!0)}},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.picker.val(this.rte.utils.rgb2hex(n(t.nodeType!=1?t.parentNode:t).css(this.name=="forecolor"?"color":"background-color"))||this.defaultColor)}},elRTE.prototype.ui.prototype.buttons.hilitecolor=elRTE.prototype.ui.prototype.buttons.forecolor}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.formatblock=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var f=this.rte.browser.msie?function(n){r.val=n,r.constructor.prototype.command.call(r)}:function(n){r.ieCommand(n)},r=this,u={labelTpl:"%label",tpls:{"":"%label"},select:function(n){r.formatBlock(n)},src:{span:this.rte.i18n("Format"),h1:this.rte.i18n("Heading 1"),h2:this.rte.i18n("Heading 2"),h3:this.rte.i18n("Heading 3"),h4:this.rte.i18n("Heading 4"),h5:this.rte.i18n("Heading 5"),h6:this.rte.i18n("Heading 6"),p:this.rte.i18n("Paragraph"),address:this.rte.i18n("Address"),pre:this.rte.i18n("Preformatted"),div:this.rte.i18n("Normal (DIV)")}};this.select=this.domElem.elSelect(u),this.command=function(){},this.formatBlock=function(t){function h(t,i){function u(t){return n(t).find("h1,h2,h3,h4,h5,h6,p,address,pre").each(function(){n(this).replaceWith(n(this).html())}),t}/^(LI|DT|DD|TD|TH|CAPTION)$/.test(t.nodeName)?r.rte.dom.isEmpty(t)||r.rte.dom.wrapContents(u(t),i):/^(UL|OL|DL|TABLE)$/.test(t.nodeName)?r.rte.dom.wrap(t,i):r.rte.dom.isEmpty(t)||n(u(t)).replaceWith(n(r.rte.dom.create(i)).html(n(t).html()))}this.rte.history.add();var u=t.toUpperCase(),i,o,a=this.rte.selection.collapsed(),c=this.rte.selection.getBookmark(),f=this.rte.selection.selected({collapsed:!0,blocks:!0,filter:"textContainsNodes",wrap:"inline",tag:"span"});for(l=f.length,s=n(f[0]).prev(),e=n(f[f.length-1]).next();l--;)i=f[l],o=n(i),u=="DIV"||u=="SPAN"?/^(H[1-6]|P|ADDRESS|PRE)$/.test(i.nodeName)&&o.replaceWith(n(this.rte.dom.create("div")).html(o.html()||"")):/^(THEAD|TBODY|TFOOT|TR)$/.test(i.nodeName)?o.find("td,th").each(function(){h(this,u)}):i.nodeName!=u&&h(i,u);this.rte.selection.moveToBookmark(c),this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled");var n=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(H[1-6]|P|ADDRESS|PRE)$/);this.select.val(n?n.nodeName.toLowerCase():"span")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fullscreen=function(t,i){function u(){r.wz.height(n(window).height()-r.delta),r.rte.updateHeight()}var r=this;this.constructor.prototype.constructor.call(this,t,i),this.active=!0,this.editor=t.editor,this.wz=t.workzone,this.height=0,this.delta=0,this._class="el-fullscreen",setTimeout(function(){r.height=r.wz.height(),r.delta=r.editor.outerHeight()-r.height},50),this.command=function(){function v(){c&&(l=h.getBookmark())}function y(){c&&(r.wz.children().toggle(),r.rte.source.focus(),r.wz.children().toggle(),h.moveToBookmark(l))}var i=n(window),t=this.editor,a=t.parents().filter(function(t,i){return!/^(html|body)$/i.test(i.nodeName)&&n(i).css("position")=="relative"}),o=this.wz,f=this._class,e=t.hasClass(f),s=this.rte,h=this.rte.selection,c=n.browser.mozilla,l;v(),a.css("position",e?"relative":"static"),e?(t.removeClass(f),o.height(this.height),i.unbind("resize",u),this.domElem.removeClass("active")):(t.addClass(f).removeAttr("style"),o.height(i.height()-this.delta).css("width","100%"),i.bind("resize",u),this.domElem.addClass("active")),s.updateHeight(),s.resizable(e),y()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.horizontalrule=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src={width:n('<input type="text" />').attr({name:"width",size:4}).css("text-align","right"),wunit:n("<select />").attr("name","wunit").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")).val("%"),height:n('<input type="text" />').attr({name:"height",size:4}).css("text-align","right"),bg:n("<div />"),border:n("<div />"),"class":n('<input type="text" />').css("width","100%"),style:n('<input type="text" />').css("width","100%")},this.command=function(){var i,u,f,e;this.src.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),i=this.rte.selection.getEnd(),this.hr=i.nodeName=="HR"?n(i):n(t.doc.createElement("hr")).css({width:"100%",height:"1px"}),this.src.border.elBorderSelect({styleHeight:73,value:this.hr}),u=this.hr.css("width")||this.hr.attr("width"),this.src.width.val(parseInt(u)||100),this.src.wunit.val(u.indexOf("px")!=-1?"px":"%"),this.src.height.val(this.rte.utils.toPixels(this.hr.css("height")||this.hr.attr("height"))||1),this.src.bg.val(this.rte.utils.color2Hex(this.hr.css("background-color"))),this.src["class"].val(this.rte.dom.attr(this.hr,"class")),this.src.style.val(this.rte.dom.attr(this.hr,"style")),f={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{title:this.rte.i18n("Horizontal rule")}},e=new elDialogForm(f),e.append([this.rte.i18n("Width"),n("<span />").append(this.src.width).append(this.src.wunit)],null,!0).append([this.rte.i18n("Height"),n("<span />").append(this.src.height).append(" px")],null,!0).append([this.rte.i18n("Border"),this.src.border],null,!0).append([this.rte.i18n("Background"),this.src.bg],null,!0).append([this.rte.i18n("Css class"),this.src["class"]],null,!0).append([this.rte.i18n("Css style"),this.src.style],null,!0).open()},this.update=function(){this.domElem.removeClass("disabled"),this.rte.selection.getEnd().nodeName=="HR"?this.domElem.addClass("active"):this.domElem.removeClass("active")},this.set=function(){this.rte.history.add(),this.hr.parentNode||this.rte.selection.insertNode(this.hr.get(0));var t={noshade:!0,style:this.src.style.val()},n=this.src.border.val(),i={width:(parseInt(this.src.width.val())||100)+this.src.wunit.val(),height:parseInt(this.src.height.val())||1,"background-color":this.src.bg.val(),border:n.width&&n.style?n.width+" "+n.style+" "+n.color:""};this.hr.removeAttr("class").removeAttr("style").removeAttr("width").removeAttr("height").removeAttr("align").attr(t).css(i),this.src["class"].val()&&this.hr.attr("class",this.src["class"].val()),this.rte.ui.update()}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.image=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this,t=r.rte,o=0,u=0,f=0,e=null,s=function(t){n.each(r.src,function(i,r){n.each(r,function(n,i){n=="src"&&t||i.val("")})})},h=function(i){n.each(r.src,function(r,u){n.each(u,function(n,u){var f,o,s,e;n=="width"?f=i.width():n=="height"?f=i.height():n=="border"?(f="",e=i.css("border")||t.utils.parseStyle(i.attr("style")).border||"",e&&(o=e.match(/(\d(px|em|%))/),s=e.match(/(#[a-z0-9]+)/),f={width:o?o[1]:e,style:e,color:t.utils.color2Hex(s?s[1]:e)})):n=="margin"?f=i:n=="align"?(f=i.css("float"),f!="left"&&f!="right"&&(f=i.css("vertical-align"))):f=i.attr(n)||"",r=="events"&&(f=t.utils.trimEventCallback(f)),u.val(f)})})},l=function(){var t=r.src.main.src.val();s(!0),t?(r.prevImg?(r.prevImg.removeAttr("src").removeAttr("style").removeAttr("class").removeAttr("id").removeAttr("title").removeAttr("alt").removeAttr("longdesc"),n.each(r.src.events,function(n){r.prevImg.removeAttr(n)})):r.prevImg=n("<img/>").prependTo(r.preview),r.prevImg.load(function(){r.prevImg.unbind("load"),setTimeout(function(){u=r.prevImg.width(),f=r.prevImg.height(),o=(u/f).toFixed(2),r.src.main.width.val(u),r.src.main.height.val(f)},100)}).attr("src",t)):(r.preview.children("img").remove(),r.prevImg=null)},c=function(n){var t=parseInt(r.src.main.width.val())||0,i=parseInt(r.src.main.height.val())||0;r.prevImg&&(t&&i?n.target===r.src.main.width[0]?i=parseInt(t/o):t=parseInt(i*o):(t=u,i=f),r.src.main.height.val(i),r.src.main.width.val(t),r.prevImg.width(t).height(i),r.src.adv.style.val(r.prevImg.attr("style")))};this.img=null,this.prevImg=null,this.preview=n('<div class="elrte-image-preview"/>').text("Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin"),this.init=function(){this.labels={main:"Properies",link:"Link",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",longdesc:"Detail description URL",href:"URL",target:"Open in",title:"Title"},this.src={main:{src:n('<input type="text" />').css("width","100%").change(l),title:n('<input type="text" />').css("width","100%"),alt:n('<input type="text" />').css("width","100%"),width:n('<input type="text" />').attr("size",5).css("text-align","right").change(c),height:n('<input type="text" />').attr("size",5).css("text-align","right").change(c),margin:n("<div />").elPaddingInput({type:"margin",change:function(){var n=r.src.main.margin.val();r.prevImg&&(n.css?r.prevImg.css("margin",n.css):r.prevImg.css({"margin-left":n.left,"margin-top":n.top,"margin-right":n.right,"margin-bottom":n.bottom}))}}),align:n("<select />").css("width","100%").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("left").text(this.rte.i18n("Left"))).append(n("<option />").val("right").text(this.rte.i18n("Right"))).append(n("<option />").val("top").text(this.rte.i18n("Top"))).append(n("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(n("<option />").val("middle").text(this.rte.i18n("middle"))).append(n("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(n("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(n("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))).change(function(){var t=n(this).val(),i={float:"","vertical-align":""};r.prevImg&&(t=="left"||t=="right"?(i.float=t,i["vertical-align"]=""):t&&(i.float="",i["vertical-align"]=t),r.prevImg.css(i))}),border:n("<div />").elBorderSelect({name:"border",change:function(){var n=r.src.main.border.val();r.prevImg&&r.prevImg.css("border",n.width?n.width+" "+n.style+" "+n.color:"")}})},adv:{},events:{}},n.each(["id","class","style","longdesc"],function(t,i){r.src.adv[i]=n('<input type="text" style="width:100%" />')}),this.src.adv["class"].change(function(){r.prevImg&&r.prevImg.attr("class",n(this).val())}),this.src.adv.style.change(function(){r.prevImg&&(r.prevImg.attr("style",n(this).val()),h(r.prevImg))}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text"  style="width:100%"/>')})},this.command=function(){this.src||this.init();var c,v={rtl:t.rtl,submit:function(n){n.stopPropagation(),n.preventDefault(),r.set(),i.close()},close:function(){e&&t.selection.moveToBookmark(e)},dialog:{autoOpen:!1,width:500,position:"top",title:t.i18n("Image"),resizable:!0,open:function(){n.fn.resizable&&n(this).parents(".ui-dialog:first").resizable("option","alsoResize",".elrte-image-preview")}}},i=new elDialogForm(v),l=!!t.options.fmOpen,a=l?n('<div class="elrte-image-src-fm"><span class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-folder-open"/><\/span><\/div>').append(this.src.main.src.css("width","87%")):this.src.main.src;s(),this.preview.children("img").remove(),this.prevImg=null,c=t.selection.getEnd(),this.img=c.nodeName=="IMG"&&!n(c).is(".elrte-protected")?n(c):n("<img/>"),e=t.selection.getBookmark(),l&&a.children(".ui-state-default").click(function(){t.options.fmOpen(function(n){r.src.main.src.val(n).change()})}).hover(function(){n(this).toggleClass("ui-state-hover")}),i.tab("main",this.rte.i18n("Properies")).append([this.rte.i18n("Image URL"),a],"main",!0).append([this.rte.i18n("Title"),this.src.main.title],"main",!0).append([this.rte.i18n("Alt text"),this.src.main.alt],"main",!0).append([this.rte.i18n("Size"),n("<span />").append(this.src.main.width).append(" x ").append(this.src.main.height).append(" px")],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0),i.append(n("<fieldset><legend>"+this.rte.i18n("Preview")+"<\/legend><\/fieldset>").append(this.preview),"main"),n.each(this.src,function(u,f){u!="main"&&(i.tab(u,t.i18n(r.labels[u])),n.each(f,function(n){r.src[u][n].val(u=="events"?t.utils.trimEventCallback(r.img.attr(n)):r.img.attr(n)||""),i.append([t.i18n(r.labels[n]||n),r.src[u][n]],u,!0)}))}),i.open(),this.img.attr("src")&&(h(this.img),this.prevImg=this.img.clone().prependTo(this.preview),o=(this.img.width()/this.img.height()).toFixed(2),u=parseInt(this.img.width()),f=parseInt(this.img.height()))},this.set=function(){var u=this.src.main.src.val(),i;if(this.rte.history.add(),e&&t.selection.moveToBookmark(e),!u)return i=t.dom.selfOrParentLink(this.img[0]),i&&i.remove(),this.img.remove();this.img[0].parentNode||(this.img=n(this.rte.doc.createElement("img"))),this.img.attr("src",u).attr("style",this.src.adv.style.val()),n.each(this.src,function(t,i){n.each(i,function(t,i){var u=i.val();switch(t){case"width":r.img.css("width",u);break;case"height":r.img.css("height",u);break;case"align":r.img.css(u=="left"||u=="right"?"float":"vertical-align",u);break;case"margin":u.css?r.img.css("margin",u.css):r.img.css({"margin-left":u.left,"margin-top":u.top,"margin-right":u.right,"margin-bottom":u.bottom});break;case"border":if(u.width){u="border:"+u.css+";"+n.trim((r.img.attr("style")||"").replace(/border\-[^;]+;?/ig,"")),t="style",r.img.attr("style",u);return}u="";break;case"src":case"style":return;default:u?r.img.attr(t,u):r.img.removeAttr(t)}})}),this.img[0].parentNode||t.selection.insertNode(this.img[0]),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getEnd(),i=n(t);t.nodeName!="IMG"||i.hasClass("elrte-protected")?this.domElem.removeClass("active"):this.domElem.addClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.indent=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){function f(t){var i=/(IMG|HR|TABLE|EMBED|OBJECT)/.test(t.nodeName)?"margin-left":"padding-left",u=r.rte.dom.attr(t,"style").indexOf(i)!=-1?parseInt(n(t).css(i))||0:0;n(t).css(i,u+40+"px")}var i,t,u;for(this.rte.history.add(),i=this.rte.selection.selected({collapsed:!0,blocks:!0,wrap:"inline",tag:"p"}),t=0;t<i.length;t++)/^(TABLE|THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(i[t].nodeName)?n(i[t]).find("td,th").each(function(){f(this)}):/^LI$/.test(i[t].nodeName)?(u=n(i[t]),n(this.rte.dom.create(i[t].parentNode.nodeName)).append(n(this.rte.dom.create("li")).html(u.html()||"")).appendTo(u.html("&nbsp;"))):f(i[t]);this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.justifyleft=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.align=this.name=="justifyfull"?"justify":this.name.replace("justify",""),this.command=function(){var i=this.rte.selection.selected({collapsed:!0,blocks:!0,tag:"div"}),t=i.length;for(t&&this.rte.history.add();t--;)this.rte.dom.filter(i[t],"textNodes")&&n(i[t]).css("text-align",this.align);this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode(),i=t.nodeName=="BODY"?t:this.rte.dom.selfOrParent(t,"textNodes")||(t.parentNode&&t.parentNode.nodeName=="BODY"?t.parentNode:null);i?this.domElem.removeClass("disabled").toggleClass("active",n(i).css("text-align")==this.align):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.justifycenter=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyright=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyfull=elRTE.prototype.ui.prototype.buttons.justifyleft}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.link=function(t,i){function u(){r.labels={id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language",charset:"Charset",type:"Target MIME type",rel:"Relationship page to target (rel)",rev:"Relationship target to page (rev)",tabindex:"Tab index",accesskey:"Access key"},r.src={main:{href:n('<input type="text" />'),title:n('<input type="text" />'),anchor:n("<select />").attr("name","anchor"),target:n("<select />").append(n("<option />").text(r.rte.i18n("In this window")).val("")).append(n("<option />").text(r.rte.i18n("In new window (_blank)")).val("_blank"))},popup:{use:n('<input type="checkbox" />'),url:n('<input type="text" />').val("http://"),name:n('<input type="text" />'),width:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Width")}).css("text-align","right"),height:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Height")}).css("text-align","right"),left:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Left")}).css("text-align","right"),top:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Top")}).css("text-align","right"),location:n('<input type="checkbox" />'),menubar:n('<input type="checkbox" />'),toolbar:n('<input type="checkbox" />'),scrollbars:n('<input type="checkbox" />'),status:n('<input type="checkbox" />'),resizable:n('<input type="checkbox" />'),dependent:n('<input type="checkbox" />'),retfalse:n('<input type="checkbox" />').attr("checked",!0)},adv:{id:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />'),charset:n('<input type="text" />'),type:n('<input type="text" />'),rel:n('<input type="text" />'),rev:n('<input type="text" />'),tabindex:n('<input type="text" />'),accesskey:n('<input type="text" />')},events:{}},n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />')}),n.each(r.src,function(){var n,t;for(n in this)t=this[n].attr("type"),t&&(t!="text"||this[n].attr("size"))||this[n].css("width","100%")})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.img=!1,this.bm,this.command=function(){function c(n){return n.nodeName=="A"&&n.href}var t=this.rte.selection.getNode(),i,f,l,a,v,e,s,h,o;if(this.src||u(),this.bm=this.rte.selection.getBookmark(),this.link=this.rte.dom.selfOrParentLink(t),!this.link&&(i=n.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1}),i.length)){for(f=0;f<i.length;f++)if(c(i[f])){this.link=i[f];break}this.link||(this.link=this.rte.dom.parent(i[0],c)||this.rte.dom.parent(i[i.length-1],c))}this.link=this.link?n(this.link):n(this.rte.doc.createElement("a")),this.img=t.nodeName=="IMG"?t:null,this.updatePopup(),this.src.main.anchor.empty(),n('a[href!=""][name]',this.rte.doc).each(function(){var t=n(this).attr("name");r.src.main.anchor.append(n("<option />").val(t).text(t))}),this.src.main.anchor.children().length&&this.src.main.anchor.prepend(n("<option />").val("").text(this.rte.i18n("Select bookmark"))).change(function(){var t=n(this).val();t&&r.src.main.href.val("#"+t)}),l={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},tabs:{show:function(n,t){t.index==3&&r.updateOnclick()}},close:function(){r.rte.browser.msie&&r.rte.selection.restoreIERange()},dialog:{width:"auto",width:430,title:this.rte.i18n("Link")}},d=new elDialogForm(l),a=n("<div />").append(n("<label />").append(this.src.popup.location).append(this.rte.i18n("Location bar"))).append(n("<label />").append(this.src.popup.menubar).append(this.rte.i18n("Menu bar"))).append(n("<label />").append(this.src.popup.toolbar).append(this.rte.i18n("Toolbar"))).append(n("<label />").append(this.src.popup.scrollbars).append(this.rte.i18n("Scrollbars"))),v=n("<div />").append(n("<label />").append(this.src.popup.status).append(this.rte.i18n("Status bar"))).append(n("<label />").append(this.src.popup.resizable).append(this.rte.i18n("Resizable"))).append(n("<label />").append(this.src.popup.dependent).append(this.rte.i18n("Depedent"))).append(n("<label />").append(this.src.popup.retfalse).append(this.rte.i18n("Add return false"))),d.tab("main",this.rte.i18n("Properies")).tab("popup",this.rte.i18n("Popup")).tab("adv",this.rte.i18n("Advanced")).tab("events",this.rte.i18n("Events")).append(n("<label />").append(this.src.popup.use).append(this.rte.i18n("Open link in popup window")),"popup").separator("popup").append([this.rte.i18n("URL"),this.src.popup.url],"popup",!0).append([this.rte.i18n("Window name"),this.src.popup.name],"popup",!0).append([this.rte.i18n("Window size"),n("<span />").append(this.src.popup.width).append(" x ").append(this.src.popup.height).append(" px")],"popup",!0).append([this.rte.i18n("Window position"),n("<span />").append(this.src.popup.left).append(" x ").append(this.src.popup.top).append(" px")],"popup",!0).separator("popup").append([a,v],"popup",!0),e=this.link.get(0),s=this.rte.dom.attr(e,"href"),this.src.main.href.val(s).change(function(){n(this).val(r.rte.utils.absoluteURL(n(this).val()))}),this.rte.options.fmAllow&&this.rte.options.fmOpen?(h=n("<span />").append(this.src.main.href.css("width","87%")).append(n("<span />").addClass("ui-state-default ui-corner-all").css({float:"right","margin-right":"3px"}).attr("title",r.rte.i18n("Open file manger")).append(n("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){r.rte.options.fmOpen(function(n){r.src.main.href.val(n).change()})}).hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")})),d.append([this.rte.i18n("Link URL"),h],"main",!0)):d.append([this.rte.i18n("Link URL"),this.src.main.href],"main",!0),this.src.main.href.change(),d.append([this.rte.i18n("Title"),this.src.main.title.val(this.rte.dom.attr(e,"title"))],"main",!0),this.src.main.anchor.children().length&&d.append([this.rte.i18n("Bookmark"),this.src.main.anchor.val(s)],"main",!0),this.rte.options.doctype.match(/xhtml/)&&this.rte.options.doctype.match(/strict/)||d.append([this.rte.i18n("Target"),this.src.main.target.val(this.link.attr("target")||"")],"main",!0);for(t in this.src.adv)this.src.adv[t].val(this.rte.dom.attr(e,t)),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.adv[t]],"adv",!0);for(t in this.src.events)o=this.rte.utils.trimEventCallback(this.rte.dom.attr(e,t)),this.src.events[t].val(o),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.events[t]],"events",!0);this.src.popup.use.change(function(){var t=n(this).attr("checked");n.each(r.src.popup,function(){n(this).attr("name")!="use"&&(t?n(this).removeAttr("disabled"):n(this).attr("disabled",!0))})}),this.src.popup.use.change(),d.open()},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(n){return n.nodeName=="A"&&n.href})?this.domElem.removeClass("disabled").addClass("active"):this.rte.selection.collapsed()&&n.nodeName!="IMG"?this.domElem.addClass("disabled").removeClass("active"):this.domElem.removeClass("disabled active")},this.updatePopup=function(){var t=""+this.link.attr("onclick");t.length>0&&(m=t.match(/window.open\('([^']+)',\s*'([^']*)',\s*'([^']*)'\s*.*\);\s*(return\s+false)?/))?(this.src.popup.use.attr("checked","on"),this.src.popup.url.val(m[1]),this.src.popup.name.val(m[2]),/location=yes/.test(m[3])&&this.src.popup.location.attr("checked",!0),/menubar=yes/.test(m[3])&&this.src.popup.menubar.attr("checked",!0),/toolbar=yes/.test(m[3])&&this.src.popup.toolbar.attr("checked",!0),/scrollbars=yes/.test(m[3])&&this.src.popup.scrollbars.attr("checked",!0),/status=yes/.test(m[3])&&this.src.popup.status.attr("checked",!0),/resizable=yes/.test(m[3])&&this.src.popup.resizable.attr("checked",!0),/dependent=yes/.test(m[3])&&this.src.popup.dependent.attr("checked",!0),(_m=m[3].match(/width=([^,]+)/))&&this.src.popup.width.val(_m[1]),(_m=m[3].match(/height=([^,]+)/))&&this.src.popup.height.val(_m[1]),(_m=m[3].match(/left=([^,]+)/))&&this.src.popup.left.val(_m[1]),(_m=m[3].match(/top=([^,]+)/))&&this.src.popup.top.val(_m[1]),m[4]&&this.src.popup.retfalse.attr("checked",!0)):n.each(this.src.popup,function(){var t=n(this);t.attr("type")=="text"?t.val(t.attr("name")=="url"?"http://":""):t.attr("name")=="retfalse"?this.attr("checked",!0):t.removeAttr("checked")})},this.updateOnclick=function(){var r=this.src.popup.url.val(),t,u,f,i;this.src.popup.use.attr("checked")&&r?(t="",this.src.popup.location.attr("checked")&&(t+="location=yes,"),this.src.popup.menubar.attr("checked")&&(t+="menubar=yes,"),this.src.popup.toolbar.attr("checked")&&(t+="toolbar=yes,"),this.src.popup.scrollbars.attr("checked")&&(t+="scrollbars=yes,"),this.src.popup.status.attr("checked")&&(t+="status=yes,"),this.src.popup.resizable.attr("checked")&&(t+="resizable=yes,"),this.src.popup.dependent.attr("checked")&&(t+="dependent=yes,"),this.src.popup.width.val()&&(t+="width="+this.src.popup.width.val()+","),this.src.popup.height.val()&&(t+="height="+this.src.popup.height.val()+","),this.src.popup.left.val()&&(t+="left="+this.src.popup.left.val()+","),this.src.popup.top.val()&&(t+="top="+this.src.popup.top.val()+","),t.length>0&&(t=t.substring(0,t.length-1)),u=this.src.popup.retfalse.attr("checked")?"return false;":"",f="window.open('"+r+"', '"+n.trim(this.src.popup.name.val())+"', '"+t+"'); "+u,this.src.events.onclick.val(f),this.src.main.href.val()||this.src.main.href.val("#")):(i=this.src.events.onclick.val(),i=i.replace(/window\.open\([^\)]+\)\s*;?\s*return\s*false\s*;?/i,""),this.src.events.onclick.val(i))},this.set=function(){var i,u,e,r,t,f;if(this.updateOnclick(),this.rte.selection.moveToBookmark(this.bm),this.rte.history.add(),i=this.rte.utils.absoluteURL(this.src.main.href.val()),i){this.img&&this.img.parentNode?(this.link=n(this.rte.dom.create("a")).attr("href",i),this.rte.dom.wrap(this.img,this.link[0])):this.link[0].parentNode||(u="#--el-editor---"+Math.random(),this.rte.doc.execCommand("createLink",!1,u),this.link=n('a[href="'+u+'"]',this.rte.doc),this.link.each(function(){var t=n(this);n.trim(t.html())||n.trim(t.text())||t.replaceWith(t.text())})),this.src.main.href.val(i);for(r in this.src)if(r!="popup")for(t in this.src[r])t!="anchors"&&(f=n.trim(this.src[r][t].val()),f?this.link.attr(t,f):this.link.removeAttr(t));this.img&&this.rte.selection.select(this.img)}else e=this.rte.selection.getBookmark(),this.rte.dom.unwrap(this.link[0]),this.rte.selection.moveToBookmark(e);this.rte.ui.update(!0)}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.nbsp=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){this.rte.history.add(),this.rte.selection.insertHtml("&nbsp;",!0),this.rte.window.focus(),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.outdent=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.find();t.node&&(this.rte.history.add(),n(t.node).css(t.type,(t.val>40?t.val-40:0)+"px"),this.rte.ui.update())},this.find=function(t){function u(t){var i={type:"",val:0},u;return(u=r.rte.dom.attr(t,"style"))&&(i.type=u.indexOf("padding-left")!=-1?"padding-left":u.indexOf("margin-left")!=-1?"margin-left":"",i.val=i.type?parseInt(n(t).css(i.type))||0:0),i}var t=this.rte.selection.getNode(),i=u(t);return i.val?i.node=t:n.each(this.rte.dom.parents(t,"*"),function(){return i=u(this),i.val?(i.node=this,i):void 0}),i},this.update=function(){var n=this.find();n.node?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pagebreak=function(t,i){this.constructor.prototype.constructor.call(this,t,i),n(this.rte.doc.body).bind("mousedown",function(t){n(t.target).hasClass("elrte-pagebreak")&&t.preventDefault()}),this.command=function(){this.rte.selection.insertHtml('<img src="'+this.rte.filter.url+'pixel.gif" class="elrte-protected elrte-pagebreak"/>',!1)},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pasteformattext=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.iframe=n(document.createElement("iframe")).addClass("el-rte-paste-input"),this.doc=null;var r=this;this.command=function(){this.rte.selection.saveIERange();var n=this,t={submit:function(t,i){t.stopPropagation(),t.preventDefault(),n.paste(),i.close()},dialog:{width:500,title:this.rte.i18n("Paste formatted text")}},i=new elDialogForm(t);if(i.append(this.iframe).open(),this.doc=this.iframe.get(0).contentWindow.document,html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',html+="<\/head><body> <br /> <\/body><\/html>",this.doc.open(),this.doc.write(html),this.doc.close(),this.rte.browser.msie)this.doc.body.contentEditable=!0;else try{this.doc.designMode="on"}catch(r){}setTimeout(function(){n.iframe[0].contentWindow.focus()},50)},this.paste=function(){n(this.doc.body).find("[class]").removeAttr("class");var t=n.trim(n(this.doc.body).html());t&&(this.rte.history.add(),this.rte.selection.restoreIERange(),this.rte.selection.insertHtml(this.rte.filter.wysiwyg2wysiwyg(this.rte.filter.proccess("paste",t))),this.rte.ui.update(!0))},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pastetext=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.input=n("<textarea />").addClass("el-rte-paste-input");var r=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var n={submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.paste(),t.close()},dialog:{width:500,title:this.rte.i18n("Paste only text")}},t=new elDialogForm(n);t.append(this.input).open()},this.paste=function(){var t=n.trim(this.input.val());t&&(this.rte.history.add(),this.rte.browser.msie&&this.rte.selection.restoreIERange(),this.rte.selection.insertText(t.replace(/\r?\n/g,"<br />"),!0),this.rte.ui.update(!0)),this.input.val("")},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.save=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.active=!0,this.command=function(){this.rte.save()},this.update=function(){}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.smiley=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.img=null,this.url=this.rte.filter.url+"smileys/",this.smileys={smile:"smile.png",happy:"happy.png",tongue:"tongue.png",surprised:"surprised.png",waii:"waii.png",wink:"wink.png",evilgrin:"evilgrin.png",grin:"grin.png",unhappy:"unhappy.png"},this.width=120,this.command=function(){var r=this,u=this.url,t,i;this.rte.browser.msie&&this.rte.selection.saveIERange(),i={dialog:{height:120,width:this.width,title:this.rte.i18n("Smiley"),buttons:{}}},t=new elDialogForm(i),n.each(this.smileys,function(i,f){t.append(n('<img src="'+u+f+'" title="'+i+'" id="'+i+'" class="el-rte-smiley"/>').click(function(){r.set(this.id,t)}))}),t.open()},this.update=function(){this.domElem.removeClass("disabled"),this.domElem.removeClass("active")},this.set=function(t,i){this.rte.browser.msie&&this.rte.selection.restoreIERange(),this.smileys[t]&&(this.img=n(this.rte.doc.createElement("img")),this.img.attr({src:this.url+this.smileys[t],title:t,alt:t}),this.rte.selection.insertNode(this.img.get(0)),this.rte.ui.update()),i.close()}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.stopfloat=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.find=function(){if(this.rte.selection.collapsed()){var t=this.rte.dom.selfOrParent(this.rte.selection.getEnd(),/^DIV$/);if(t&&(this.rte.dom.attr(t,"clear")||n(t).css("clear")!="none"))return t}},this.command=function(){var t;(t=this.find())?(t=n(t),this.rte.history.add(),t.children().length||n.trim(t.text()).length?t.removeAttr("clear").css("clear",""):t.remove()):(this.rte.history.add(),this.rte.selection.insertNode(n(this.rte.dom.create("div")).css("clear","both").get(0),!0)),this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled"),this.find()?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.table=function(t,i){function u(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",summary:"Summary",lang:"Language",href:"URL"},r.src={main:{caption:n('<input type="text" />'),rows:n('<input type="text" />').attr("size",5).val(2),cols:n('<input type="text" />').attr("size",5).val(2),width:n('<input type="text" />').attr("size",5),wunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),height:n('<input type="text" />').attr("size",5),hunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),align:n("<select />").append(n("<option />").val("").text(r.rte.i18n("Not set"))).append(n("<option />").val("left").text(r.rte.i18n("Left"))).append(n("<option />").val("center").text(r.rte.i18n("Center"))).append(n("<option />").val("right").text(r.rte.i18n("Right"))),spacing:n('<input type="text" />').attr("size",5),padding:n('<input type="text" />').attr("size",5),border:n("<div />"),rules:n("<select />").append(n("<option />").val("none").text(r.rte.i18n("No"))).append(n("<option />").val("all").text(r.rte.i18n("Cells"))).append(n("<option />").val("groups").text(r.rte.i18n("Groups"))).append(n("<option />").val("rows").text(r.rte.i18n("Rows"))).append(n("<option />").val("cols").text(r.rte.i18n("Columns"))),margin:n("<div />"),bg:n("<div />"),bgimg:n('<input type="text" />').css("width","90%")},adv:{id:n('<input type="text" />'),summary:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />')},events:{}},n.each(r.src,function(){var n,t;for(n in this)this[n].attr("name",n),t=this[n].get(0).nodeName,t=="INPUT"&&n!="bgimg"?this[n].css(this[n].attr("size")?{"text-align":"right"}:{width:"100%"}):t=="SELECT"&&n!="wunit"&&n!="hunit"&&this[n].css("width","100%")}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />').css("width","100%")}),r.src.main.align.change(function(){var i=n(this).val(),t;i=="center"?r.src.main.margin.val({left:"auto",right:"auto"}):(t=r.src.main.margin.val(),t.left=="auto"&&t.right=="auto"&&r.src.main.margin.val({left:"",right:""}))}),r.src.main.bgimg.change(function(){var t=n(this);t.val(r.rte.utils.absoluteURL(t.val()))})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src=null,this.labels=null,this.command=function(){var l=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/),h,e,o,a,v,c,y,f,t,i,s;this.table=this.name=="table"?n(this.rte.doc.createElement("table")):l?n(l):n(this.rte.doc.createElement("table")),this.src||u(),this.src.main.border.elBorderSelect({styleHeight:117}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.margin.elPaddingInput({type:"margin",value:this.table}),this.table.parents().length?(this.src.main.rows.val("").attr("disabled",!0),this.src.main.cols.val("").attr("disabled",!0)):(this.src.main.rows.val(2).removeAttr("disabled"),this.src.main.cols.val(2).removeAttr("disabled")),h=this.table.css("width")||this.table.attr("width"),this.src.main.width.val(parseInt(h)||""),this.src.main.wunit.val(h.indexOf("px")!=-1?"px":"%"),e=this.table.css("height")||this.table.attr("height"),this.src.main.height.val(parseInt(e)||""),this.src.main.hunit.val(e&&e.indexOf("px")!=-1?"px":"%"),o=this.table.css("float"),this.src.main.align.val(""),o=="left"||o=="right"?this.src.main.align.val(o):(a=this.table.css("margin-left"),v=this.table.css("margin-right"),a=="auto"&&v=="auto"&&this.src.main.align.val("center")),this.src.main.border.val(this.table),this.src.main.rules.val(this.rte.dom.attr(this.table.get(0),"rules")),this.src.main.bg.val(this.table.css("background-color")),c=(this.table.css("background-image")||"").replace(/url\(([^\)]+)\)/i,"$1"),this.src.main.bgimg.val(c!="none"?c:""),y={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{width:530,title:this.rte.i18n("Table")}},f=new elDialogForm(y);for(t in this.src)if(f.tab(t,this.rte.i18n(this.labels[t])),t=="main"){var p=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Rows")+"<\/td>").append(n("<td />").append(this.src.main.rows))).append(n("<tr />").append("<td>"+this.rte.i18n("Columns")+"<\/td>").append(n("<td />").append(this.src.main.cols))),w=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Width")+"<\/td>").append(n("<td />").append(this.src.main.width).append(this.src.main.wunit))).append(n("<tr />").append("<td>"+this.rte.i18n("Height")+"<\/td>").append(n("<td />").append(this.src.main.height).append(this.src.main.hunit))),b=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Spacing")+"<\/td>").append(n("<td />").append(this.src.main.spacing.val(this.table.attr("cellspacing")||"")))).append(n("<tr />").append("<td>"+this.rte.i18n("Padding")+"<\/td>").append(n("<td />").append(this.src.main.padding.val(this.table.attr("cellpadding")||""))));f.append([this.rte.i18n("Caption"),this.src.main.caption.val(this.table.find("caption").eq(0).text()||"")],"main",!0).separator("main").append([p,w,b],"main",!0).separator("main").append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Inner borders"),this.src.main.rules],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Background"),n("<span />").append(n("<span />").css({float:"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0)}else for(i in this.src[t])s=this.rte.dom.attr(this.table,i),t=="events"&&(s=this.rte.utils.trimEventCallback(s)),f.append([this.rte.i18n(this.labels[i]?this.labels[i]:i),this.src[t][i].val(s)],t,!0);f.open()},this.set=function(){var e,o,t,i,s,h,c,u,f,l,a,v,p;if(this.table.parents().length)this.table.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor").removeAttr("cellspacing").removeAttr("cellpadding").removeAttr("frame").removeAttr("rules").removeAttr("style");else{if(e=parseInt(this.src.main.rows.val())||0,o=parseInt(this.src.main.cols.val())||0,e<=0||o<=0)return;for(this.rte.history.add(),t=n(this.rte.doc.createElement("tbody")).appendTo(this.table),i=0;i<e;i++){for(s="<tr>",h=0;h<o;h++)s+="<td>&nbsp;<\/td>";t.append(s+"<\/tr>")}}c=n.trim(this.src.main.caption.val()),c?(this.table.children("caption").length||this.table.prepend("<caption />"),this.table.children("caption").text(c)):this.table.children("caption").remove();for(u in this.src)if(u!="main")for(f in this.src[u])l=n.trim(this.src[u][f].val()),l?this.table.attr(f,l):this.table.removeAttr(f);(a=parseInt(this.src.main.spacing.val()))&&a>=0&&this.table.attr("cellspacing",a),(v=parseInt(this.src.main.padding.val()))&&v>=0&&this.table.attr("cellpadding",v),(p=this.src.main.rules.val())&&this.table.attr("rules",p);var w=parseInt(this.src.main.width.val())||"",b=parseInt(this.src.main.height.val())||"",i=n.trim(this.src.main.bgimg.val()),t=this.src.main.border.val(),r=this.src.main.margin.val(),y=this.src.main.align.val();this.table.css({width:w?w+this.src.main.wunit.val():"",height:b?b+this.src.main.hunit.val():"",border:n.trim(t.width+" "+t.style+" "+t.color),"background-color":this.src.main.bg.val(),"background-image":i?"url("+i+")":""}),r.css?this.table.css("margin",r.css):this.table.css({"margin-top":r.top,"margin-right":r.right,"margin-bottom":r.bottom,"margin-left":r.left}),(y=="left"||y=="right")&&this.table.css("margin-left")!="auto"&&this.table.css("margin-right")!="auto"&&this.table.css("float",y),this.table.attr("style")||this.table.removeAttr("style"),this.table.parents().length||this.rte.selection.insertNode(this.table.get(0),!0),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled"),this.name!="tableprops"||this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/)||this.domElem.addClass("disabled").removeClass("active")}},elRTE.prototype.ui.prototype.buttons.tableprops=elRTE.prototype.ui.prototype.buttons.table}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tablerm=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var t=this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/);t&&(this.rte.history.add(),n(t).remove()),this.rte.ui.update(!0)},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellprops=function(t,i){function u(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language"},r.src={main:{type:n("<select />").css("width","100%").append(n("<option />").val("td").text(r.rte.i18n("Data"))).append(n("<option />").val("th").text(r.rte.i18n("Header"))),width:n('<input type="text" />').attr("size",4),wunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),height:n('<input type="text" />').attr("size",4),hunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),align:n("<select />").css("width","100%").append(n("<option />").val("").text(r.rte.i18n("Not set"))).append(n("<option />").val("left").text(r.rte.i18n("Left"))).append(n("<option />").val("center").text(r.rte.i18n("Center"))).append(n("<option />").val("right").text(r.rte.i18n("Right"))).append(n("<option />").val("justify").text(r.rte.i18n("Justify"))),border:n("<div />"),padding:n("<div />"),bg:n("<div />"),bgimg:n('<input type="text" />').css("width","90%"),apply:n("<select />").css("width","100%").append(n("<option />").val("").text(r.rte.i18n("Current cell"))).append(n("<option />").val("row").text(r.rte.i18n("All cells in row"))).append(n("<option />").val("column").text(r.rte.i18n("All cells in column"))).append(n("<option />").val("table").text(r.rte.i18n("All cells in table")))},adv:{id:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").css("width","100%").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />')},events:{}},n.each(r.src,function(){for(var n in this)this[n].attr("name",n),this[n].attr("type")!="text"||this[n].attr("size")||n=="bgimg"||this[n].css("width","100%")}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />').css("width","100%")})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src=null,this.labels=null,this.command=function(){var s,h,e,c,f,t,i,o;if(this.src||u(),this.cell=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/),this.cell){this.src.main.type.val(this.cell.nodeName.toLowerCase()),this.cell=n(this.cell),this.src.main.border.elBorderSelect({styleHeight:117,value:this.cell}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.padding.elPaddingInput({value:this.cell}),s=this.cell.css("width")||this.cell.attr("width"),this.src.main.width.val(parseInt(s)||""),this.src.main.wunit.val(s.indexOf("px")!=-1?"px":"%"),h=this.cell.css("height")||this.cell.attr("height"),this.src.main.height.val(parseInt(h)||""),this.src.main.hunit.val(h.indexOf("px")!=-1?"px":"%"),this.src.main.align.val(this.cell.attr("align")||this.cell.css("text-align")),this.src.main.bg.val(this.cell.css("background-color")),e=this.cell.css("background-image"),this.src.main.bgimg.val(e&&e!="none"?e.replace(/url\(([^\)]+)\)/i,"$1"):""),this.src.main.apply.val(""),c={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{width:520,title:this.rte.i18n("Table cell properties")}},f=new elDialogForm(c);for(t in this.src)if(f.tab(t,this.rte.i18n(this.labels[t])),t=="main")f.append([this.rte.i18n("Width"),n("<span />").append(this.src.main.width).append(this.src.main.wunit)],"main",!0).append([this.rte.i18n("Height"),n("<span />").append(this.src.main.height).append(this.src.main.hunit)],"main",!0).append([this.rte.i18n("Table cell type"),this.src.main.type],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Paddings"),this.src.main.padding],"main",!0).append([this.rte.i18n("Background"),n("<span />").append(n("<span />").css({float:"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0).append([this.rte.i18n("Apply to"),this.src.main.apply],"main",!0);else for(i in this.src[t])o=this.cell.attr(i)||"",t=="events"&&(o=this.rte.utils.trimEventCallback(o)),f.append([this.rte.i18n(this.labels[i]?this.labels[i]:i),this.src[t][i].val(o)],t,!0);f.open()}},this.set=function(){var t=this.cell,v=this.src.main.apply.val(),f,e,o;switch(this.src.main.apply.val()){case"row":t=this.cell.parent("tr").children("td,th");break;case"column":t=n(this.rte.dom.tableColumn(this.cell.get(0)));break;case"table":t=this.cell.parents("table").find("td,th")}for(f in this.src)if(f!="main")for(e in this.src[f])o=n.trim(this.src[f][e].val()),o?t.attr(e,o):t.removeAttr(e);t.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor");var h=this.src.main.type.val(),c=parseInt(this.src.main.width.val())||"",l=parseInt(this.src.main.height.val())||"",a=n.trim(this.src.main.bgimg.val()),s=this.src.main.border.val(),i={width:c?c+this.src.main.wunit.val():"",height:l?l+this.src.main.hunit.val():"","background-color":this.src.main.bg.val(),"background-image":a?"url("+a+")":"",border:n.trim(s.width+" "+s.style+" "+s.color),"text-align":this.src.main.align.val()||""},u=this.src.main.padding.val();u.css?i.padding=u.css:(i["padding-top"]=u.top,i["padding-right"]=u.right,i["padding-bottom"]=u.bottom,i["padding-left"]=u.left),t=t.get(),n.each(t,function(){var c=this.nodeName.toLowerCase(),t=n(this),f,e,u,o,s;if(c!=h){f={};for(e in r.src.adv)u=t.attr(e),u&&(f[e]=u.toString());for(e in r.src.events)u=t.attr(e),u&&(f[e]=u.toString());o=t.attr("colspan")||1,s=t.attr("rowspan")||1,o>1&&(f.colspan=o),s>1&&(f.rowspan=s),t.replaceWith(n("<"+h+" />").html(t.html()).attr(f).css(i))}else t.css(i)}),this.rte.ui.update()},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellsmerge=function(t,i){function u(){var t=r.rte.dom.selfOrParent(r.rte.selection.getStart(),/^(TD|TH)$/),i=r.rte.dom.selfOrParent(r.rte.selection.getEnd(),/^(TD|TH)$/);return t&&i&&t!=i&&n(t).parents("table").get(0)==n(i).parents("table").get(0)?[t,i]:null}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=u(),w;if(t){var c=this.rte.dom.indexOf(n(t[0]).parent("tr").get(0)),l=this.rte.dom.indexOf(n(t[1]).parent("tr").get(0)),s=Math.min(c,l),h=Math.max(c,l)-s+1,f=this.rte.dom.tableColumn(t[0],!0,!0),e=this.rte.dom.tableColumn(t[1],!0),a=n.inArray(t[0],f.column),v=n.inArray(t[1],e.column),y=f.info.offset[a]<e.info.offset[v]?f:e,p=f.info.offset[a]>=e.info.offset[v]?f:e,o=0,i=null,r="";this.rte.history.add(),w=n(n(t[0]).parents("table").eq(0).find("tr").get().slice(s,s+h)).each(function(t){var f=r.length,u=!1;n(this).children("td,th").each(function(){var f=n(this),h=n.inArray(this,y.column),c=n.inArray(this,p.column),l,s,a,e;h!=-1||c!=-1?(u=h!=-1&&c==-1,l=parseInt(f.attr("colspan")||1),t==0&&(o+=l),h!=-1&&t>0&&(s=y.info.delta[h],s>0&&(f.css("text-align")=="left"?(e=f.clone(!0),f.html("&nbsp;")):e=f.clone().html("&nbsp;"),e.removeAttr("colspan").removeAttr("id").insertBefore(this),s>1&&e.attr("colspan",s))),c!=-1&&(s=p.info.delta[c],l-s>1&&(a=l-s-1,f.css("text-align")=="right"?(e=f.clone(!0),f.html("&nbsp;")):e=f.clone().html("&nbsp;"),e.removeAttr("colspan").removeAttr("id").insertAfter(this),a>1&&e.attr("colspan",a))),i?(r+=f.html(),f.remove()):i=f):u&&(t==0&&(o+=parseInt(f.attr("colspan")||1)),r+=f.html(),f.remove())}),r+=f!=r.length?"<br />":""}),i.removeAttr("colspan").removeAttr("rowspan").html(i.html()+r),o>1&&i.attr("colspan",o),h>1&&i.attr("rowspan",h),this.rte.dom.fixTable(n(t[0]).parents("table").get(0))}},this.update=function(){u()?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellsplit=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/),o,s,r,f,t;if(i&&(this.rte.history.add(),o=parseInt(this.rte.dom.attr(i,"colspan")),s=parseInt(this.rte.dom.attr(i,"rowspan")),o>1||s>1)){var h=o-1,c=s-1,l=this.rte.dom.parent(i,/^TABLE$/),u=this.rte.dom.tableMatrix(l);if(h)for(t=0;t<h;t++)n(this.rte.dom.create(i.nodeName)).html("&nbsp;").insertAfter(i);if(c){var a=this.rte.dom.indexesOfCell(i,u),v=a[0],e=a[1];for(r=v+1;r<v+c+1;r++)if(!u[r][e].nodeName){if(u[r][e-1].nodeName)f=u[r][e-1];else for(t=e-1;t>=0;t--)if(u[r][t].nodeName){f=u[r][t];break}if(f)for(t=0;t<=h;t++)n(this.rte.dom.create(f.nodeName)).html("&nbsp;").insertAfter(f)}}n(i).removeAttr("colspan").removeAttr("rowspan"),this.rte.dom.fixTable(l)}this.rte.ui.update(!0)},this.update=function(){var n=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);n&&(parseInt(this.rte.dom.attr(n,"colspan"))>1||parseInt(this.rte.dom.attr(n,"rowspan"))>1)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcolbefore=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this,i=this.rte.dom.tableColumn(this.rte.selection.getNode(),!1,!0);i.length&&(this.rte.history.add(),n.each(i,function(){var r=n(this),u=parseInt(r.attr("colspan")||1),i;u>1?r.attr("colspan",u+1):(i=n(t.rte.dom.create(this.nodeName)).html("&nbsp;"),t.name=="tbcolbefore"?i.insertBefore(this):i.insertAfter(this))}),this.rte.ui.update())},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbcolafter=elRTE.prototype.ui.prototype.buttons.tbcolbefore}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcolrm=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),r=this.rte.dom.selfOrParent(t,/^(TD|TH)$/),i=n(r).prev("td,th").get(0),u=n(r).next("td,th").get(0),e=this.rte.dom.parent(t,/^TABLE$/),f=this.rte.dom.tableColumn(t,!1,!0);f.length&&(this.rte.history.add(),n.each(f,function(){var t=n(this),i=parseInt(t.attr("colspan")||1);i>1?t.attr("colspan",i-1):t.remove()}),this.rte.dom.fixTable(e),(i||u)&&this.rte.selection.selectContents(i?i:u).collapse(!0),this.rte.ui.update(!0))},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),elRTE.prototype.ui.prototype.buttons.tbrowbefore=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){var l=this.rte.selection.getNode(),e=this.rte.dom.selfOrParent(l,/^(TD|TH)$/),u=this.rte.dom.selfOrParent(e,/^TR$/),t=this.rte.dom.tableMatrix(this.rte.dom.selfOrParent(e,/^TABLE$/)),i,h,f,n;if(e&&u&&t){this.rte.history.add();var c=this.name=="tbrowbefore",r=$(u).prevAll("tr").length,o=0,s=[];function a(n,i){while(i>0)if(i--,t[i]&&t[i][n]&&t[i][n].nodeName)return t[i][n]}for(n=0;n<t[r].length;n++)t[r][n]&&t[r][n].nodeName?(i=$(t[r][n]),h=parseInt(i.attr("colspan")||1),parseInt(i.attr("rowspan")||1)>1?c?o+=h:s.push(i):o+=h):t[r][n]=="-"&&(i=a(n,r),i&&s.push($(i)));for(f=$(this.rte.dom.create("tr")),n=0;n<o;n++)f.append("<td>&nbsp;<\/td>");c?f.insertBefore(u):f.insertAfter(u),$.each(s,function(){$(this).attr("rowspan",parseInt($(this).attr("rowspan")||1)+1)}),this.rte.ui.update()}},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbrowafter=elRTE.prototype.ui.prototype.buttons.tbrowbefore,function(n){elRTE.prototype.ui.prototype.buttons.tbrowrm=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var l=this.rte.selection.getNode(),f=this.rte.dom.selfOrParent(l,/^(TD|TH)$/),e=this.rte.dom.selfOrParent(f,/^TR$/),c=this.rte.dom.selfOrParent(f,/^TABLE$/),t=this.rte.dom.tableMatrix(c),a,i,r,u,o,s,h;if(f&&e&&t.length){if(this.rte.history.add(),t.length==1)return n(c).remove(),this.rte.ui.update();a=[],i=n(e).prevAll("tr").length;function v(n,i){while(i>0)if(i--,t[i]&&t[i][n]&&t[i][n].nodeName)return t[i][n]}function p(r,u){var o,f;if(y=i+1,o=null,t[y]){for(f=0;f<u;f++)t[y][f]&&t[y][f].nodeName&&(o=t[y][f]);r=r.remove(),o?r.insertAfter(o):r.prependTo(n(e).next("tr").eq(0))}}function w(n){for(var t=0;t<n.length;t++)if(n[t]==f)return t<n.length-1?n[t+1]:n[t-1]}for(r=0;r<t[i].length;r++)u=null,o=!1,t[i][r]&&t[i][r].nodeName?(u=t[i][r],o=!0):t[i][r]=="-"&&(u=v(r,i))&&(o=!1),u&&(u=n(u),s=parseInt(u.attr("rowspan")||1),s>1&&(u.attr("rowspan",s-1),o&&p(u,r,i)));h=w(this.rte.dom.tableColumn(f)),h&&this.rte.selection.selectContents(h).collapse(!0),n(e).remove()}this.rte.ui.update()},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.undo=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){this.name=="undo"&&this.rte.history.canBack()?(this.rte.history.back(),this.rte.ui.update()):this.name=="redo"&&this.rte.history.canFwd()&&(this.rte.history.fwd(),this.rte.ui.update())},this.update=function(){this.domElem.toggleClass("disabled",this.name=="undo"?!this.rte.history.canBack():!this.rte.history.canFwd())}},elRTE.prototype.ui.prototype.buttons.redo=elRTE.prototype.ui.prototype.buttons.undo}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.unlink=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){function u(n){return n.nodeName=="A"&&n.href}var f=this.rte.selection.getNode(),i=this.rte.dom.selfOrParentLink(f),t,r;if(!i&&(t=n.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1}),t.length)){for(r=0;r<t.length;r++)if(u(t[r])){i=t[r];break}i||(i=this.rte.dom.parent(t[0],u)||this.rte.dom.parent(t[t.length-1],u))}i&&(this.rte.history.add(),this.rte.selection.select(i),this.rte.doc.execCommand("unlink",!1,null),this.rte.ui.update(!0))},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(n){return n.nodeName=="A"&&n.href})?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active")}}}(jQuery),eli18n.prototype=new function(){this.messages={},this._domain="",this.load=function(n){var t,i,r;if(typeof n=="object")for(t in n)if(i=n[t],typeof i=="object"){this.messages[t]||(this.messages[t]={});for(r in i)typeof i[r]=="string"&&(this.messages[t][r]=i[r])}return this},this.translate=function(n,t){var t=t&&this.messages[t]?t:this._domain;return this.messages[t]&&this.messages[t][n]?this.messages[t][n]:n},this.format=function(n,t,i){if(n=this.translate(n,i),typeof t=="object")for(var r in t)n=n.replace("%"+r,this.translate(t[r],i));return n}},function(n){n.fn.elColorPicker=function(t){function u(n){i.val(n),r.change&&r.change(i.val()),i.palette.slideUp()}function f(){i.palette=n("<div />").addClass(r.paletteClass+" rounded-3");for(var t=0;t<r.colors.length;t++)n("<div />").addClass("color").css("background-color",r.colors[t]).attr({title:r.colors[t],unselectable:"on"}).appendTo(i.palette).mouseenter(function(){var t=n(this).attr("title");i.input.val(t),i.preview.css("background-color",t)}).click(function(t){t.stopPropagation(),u(n(this).attr("title"))});i.input=n('<input type="text" />').addClass("rounded-3").attr("size",8).click(function(t){t.stopPropagation(),n(this).focus()}).keydown(function(t){var r,f;return t.ctrlKey||t.metaKey?!0:(r=t.keyCode,r==27)?i.mouseleave():r!=8&&r!=13&&r!=46&&r!=37&&r!=39&&(r<48||r>57)&&(r<65||r>70)?!1:(f=n(this).val(),(f.length==7||f.length==0)&&(r==13&&(t.stopPropagation(),t.preventDefault(),u(f),i.palette.slideUp()),t.keyCode!=8&&t.keyCode!=46&&r!=37&&r!=39)?!1:void 0)}).keyup(function(){var t=n(this).val();t.length==7&&/^#[0-9abcdef]{6}$/i.test(t)&&i.val(t)}),i.preview=n("<div />").addClass("preview rounded-3").click(function(n){n.stopPropagation(),u(i.input.val())}),i.palette.append(n("<div />").addClass("clearfix")).append(n("<div />").addClass("panel").append(i.input).append(i.preview)),r.palettePosition=="outer"?(i.palette.hide().appendTo(i.parents("body").eq(0)).mouseleave(function(){i.palette.is(":animated")||(n(this).slideUp(),i.val(i.val()))}),i.mouseleave(function(n){n.relatedTarget!=i.palette.get(0)&&(i.palette.is(":animated")||(i.palette.slideUp(),i.val(i.val())))})):i.append(i.palette.hide()).mouseleave(function(){i.palette.slideUp(),i.val(i.val())}),i.val(i.val())}var i=this,r=n.extend({},n.fn.elColorPicker.defaults,t);return this.hidden=n('<input type="hidden" />').attr("name",r.name).val(r.color||"").appendTo(this),this.palette=null,this.preview=null,this.input=null,this.empty().addClass(r["class"]+" rounded-3").css({position:"relative","background-color":r.color||""}).click(function(){if(!i.hasClass("disabled")){if(i.palette||f(),r.palettePosition=="outer"&&i.palette.css("display")=="none"){var t=n(this).offset(),u=i.palette.width(),e=i.parents("body").width()-t.left>=u?t.left:t.left+n(this).outerWidth()-u;i.palette.css({left:e+"px",top:t.top+n(this).height()+1+"px"})}i.palette.slideToggle()}}),this.val=function(n){if(n||n==="")this.hidden.val(n),r.update?r.update(this.hidden.val()):this.css("background-color",n),i.palette&&(i.preview.css("background-color",n),i.input.val(n));else return this.hidden.val();return this},this},n.fn.elColorPicker.defaults={"class":"el-colorpicker",paletteClass:"el-palette",palettePosition:"inner",name:"color",color:"",update:null,change:function(){},colors:["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ffcccc","#cc9999","#996666","#663333","#330000","#ff9999","#cc6666","#cc3333","#993333","#660000","#ff6666","#ff3333","#ff0000","#cc0000","#990000","#ff9966","#ff6633","#ff3300","#cc3300","#993300","#ffcc99","#cc9966","#cc6633","#996633","#663300","#ff9933","#ff6600","#ff9900","#cc6600","#cc9933","#ffcc66","#ffcc33","#ffcc00","#cc9900","#996600","#ffffcc","#cccc99","#999966","#666633","#333300","#ffff99","#cccc66","#cccc33","#999933","#666600","#ffff66","#ffff33","#ffff00","#cccc00","#999900","#ccff66","#ccff33","#ccff00","#99cc00","#669900","#ccff99","#99cc66","#99cc33","#669933","#336600","#99ff33","#99ff00","#66ff00","#66cc00","#66cc33","#99ff66","#66ff33","#33ff00","#33cc00","#339900","#ccffcc","#99cc99","#669966","#336633","#003300","#99ff99","#66cc66","#33cc33","#339933","#006600","#66ff66","#33ff33","#00ff00","#00cc00","#009900","#66ff99","#33ff66","#00ff33","#00cc33","#009933","#99ffcc","#66cc99","#33cc66","#339966","#006633","#33ff99","#00ff66","#00ff99","#00cc66","#33cc99","#66ffcc","#33ffcc","#00ffcc","#00cc99","#009966","#ccffff","#99cccc","#669999","#336666","#003333","#99ffff","#66cccc","#33cccc","#339999","#006666","#66cccc","#33ffff","#00ffff","#00cccc","#009999","#66ccff","#33ccff","#00ccff","#0099cc","#006699","#99ccff","#6699cc","#3399cc","#336699","#003366","#3399ff","#0099ff","#0066ff","#066ccc","#3366cc","#6699ff","#3366ff","#0033ff","#0033cc","#003399","#ccccff","#9999cc","#666699","#333366","#000033","#9999ff","#6666cc","#3333cc","#333399","#000066","#6666ff","#3333ff","#0000ff","#0000cc","#009999","#9966ff","#6633ff","#3300ff","#3300cc","#330099","#cc99ff","#9966cc","#6633cc","#663399","#330066","#9933ff","#6600ff","#9900ff","#6600cc","#9933cc","#cc66ff","#cc33ff","#cc00ff","#9900cc","#660099","#ffccff","#cc99cc","#996699","#663366","#330033","#ff99ff","#cc66cc","#cc33cc","#993399","#660066","#ff66ff","#ff33ff","#ff00ff","#cc00cc","#990099","#ff66cc","#ff33cc","#ff00cc","#cc0099","#990066","#ff99cc","#cc6699","#cc3399","#993366","#660033","#ff3399","#ff0099","#ff0066","#cc0066","#cc3366","#ff6699","#ff3366","#ff0033","#cc0033","#990033"]}}(jQuery),function(n){n.fn.elBorderSelect=function(t){function s(n){function i(n){return hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n?hexDigits[(n-n%16)/16]+hexDigits[n%16]:"00"}var t=(n||"").match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/);return t?"#"+i(t[1])+i(t[2])+i(t[3]):""}function h(t){var i,r;if(!t)return t;if(i=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/),i&&(t=i[1],unit=i[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t),isNaN(t))return"";r=parseInt(n(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*r);case"pt":return parseInt(t*r/12);case"%":return parseInt(t*r/100)}return t}var r=this,o=this.eq(0),i=n.extend({},n.fn.elBorderSelect.defaults,t),u=n('<input type="text" />').attr({name:i.name+"[width]",size:3}).css("text-align","right").change(function(){r.change()}),f=n("<div />").css("position","relative").elColorPicker({"class":"el-colorpicker ui-icon ui-icon-pencil",name:i.name+"[color]",palettePosition:"outer",change:function(){r.change()}}),e=n("<div />").elSelect({tpl:'<div style="border-bottom:4px %val #000;width:100%;margin:7px 0"> <\/div>',tpls:{"":"%label"},maxHeight:i.styleHeight||null,select:function(){r.change()},src:{"":"none",solid:"solid",dashed:"dashed",dotted:"dotted",double:"double",groove:"groove",ridge:"ridge",inset:"inset",outset:"outset"}});return o.empty().addClass(i["class"]).attr("name",i.name||"").append(n("<table />").attr("cellspacing",0).append(n("<tr />").append(n("<td />").append(u).append(" px")).append(n("<td />").append(e)).append(n("<td />").append(f)))),this.change=function(){i.change&&i.change(this.val())},this.val=function(t){var i,o,r,c,l;return t||t===""?(c="",t.nodeName||t.css?(t.css||(t=n(t)),c=t.css("border"),(c=t.css("border"))?i=o=r=c:(i=t.css("border-width"),o=t.css("border-style"),r=t.css("border-color"))):(i=t.width||"",o=t.style||"",r=t.color||""),u.val(h(i)),l=o?o.match(/(solid|dashed|dotted|double|groove|ridge|inset|outset)/i):"",e.val(l?l[1]:""),f.val(r.indexOf("#")===0?r:s(r)),this):(i=parseInt(u.val()),i=isNaN(i)?"":i+"px",o=e.val(),r=f.val(),{width:i,style:o,color:r,css:n.trim(i+" "+o+" "+r)})},this.val(i.value),this},n.fn.elBorderSelect.defaults={name:"el-borderselect","class":"el-borderselect",value:{},change:null}}(jQuery),function(t){t.fn.elPaddingInput=function(i){function f(i){return i=t.trim(i.toString()),i[0]=="."&&(i="0"+i),n=parseFloat(i),isNaN(n)?i=="auto"?i:"":n}function e(){r.change&&r.change(u)}var u=this,r=t.extend({},t.fn.elPaddingInput.defaults,{name:this.attr("name")},i);return this.regexps={main:new RegExp(r.type=="padding"?'paddings*:s*([^;"]+)':'margins*:s*([^;"]+)',"im"),left:new RegExp(r.type=="padding"?'padding-lefts*:s*([^;"]+)':'margin-lefts*:s*([^;"]+)',"im"),top:new RegExp(r.type=="padding"?'padding-tops*:s*([^;"]+)':'margin-tops*:s*([^;"]+)',"im"),right:new RegExp(r.type=="padding"?'padding-rights*:s*([^;"]+)':'margin-rights*:s*([^;"]+)',"im"),bottom:new RegExp(r.type=="padding"?'padding-bottoms*:s*([^;"]+)':'margin-bottoms*:s*([^;"]+)',"im")},t.each(["left","top","right","bottom"],function(){u[this]=t('<input type="text" />').attr("size",3).css("text-align","right").css("border-"+this,"2px solid red").bind("change",function(){t(this).val(f(t(this).val())),e()}).attr("name",r.name+"["+this+"]")}),t.each(["uleft","utop","uright","ubottom"],function(){u[this]=t("<select />").append('<option value="px">px<\/option>').append('<option value="em">em<\/option>').append('<option value="pt">pt<\/option>').bind("change",function(){e()}).attr("name",r.name+"["+this+"]"),r.percents&&u[this].append('<option value="%">%<\/option>')}),this.empty().addClass(r["class"]).append(this.left).append(this.uleft).append(" x ").append(this.top).append(this.utop).append(" x ").append(this.right).append(this.uright).append(" x ").append(this.bottom).append(this.ubottom),this.val=function(n){var e,o,s,r,n;if(n||n==="")return(n.nodeName||n.css)&&(n.css||(n=t(n)),e={left:"",top:"",right:"",bottom:""},o=(n.attr("style")||"").toLowerCase(),o&&(o=t.trim(o),s=o.match(this.regexps.main),s?(r=t.trim(s[1]).replace(/\s+/g," ").split(" ",4),e.top=r[0],e.right=r[1]&&r[1]!==""?r[1]:e.top,e.bottom=r[2]&&r[2]!==""?r[2]:e.top,e.left=r[3]&&r[3]!==""?r[3]:e.right):t.each(["left","top","right","bottom"],function(){var n=this.toString();s=o.match(u.regexps[n]),s&&(e[n]=s[1])})),n=e),t.each(["left","top","right","bottom"],function(){var t=this.toString(),r,i;u[t].val(""),u["u"+t].val(),typeof n[t]!="undefined"&&n[t]!==null&&(n[t]=n[t].toString(),r=f(n[t]),u[t].val(r),i=n[t].match(/(px|em|pt|%)/i),u["u"+t].val(i?i[1]:"px"))}),this;var h=f(this.left.val()),c=f(this.top.val()),l=f(this.right.val()),a=f(this.bottom.val()),i={left:h=="auto"||h==0?h:h!==""?h+this.uleft.val():"",top:c=="auto"||c==0?c:c!==""?c+this.utop.val():"",right:l=="auto"||l==0?l:l!==""?l+this.uright.val():"",bottom:a=="auto"||a==0?a:a!==""?a+this.ubottom.val():"",css:""};return i.left!==""&&i.right!==""&&i.top!==""&&i.bottom!==""&&(i.css=i.left==i.right&&i.top==i.bottom?i.top+" "+i.left:i.top+" "+i.right+" "+i.bottom+" "+i.left),i},this.val(r.value),this},t.fn.elPaddingInput.defaults={name:"el-paddinginput","class":"el-paddinginput",type:"padding",value:{},percents:!0,change:null}}(jQuery),function(n){n.fn.elSelect=function(t){function l(n){var t=i.labelTpl||i.tpls[n]||i.tpl;s.html(t.replace(/%val/g,n).replace(/%label/,i.src[n])).children().attr({unselectable:"on"})}function a(){var t,s,f,h;r=n("<div />").addClass(i.listClass+" rounded-3").hide().appendTo(u.mouseleave(function(){r.slideUp()}));for(t in i.src)s=i.tpls[t]||i.tpl,n("<div />").attr("name",t).append(n(s.replace(/%val/g,t).replace(/%label/g,i.src[t])).attr({unselectable:"on"})).appendTo(r).hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault();var u=n(this).attr("name");o.val(u),i.select(u),r.slideUp()});f=u.outerWidth(),r.width()<f&&r.width(f),h=r.height(),i.maxHeight>0&&h>i.maxHeight&&r.height(i.maxHeight),o.val(e.val())}var o=this,u=this.eq(0),i=n.extend({},n.fn.elSelect.defaults,t),e=n('<input type="hidden" />').attr("name",i.name),s=n("<label />").attr({unselectable:"on"}).addClass("rounded-left-3"),r=null,f=null,h,c;if(u.get(0).nodeName=="SELECT"&&(i.src={},u.children("option").each(function(){i.src[n(this).val()]=n(this).text()}),i.value=u.val(),i.name=u.attr("name"),u.replaceWith(u=n("<div />"))),!i.value||!i.src[i.val]){i.value=null,h=0;for(c in i.src)h++==0&&(i.value=c)}return this.val=function(t){return t||t===""?(i.src[t]&&(e.val(t),l(t),r&&r.children().each(function(){n(this).attr("name")==t?n(this).addClass("active"):n(this).removeClass("active")})),this):e.val()},u.empty().addClass(i["class"]+" rounded-3").attr({unselectable:"on"}).append(e).append(s).hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(){r||a(),r.slideToggle(),n.browser.msie&&!f&&(r.children().each(function(){f=Math.max(f,n(this).width())}),f>r.width()&&r.width(f+40))}),this.val(i.value),this},n.fn.elSelect.defaults={name:"el-select","class":"el-select",listClass:"list",labelTpl:null,tpl:"<%val>%label<\/%val>",tpls:{},value:null,src:{},select:function(n){window.console&&window.console.log&&window.console.log("selected: "+n)},maxHeight:410}}(jQuery),function(n){elRTE=function(t,i){var r,f,u,e,o;if(!t||!t.nodeName)return alert('elRTE: argument "target" is not DOM Element');if(r=this,this.version="1.3",this.build="2011-06-23",this.options=n.extend(!0,{},this.options,i),this.browser=n.browser,this.target=n(t),this.lang=""+this.options.lang,this._i18n=new eli18n({textdomain:"rte",messages:{rte:this.i18Messages[this.lang]||{}}}),this.rtl=!!(/^(ar|fa|he)$/.test(this.lang)&&this.i18Messages[this.lang]),this.rtl&&(this.options.cssClass+=" el-rte-rtl"),this.toolbar=n('<div class="toolbar"/>'),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("frameborder",0),this.workzone=n('<div class="workzone"/>').append(this.iframe).append(this.source),this.statusbar=n('<div class="statusbar"/>'),this.tabsbar=n('<div class="tabsbar"/>'),this.editor=n('<div class="'+this.options.cssClass+'" />').append(this.toolbar).append(this.workzone).append(this.statusbar).append(this.tabsbar),this.doc=null,this.$doc=null,this.window=null,this.utils=new this.utils(this),this.dom=new this.dom(this),this.filter=new this.filter(this),this.updateHeight=function(){r.workzone.add(r.iframe).add(r.source).height(r.workzone.height())},this.resizable=function(t){var i=this;this.options.resizable&&n.fn.resizable&&(t?this.editor.resizable({handles:"se",alsoResize:this.workzone,minWidth:300,minHeight:200}).bind("resize",i.updateHeight):this.editor.resizable("destroy").unbind("resize",i.updateHeight))},this.editor.insertAfter(t),u="",t.nodeName=="TEXTAREA"?(this.source=this.target,this.source.insertAfter(this.iframe).hide(),u=this.target.val()):(this.source=n("<textarea />").insertAfter(this.iframe).hide(),u=this.target.hide().html()),this.source.attr("name",this.target.attr("name")||this.target.attr("id")),u=n.trim(u),u||(u=" "),this.options.allowSource&&this.tabsbar.append('<div class="tab editor rounded-bottom-7 active">'+r.i18n("Editor")+'<\/div><div class="tab source rounded-bottom-7">'+r.i18n("Source")+'<\/div><div class="clearfix" style="clear:both"/>').children(".tab").click(function(){n(this).hasClass("active")||(r.tabsbar.children(".tab").toggleClass("active"),r.workzone.children().toggle(),n(this).hasClass("editor")?(r.updateEditor(),r.window.focus(),r.ui.update(!0)):(r.updateSource(),r.source.focus(),n.browser.msie||r.source[0].setSelectionRange(0,0),r.ui.disable(),r.statusbar.empty()))}),this.window=this.iframe.contentWindow,this.doc=this.iframe.contentWindow.document,this.$doc=n(this.doc),f='<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',n.each(r.options.cssfiles,function(){f+='<link rel="stylesheet" type="text/css" href="'+this+'" />'}),this.doc.open(),e=this.filter.wysiwyg(u),o=this.rtl?' class="el-rte-rtl"':"",this.doc.write(r.options.doctype+f+"<\/head><body"+o+">"+e+"<\/body><\/html>"),this.doc.close(),n.browser.msie)this.doc.body.contentEditable=!0;else{try{this.doc.designMode="on"}catch(s){}this.doc.execCommand("styleWithCSS",!1,this.options.styleWithCSS)}this.options.height>0&&this.workzone.height(this.options.height),this.options.width>0&&this.editor.width(this.options.width),this.updateHeight(),this.resizable(!0),this.window.focus(),this.history=new this.history(this),this.selection=new this.selection(this),this.ui=new this.ui(this),this.target.parents("form").bind("submit.elfinder",function(){r.source.parents("form").find('[name="el-select"]').remove(),r.beforeSave()}),this.source.bind("keydown",function(t){var r,i,u;t.keyCode==9&&(t.preventDefault(),n.browser.msie?(r=document.selection.createRange(),r.text="\t"+r.text,this.focus()):(i=this.value.substr(0,this.selectionStart),u=this.value.substr(this.selectionEnd),this.value=i+"\t"+u,this.setSelectionRange(i.length+1,i.length+1)))}),n(this.doc.body).bind("dragend",function(){setTimeout(function(){try{r.window.focus();var n=r.selection.getBookmark();r.selection.moveToBookmark(n),r.ui.update()}catch(t){}},200)}),this.typing=!1,this.lastKey=null,this.$doc.bind("mouseup",function(){r.typing=!1,r.lastKey=null,r.ui.update()}).bind("keyup",function(n){(n.keyCode>=8&&n.keyCode<=13||n.keyCode>=32&&n.keyCode<=40||n.keyCode==46||n.keyCode>=96&&n.keyCode<=111)&&r.ui.update()}).bind("keydown",function(t){if((t.metaKey||t.ctrlKey)&&t.keyCode==65)r.ui.update();else if(t.keyCode==13){var i=r.selection.getNode();if(r.dom.selfOrParent(i,/^PRE$/))return r.selection.insertNode(r.doc.createTextNode("\r\n")),!1;if(n.browser.safari&&t.shiftKey)return r.selection.insertNode(r.doc.createElement("br")),!1}return t.keyCode>=48&&t.keyCode<=57||t.keyCode==61||t.keyCode==109||t.keyCode>=65&&t.keyCode<=90||t.keyCode==188||t.keyCode==190||t.keyCode==191||t.keyCode>=219&&t.keyCode<=222?(r.typing||r.history.add(!0),r.typing=!0,r.lastKey=null):(t.keyCode==8||t.keyCode==46||t.keyCode==32||t.keyCode==13)&&(t.keyCode!=r.lastKey&&r.history.add(!0),r.lastKey=t.keyCode,r.typing=!1),t.keyCode==32&&n.browser.opera?(r.selection.insertNode(r.doc.createTextNode(" ")),!1):void 0}).bind("paste",function(t){if(r.options.allowPaste){var i=n(r.dom.create("div"))[0],u=r.doc.createTextNode("_");r.history.add(!0),r.typing=!0,r.lastKey=null,i.appendChild(u),r.selection.deleteContents().insertNode(i),r.selection.select(u),setTimeout(function(){i.parentNode?(n(i).html(r.filter.proccess("paste",n(i).html())),u=i.lastChild,r.dom.unwrap(i),u&&(r.selection.select(u),r.selection.collapse(!1))):(i.parentNode&&i.parentNode.removeChild(i),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(n(r.doc.body).html()))),r.selection.select(r.doc.body.firstChild),r.selection.collapse(!0)),n(r.doc.body).mouseup()},15)}else t.stopPropagation(),t.preventDefault()}),n.browser.msie&&this.$doc.bind("keyup",function(t){t.keyCode==86&&(t.metaKey||t.ctrlKey)&&(r.history.add(!0),r.typing=!0,r.lastKey=null,r.selection.saveIERange(),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(n(r.doc.body).html()))),r.selection.restoreIERange(),n(r.doc.body).mouseup(),this.ui.update())}),n.browser.safari&&this.$doc.bind("click",function(t){n(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl"),t.target.nodeName=="IMG"&&n(t.target).addClass("elrte-webkit-hl")}).bind("keyup",function(){n(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl")}),this.window.focus(),this.destroy=function(){this.updateSource(),this.target.is("textarea")?this.target.val(n.trim(this.source.val())):this.target.html(n.trim(this.source.val())),this.editor.remove(),this.target.show().parents("form").unbind("submit.elfinder")}},elRTE.prototype.i18n=function(n){return this._i18n.translate(n)},elRTE.prototype.open=function(){this.editor.show()},elRTE.prototype.close=function(){this.editor.hide()},elRTE.prototype.updateEditor=function(){this.val(this.source.val())},elRTE.prototype.updateSource=function(){this.source.val(this.filter.source(n(this.doc.body).html()))},elRTE.prototype.val=function(t){if(typeof t=="string")t=""+t,this.source.is(":visible")?this.source.val(this.filter.source2source(t)):n.browser.msie?(this.doc.body.innerHTML="<br />"+this.filter.wysiwyg(t),this.doc.body.removeChild(this.doc.body.firstChild)):this.doc.body.innerHTML=this.filter.wysiwyg(t);else return this.source.is(":visible")?this.filter.source2source(this.source.val()).trim():this.filter.source(n(this.doc.body).html()).trim()},elRTE.prototype.beforeSave=function(){this.source.val(n.trim(this.val())||"")},elRTE.prototype.save=function(){this.beforeSave(),this.editor.parents("form").submit()},elRTE.prototype.log=function(n){window.console&&window.console.log&&window.console.log(n)},elRTE.prototype.i18Messages={},n.fn.elrte=function(n,t){var r=typeof n=="string"?n:"",i;return(this.each(function(){this.elrte||(this.elrte=new elRTE(this,typeof n=="object"?n:{}));switch(r){case"open":case"show":this.elrte.open();break;case"close":case"hide":this.elrte.close();break;case"updateSource":this.elrte.updateSource();break;case"destroy":this.elrte.destroy()}}),r=="val")?this.length?this.length==1?t?this[0].elrte.val(t):this[0].elrte.val():(i={},this.each(function(){i[this.elrte.source.attr("name")]=this.elrte.val()}),i):"":this}}(jQuery),function(n){elRTE.prototype.dom=function(t){this.rte=t;var r=this;this.regExp={textNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TD|TH|TT|VAR)$/,textContainsNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DL|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|OL|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|TT|UL|VAR)$/,block:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|UL)$/,selectionBlock:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TD|TH|TR|UL)$/,header:/^H[1-6]$/,formElement:/^(FORM|INPUT|HIDDEN|TEXTAREA|SELECT|BUTTON)$/},this.root=function(){return this.rte.body},this.create=function(n){return this.rte.doc.createElement(n)},this.createBookmark=function(){var t=this.rte.doc.createElement("span");return t.id="elrte-bm-"+Math.random().toString().substr(2),n(t).addClass("elrtebm elrte-protected"),t},this.indexOf=function(t){var i=0;for(t=n(t);(t=t.prev())&&t.length;)i++;return i},this.attr=function(t,i){var r="";return t.nodeType==1&&(r=n(t).attr(i),r&&i!="src"&&i!="href"&&i!="title"&&i!="alt"&&(r=r.toString().toLowerCase())),r||""},this.findCommonAncestor=function(t,i){var r;if(!t||!i)return this.rte.log("dom.findCommonAncestor invalid arguments");if(t==i)return t;if(t.nodeName=="BODY"||i.nodeName=="BODY")return this.rte.doc.body;var u=n(t).parents(),f=n(i).parents(),e=f.length-1,o=f[e];for(r=u.length-1;r>=0;r--,e--)if(u[r]==f[e])o=u[r];else break;return o},this.isEmpty=function(t){return t.nodeType==1?this.regExp.textNodes.test(t.nodeName)?n.trim(n(t).text()).length==0:!1:t.nodeType==3?/^(TABLE|THEAD|TFOOT|TBODY|TR|UL|OL|DL)$/.test(t.parentNode.nodeName)||t.nodeValue==""||n.trim(t.nodeValue).length==0&&!(t.nextSibling&&t.previousSibling&&t.nextSibling.nodeType==1&&t.previousSibling.nodeType==1&&!this.regExp.block.test(t.nextSibling.nodeName)&&!this.regExp.block.test(t.previousSibling.nodeName)):!0},this.next=function(n){while(n.nextSibling&&(n=n.nextSibling))if(n.nodeType==1||n.nodeType==3&&!this.isEmpty(n))return n;return null},this.prev=function(n){while(n.previousSibling&&(n=n.previousSibling))if(n.nodeType==1||n.nodeType==3&&!this.isEmpty(n))return n;return null},this.isPrev=function(n,t){while(n=this.prev(n))if(n==t)return!0;return!1},this.nextAll=function(n){for(var t=[];n=this.next(n);)t.push(n);return t},this.prevAll=function(n){for(var t=[];n=this.prev(n);)t.push(n);return t},this.toLineEnd=function(n){for(var t=[];(n=this.next(n))&&n.nodeName!="BR"&&n.nodeName!="HR"&&this.isInline(n);)t.push(n);return t},this.toLineStart=function(n){for(var t=[];(n=this.prev(n))&&n.nodeName!="BR"&&n.nodeName!="HR"&&this.isInline(n);)t.unshift(n);return t},this.isFirstNotEmpty=function(t){while(t=this.prev(t))if(t.nodeType==1||t.nodeType==3&&n.trim(t.nodeValue)!="")return!1;return!0},this.isLastNotEmpty=function(n){while(n=this.next(n))if(!this.isEmpty(n))return!1;return!0},this.isOnlyNotEmpty=function(n){return this.isFirstNotEmpty(n)&&this.isLastNotEmpty(n)},this.findLastNotEmpty=function(n){if(this.rte.log("findLastNotEmpty Who is here 0_o"),n.nodeType==1&&(l=n.lastChild)){if(!this.isEmpty(l))return l;while(l.previousSibling&&(l=l.previousSibling))if(!this.isEmpty(l))return l}return!1},this.isInline=function(t){if(t.nodeType==3)return!0;if(t.nodeType==1){t=n(t);var i=t.css("display"),r=t.css("float");return i=="inline"||i=="inline-block"||r=="left"||r=="right"}return!0},this.is=function(n,t){if(n&&n.nodeName){if(typeof t=="string"&&(t=this.regExp[t]||/.?/),t instanceof RegExp&&n.nodeName)return t.test(n.nodeName);if(typeof t=="function")return t(n)}return!1},this.filter=function(n,t){var r=[],i;if(!n.push)return this.is(n,t)?n:null;for(i=0;i<n.length;i++)this.is(n[i],t)&&r.push(n[i]);return r},this.parents=function(n,t){for(var i=[];n&&(n=n.parentNode)&&n.nodeName!="BODY"&&n.nodeName!="HTML";)this.is(n,t)&&i.push(n);return i},this.parent=function(n,t){return this.parents(n,t)[0]||null},this.selfOrParent=function(n,t,i){return this.is(n,t)?n:this.parent(n,i||t)},this.selfOrParentLink=function(n){return n=this.selfOrParent(n,/^A$/),n&&n.href?n:null},this.selfOrParentAnchor=function(n){return n=this.selfOrParent(n,/^A$/),n&&!n.href&&n.name?n:null},this.childLinks=function(t){var i=[];return n("a[href]",t).each(function(){i.push(this)}),i},this.selectionHas=function(n){var t=this.rte.selection.cloneContents(),i;if(t&&t.childNodes&&t.childNodes.length)for(i=0;i<t.childNodes.length;i++)if(typeof n=="function"){if(n(t.childNodes[i]))return!0}else if(t instanceof RegExp&&n.test(t.childNodes[i].nodeName))return!0;return!1},this.wrap=function(t,i){return t=n.isArray(t)?t:[t],i=i.nodeName?i:this.create(i),t[0]&&t[0].nodeType&&t[0].parentNode&&(i=t[0].parentNode.insertBefore(i,t[0]),n(t).each(function(){this!=i&&i.appendChild(this)})),i},this.unwrap=function(n){if(n&&n.parentNode){while(n.firstChild)n.parentNode.insertBefore(n.firstChild,n);n.parentNode.removeChild(n)}},this.wrapContents=function(n,t){t=t.nodeName?t:this.create(t);for(var i=0;i<n.childNodes.length;i++)t.appendChild(n.childNodes[i]);return n.appendChild(t),t},this.cleanNode=function(t){if(t.nodeType==1){if(/^(P|LI)$/.test(t.nodeName)&&(l=this.findLastNotEmpty(t))&&l.nodeName=="BR"&&n(l).remove(),$n=n(t),$n.children().each(function(){this.cleanNode(this)}),t.nodeName!="BODY"&&!/^(TABLE|TR|TD)$/.test(t)&&this.isEmpty(t))return $n.remove();$n.attr("style")===""&&$n.removeAttr("style"),this.rte.browser.safari&&$n.hasClass("Apple-span")&&$n.removeClass("Apple-span"),t.nodeName!="SPAN"||$n.attr("style")||$n.attr("class")||$n.attr("id")||$n.replaceWith($n.html())}},this.cleanChildNodes=function(t){var i=this.cleanNode;n(t).children().each(function(){i(this)})},this.tableMatrix=function(t){var i=[],r;if(t&&t.nodeName=="TABLE"){r=0;function u(n){for(var t=0;t<=r;t++)if(!i[n][t])return t}n(t).find("tr").each(function(t){n.isArray(i[t])||(i[t]=[]),n(this).children("td,th").each(function(){for(var h=parseInt(n(this).attr("colspan")||1),c=parseInt(n(this).attr("rowspan")||1),l=u(t),e,o,s,f=0;f<c;f++)for(e=0;e<h;e++)o=t+f,n.isArray(i[o])||(i[o]=[]),s=e==0&&f==0?this:f==0?e:"-",i[o][l+e]=s;r=Math.max(r,i[t].length)})})}return i},this.indexesOfCell=function(n,t){for(var r,i=0;i<t.length;i++)for(r=0;r<t[i].length;r++)if(t[i][r]==n)return[i,r]},this.fixTable=function(t){var r,f,s,h;if(t&&t.nodeName=="TABLE"){var e=n(t),o=this.tableMatrix(t),u=0;if(n.each(o,function(){u=Math.max(u,this.length)}),u==0)return e.remove();for(r=0;r<o.length;r++)if(f=o[r].length,f==0)e.find("tr").eq(r).remove();else if(f<u)for(s=u-f,h=e.find("tr").eq(r),i=0;i<s;i++)h.append("<td>&nbsp;<\/td>")}},this.tableColumn=function(n,t,i){var h,u,c,f,o,r,s,e;if(n=this.selfOrParent(n,/^TD|TH$/),h=this.selfOrParent(n,/^TABLE$/),ret=[],info={offset:[],delta:[]},n&&h){for(i&&this.fixTable(h),u=this.tableMatrix(h),c=!1,r=0;r<u.length;r++){for(o=0;o<u[r].length;o++)if(u[r][o]==n){f=o,c=!0;break}if(c)break}if(f>=0)for(r=0;r<u.length;r++)s=u[r][f]||null,s&&(s.nodeName?(ret.push(s),t&&(info.delta.push(0),info.offset.push(f))):(e=parseInt(s),!isNaN(e)&&u[r][f-e]&&u[r][f-e].nodeName&&(ret.push(u[r][f-e]),t&&(info.delta.push(e),info.offset.push(f)))))}return t?{column:ret,info:info}:ret}}}(jQuery),function(n){elRTE.prototype.filter=function(t){var i=this,r=n("<span/>").addClass("elrtetesturl").appendTo(document.body)[0];this.url=(typeof r.currentStyle!="undefined"?r.currentStyle.backgroundImage:document.defaultView.getComputedStyle(r,null).backgroundImage).replace(/^url\((['"]?)([\s\S]+\/)[\s\S]+\1\)$/i,"$2"),n(r).remove(),this.rte=t,this.xhtml=/xhtml/i.test(t.options.doctype),this.boolAttrs=t.utils.makeObject("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected".split(",")),this.tagRegExp=/<(\/?)([\w:]+)((?:\s+[a-z\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.openTagRegExp=/<([\w:]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.attrRegExp=/(\w+)(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^\s]+))?/g,this.scriptRegExp=/<script([^>]*)>([\s\S]*?)<\/script>/gi,this.styleRegExp=/(<style([^>]*)>[\s\S]*?<\/style>)/gi,this.linkRegExp=/(<link([^>]+)>)/gi,this.cdataRegExp=/<!\[CDATA\[([\s\S]+)\]\]>/g,this.objRegExp=/<object([^>]*)>([\s\S]*?)<\/object>/gi,this.embRegExp=/<(embed)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.paramRegExp=/<(param)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.iframeRegExp=/<iframe([^>]*)>([\s\S]*?)<\/iframe>/gi,this.yMapsRegExp=/<div\s+([^>]*id\s*=\s*('|")?YMapsID[^>]*)>/gi,this.gMapsRegExp=/<iframe\s+([^>]*src\s*=\s*"http:\/\/maps\.google\.\w+[^>]*)>([\s\S]*?)<\/iframe>/gi,this.videoHostRegExp=/^(http:\/\/[\w\.]*)?(youtube|vimeo|rutube).*/i,this.serviceClassRegExp=/<(\w+)([^>]*class\s*=\s*"[^>]*elrte-[^>]*)>\s*(<\/\1>)?/gi,this.pagebreakRegExp=/<(\w+)([^>]*style\s*=\s*"[^>]*page-break[^>]*)>\s*(<\/\1>)?/gi,this.pbRegExp=new RegExp("<!-- pagebreak -->","gi"),this.allowTags=t.options.allowTags.length?t.utils.makeObject(t.options.allowTags):null,this.denyTags=t.options.denyTags.length?t.utils.makeObject(t.options.denyTags):null,this.denyAttr=t.options.denyAttr?t.utils.makeObject(t.options.denyAttr):null,this.pasteDenyAttr=t.options.pasteDenyAttr?t.utils.makeObject(t.options.pasteDenyAttr):null,this.fontSize=["medium","xx-small","small","medium","large","x-large","xx-large"],this.fontFamily={"sans-serif":/^(arial|tahoma|verdana)$/i,serif:/^(times|times new roman)$/i,monospace:/^courier$/i},this.scripts={},this._chains={},n.each(this.chains,function(t){i._chains[t]=[],n.each(this,function(n,r){typeof i.rules[r]=="function"&&i._chains[t].push(i.rules[r])})}),this.proccess=function(t,r){return r=n.trim(r).replace(/^\s*(&nbsp;)+/gi,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""),n.each(this._chains[t]||[],function(){r=this.call(i,r)}),r=r.replace(/\t/g,"  ").replace(/\r/g,"").replace(/\s*\n\s*\n+/g,"\n")+"  ",n.trim(r)?r:" "},this.wysiwyg=function(n){return this.proccess("wysiwyg",n)},this.source=function(n){return this.proccess("source",n)},this.source2source=function(n){return this.proccess("source2source",n)},this.wysiwyg2wysiwyg=function(n){return this.proccess("wysiwyg2wysiwyg",n)},this.parseAttrs=function(t){var i={},o=this.boolAttrs,e=t.match(this.attrRegExp),r,u,f;return e&&n.each(e,function(t,e){r=e.split("="),u=n.trim(r[0]).toLowerCase(),r.length>2?(r.shift(),f=r.join("=")):f=o[u]||r[1]||"",i[u]=n.trim(f).replace(/^('|")(.*)(\1)$/,"$2")}),i.style=this.rte.utils.parseStyle(i.style),i["class"]=this.rte.utils.parseClass(i["class"]||""),i},this.serializeAttrs=function(t,i){var r=[],u=this;return n.each(t,function(n,t){n=="style"?t=u.rte.utils.serializeStyle(t,i):n=="class"&&(t=u.rte.utils.serializeClass(t)),t&&r.push(n+'="'+t+'"')}),r.join(" ")},this.cleanAttrs=function(t,i){function r(n){return n+(/\d$/.test(n)?"px":"")}var f=this,u=this.replaceAttrs;return n.each(t["class"],function(n){/^(Apple-style-span|mso\w+)$/i.test(n)&&delete t["class"][n]}),n.each(t,function(e,o){u[e]&&u[e].call(f,t,i),e=="style"&&n.each(o,function(n,i){switch(n){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":t.style[n.replace(/^mso-|-alt$/g,"")]=r(i),delete t.style[n];break;case"horiz-align":t.style["text-align"]=i,delete t.style[n];break;case"vert-align":t.style["vertical-align"]=i,delete t.style[n];break;case"font-color":case"mso-foreground":t.style.color=i,delete t.style[n];break;case"mso-background":case"mso-highlight":t.style.background=i,delete t.style[n];break;case"mso-default-height":t.style["min-height"]=r(i),delete t.style[n];break;case"mso-default-width":t.style["min-width"]=r(i),delete t.style[n];break;case"mso-padding-between-alt":t.style["border-collapse"]="separate",t.style["border-spacing"]=r(i),delete t.style[n];break;case"text-line-through":i.match(/(single|double)/i)&&(t.style["text-decoration"]="line-through"),delete t.style[n];break;case"mso-zero-height":i=="yes"&&(t.style.display="none"),delete t.style[n];break;case"font-weight":i==700&&(t.style["font-weight"]="bold");break;default:n.match(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/)&&delete t.style[n]}})}),t}},elRTE.prototype.filter.prototype.replaceTags={b:{tag:"strong"},big:{tag:"span",style:{"font-size":"large"}},center:{tag:"div",style:{"text-align":"center"}},i:{tag:"em"},font:{tag:"span"},nobr:{tag:"span",style:{"white-space":"nowrap"}},menu:{tag:"ul"},plaintext:{tag:"pre"},s:{tag:"strike"},small:{tag:"span",style:{"font-size":"small"}},u:{tag:"span",style:{"text-decoration":"underline"}},xmp:{tag:"pre"}},elRTE.prototype.filter.prototype.replaceAttrs={align:function(n,t){switch(t){case"img":n.style[n.align.match(/(left|right)/)?"float":"vertical-align"]=n.align;break;case"table":n.align=="center"?n.style["margin-left"]=n.style["margin-right"]="auto":n.style.float=n.align;break;default:n.style["text-align"]=n.align}delete n.align},border:function(n){n.style["border-width"]||(n.style["border-width"]=(parseInt(n.border)||1)+"px"),n.style["border-style"]||(n.style["border-style"]="solid"),delete n.border},bordercolor:function(n){n.style["border-color"]||(n.style["border-color"]=n.bordercolor),delete n.bordercolor},background:function(n){n.style["background-image"]||(n.style["background-image"]="url("+n.background+")"),delete n.background},bgcolor:function(n){n.style["background-color"]||(n.style["background-color"]=n.bgcolor),delete n.bgcolor},clear:function(n){n.style.clear=n.clear=="all"?"both":n.clear,delete n.clear},color:function(n){n.style.color||(n.style.color=n.color),delete n.color},face:function(t){var i=t.face.toLowerCase();n.each(this.fontFamily,function(n,r){i.match(r)&&(t.style["font-family"]=i+","+n)}),delete t.face},hspace:function(n,t){if(t=="img"){var i=parseInt(n.hspace)||0;n.style["margin-left"]||(n.style["margin-left"]=i+"px"),n.style["margin-right"]||(n.style["margin-right"]=i+"px"),delete n.hspace}},size:function(n,t){t!="input"&&(n.style["font-size"]=this.fontSize[parseInt(n.size)||0]||"medium",delete n.size)},valign:function(n){n.style["vertical-align"]||(n.style["vertical-align"]=n.valign),delete n.valign},vspace:function(n,t){if(t=="img"){var i=parseInt(n.vspace)||0;n.style["margin-top"]||(n.style["margin-top"]=i+"px"),n.style["margin-bottom"]||(n.style["margin-bottom"]=i+"px"),delete n.hspace}}},elRTE.prototype.filter.prototype.rules={allowedTags:function(n){var t=this.allowTags;return t?n.replace(this.tagRegExp,function(n,i,r){return t[r.toLowerCase()]?n:""}):n},deniedTags:function(n){var t=this.denyTags;return t?n.replace(this.tagRegExp,function(n,i,r){return t[r.toLowerCase()]?"":n}):n},clean:function(t){var i=this,r=this.replaceTags,e=this.replaceAttrs,f=this.denyAttr,u;return t=t.replace(/<!DOCTYPE([\s\S]*)>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1<\/strong><\/p>").replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s&nbsp;]*)<\/span>/gi,"$1").replace(/(<p[^>]*>\s*<\/p>|<p[^>]*\/>)/gi,"<br>").replace(/(<\/p>)(?:\s*<br\s*\/?>\s*|\s*&nbsp;\s*)+\s*(<p[^>]*>)/gi,function(n,t,i){return t+"\n"+i}).replace(this.tagRegExp,function(t,u,e,o){return(e=e.toLowerCase(),u)?"<\/"+(r[e]?r[e].tag:e)+">":(o=i.cleanAttrs(i.parseAttrs(o||""),e),r[e]&&(r[e].style&&n.extend(o.style,r[e].style),e=r[e].tag),f&&n.each(o,function(n){f[n]&&delete o[n]}),o=i.serializeAttrs(o),"<"+e+(o?" ":"")+o+">")}),u=n("<div>"+t+"<\/div>"),u.find("span:not([id]):not([class])").each(function(){var t=n(this);t.attr("style")||(n.trim(t.html()).length?i.rte.dom.unwrap(this):t.remove())}).end().find("span span:only-child").each(function(){var r=n(this),t=r.parent().eq(0),o=r.attr("id"),s=t.attr("id"),u,f,e;!i.rte.dom.isOnlyNotEmpty(this)||o&&s||(e=n.trim(t.attr("class")+" "+r.attr("class")),e&&t.attr("class",e),f=i.rte.utils.serializeStyle(n.extend(i.rte.utils.parseStyle(n(this).attr("style")||""),i.rte.utils.parseStyle(n(t).attr("style")||""))),f&&t.attr("style",f),u=o||s,u&&t.attr("id",u),this.firstChild?n(this.firstChild).unwrap():r.remove())}).end().find("a[name]").each(function(){n(this).addClass("elrte-protected elrte-anchor")}),u.html()},cleanPaste:function(t){var i=this,r=this.pasteDenyAttr;return t=t.replace(this.scriptRegExp,"").replace(this.styleRegExp,"").replace(this.linkRegExp,"").replace(this.cdataRegExp,"").replace(/\<\!--[\s\S]*?--\>/g,""),this.rte.options.pasteOnlyText?t=t.replace(this.tagRegExp,function(n,t,i){return/br/i.test(i)||t&&/h[1-6]|p|ol|ul|li|div|blockquote|tr/i?"<br>":""}).replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""):r&&(t=t.replace(this.openTagRegExp,function(t,u,f){return f=i.parseAttrs(f),n.each(f,function(n){r[n]&&delete f[n]}),f=i.serializeAttrs(f,!0),"<"+u+(f?" ":"")+f+">"})),t},replace:function(t){function e(n,t){function c(){if(n.embed&&n.embed.src)return n.embed.src;if(n.params&&n.params.length)for(u=n.params.length;u--;)if(n.params[u].name=="src"||n.params[u].name=="movie")return n.params[u].value}var r=c(),o=r&&i.videoHostRegExp.test(r)?r.replace(i.videoHostRegExp,"$2"):t.replace(/^\w+\/(.+)/,"$1"),s=parseInt((n.obj?n.obj.width||n.obj.style.width:0)||(n.embed?n.embed.width||n.embed.style.width:0))||150,h=parseInt((n.obj?n.obj.height||n.obj.style.height:0)||(n.embed?n.embed.height||n.embed.style.height:0))||100,f="media"+Math.random().toString().substring(2),e="",u;return n.obj&&n.obj.style&&n.obj.style.float&&(e=' style="float:'+n.obj.style.float+'"'),i.scripts[f]=n,'<img src="'+i.url+'pixel.gif" class="elrte-media elrte-media-'+o+' elrte-protected" title="'+(r?i.rte.utils.encode(r):"")+'" rel="'+f+'" width="'+s+'" height="'+h+'"'+e+">"}var i=this,c=this.rte.options.replace||[],u,f;if(c.length&&n.each(c,function(n,r){typeof r=="function"&&(t=r.call(i,t))}),t=t.replace(this.styleRegExp,"<!-- ELRTE_COMMENT$1 -->").replace(this.linkRegExp,"<!-- ELRTE_COMMENT$1-->").replace(this.cdataRegExp,"<!--[CDATA[$1]]-->").replace(this.scriptRegExp,function(n,t,r){var u;return i.denyTags.script?"":(u="script"+Math.random().toString().substring(2),t=i.parseAttrs(t),t.type||(t.type="text/javascript"),i.scripts[u]="<script "+i.serializeAttrs(t)+">"+r+"<\/script>","<!-- ELRTE_SCRIPT:"+u+" -->")}).replace(this.yMapsRegExp,function(n,t){return t=i.parseAttrs(t),t["class"]["elrte-yandex-maps"]="elrte-yandex-maps",t["class"]["elrte-protected"]="elrte-protected","<div "+i.serializeAttrs(t)+">"}).replace(this.gMapsRegExp,function(n,t){var r="gmaps"+Math.random().toString().substring(2),u,f;return t=i.parseAttrs(t),u=parseInt(t.width||t.style.width||100),f=parseInt(t.height||t.style.height||100),i.scripts[r]=n,'<img src="'+i.url+'pixel.gif" class="elrte-google-maps elrte-protected" id="'+r+'" style="width:'+u+"px;height:"+f+'px">'}).replace(this.objRegExp,function(t,r,u){var o=u.match(i.embRegExp),f={obj:i.parseAttrs(r),embed:o&&o.length?i.parseAttrs(o[0].substring(7)):null,params:[]},s=i.rte.utils.mediaInfo(f.embed?f.embed.type||"":"",f.obj.classid||"");return s?((o=u.match(i.paramRegExp))&&n.each(o,function(n,t){f.params.push(i.parseAttrs(t.substring(6)))}),f.obj.classid||(f.obj.classid=s.classid[0]),f.obj.codebase||(f.obj.codebase=s.codebase),f.embed&&!f.embed.type&&(f.embed.type=s.type),f.obj.width=="1"&&delete f.obj.width,f.obj.height=="1"&&delete f.obj.height,f.embed&&(f.embed.width=="1"&&delete f.embed.width,f.embed.height=="1"&&delete f.embed.height),e(f,s.type)):t}).replace(this.embRegExp,function(n,t,r){var r=i.parseAttrs(r),u=i.rte.utils.mediaInfo(r.type||"");return r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,u?e({embed:r},u.type):n}).replace(this.iframeRegExp,function(n,t){var t=i.parseAttrs(t),u=t.style.width||(parseInt(t.width)>1?parseInt(t.width)+"px":"100px"),f=t.style.height||(parseInt(t.height)>1?parseInt(t.height)+"px":"100px"),r="iframe"+Math.random().toString().substring(2);return i.scripts[r]=n,'<img id="'+r+'" src="'+i.url+'pixel.gif" class="elrte-protected elrte-iframe" style="width:'+u+"; height:"+f+'">'}).replace(this.vimeoRegExp,function(n,t,r){return r=i.parseAttrs(r),delete r.frameborder,r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,r.type="application/x-shockwave-flash",e({embed:r},"application/x-shockwave-flash")}).replace(/<\/(embed|param)>/gi,"").replace(this.pbRegExp,function(){return'<img src="'+i.url+'pixel.gif" class="elrte-protected elrte-pagebreak">'}),u=n("<div>"+t+"<\/div>"),!this.rte.options.allowTextNodes){var o=this.rte.dom,s=[],r=[];if(n.browser.msie)for(f=0;f<u[0].childNodes.length;f++)s.push(u[0].childNodes[f]);else s=Array.prototype.slice.call(u[0].childNodes);function h(){r.length&&o.filter(r,"notEmpty").length&&o.wrap(r,document.createElement("p")),r=[]}n.each(s,function(n,t){o.is(t,"block")?h():(r.length&&t.previousSibling!=r[r.length-1]&&h(),r.push(t))}),h()}return u.html()},restore:function(t){var i=this,r=this.rte.options.restore||[];return r.length&&n.each(r,function(n,r){typeof r=="function"&&(t=r.call(i,t))}),t=t.replace(/\<\!--\[CDATA\[([\s\S]*?)\]\]--\>/gi,"<![CDATA[$1]\]>").replace(/\<\!--\s*ELRTE_SCRIPT\:\s*(script\d+)\s*--\>/gi,function(n,t){return i.scripts[t]&&(n=i.scripts[t],delete i.scripts[t]),n||""}).replace(/\<\!-- ELRTE_COMMENT([\s\S]*?) --\>/gi,"$1").replace(this.serviceClassRegExp,function(t,r,u,f){var u=i.parseAttrs(u),e,o="",t;return u["class"]["elrte-google-maps"]?(t="",i.scripts[u.id]&&(t=i.scripts[u.id],delete i.scripts[u.id]),t):u["class"]["elrte-iframe"]?i.scripts[u.id]||"":u["class"].elrtebm?"":u["class"]["elrte-media"]?(e=i.scripts[u.rel]||{},e.params&&n.each(e.params,function(n,t){o+="<param "+i.serializeAttrs(t)+">\n"}),e.embed&&(o+="<embed "+i.serializeAttrs(e.embed)+">"),e.obj&&(o="<object "+i.serializeAttrs(e.obj)+">\n"+o+"\n<\/object>\n"),o||t):u["class"]["elrte-pagebreak"]?"<!-- pagebreak -->":(n.each(u["class"],function(n){/^elrte-\w+/i.test(n)&&delete u["class"][n]}),"<"+r+" "+i.serializeAttrs(u)+">"+(f||""))})},compactStyles:function(n){var t=this;return n.replace(this.tagRegExp,function(n,i,r,u){return u=!i&&u?t.serializeAttrs(t.parseAttrs(u),!0):"","<"+i+r.toLowerCase()+(u?" ":"")+u+">"})},xhtmlTags:function(n){return this.xhtml?n.replace(/<(img|hr|br|embed|param|link|area)([^>]*\/*)>/gi,"<$1$2 />"):n}},elRTE.prototype.filter.prototype.chains={wysiwyg:["replace","clean","allowedTags","deniedTags","compactStyles"],source:["clean","allowedTags","restore","compactStyles","xhtmlTags"],paste:["clean","allowedTags","cleanPaste","replace","deniedTags","compactStyles"],wysiwyg2wysiwyg:["clean","allowedTags","restore","replace","deniedTags","compactStyles"],source2source:["clean","allowedTags","replace","deniedTags","restore","compactStyles","xhtmlTags"]}}(jQuery),function(n){elRTE.prototype.history=function(t){this.rte=t,this._prev=[],this._next=[],this.add=function(){this.rte.options.historyLength>0&&this._prev.length>=this.rte.options.historyLength&&this._prev.slice(this.rte.options.historyLength);var t=this.rte.selection.getBookmark();this._prev.push([n(this.rte.doc.body).html(),t]),this.rte.selection.moveToBookmark(t),this._next=[]},this.back=function(){if(this._prev.length){var i=this.rte.selection.getBookmark(),t=this._prev.pop();this._next.push([n(this.rte.doc.body).html(),i]),n(this.rte.doc.body).html(t[0]),this.rte.selection.moveToBookmark(t[1])}},this.fwd=function(){if(this._next.length){var i=this.rte.selection.getBookmark(),t=this._next.pop();this._prev.push([n(this.rte.doc.body).html(),i]),n(this.rte.doc.body).html(t[0]),this.rte.selection.moveToBookmark(t[1])}},this.canBack=function(){return this._prev.length},this.canFwd=function(){return this._next.length}}}(jQuery),function(){elRTE.prototype.options={doctype:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">',cssClass:"el-rte",cssfiles:[],height:null,resizable:!0,lang:"en",toolbar:"normal",absoluteURLs:!0,allowSource:!0,stripWhiteSpace:!0,styleWithCSS:!1,fmAllow:!0,fmOpen:null,allowTags:[],denyTags:["applet","base","basefont","bgsound","blink","body","col","colgroup","isindex","frameset","html","head","meta","marquee","noframes","noembed","o:p","title","xml"],denyAttr:[],pasteDenyAttr:["id","name","class","style","language","onclick","ondblclick","onhover","onkeup","onkeydown","onkeypress"],allowTextNodes:!0,allowBrowsersSpecStyles:!1,allowPaste:!0,pasteOnlyText:!1,replace:[],restore:[],pagebreak:'<div style="page-break-after: always;"><\/div>',buttons:{save:"Save",copy:"Copy",cut:"Cut",css:"Css style and class",paste:"Paste",pastetext:"Paste only text",pasteformattext:"Paste formatted text",removeformat:"Clean format",undo:"Undo last action",redo:"Redo previous action",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyleft:"Align left",justifyright:"Ailgn right",justifycenter:"Align center",justifyfull:"Align full",indent:"Indent",outdent:"Outdent",rtl:"Right to left",ltr:"Left to right",forecolor:"Font color",hilitecolor:"Background color",formatblock:"Format",fontsize:"Font size",fontname:"Font",insertorderedlist:"Ordered list",insertunorderedlist:"Unordered list",horizontalrule:"Horizontal rule",blockquote:"Blockquote",div:"Block element (DIV)",link:"Link",unlink:"Delete link",anchor:"Bookmark",image:"Image",pagebreak:"Page break",smiley:"Smiley",flash:"Flash",table:"Table",tablerm:"Delete table",tableprops:"Table properties",tbcellprops:"Table cell properties",tbrowbefore:"Insert row before",tbrowafter:"Insert row after",tbrowrm:"Delete row",tbcolbefore:"Insert column before",tbcolafter:"Insert column after",tbcolrm:"Delete column",tbcellsmerge:"Merge table cells",tbcellsplit:"Split table cell",docstructure:"Toggle display document structure",elfinder:"Open file manager",fullscreen:"Toggle full screen mode",nbsp:"Non breakable space",stopfloat:"Stop element floating",about:"About this software"},panels:{eol:[],save:["save"],copypaste:["copy","cut","paste","pastetext","pasteformattext","removeformat","docstructure"],undoredo:["undo","redo"],style:["bold","italic","underline","strikethrough","subscript","superscript"],colors:["forecolor","hilitecolor"],alignment:["justifyleft","justifycenter","justifyright","justifyfull"],indent:["outdent","indent"],format:["formatblock","fontsize","fontname"],lists:["insertorderedlist","insertunorderedlist"],elements:["horizontalrule","blockquote","div","stopfloat","css","nbsp","smiley","pagebreak"],direction:["ltr","rtl"],links:["link","unlink","anchor"],images:["image"],media:["image","flash"],tables:["table","tableprops","tablerm","tbrowbefore","tbrowafter","tbrowrm","tbcolbefore","tbcolafter","tbcolrm","tbcellprops","tbcellsmerge","tbcellsplit"],elfinder:["elfinder"],fullscreen:["fullscreen","about"]},toolbars:{tiny:["style"],compact:["save","undoredo","style","alignment","lists","links","fullscreen"],normal:["save","copypaste","undoredo","style","alignment","colors","indent","lists","links","elements","images","fullscreen"],complete:["save","copypaste","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","fullscreen"],maxi:["save","copypaste","undoredo","elfinder","style","alignment","direction","colors","format","indent","lists","links","elements","media","tables","fullscreen"],eldorado:["save","copypaste","elfinder","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"]},panelNames:{save:"Save",copypaste:"Copy/Pase",undoredo:"Undo/Redo",style:"Text styles",colors:"Colors",alignment:"Alignment",indent:"Indent/Outdent",format:"Text format",lists:"Lists",elements:"Misc elements",direction:"Script direction",links:"Links",images:"Images",media:"Media",tables:"Tables",elfinder:"File manager (elFinder)"}}}(jQuery),function(n){elRTE.prototype.selection=function(t){function u(){return i.rte.window.getSelection?i.rte.window.getSelection():i.rte.window.document.selection}function s(n,t,r){while(n.nodeName!="BODY"&&n.parentNode&&n.parentNode.nodeName!="BODY"&&(t?n!==t&&n.parentNode!=t:1)&&(r=="left"&&i.rte.dom.isFirstNotEmpty(n)||r=="right"&&i.rte.dom.isLastNotEmpty(n)||i.rte.dom.isFirstNotEmpty(n)&&i.rte.dom.isLastNotEmpty(n)))n=n.parentNode;return n}var i,f,r,e,o;this.rte=t,i=this,this.w3cRange=null,n(this.rte.doc).keyup(function(n){(n.ctrlKey||n.metaKey||n.keyCode>=8&&n.keyCode<=13||n.keyCode>=32&&n.keyCode<=40||n.keyCode==46||n.keyCode>=96&&n.keyCode<=111)&&i.cleanCache()}).mousedown(function(n){f=n.target.nodeName=="HTML"?i.rte.doc.body:n.target,r=e=null}).mouseup(function(n){r=n.target.nodeName=="HTML"?i.rte.doc.body:n.target,r=n.target,e=null}).click(),this.collapsed=function(){return this.getRangeAt().isCollapsed()},this.collapse=function(t){var i=u(),r=this.getRangeAt();return r.collapse(t?!0:!1),n.browser.msie||(i.removeAllRanges(),i.addRange(r)),this},this.getRangeAt=function(n){if(this.rte.browser.msie)return this.w3cRange||(this.w3cRange=new this.rte.w3cRange(this.rte)),n&&this.w3cRange.update(),this.w3cRange;var i=u(),t=i.rangeCount>0?i.getRangeAt(0):this.rte.doc.createRange();return t.getStart=function(){return this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(this.startOffset,this.startContainer.childNodes.length-1)]:this.startContainer},t.getEnd=function(){return this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(this.startOffset==this.endOffset?this.endOffset:this.endOffset-1,this.endContainer.childNodes.length-1)]:this.endContainer},t.isCollapsed=function(){return this.collapsed},t},this.saveIERange=function(){n.browser.msie&&(o=this.getRangeAt().getBookmark())},this.restoreIERange=function(){n.browser.msie&&o&&this.getRangeAt().moveToBookmark(o)},this.cloneContents=function(){var i=this.rte.dom.create("div"),r,u,t;if(n.browser.msie){try{r=this.rte.window.document.selection.createRange()}catch(f){r=this.rte.doc.body.createTextRange()}n(i).html(r.htmlText)}else for(u=this.getRangeAt().cloneContents(),t=0;t<u.childNodes.length;t++)i.appendChild(u.childNodes[t].cloneNode(!0));return i},this.select=function(n,t){var r,i;if(t=t||n,this.rte.browser.msie){var i=this.rte.doc.body.createTextRange(),f=i.duplicate(),e=i.duplicate();f.moveToElementText(n),e.moveToElementText(t),i.setEndPoint("StartToStart",f),i.setEndPoint("EndToEnd",e),i.select()}else r=u(),i=this.getRangeAt(),i.setStartBefore(n),i.setEndAfter(t),r.removeAllRanges(),r.addRange(i);return this.cleanCache()},this.selectContents=function(n){var t=this.getRangeAt(),i;if(n&&n.nodeType==1)if(this.rte.browser.msie)t.range(),t.r.moveToElementText(n.parentNode),t.r.select();else{try{t.selectNodeContents(n)}catch(r){return this.rte.log("unable select node contents "+n)}i=u(),i.removeAllRanges(),i.addRange(t)}return this},this.deleteContents=function(){return n.browser.msie||this.getRangeAt().deleteContents(),this},this.insertNode=function(t,i){var e,r,f;return i&&!this.collapsed()&&this.collapse(),this.rte.browser.msie?(e=t.nodeType==3?t.nodeValue:n(this.rte.dom.create("span")).append(n(t)).html(),r=this.getRangeAt(),r.insertNode(e)):(r=this.getRangeAt(),r.insertNode(t),r.setStartAfter(t),r.setEndAfter(t),f=u(),f.removeAllRanges(),f.addRange(r)),this.cleanCache()},this.insertHtml=function(t,i){if(i&&!this.collapsed()&&this.collapse(),this.rte.browser.msie)this.getRangeAt().range().pasteHTML(t);else{var r=n(this.rte.dom.create("span")).html(t||"").get(0);this.insertNode(r),n(r).replaceWith(n(r).html())}return this.cleanCache()},this.insertText=function(n){var t=this.rte.doc.createTextNode(n);return this.insertHtml(t.nodeValue)},this.getBookmark=function(){var i,r,o,s,f,e,c,h,t;if(this.rte.window.focus(),f=this.rte.dom.createBookmark(),e=this.rte.dom.createBookmark(),n.browser.msie){try{t=this.rte.window.document.selection.createRange()}catch(e){t=this.rte.doc.body.createTextRange()}t.item&&(c=t.item(0),t=this.rte.doc.body.createTextRange(),t.moveToElementText(c)),i=t.duplicate(),r=t.duplicate(),o=this.rte.dom.create("span"),s=this.rte.dom.create("span"),o.appendChild(f),s.appendChild(e),i.collapse(!0),i.pasteHTML(o.innerHTML),r.collapse(!1),r.pasteHTML(s.innerHTML)}else h=u(),t=h.rangeCount>0?h.getRangeAt(0):this.rte.doc.createRange(),i=t.cloneRange(),r=t.cloneRange(),r.collapse(!1),r.insertNode(e),i.collapse(!0),i.insertNode(f),this.select(f,e);return[f.id,e.id]},this.moveToBookmark=function(t){if(this.rte.window.focus(),t&&t.length==2){var i=this.rte.doc.getElementById(t[0]),r=this.rte.doc.getElementById(t[1]),f,e;i&&r&&(this.select(i,r),this.rte.dom.next(i)==r&&this.collapse(!0),n.browser.msie||(f=u(),e=f.rangeCount>0?f.getRangeAt(0):this.rte.doc.createRange(),f.removeAllRanges(),f.addRange(e)),i.parentNode.removeChild(i),r.parentNode.removeChild(r))}return this},this.removeBookmark=function(n){if(this.rte.window.focus(),n.length==2){var t=this.rte.doc.getElementById(n[0]),i=this.rte.doc.getElementById(n[1]);t&&i&&(t.parentNode.removeChild(t),i.parentNode.removeChild(i))}},this.cleanCache=function(){return f=r=e=null,this},this.getStart=function(){if(!f){var n=this.getRangeAt();f=n.getStart()}return f},this.getEnd=function(){if(!r){var n=this.getRangeAt();r=n.getEnd()}return r},this.getNode=function(){return e||(e=this.rte.dom.findCommonAncestor(this.getStart(),this.getEnd())),e},this.selected=function(t){function a(){function t(){for(var t=0;t<o.length;t++)if(o[t].nodeType==1&&(i.rte.dom.selfOrParent(o[t],/^P$/)||n(o[t]).find("p").length>0))return!1;return!0}if(o.length>0){var r=u.tag=="p"&&!t()?"div":u.tag,e=i.rte.dom.wrap(o,r);f[h]=e,h=null,o=[]}}function l(t){var e,t,r;if(t.nodeType==1)if(/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(t.nodeName))n(t).find("td,th").each(function(){var t=u.tag=="p"&&n(this).find("p").length>0?"div":u.tag,r=i.rte.dom.wrapContents(this,t);return f.push(r)});else if(/^(CAPTION|TD|TH|LI|DT|DD)$/.test(t.nodeName))return e=u.tag=="p"&&n(t).find("p").length>0?"div":u.tag,t=i.rte.dom.wrapContents(t,e),f.push(t);r=o.length>0?o[o.length-1]:null,r&&r!=i.rte.dom.prev(t)&&a(),o.push(t),h===null&&(h=f.length,f.push("dummy"))}var u={collapsed:!1,blocks:!1,filter:!1,wrap:"text",tag:"span"},c,s,r;if(u=n.extend({},u,t),u.blocks&&(r=this.getNode(),c=null,c=this.rte.dom.selfOrParent(r,"selectionBlock")))return[c];var e=this.selectedRaw(u.collapsed,u.blocks),f=[],o=[],h=null;if(e.nodes.length>0){for(s=0;s<e.nodes.length;s++){r=e.nodes[s],r.nodeType==3&&(s==0||s==e.nodes.length-1)&&n.trim(r.nodeValue).length>0&&(s==0&&e.so>0&&(r=r.splitText(e.so)),s==e.nodes.length-1&&e.eo>0&&r.splitText(s==0&&e.so>0?e.eo-e.so:e.eo));switch(u.wrap){case"text":r.nodeType==1&&r.nodeName=="BR"||r.nodeType==3&&n.trim(r.nodeValue).length>0?l(r):r.nodeType==1&&f.push(r);break;case"inline":this.rte.dom.isInline(r)?l(r):r.nodeType==1&&f.push(r);break;case"all":r.nodeType!=1&&this.rte.dom.isEmpty(r)||l(r);break;default:r.nodeType!=1&&this.rte.dom.isEmpty(r)||f.push(r)}}a()}return f.length&&(this.rte.window.focus(),this.select(f[0],f[f.length-1])),u.filter?this.rte.dom.filter(f,u.filter):f},this.dump=function(n,t,i,r,u){var f=this.getRangeAt();this.rte.log("commonAncestorContainer"),this.rte.log(n||f.commonAncestorContainer),this.rte.log("startContainer"),this.rte.log(t||f.startContainer),this.rte.log("startOffset: "+(r>=0?r:f.startOffset)),this.rte.log("endContainer"),this.rte.log(i||f.endContainer),this.rte.log("endOffset: "+(u>=0?u:f.endOffset))},this.selectedRaw=function(t,r){function b(t,i,r){return t.nodeType==3?(r=r>=0?r:t.nodeValue.length,i==0&&r==t.nodeValue.length||n.trim(t.nodeValue).length==n.trim(t.nodeValue.substring(i,r)).length):!0}function k(t,r,u){return t.nodeType==1?i.rte.dom.isEmpty(t):t.nodeType==3?n.trim(t.nodeValue.substring(r||0,u>=0?u:t.nodeValue.length)).length==0:!0}var u={so:null,eo:null,nodes:[]},o=this.getRangeAt(!0),v=o.commonAncestorContainer,f,e,p=!1,w=!1,l,a,h,y,c;if(o.startContainer.nodeType==1?o.startOffset<o.startContainer.childNodes.length?(f=o.startContainer.childNodes[o.startOffset],u.so=f.nodeType==1?null:0):(f=o.startContainer.childNodes[o.startOffset-1],u.so=f.nodeType==1?null:f.nodeValue.length):(f=o.startContainer,u.so=o.startOffset),o.collapsed)return t&&(r?(f=s(f),(!this.rte.dom.isEmpty(f)||(f=this.rte.dom.next(f)))&&(u.nodes=[f]),this.rte.dom.isInline(f)&&(u.nodes=this.rte.dom.toLineStart(f).concat(u.nodes,this.rte.dom.toLineEnd(f))),u.nodes.length>0&&(u.so=u.nodes[0].nodeType==1?null:0,u.eo=u.nodes[u.nodes.length-1].nodeType==1?null:u.nodes[u.nodes.length-1].nodeValue.length)):this.rte.dom.isEmpty(f)||(u.nodes=[f])),u;if(o.endContainer.nodeType==1?(e=o.endContainer.childNodes[o.endOffset-1],u.eo=e.nodeType==1?null:e.nodeValue.length):(e=o.endContainer,u.eo=o.endOffset),(f.nodeType==1||r||b(f,u.so,f.nodeValue.length))&&(f=s(f,v,"left"),p=!0,u.so=f.nodeType==1?null:0),(e.nodeType==1||r||b(e,0,u.eo))&&(e=s(e,v,"right"),w=!0,u.eo=e.nodeType==1?null:e.nodeValue.length),r&&(f.nodeType!=1&&f.parentNode!=v&&f.parentNode.nodeName!="BODY"&&(f=f.parentNode,u.so=null),e.nodeType!=1&&e.parentNode!=v&&e.parentNode.nodeName!="BODY"&&(e=e.parentNode,u.eo=null)),f.parentNode==e.parentNode&&f.parentNode.nodeName!="BODY"&&p&&this.rte.dom.isFirstNotEmpty(f)&&w&&this.rte.dom.isLastNotEmpty(e)&&(f=e=f.parentNode,u.so=f.nodeType==1?null:0,u.eo=e.nodeType==1?null:e.nodeValue.length),f==e)return this.rte.dom.isEmpty(f)||u.nodes.push(f),u;for(l=f;l.nodeName!="BODY"&&l.parentNode!==v&&l.parentNode.nodeName!="BODY";)l=l.parentNode;for(a=e;a.nodeName!="BODY"&&a.parentNode!==v&&a.parentNode.nodeName!="BODY";)a=a.parentNode;for(k(f,u.so,f.nodeType==3?f.nodeValue.length:null)||u.nodes.push(f),h=f;h!==l;){for(c=h;c=this.rte.dom.next(c);)u.nodes.push(c);h=h.parentNode}for(h=l;(h=this.rte.dom.next(h))&&h!=a;)u.nodes.push(h);for(y=[],h=e;h!==a;){for(c=h;c=this.rte.dom.prev(c);)y.push(c);h=h.parentNode}return y.length&&(u.nodes=u.nodes.concat(y.reverse())),k(e,0,e.nodeType==3?u.eo:null)||u.nodes.push(e),r&&(this.rte.dom.isInline(f)&&(u.nodes=this.rte.dom.toLineStart(f).concat(u.nodes),u.so=u.nodes[0].nodeType==1?null:0),this.rte.dom.isInline(e)&&(u.nodes=u.nodes.concat(this.rte.dom.toLineEnd(e)),u.eo=u.nodes[u.nodes.length-1].nodeType==1?null:u.nodes[u.nodes.length-1].nodeValue.length)),u}}}(jQuery),function(n){elRTE.prototype.ui=function(t){this.rte=t,this._buttons=[];var l=this,f=this.rte.options.toolbars[t.options.toolbar&&t.options.toolbars[t.options.toolbar]?t.options.toolbar:"normal"],r=f.length,e,i,o,s,h,c,u;for(u in this.buttons)this.buttons.hasOwnProperty(u)&&u!="button"&&(this.buttons[u].prototype=this.buttons.button.prototype);while(r--){if(first=r==0?!0:!1,f[r-1]=="eol"&&(first=!0),i=f[r],i=="eol"){n(this.rte.doc.createElement("br")).prependTo(this.rte.toolbar);continue}for(e=n('<ul class="panel-'+i+(first?" first":"")+'" />').prependTo(this.rte.toolbar),e.bind("mousedown",function(n){n.preventDefault()}),o=this.rte.options.panels[i].length;o--;)s=this.rte.options.panels[i][o],h=this.buttons[s]||this.buttons.button,this._buttons.push(c=new h(this.rte,s)),e.prepend(c.domElem)}this.update(),this.disable=function(){n.each(l._buttons,function(){this.active||this.domElem.addClass("disabled")})}},elRTE.prototype.ui.prototype.update=function(t){function s(t){var i=t.nodeName.toLowerCase();return t=n(t),i=="img"&&(t.hasClass("elrte-media")?i="media":t.hasClass("elrte-google-maps")?i="google map":t.hasClass("elrte-yandex-maps")?i="yandex map":t.hasClass("elrte-pagebreak")&&(i="pagebreak")),i}t&&this.rte.selection.cleanCache();var i=this.rte.selection.getNode(),r=this.rte.dom.parents(i,"*"),f=this.rte.rtl,o=f?" &laquo; ":" &raquo; ",e="",u;for(i&&i.nodeType==1&&i.nodeName!="BODY"&&r.unshift(i),f||(r=r.reverse()),u=0;u<r.length;u++)e+=(u>0?o:"")+s(r[u]);this.rte.statusbar.html(e),n.each(this._buttons,function(){this.update()}),this.rte.window.focus()},elRTE.prototype.ui.prototype.buttons={button:function(t,i){var r=this;this.rte=t,this.active=!1,this.name=i,this.val=null,this.domElem=n('<li style="-moz-user-select:-moz-none" class="'+i+' rounded-3" name="'+i+'" title="'+this.rte.i18n(this.rte.options.buttons[i]||i)+'" unselectable="on" />').hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault(),n(this).hasClass("disabled")||r.command(),r.rte.window.focus()})}},elRTE.prototype.ui.prototype.buttons.button.prototype.command=function(){this.rte.history.add();try{this.rte.doc.execCommand(this.name,!1,this.val)}catch(n){return this.rte.log("commands failed: "+this.name)}this.rte.ui.update(!0)},elRTE.prototype.ui.prototype.buttons.button.prototype.update=function(){try{if(this.rte.doc.queryCommandEnabled(this.name))this.domElem.removeClass("disabled");else return this.domElem.addClass("disabled")}catch(n){return}try{this.rte.doc.queryCommandState(this.name)?this.domElem.addClass("active"):this.domElem.removeClass("active")}catch(n){}}}(jQuery),function(n){elRTE.prototype.utils=function(t){this.rte=t,this.url=null,this.reg=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,this.baseURL="",this.path="",this.entities={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},this.entitiesRegExp=/[<>&\"]/g,this.media=[{type:"application/x-shockwave-flash",classid:["clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"},{type:"application/x-director",classid:["clsid:166b1bca-3f9c-11cf-8075-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0"},{type:"application/x-mplayer2",classid:["clsid:6bf52a52-394a-11d3-b153-00c04f79faa6","clsid:22d6f312-b0f6-11d0-94ab-0080c74c7e95","clsid:05589fa1-c356-11ce-bf01-00aa0055595a"],codebase:"http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"},{type:"video/quicktime",classid:["clsid:02bf25d5-8c17-4b23-bc80-d3488abddc6b"],codebase:"http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"},{type:"audio/x-pn-realaudio-plugin",classid:["clsid:cfcdaa03-8be4-11cf-b84b-0020afbbccfa"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"}],this.rgbRegExp=/\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*/i,this.colorsRegExp=/aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\s*\([^\)]+\)/i,this.colors={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#fffffff",yellow:"#ffff00"};var i=this;this.rgb2hex=function(n){return this.color2Hex(""+n)},this.toPixels=function(t){var r=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/),i;if(r&&(t=r[1],unit=r[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t),isNaN(t))return"";i=parseInt(n(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*i);case"pt":return parseInt(t*i/12);case"%":return parseInt(t*i/100)}return t},this.absoluteURL=function(t){if(this.url||this._url(),t=n.trim(t),!t)return"";if(t[0]=="#")return t;var i=this.parseURL(t);return!i.host&&!i.path&&!i.anchor?"":this.rte.options.absoluteURLs?i.protocol?t:i.host&&(i.host.indexOf(".")!=-1||i.host=="localhost")?this.url.protocol+"://"+t:(t[0]=="/"?t=this.baseURL+t:(t.indexOf("./")==0&&(t=t.substring(2)),t=this.baseURL+this.path+t),t):t},this.parseURL=function(t){var r=t.match(this.reg),i={};return n.each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(n){i[this]=r[n]}),i.host.match(/[a-z0-9]/i)||(i.host=""),i},this.trimEventCallback=function(t){return t=t?t.toString():"",n.trim(t.replace(/\r*\n/mg,"").replace(/^function\s*on[a-z]+\s*\(\s*event\s*\)\s*\{(.+)\}$/igm,"$1"))},this._url=function(){this.url=this.parseURL(window.location.href),this.baseURL=this.url.protocol+"://"+(this.url.userInfo?parts.userInfo+"@":"")+this.url.host+(this.url.port?":"+this.url.port:""),this.path=this.url.file?this.url.path.substring(0,this.url.path.length-this.url.file.length):this.url.path},this.makeObject=function(t){var i={};return n.each(t,function(n,t){i[t]=t}),i},this.encode=function(n){var t=this.entities;return(""+n).replace(this.entitiesRegExp,function(n){return t[n]})},this.decode=function(t){return n("<div/>").html(t||"").text()},this.parseStyle=function(t){var f={},e=this.rte.options.allowBrowsersSpecStyles,i,r,u;return typeof t=="string"&&t.length&&n.each(t.replace(/&quot;/gi,"'").split(";"),function(t,o){(u=o.indexOf(":"))!==-1&&(i=n.trim(o.substr(0,u)),r=n.trim(o.substr(u+1)),(i=="color"||i=="background-color")&&(r=r.toLowerCase()),i&&r&&(e||i.substring(0,1)!="-")&&(f[i]=r))}),f},this.compactStyle=function(t){var i=this;return t.border=="medium none"&&delete t.border,n.each(t,function(n,r){/color$/i.test(n)?t[n]=i.color2Hex(r):/^(border|background)$/i.test(n)&&(t[n]=r.replace(i.colorsRegExp,function(n){return i.color2Hex(n)}))}),t["border-width"]&&(t.border=t["border-width"]+" "+(t["border-style"]||"solid")+" "+(t["border-color"]||"#000"),delete t["border-width"],delete t["border-style"],delete t["border-color"]),t["background-image"]&&(t.background=t["background-color"]+" "||""+t["background-image"]+" "+t["background-position"]||"0 0 "+t["background-repeat"]||"repeat",delete t["background-image"],delete["background-image"],delete["background-position"],delete["background-repeat"]),t["margin-top"]&&t["margin-right"]&&t["margin-bottom"]&&t["margin-left"]&&(t.margin=t["margin-top"]+" "+t["margin-right"]+" "+t["margin-bottom"]+" "+t["margin-left"],delete t["margin-top"],delete t["margin-right"],delete t["margin-bottom"],delete t["margin-left"]),t["padding-top"]&&t["padding-right"]&&t["padding-bottom"]&&t["padding-left"]&&(t.padding=t["padding-top"]+" "+t["padding-right"]+" "+t["padding-bottom"]+" "+t["padding-left"],delete t["padding-top"],delete t["padding-right"],delete t["padding-bottom"],delete t["padding-left"]),(t["list-style-type"]||t["list-style-position"]||t["list-style-image"])&&(t["list-style"]=n.trim(t["list-style-type"]||" "+t["list-style-position"]||""+t["list-style-image"]||""),delete t["list-style-type"],delete t["list-style-position"],delete t["list-style-image"]),t},this.serializeStyle=function(t,i){var r=[];return n.each(i?this.compactStyle(t):t,function(n,t){t&&r.push(n+":"+t)}),r.join(";")},this.parseClass=function(t){return t=n.trim(t),t.length?this.makeObject(t.split(/\s+/)):{}},this.serializeClass=function(t){var i=[],r=this.rte;return n.each(t,function(n){i.push(n)}),i.join(" ")},this.mediaInfo=function(t,i){for(var r=this.media.length;r--;)if(t===this.media[r].type||i&&n.inArray(i,this.media[r].classid)!=-1)return this.media[r]},this.color2Hex=function(n){function i(n){return n=parseInt(n).toString(16),n.length>1?n:"0"+n}var t;return(n=n||"",n.indexOf("#")===0)?n:this.colors[n]?this.colors[n]:(t=n.match(this.rgbRegExp))?"#"+i(t[1])+i(t[2])+i(t[3]):""}}}(jQuery),function(){elRTE.prototype.w3cRange=function(n){var t=this;this.rte=n,this.r=null,this.collapsed=!0,this.startContainer=null,this.endContainer=null,this.startOffset=0,this.endOffset=0,this.commonAncestorContainer=null,this.range=function(){try{this.r=this.rte.window.document.selection.createRange()}catch(n){this.r=this.rte.doc.body.createTextRange()}return this.r},this.insertNode=function(n){this.range(),t.r.collapse(!1);var i=t.r.duplicate();i.pasteHTML(n)},this.getBookmark=function(){if(this.range(),this.r.item){var n=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(n)}return this.r.getBookmark()},this.moveToBookmark=function(n){this.rte.window.focus(),this.range().moveToBookmark(n),this.r.select()},this.update=function(){function u(n){var s="﻿",e=offset=0,u=t.r.duplicate(),i,r,f,o;if(u.collapse(n),i=u.parentElement(),!i||i.nodeName=="HTML")return{parent:t.rte.doc.body,ndx:e,offset:offset};for(u.pasteHTML(s),childs=i.childNodes,r=0;r<childs.length;r++)if(f=childs[r],r>0&&(f.nodeType!==3||childs[r-1].nodeType!==3)&&e++,f.nodeType!==3)offset=0;else{if(o=f.nodeValue.indexOf(s),o!==-1){offset+=o;break}offset+=f.nodeValue.length}return u.moveStart("character",-1),u.text="",{parent:i,ndx:Math.min(e,i.childNodes.length-1),offset:offset}}var r,n,i;return this.range(),this.startContainer=this.endContainer=null,this.r.item?(this.collapsed=!1,r=this.r.item(0),this.setStart(r.parentNode,this.rte.dom.indexOf(r)),this.setEnd(r.parentNode,this.startOffset+1)):(this.collapsed=this.r.boundingWidth==0,n=u(!0),i=u(!1),n.parent.normalize(),i.parent.normalize(),n.ndx=Math.min(n.ndx,n.parent.childNodes.length-1),i.ndx=Math.min(i.ndx,i.parent.childNodes.length-1),n.parent.childNodes[n.ndx].nodeType&&n.parent.childNodes[n.ndx].nodeType==1?this.setStart(n.parent,n.ndx):this.setStart(n.parent.childNodes[n.ndx],n.offset),i.parent.childNodes[i.ndx].nodeType&&i.parent.childNodes[i.ndx].nodeType==1?this.setEnd(i.parent,i.ndx):this.setEnd(i.parent.childNodes[i.ndx],i.offset),this.select()),this},this.isCollapsed=function(){return this.range(),this.collapsed=this.r.item?!1:this.r.boundingWidth==0,this.collapsed},this.collapse=function(n){if(this.range(),this.r.item){var t=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(t)}this.r.collapse(n),this.r.select(),this.collapsed=!0},this.getStart=function(){var t,n;return(this.range(),this.r.item)?this.r.item(0):(t=this.r.duplicate(),t.collapse(!0),n=t.parentElement(),n&&n.nodeName=="BODY"?n.firstChild:n)},this.getEnd=function(){var t,n;return(this.range(),this.r.item)?this.r.item(0):(t=this.r.duplicate(),t.collapse(!1),n=t.parentElement(),n&&n.nodeName=="BODY"?n.lastChild:n)},this.setStart=function(n,t){this.startContainer=n,this.startOffset=t,this.endContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setEnd=function(n,t){this.endContainer=n,this.endOffset=t,this.startContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setStartBefore=function(n){n.parentNode&&this.setStart(n.parentNode,this.rte.dom.indexOf(n))},this.setStartAfter=function(n){n.parentNode&&this.setStart(n.parentNode,this.rte.dom.indexOf(n)+1)},this.setEndBefore=function(n){n.parentNode&&this.setEnd(n.parentNode,this.rte.dom.indexOf(n))},this.setEndAfter=function(n){n.parentNode&&this.setEnd(n.parentNode,this.rte.dom.indexOf(n)+1)},this.select=function(){function f(n,i){var e;if(n.nodeType!=3)return-1;var f="﻿",r=n.nodeValue,u=t.rte.doc.body.createTextRange();return n.nodeValue=r.substring(0,i)+f+r.substring(i),u.moveToElementText(n.parentNode),u.findText(f),e=Math.abs(u.moveStart("character",-1048575)),n.nodeValue=r,e}var o;this.r=this.rte.doc.body.createTextRange();var r=this.startOffset,u=this.endOffset,n=this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(r,this.startContainer.childNodes.length-1)]:this.startContainer,e=this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(r==u?u:u-1,this.endContainer.childNodes.length-1)]:this.endContainer;if(this.collapsed)n.nodeType==3?(o=f(n,r),this.r.move("character",o)):(this.r.moveToElementText(n),this.r.collapse(!0));else{var i=this.rte.doc.body.createTextRange(),s=f(n,r),h=f(e,u);n.nodeType==3?this.r.move("character",s):this.r.moveToElementText(n),e.nodeType==3?i.move("character",h):i.moveToElementText(e),this.r.setEndPoint("EndToEnd",i)}try{this.r.select()}catch(e){}i&&(i=null)},this.dump=function(){this.rte.log("collapsed: "+this.collapsed),this.rte.log("startContainer: "+(this.startContainer?this.startContainer.nodeName:"non")),this.rte.log("startOffset: "+this.startOffset),this.rte.log("endContainer: "+(this.endContainer?this.endContainer.nodeName:"none")),this.rte.log("endOffset: "+this.endOffset)}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.about=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.active=!0,this.command=function(){var r,i,u;r={rtl:t.rtl,submit:function(n,t){t.close()},dialog:{width:560,title:this.rte.i18n("About this software"),buttons:{Ok:function(){n(this).dialog("destroy")}}}},u='<div class="elrte-logo"><\/div><h3>'+this.rte.i18n("About elRTE")+'<\/h3><br clear="all"/><div class="elrte-ver">'+this.rte.i18n("Version")+": "+this.rte.version+" ("+this.rte.build+')<\/div><div class="elrte-ver">jQuery: '+n("<div/>").jquery+'<\/div><div class="elrte-ver">jQueryUI: '+n.ui.version+'<\/div><div class="elrte-ver">'+this.rte.i18n("Licence")+": BSD Licence<\/div><p>"+this.rte.i18n("elRTE is an open-source JavaScript based WYSIWYG HTML-editor.")+"<br/>"+this.rte.i18n("Main goal of the editor - simplify work with text and formating (HTML) on sites, blogs, forums and other online services.")+"<br/>"+this.rte.i18n("You can use it in any commercial or non-commercial projects.")+"<\/p><h4>"+this.rte.i18n("Authors")+'<\/h4><table class="elrte-authors"><tr><td>Dmitry (dio) Levashov &lt;dio@std42.ru&gt;<\/td><td>'+this.rte.i18n("Chief developer")+"<\/td><\/tr><tr><td>Troex Nevelin &lt;troex@fury.scancode.ru&gt;<\/td><td>"+this.rte.i18n("Developer, tech support")+"<\/td><\/tr><tr><td>Valentin Razumnyh &lt;content@std42.ru&gt;<\/td><td>"+this.rte.i18n("Interface designer")+"<\/td><\/tr><tr><td>Tawfek Daghistani &lt;tawfekov@gmail.com&gt;<\/td><td>"+this.rte.i18n("RTL support")+"<\/td><\/tr>"+(this.rte.options.lang!="en"?"<tr><td>"+this.rte.i18n("_translator")+"<\/td><td>"+this.rte.i18n("_translation")+"<\/td><\/tr>":"")+'<\/table><div class="elrte-copy">Copyright &copy; 2009-2011, <a href="http://www.std42.ru">Studio 42<\/a><\/div><div class="elrte-copy">'+this.rte.i18n("For more information about this software visit the")+' <a href="http://elrte.org">'+this.rte.i18n("elRTE website")+'.<\/a><\/div><div class="elrte-copy">Twitter: <a href="http://twitter.com/elrte_elfinder">elrte_elfinder<\/a><\/div>',i=new elDialogForm(r),i.append(u),i.open()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.anchor=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.input=n('<input type="text" />').attr("name","anchor").attr("size","16");var r=this;this.command=function(){var u={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Bookmark")}},i;this.anchor=this.rte.dom.selfOrParentAnchor(this.rte.selection.getEnd())||t.dom.create("a"),this.rte.selection.collapsed()||this.rte.selection.collapse(!1),this.input.val(n(this.anchor).addClass("elrte-anchor").attr("name")),this.rte.selection.saveIERange(),i=new elDialogForm(u),i.append([this.rte.i18n("Bookmark name"),this.input],null,!0).open(),setTimeout(function(){r.input.focus()},20)},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.addClass("disabled"):this.rte.dom.selfOrParentAnchor(n)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.removeClass("disabled").removeClass("active")},this.set=function(){var t=n.trim(this.input.val());t?(this.rte.history.add(),this.anchor.parentNode?(this.anchor.name=t,this.anchor.title=this.rte.i18n("Bookmark")+": "+t):this.rte.selection.insertHtml('<a name="'+t+'" title="'+this.rte.i18n("Bookmark")+": "+t+'" class="elrte-anchor"><\/a>')):this.anchor.parentNode&&(this.rte.history.add(),this.anchor.parentNode.removeChild(this.anchor))}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.blockquote=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i,t;this.rte.history.add(),this.rte.selection.collapsed()&&(i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/))?n(i).replaceWith(n(i).html()):(t=this.rte.selection.selected({wrap:"all",tag:"blockquote"}),t.length&&this.rte.selection.select(t[0],t[t.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.copy=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var t,i,r;if(this.rte.browser.mozilla)try{this.rte.doc.execCommand(this.name,!1,null)}catch(u){t=" Ctl + C",this.name=="cut"?t=" Ctl + X":this.name=="paste"&&(t=" Ctl + V"),i={dialog:{title:this.rte.i18n("Warning"),buttons:{Ok:function(){n(this).dialog("close")}}}},r=new elDialogForm(i),r.append(this.rte.i18n("This operation is disabled in your browser on security reason. Use shortcut instead.")+": "+t).open()}else this.constructor.prototype.command.call(this)}},elRTE.prototype.ui.prototype.buttons.cut=elRTE.prototype.ui.prototype.buttons.copy,elRTE.prototype.ui.prototype.buttons.paste=elRTE.prototype.ui.prototype.buttons.copy}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.css=function(t,i){var r=this;this.constructor.prototype.constructor.call(this,t,i),this.cssStyle=n('<input type="text" size="42" name="style" />'),this.cssClass=n('<input type="text" size="42" name="class" />'),this.elementID=n('<input type="text" size="42" name="id" />'),this.command=function(){var i=this.node(),u,t;this.rte.selection.saveIERange(),i&&(u={submit:function(n,t){n.stopPropagation(),n.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Style"),width:450,resizable:!0,modal:!0}},this.cssStyle.val(n(i).attr("style")),this.cssClass.val(n(i).attr("class")),this.elementID.val(n(i).attr("id")),t=new elDialogForm(u),t.append([this.rte.i18n("Css style"),this.cssStyle],null,!0),t.append([this.rte.i18n("Css class"),this.cssClass],null,!0),t.append([this.rte.i18n("ID"),this.elementID],null,!0),t.open(),setTimeout(function(){r.cssStyle.focus()},20))},this.set=function(){var t=this.node();this.rte.selection.restoreIERange(),t&&(n(t).attr("style",this.cssStyle.val()),n(t).attr("class",this.cssClass.val()),n(t).attr("id",this.elementID.val()),this.rte.ui.update())},this.node=function(){var n=this.rte.selection.getNode();return n.nodeType==3&&(n=n.parentNode),n.nodeType==1&&n.nodeName!="BODY"?n:null},this.update=function(){this.domElem.toggleClass("disabled",this.node()?!1:!0)}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.rtl=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),i=this;n(t).attr("dir")=="rtl"||n(t).parents('[dir="rtl"]').length||n(t).find('[dir="rtl"]').length?(n(t).removeAttr("dir"),n(t).parents('[dir="rtl"]').removeAttr("dir"),n(t).find('[dir="rtl"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?n(t).attr("dir","rtl"):n.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(i.rte.dom.is(r,"block"))return n(r).attr("dir","rtl"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),n(t).attr("dir")=="rtl"||n(t).parents('[dir="rtl"]').length||n(t).find('[dir="rtl"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}},elRTE.prototype.ui.prototype.buttons.ltr=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),i=this;n(t).attr("dir")=="ltr"||n(t).parents('[dir="ltr"]').length||n(t).find('[dir="ltr"]').length?(n(t).removeAttr("dir"),n(t).parents('[dir="ltr"]').removeAttr("dir"),n(t).find('[dir="ltr"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?n(t).attr("dir","ltr"):n.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(i.rte.dom.is(r,"block"))return n(r).attr("dir","ltr"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),n(t).attr("dir")=="ltr"||n(t).parents('[dir="ltr"]').length||n(t).find('[dir="ltr"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.div=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i,t;this.rte.history.add(),this.rte.selection.collapsed()?(i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/),i&&n(i).replaceWith(n(i).html())):(t=this.rte.selection.selected({wrap:"all",tag:"div"}),t.length&&this.rte.selection.select(t[0],t[t.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.docstructure=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){this.domElem.toggleClass("active"),n(this.rte.doc.body).toggleClass("el-rte-structure")},this.command(),this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.elfinder=function(n,t){this.constructor.prototype.constructor.call(this,n,t);var i=this,n=this.rte;this.command=function(){i.rte.options.fmAllow&&typeof i.rte.options.fmOpen=="function"&&i.rte.options.fmOpen(function(t){var i=decodeURIComponent(t.split("/").pop().replace(/\+/g," "));n.selection.collapsed()?n.selection.insertHtml('<a href="'+t+'" >'+i+"<\/a>"):n.doc.execCommand("createLink",!1,t)})},this.update=function(){i.rte.options.fmAllow&&typeof i.rte.options.fmOpen=="function"?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.flash=function(t,r){this.constructor.prototype.constructor.call(this,t,r);var u=this;this.swf=null,this.placeholder=null,this.src={url:n('<input type="text" name="url" />').css("width","99%"),type:n('<select name="type"/>').append('<option value="application/x-shockwave-flash">Flash<\/option>').append('<option value="video/quicktime">Quicktime movie<\/option>').append('<option value="application/x-mplayer2">Windows media<\/option>'),width:n('<input type="text" />').attr("size",5).css("text-align","right"),height:n('<input type="text" />').attr("size",5).css("text-align","right"),wmode:n("<select />").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("transparent").text(this.rte.i18n("Transparent"))),align:n("<select />").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("left").text(this.rte.i18n("Left"))).append(n("<option />").val("right").text(this.rte.i18n("Right"))).append(n("<option />").val("top").text(this.rte.i18n("Top"))).append(n("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(n("<option />").val("middle").text(this.rte.i18n("middle"))).append(n("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(n("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(n("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))),margin:n("<div />")},this.command=function(){var i=this.rte.selection.getEnd(),e="",o="",s="",h,c,v,t,y,a,r,p,w,f;if(this.rte.selection.saveIERange(),this.src.margin.elPaddingInput({type:"margin"}),this.placeholder=null,this.swf=null,n(i).hasClass("elrte-media")&&(v=n(i).attr("rel"))&&this.rte.filter.scripts[v]){if(this.placeholder=n(i),t=this.rte.filter.scripts[v],e="",t.embed&&t.embed.src&&(e=t.embed.src),t.params&&t.params.length)for(l=t.params.length;l--;)(t.params[l].name=="src"||t.params[l].name=="movie")&&(e=t.params[l].value);t.embed?(o=t.embed.width||parseInt(t.embed.style.width)||"",s=t.embed.height||parseInt(t.embed.style.height)||"",y=t.embed.wmode||""):t.obj&&(o=t.obj.width||parseInt(t.obj.style.width)||"",s=t.obj.height||parseInt(t.obj.style.height)||"",y=t.obj.wmode||""),t.obj?(h=t.obj.style.float||"",c=t.obj.style["vertical-align"]||""):t.embed&&(h=t.embed.style.float||"",c=t.embed.style["vertical-align"]||""),this.src.margin.val(i),this.src.type.val(t.embed?t.embed.type:"")}n(i).hasClass("elrte-swf-placeholder")&&(this.placeholder=n(i),e=n(i).attr("rel"),o=parseInt(n(i).css("width"))||"",s=parseInt(n(i).css("height"))||"",h=n(i).css("float"),c=n(i).css("vertical-align"),this.src.margin.val(i),this.src.wmode.val(n(i).attr("wmode"))),this.src.url.val(e),this.src.width.val(o),this.src.height.val(s),this.src.align.val(h||c),this.src.wmode.val(y),a={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),u.set(),t.close()},dialog:{width:580,position:"top",title:this.rte.i18n("Flash")}},r=new elDialogForm(a),p=this.rte.options.fmAllow&&this.rte.options.fmOpen?n("<span />").append(this.src.url.css("width","85%")).append(n("<span />").addClass("ui-state-default ui-corner-all").css({float:"right","margin-right":"3px"}).attr("title",u.rte.i18n("Open file manger")).append(n("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){u.rte.options.fmOpen(function(n){u.src.url.val(n).change()})}).hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")})):this.src.url,r.append([this.rte.i18n("URL"),p],null,!0),r.append([this.rte.i18n("Type"),this.src.type],null,!0),r.append([this.rte.i18n("Size"),n("<span />").append(this.src.width).append(" x ").append(this.src.height).append(" px")],null,!0),r.append([this.rte.i18n("Wmode"),this.src.wmode],null,!0),r.append([this.rte.i18n("Alignment"),this.src.align],null,!0),r.append([this.rte.i18n("Margins"),this.src.margin],null,!0),r.open(),w=n("<fieldset />").append(n("<legend />").text(this.rte.i18n("Preview"))),r.append(w,"main"),f=document.createElement("iframe"),n(f).attr("src","#").addClass("el-rte-preview").appendTo(w),html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><\/head><body style="padding:0;margin:0;font-size:9px"> Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin<\/body><\/html>',f.contentWindow.document.open(),f.contentWindow.document.write(html),f.contentWindow.document.close(),this.frame=f.contentWindow.document,this.preview=n(f.contentWindow.document.body),this.src.type.change(function(){u.src.url.change()}),this.src.width.change(function(){if(u.swf){var t=parseInt(n(this).val())||"";n(this).val(t),u.swf.css("width",t),u.swf.children("embed").css("width",t)}else n(this).val("")}),this.src.height.change(function(){if(u.swf){var t=parseInt(n(this).val())||"";n(this).val(t),u.swf.css("height",t),u.swf.children("embed").css("height",t)}else n(this).val("")}),this.src.wmode.change(function(){if(u.swf){var t=n(this).val();t?(u.swf.attr("wmode",t),u.swf.children("embed").attr("wmode",t)):(u.swf.removeAttr("wmode"),u.swf.children("embed").removeAttr("wmode"))}}),this.src.align.change(function(){var t=n(this).val(),i=t=="left"||t=="right";u.swf?u.swf.css({float:i?t:"","vertical-align":i?"":t}):n(this).val("")}),this.src.margin.change(function(){if(u.swf){var n=u.src.margin.val();n.css?u.swf.css("margin",n.css):(u.swf.css("margin-top",n.top),u.swf.css("margin-right",n.right),u.swf.css("margin-bottom",n.bottom),u.swf.css("margin-left",n.left))}}),this.src.url.change(function(){var i=u.rte.utils.absoluteURL(n(this).val()),t,r;i?(t=u.rte.utils.mediaInfo(u.src.type.val()),t||(t=u.rte.util.mediaInfo("application/x-shockwave-flash")),r='<object classid="'+t.classid+'" codebase="'+t.codebase+'"><param name="src" value="'+i+'" /><embed quality="high" src="'+i+'" type="'+t.type+'"><\/object>',u.preview.children("object").remove().end().prepend(r),u.swf=u.preview.children("object").eq(0)):u.swf&&(u.swf.remove(),u.swf=null),u.src.width.trigger("change"),u.src.height.trigger("change"),u.src.align.trigger("change")}).trigger("change")},this.set=function(){var l,p;u.swf=null;var f=this.rte.utils.absoluteURL(this.src.url.val()),o=parseInt(this.src.width.val())||"",s=parseInt(this.src.height.val())||"",w=this.src.wmode.val(),r=this.src.align.val(),h=r=="left"||r=="right"?r:"",c=this.placeholder?this.placeholder.attr("rel"):"",t,a,v,e=this.src.margin.val(),y;f?(i=u.rte.utils.mediaInfo(u.src.type.val()),i||(i=u.rte.util.mediaInfo("application/x-shockwave-flash")),v=this.rte.filter.videoHostRegExp.test(f)?f.replace(this.rte.filter.videoHostRegExp,"$2"):i.type.replace(/^\w+\/(.+)/,"$1"),t={obj:{classid:i.classid[0],codebase:i.codebase,style:{}},params:[{name:"src",value:f}],embed:{src:f,type:i.type,quality:"high",wmode:w,style:{}}},o&&(t.obj.width=o,t.embed.width=o),s&&(t.obj.height=s,t.embed.height=s),h?t.obj.style.float=h:r&&(t.obj.style["vertical-align"]=r),y=e.css?{margin:e.css}:{"margin-top":e.top,"margin-right":e.right,"margin-bottom":e.bottom,"margin-left":e.left},t.obj.style=n.extend({},t.obj.style,y),this.placeholder&&c?(a=this.rte.filter.scripts[c]||{},t=n.extend(!0,a,t),delete t.obj.style.width,delete t.obj.style.height,delete t.embed.style.width,delete t.embed.style.height,this.rte.filter.scripts[c]=t,this.placeholder.removeAttr("class")):(l="media"+Math.random().toString().substring(2),this.rte.filter.scripts[l]=t,this.placeholder=n(this.rte.dom.create("img")).attr("rel",l).attr("src",this.rte.filter.url+"pixel.gif"),p=!0),this.placeholder.attr("title",this.rte.utils.encode(f)).attr("width",o||150).attr("height",s||100).addClass("elrte-protected elrte-media elrte-media-"+v).css(t.obj.style),h?this.placeholder.css("float",h).css("vertical-align",""):r?this.placeholder.css("float","").css("vertical-align",r):this.placeholder.css("float","").css("vertical-align",""),p&&(this.rte.window.focus(),this.rte.selection.restoreIERange(),this.rte.selection.insertNode(this.placeholder.get(0)))):this.placeholder&&(this.placeholder.remove(),delete this.rte.filter.scripts[c])},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.domElem.toggleClass("active",t&&t.nodeName=="IMG"&&n(t).hasClass("elrte-media"))}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fontname=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var u=this,r={tpl:'<span style="font-family:%val">%label<\/span>',select:function(n){u.set(n)},src:{"":this.rte.i18n("Font"),"andale mono,sans-serif":"Andale Mono","arial,helvetica,sans-serif":"Arial","arial black,gadget,sans-serif":"Arial Black","book antiqua,palatino,sans-serif":"Book Antiqua","comic sans ms,cursive":"Comic Sans MS","courier new,courier,monospace":"Courier New","georgia,palatino,serif":"Georgia","helvetica,sans-serif":"Helvetica","impact,sans-serif":"Impact","lucida console,monaco,monospace":"Lucida console","lucida sans unicode,lucida grande,sans-serif":"Lucida grande","tahoma,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,lucida grande,verdana,sans-serif":"Trebuchet MS","verdana,geneva,sans-serif":"Verdana"}};this.select=this.domElem.elSelect(r),this.command=function(){},this.set=function(t){this.rte.history.add();var i=this.rte.selection.selected({filter:"textContainsNodes"});n.each(i,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?n(this).find("td,th"):n(this),n(this).css("font-family",t).find("[style]").css("font-family","")}),this.rte.ui.update()},this.update=function(){var i,t;this.domElem.removeClass("disabled"),i=this.rte.selection.getNode(),i.nodeType!=1&&(i=i.parentNode),t=n(i).css("font-family"),t=t?t.toString().toLowerCase().replace(/,\s+/g,",").replace(/'|"/g,""):"",this.select.val(r.src[t]?t:"")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fontsize=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this,u={labelTpl:"%label",tpl:'<span style="font-size:%val;line-height:1.2em">%label<\/span>',select:function(n){r.set(n)},src:{"":this.rte.i18n("Font size"),"xx-small":this.rte.i18n("Small (8pt)"),"x-small":this.rte.i18n("Small (10px)"),small:this.rte.i18n("Small (12pt)"),medium:this.rte.i18n("Normal (14pt)"),large:this.rte.i18n("Large (18pt)"),"x-large":this.rte.i18n("Large (24pt)"),"xx-large":this.rte.i18n("Large (36pt)")}};this.select=this.domElem.elSelect(u),this.command=function(){},this.set=function(t){this.rte.history.add();var i=this.rte.selection.selected({filter:"textContainsNodes"});n.each(i,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?n(this).find("td,th"):n(this),$this.css("font-size",t).find("[style]").css("font-size","")}),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var n=this.rte.selection.getNode();this.select.val((m=this.rte.dom.attr(n,"style").match(/font-size:\s*([^;]+)/i))?m[1]:"")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.forecolor=function(t,i){var r=this,u;this.constructor.prototype.constructor.call(this,t,i),u={"class":"",palettePosition:"outer",color:this.defaultColor,update:function(n){r.indicator.css("background-color",n)},change:function(n){r.set(n)}},this.defaultColor=this.name=="forecolor"?"#000000":"#ffffff",this.picker=this.domElem.elColorPicker(u),this.indicator=n("<div />").addClass("color-indicator").prependTo(this.domElem),this.command=function(){},this.set=function(t){if(!this.rte.selection.collapsed()){this.rte.history.add();var r=this.rte.selection.selected({collapse:!1,wrap:"text"}),i=this.name=="forecolor"?"color":"background-color";n.each(r,function(){/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)?n(this).find("td,th").each(function(){n(this).css(i,t).find("*").css(i,"")}):n(this).css(i,t).find("*").css(i,"")}),this.rte.ui.update(!0)}},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.picker.val(this.rte.utils.rgb2hex(n(t.nodeType!=1?t.parentNode:t).css(this.name=="forecolor"?"color":"background-color"))||this.defaultColor)}},elRTE.prototype.ui.prototype.buttons.hilitecolor=elRTE.prototype.ui.prototype.buttons.forecolor}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.formatblock=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var f=this.rte.browser.msie?function(n){r.val=n,r.constructor.prototype.command.call(r)}:function(n){r.ieCommand(n)},r=this,u={labelTpl:"%label",tpls:{"":"%label"},select:function(n){r.formatBlock(n)},src:{span:this.rte.i18n("Format"),h1:this.rte.i18n("Heading 1"),h2:this.rte.i18n("Heading 2"),h3:this.rte.i18n("Heading 3"),h4:this.rte.i18n("Heading 4"),h5:this.rte.i18n("Heading 5"),h6:this.rte.i18n("Heading 6"),p:this.rte.i18n("Paragraph"),address:this.rte.i18n("Address"),pre:this.rte.i18n("Preformatted"),div:this.rte.i18n("Normal (DIV)")}};this.select=this.domElem.elSelect(u),this.command=function(){},this.formatBlock=function(t){function h(t,i){function u(t){return n(t).find("h1,h2,h3,h4,h5,h6,p,address,pre").each(function(){n(this).replaceWith(n(this).html())}),t}/^(LI|DT|DD|TD|TH|CAPTION)$/.test(t.nodeName)?r.rte.dom.isEmpty(t)||r.rte.dom.wrapContents(u(t),i):/^(UL|OL|DL|TABLE)$/.test(t.nodeName)?r.rte.dom.wrap(t,i):r.rte.dom.isEmpty(t)||n(u(t)).replaceWith(n(r.rte.dom.create(i)).html(n(t).html()))}this.rte.history.add();var u=t.toUpperCase(),i,o,a=this.rte.selection.collapsed(),c=this.rte.selection.getBookmark(),f=this.rte.selection.selected({collapsed:!0,blocks:!0,filter:"textContainsNodes",wrap:"inline",tag:"span"});for(l=f.length,s=n(f[0]).prev(),e=n(f[f.length-1]).next();l--;)i=f[l],o=n(i),u=="DIV"||u=="SPAN"?/^(H[1-6]|P|ADDRESS|PRE)$/.test(i.nodeName)&&o.replaceWith(n(this.rte.dom.create("div")).html(o.html()||"")):/^(THEAD|TBODY|TFOOT|TR)$/.test(i.nodeName)?o.find("td,th").each(function(){h(this,u)}):i.nodeName!=u&&h(i,u);this.rte.selection.moveToBookmark(c),this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled");var n=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(H[1-6]|P|ADDRESS|PRE)$/);this.select.val(n?n.nodeName.toLowerCase():"span")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fullscreen=function(t,i){function u(){r.wz.height(n(window).height()-r.delta),r.rte.updateHeight()}var r=this;this.constructor.prototype.constructor.call(this,t,i),this.active=!0,this.editor=t.editor,this.wz=t.workzone,this.height=0,this.delta=0,this._class="el-fullscreen",setTimeout(function(){r.height=r.wz.height(),r.delta=r.editor.outerHeight()-r.height},50),this.command=function(){function v(){c&&(l=h.getBookmark())}function y(){c&&(r.wz.children().toggle(),r.rte.source.focus(),r.wz.children().toggle(),h.moveToBookmark(l))}var i=n(window),t=this.editor,a=t.parents().filter(function(t,i){return!/^(html|body)$/i.test(i.nodeName)&&n(i).css("position")=="relative"}),o=this.wz,f=this._class,e=t.hasClass(f),s=this.rte,h=this.rte.selection,c=n.browser.mozilla,l;v(),a.css("position",e?"relative":"static"),e?(t.removeClass(f),o.height(this.height),i.unbind("resize",u),this.domElem.removeClass("active")):(t.addClass(f).removeAttr("style"),o.height(i.height()-this.delta).css("width","100%"),i.bind("resize",u),this.domElem.addClass("active")),s.updateHeight(),s.resizable(e),y()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.horizontalrule=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src={width:n('<input type="text" />').attr({name:"width",size:4}).css("text-align","right"),wunit:n("<select />").attr("name","wunit").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")).val("%"),height:n('<input type="text" />').attr({name:"height",size:4}).css("text-align","right"),bg:n("<div />"),border:n("<div />"),"class":n('<input type="text" />').css("width","100%"),style:n('<input type="text" />').css("width","100%")},this.command=function(){var i,u,f,e;this.src.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),i=this.rte.selection.getEnd(),this.hr=i.nodeName=="HR"?n(i):n(t.doc.createElement("hr")).css({width:"100%",height:"1px"}),this.src.border.elBorderSelect({styleHeight:73,value:this.hr}),u=this.hr.css("width")||this.hr.attr("width"),this.src.width.val(parseInt(u)||100),this.src.wunit.val(u.indexOf("px")!=-1?"px":"%"),this.src.height.val(this.rte.utils.toPixels(this.hr.css("height")||this.hr.attr("height"))||1),this.src.bg.val(this.rte.utils.color2Hex(this.hr.css("background-color"))),this.src["class"].val(this.rte.dom.attr(this.hr,"class")),this.src.style.val(this.rte.dom.attr(this.hr,"style")),f={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{title:this.rte.i18n("Horizontal rule")}},e=new elDialogForm(f),e.append([this.rte.i18n("Width"),n("<span />").append(this.src.width).append(this.src.wunit)],null,!0).append([this.rte.i18n("Height"),n("<span />").append(this.src.height).append(" px")],null,!0).append([this.rte.i18n("Border"),this.src.border],null,!0).append([this.rte.i18n("Background"),this.src.bg],null,!0).append([this.rte.i18n("Css class"),this.src["class"]],null,!0).append([this.rte.i18n("Css style"),this.src.style],null,!0).open()},this.update=function(){this.domElem.removeClass("disabled"),this.rte.selection.getEnd().nodeName=="HR"?this.domElem.addClass("active"):this.domElem.removeClass("active")},this.set=function(){this.rte.history.add(),this.hr.parentNode||this.rte.selection.insertNode(this.hr.get(0));var t={noshade:!0,style:this.src.style.val()},n=this.src.border.val(),i={width:(parseInt(this.src.width.val())||100)+this.src.wunit.val(),height:parseInt(this.src.height.val())||1,"background-color":this.src.bg.val(),border:n.width&&n.style?n.width+" "+n.style+" "+n.color:""};this.hr.removeAttr("class").removeAttr("style").removeAttr("width").removeAttr("height").removeAttr("align").attr(t).css(i),this.src["class"].val()&&this.hr.attr("class",this.src["class"].val()),this.rte.ui.update()}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.image=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this,t=r.rte,o=0,u=0,f=0,e=null,s=function(t){n.each(r.src,function(i,r){n.each(r,function(n,i){n=="src"&&t||i.val("")})})},h=function(i){n.each(r.src,function(r,u){n.each(u,function(n,u){var f,o,s,e;n=="width"?f=i.width():n=="height"?f=i.height():n=="border"?(f="",e=i.css("border")||t.utils.parseStyle(i.attr("style")).border||"",e&&(o=e.match(/(\d(px|em|%))/),s=e.match(/(#[a-z0-9]+)/),f={width:o?o[1]:e,style:e,color:t.utils.color2Hex(s?s[1]:e)})):n=="margin"?f=i:n=="align"?(f=i.css("float"),f!="left"&&f!="right"&&(f=i.css("vertical-align"))):f=i.attr(n)||"",r=="events"&&(f=t.utils.trimEventCallback(f)),u.val(f)})})},l=function(){var t=r.src.main.src.val();s(!0),t?(r.prevImg?(r.prevImg.removeAttr("src").removeAttr("style").removeAttr("class").removeAttr("id").removeAttr("title").removeAttr("alt").removeAttr("longdesc"),n.each(r.src.events,function(n){r.prevImg.removeAttr(n)})):r.prevImg=n("<img/>").prependTo(r.preview),r.prevImg.load(function(){r.prevImg.unbind("load"),setTimeout(function(){u=r.prevImg.width(),f=r.prevImg.height(),o=(u/f).toFixed(2),r.src.main.width.val(u),r.src.main.height.val(f)},100)}).attr("src",t)):(r.preview.children("img").remove(),r.prevImg=null)},c=function(n){var t=parseInt(r.src.main.width.val())||0,i=parseInt(r.src.main.height.val())||0;r.prevImg&&(t&&i?n.target===r.src.main.width[0]?i=parseInt(t/o):t=parseInt(i*o):(t=u,i=f),r.src.main.height.val(i),r.src.main.width.val(t),r.prevImg.width(t).height(i),r.src.adv.style.val(r.prevImg.attr("style")))};this.img=null,this.prevImg=null,this.preview=n('<div class="elrte-image-preview"/>').text("Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin"),this.init=function(){this.labels={main:"Properies",link:"Link",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",longdesc:"Detail description URL",href:"URL",target:"Open in",title:"Title"},this.src={main:{src:n('<input type="text" />').css("width","100%").change(l),title:n('<input type="text" />').css("width","100%"),alt:n('<input type="text" />').css("width","100%"),width:n('<input type="text" />').attr("size",5).css("text-align","right").change(c),height:n('<input type="text" />').attr("size",5).css("text-align","right").change(c),margin:n("<div />").elPaddingInput({type:"margin",change:function(){var n=r.src.main.margin.val();r.prevImg&&(n.css?r.prevImg.css("margin",n.css):r.prevImg.css({"margin-left":n.left,"margin-top":n.top,"margin-right":n.right,"margin-bottom":n.bottom}))}}),align:n("<select />").css("width","100%").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("left").text(this.rte.i18n("Left"))).append(n("<option />").val("right").text(this.rte.i18n("Right"))).append(n("<option />").val("top").text(this.rte.i18n("Top"))).append(n("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(n("<option />").val("middle").text(this.rte.i18n("middle"))).append(n("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(n("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(n("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))).change(function(){var t=n(this).val(),i={float:"","vertical-align":""};r.prevImg&&(t=="left"||t=="right"?(i.float=t,i["vertical-align"]=""):t&&(i.float="",i["vertical-align"]=t),r.prevImg.css(i))}),border:n("<div />").elBorderSelect({name:"border",change:function(){var n=r.src.main.border.val();r.prevImg&&r.prevImg.css("border",n.width?n.width+" "+n.style+" "+n.color:"")}})},adv:{},events:{}},n.each(["id","class","style","longdesc"],function(t,i){r.src.adv[i]=n('<input type="text" style="width:100%" />')}),this.src.adv["class"].change(function(){r.prevImg&&r.prevImg.attr("class",n(this).val())}),this.src.adv.style.change(function(){r.prevImg&&(r.prevImg.attr("style",n(this).val()),h(r.prevImg))}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text"  style="width:100%"/>')})},this.command=function(){this.src||this.init();var c,v={rtl:t.rtl,submit:function(n){n.stopPropagation(),n.preventDefault(),r.set(),i.close()},close:function(){e&&t.selection.moveToBookmark(e)},dialog:{autoOpen:!1,width:500,position:"top",title:t.i18n("Image"),resizable:!0,open:function(){n.fn.resizable&&n(this).parents(".ui-dialog:first").resizable("option","alsoResize",".elrte-image-preview")}}},i=new elDialogForm(v),l=!!t.options.fmOpen,a=l?n('<div class="elrte-image-src-fm"><span class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-folder-open"/><\/span><\/div>').append(this.src.main.src.css("width","87%")):this.src.main.src;s(),this.preview.children("img").remove(),this.prevImg=null,c=t.selection.getEnd(),this.img=c.nodeName=="IMG"&&!n(c).is(".elrte-protected")?n(c):n("<img/>"),e=t.selection.getBookmark(),l&&a.children(".ui-state-default").click(function(){t.options.fmOpen(function(n){r.src.main.src.val(n).change()})}).hover(function(){n(this).toggleClass("ui-state-hover")}),i.tab("main",this.rte.i18n("Properies")).append([this.rte.i18n("Image URL"),a],"main",!0).append([this.rte.i18n("Title"),this.src.main.title],"main",!0).append([this.rte.i18n("Alt text"),this.src.main.alt],"main",!0).append([this.rte.i18n("Size"),n("<span />").append(this.src.main.width).append(" x ").append(this.src.main.height).append(" px")],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0),i.append(n("<fieldset><legend>"+this.rte.i18n("Preview")+"<\/legend><\/fieldset>").append(this.preview),"main"),n.each(this.src,function(u,f){u!="main"&&(i.tab(u,t.i18n(r.labels[u])),n.each(f,function(n){r.src[u][n].val(u=="events"?t.utils.trimEventCallback(r.img.attr(n)):r.img.attr(n)||""),i.append([t.i18n(r.labels[n]||n),r.src[u][n]],u,!0)}))}),i.open(),this.img.attr("src")&&(h(this.img),this.prevImg=this.img.clone().prependTo(this.preview),o=(this.img.width()/this.img.height()).toFixed(2),u=parseInt(this.img.width()),f=parseInt(this.img.height()))},this.set=function(){var u=this.src.main.src.val(),i;if(this.rte.history.add(),e&&t.selection.moveToBookmark(e),!u)return i=t.dom.selfOrParentLink(this.img[0]),i&&i.remove(),this.img.remove();this.img[0].parentNode||(this.img=n(this.rte.doc.createElement("img"))),this.img.attr("src",u).attr("style",this.src.adv.style.val()),n.each(this.src,function(t,i){n.each(i,function(t,i){var u=i.val();switch(t){case"width":r.img.css("width",u);break;case"height":r.img.css("height",u);break;case"align":r.img.css(u=="left"||u=="right"?"float":"vertical-align",u);break;case"margin":u.css?r.img.css("margin",u.css):r.img.css({"margin-left":u.left,"margin-top":u.top,"margin-right":u.right,"margin-bottom":u.bottom});break;case"border":if(u.width){u="border:"+u.css+";"+n.trim((r.img.attr("style")||"").replace(/border\-[^;]+;?/ig,"")),t="style",r.img.attr("style",u);return}u="";break;case"src":case"style":return;default:u?r.img.attr(t,u):r.img.removeAttr(t)}})}),this.img[0].parentNode||t.selection.insertNode(this.img[0]),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getEnd(),i=n(t);t.nodeName!="IMG"||i.hasClass("elrte-protected")?this.domElem.removeClass("active"):this.domElem.addClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.indent=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){function f(t){var i=/(IMG|HR|TABLE|EMBED|OBJECT)/.test(t.nodeName)?"margin-left":"padding-left",u=r.rte.dom.attr(t,"style").indexOf(i)!=-1?parseInt(n(t).css(i))||0:0;n(t).css(i,u+40+"px")}var i,t,u;for(this.rte.history.add(),i=this.rte.selection.selected({collapsed:!0,blocks:!0,wrap:"inline",tag:"p"}),t=0;t<i.length;t++)/^(TABLE|THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(i[t].nodeName)?n(i[t]).find("td,th").each(function(){f(this)}):/^LI$/.test(i[t].nodeName)?(u=n(i[t]),n(this.rte.dom.create(i[t].parentNode.nodeName)).append(n(this.rte.dom.create("li")).html(u.html()||"")).appendTo(u.html("&nbsp;"))):f(i[t]);this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.justifyleft=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.align=this.name=="justifyfull"?"justify":this.name.replace("justify",""),this.command=function(){var i=this.rte.selection.selected({collapsed:!0,blocks:!0,tag:"div"}),t=i.length;for(t&&this.rte.history.add();t--;)this.rte.dom.filter(i[t],"textNodes")&&n(i[t]).css("text-align",this.align);this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode(),i=t.nodeName=="BODY"?t:this.rte.dom.selfOrParent(t,"textNodes")||(t.parentNode&&t.parentNode.nodeName=="BODY"?t.parentNode:null);i?this.domElem.removeClass("disabled").toggleClass("active",n(i).css("text-align")==this.align):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.justifycenter=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyright=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyfull=elRTE.prototype.ui.prototype.buttons.justifyleft}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.link=function(t,i){function u(){r.labels={id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language",charset:"Charset",type:"Target MIME type",rel:"Relationship page to target (rel)",rev:"Relationship target to page (rev)",tabindex:"Tab index",accesskey:"Access key"},r.src={main:{href:n('<input type="text" />'),title:n('<input type="text" />'),anchor:n("<select />").attr("name","anchor"),target:n("<select />").append(n("<option />").text(r.rte.i18n("In this window")).val("")).append(n("<option />").text(r.rte.i18n("In new window (_blank)")).val("_blank"))},popup:{use:n('<input type="checkbox" />'),url:n('<input type="text" />').val("http://"),name:n('<input type="text" />'),width:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Width")}).css("text-align","right"),height:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Height")}).css("text-align","right"),left:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Left")}).css("text-align","right"),top:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Top")}).css("text-align","right"),location:n('<input type="checkbox" />'),menubar:n('<input type="checkbox" />'),toolbar:n('<input type="checkbox" />'),scrollbars:n('<input type="checkbox" />'),status:n('<input type="checkbox" />'),resizable:n('<input type="checkbox" />'),dependent:n('<input type="checkbox" />'),retfalse:n('<input type="checkbox" />').attr("checked",!0)},adv:{id:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />'),charset:n('<input type="text" />'),type:n('<input type="text" />'),rel:n('<input type="text" />'),rev:n('<input type="text" />'),tabindex:n('<input type="text" />'),accesskey:n('<input type="text" />')},events:{}},n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />')}),n.each(r.src,function(){var n,t;for(n in this)t=this[n].attr("type"),t&&(t!="text"||this[n].attr("size"))||this[n].css("width","100%")})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.img=!1,this.bm,this.command=function(){function c(n){return n.nodeName=="A"&&n.href}var t=this.rte.selection.getNode(),i,f,l,a,v,e,s,h,o;if(this.src||u(),this.bm=this.rte.selection.getBookmark(),this.link=this.rte.dom.selfOrParentLink(t),!this.link&&(i=n.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1}),i.length)){for(f=0;f<i.length;f++)if(c(i[f])){this.link=i[f];break}this.link||(this.link=this.rte.dom.parent(i[0],c)||this.rte.dom.parent(i[i.length-1],c))}this.link=this.link?n(this.link):n(this.rte.doc.createElement("a")),this.img=t.nodeName=="IMG"?t:null,this.updatePopup(),this.src.main.anchor.empty(),n('a[href!=""][name]',this.rte.doc).each(function(){var t=n(this).attr("name");r.src.main.anchor.append(n("<option />").val(t).text(t))}),this.src.main.anchor.children().length&&this.src.main.anchor.prepend(n("<option />").val("").text(this.rte.i18n("Select bookmark"))).change(function(){var t=n(this).val();t&&r.src.main.href.val("#"+t)}),l={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},tabs:{show:function(n,t){t.index==3&&r.updateOnclick()}},close:function(){r.rte.browser.msie&&r.rte.selection.restoreIERange()},dialog:{width:"auto",width:430,title:this.rte.i18n("Link")}},d=new elDialogForm(l),a=n("<div />").append(n("<label />").append(this.src.popup.location).append(this.rte.i18n("Location bar"))).append(n("<label />").append(this.src.popup.menubar).append(this.rte.i18n("Menu bar"))).append(n("<label />").append(this.src.popup.toolbar).append(this.rte.i18n("Toolbar"))).append(n("<label />").append(this.src.popup.scrollbars).append(this.rte.i18n("Scrollbars"))),v=n("<div />").append(n("<label />").append(this.src.popup.status).append(this.rte.i18n("Status bar"))).append(n("<label />").append(this.src.popup.resizable).append(this.rte.i18n("Resizable"))).append(n("<label />").append(this.src.popup.dependent).append(this.rte.i18n("Depedent"))).append(n("<label />").append(this.src.popup.retfalse).append(this.rte.i18n("Add return false"))),d.tab("main",this.rte.i18n("Properies")).tab("popup",this.rte.i18n("Popup")).tab("adv",this.rte.i18n("Advanced")).tab("events",this.rte.i18n("Events")).append(n("<label />").append(this.src.popup.use).append(this.rte.i18n("Open link in popup window")),"popup").separator("popup").append([this.rte.i18n("URL"),this.src.popup.url],"popup",!0).append([this.rte.i18n("Window name"),this.src.popup.name],"popup",!0).append([this.rte.i18n("Window size"),n("<span />").append(this.src.popup.width).append(" x ").append(this.src.popup.height).append(" px")],"popup",!0).append([this.rte.i18n("Window position"),n("<span />").append(this.src.popup.left).append(" x ").append(this.src.popup.top).append(" px")],"popup",!0).separator("popup").append([a,v],"popup",!0),e=this.link.get(0),s=this.rte.dom.attr(e,"href"),this.src.main.href.val(s).change(function(){n(this).val(r.rte.utils.absoluteURL(n(this).val()))}),this.rte.options.fmAllow&&this.rte.options.fmOpen?(h=n("<span />").append(this.src.main.href.css("width","87%")).append(n("<span />").addClass("ui-state-default ui-corner-all").css({float:"right","margin-right":"3px"}).attr("title",r.rte.i18n("Open file manger")).append(n("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){r.rte.options.fmOpen(function(n){r.src.main.href.val(n).change()})}).hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")})),d.append([this.rte.i18n("Link URL"),h],"main",!0)):d.append([this.rte.i18n("Link URL"),this.src.main.href],"main",!0),this.src.main.href.change(),d.append([this.rte.i18n("Title"),this.src.main.title.val(this.rte.dom.attr(e,"title"))],"main",!0),this.src.main.anchor.children().length&&d.append([this.rte.i18n("Bookmark"),this.src.main.anchor.val(s)],"main",!0),this.rte.options.doctype.match(/xhtml/)&&this.rte.options.doctype.match(/strict/)||d.append([this.rte.i18n("Target"),this.src.main.target.val(this.link.attr("target")||"")],"main",!0);for(t in this.src.adv)this.src.adv[t].val(this.rte.dom.attr(e,t)),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.adv[t]],"adv",!0);for(t in this.src.events)o=this.rte.utils.trimEventCallback(this.rte.dom.attr(e,t)),this.src.events[t].val(o),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.events[t]],"events",!0);this.src.popup.use.change(function(){var t=n(this).attr("checked");n.each(r.src.popup,function(){n(this).attr("name")!="use"&&(t?n(this).removeAttr("disabled"):n(this).attr("disabled",!0))})}),this.src.popup.use.change(),d.open()},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(n){return n.nodeName=="A"&&n.href})?this.domElem.removeClass("disabled").addClass("active"):this.rte.selection.collapsed()&&n.nodeName!="IMG"?this.domElem.addClass("disabled").removeClass("active"):this.domElem.removeClass("disabled active")},this.updatePopup=function(){var t=""+this.link.attr("onclick");t.length>0&&(m=t.match(/window.open\('([^']+)',\s*'([^']*)',\s*'([^']*)'\s*.*\);\s*(return\s+false)?/))?(this.src.popup.use.attr("checked","on"),this.src.popup.url.val(m[1]),this.src.popup.name.val(m[2]),/location=yes/.test(m[3])&&this.src.popup.location.attr("checked",!0),/menubar=yes/.test(m[3])&&this.src.popup.menubar.attr("checked",!0),/toolbar=yes/.test(m[3])&&this.src.popup.toolbar.attr("checked",!0),/scrollbars=yes/.test(m[3])&&this.src.popup.scrollbars.attr("checked",!0),/status=yes/.test(m[3])&&this.src.popup.status.attr("checked",!0),/resizable=yes/.test(m[3])&&this.src.popup.resizable.attr("checked",!0),/dependent=yes/.test(m[3])&&this.src.popup.dependent.attr("checked",!0),(_m=m[3].match(/width=([^,]+)/))&&this.src.popup.width.val(_m[1]),(_m=m[3].match(/height=([^,]+)/))&&this.src.popup.height.val(_m[1]),(_m=m[3].match(/left=([^,]+)/))&&this.src.popup.left.val(_m[1]),(_m=m[3].match(/top=([^,]+)/))&&this.src.popup.top.val(_m[1]),m[4]&&this.src.popup.retfalse.attr("checked",!0)):n.each(this.src.popup,function(){var t=n(this);t.attr("type")=="text"?t.val(t.attr("name")=="url"?"http://":""):t.attr("name")=="retfalse"?this.attr("checked",!0):t.removeAttr("checked")})},this.updateOnclick=function(){var r=this.src.popup.url.val(),t,u,f,i;this.src.popup.use.attr("checked")&&r?(t="",this.src.popup.location.attr("checked")&&(t+="location=yes,"),this.src.popup.menubar.attr("checked")&&(t+="menubar=yes,"),this.src.popup.toolbar.attr("checked")&&(t+="toolbar=yes,"),this.src.popup.scrollbars.attr("checked")&&(t+="scrollbars=yes,"),this.src.popup.status.attr("checked")&&(t+="status=yes,"),this.src.popup.resizable.attr("checked")&&(t+="resizable=yes,"),this.src.popup.dependent.attr("checked")&&(t+="dependent=yes,"),this.src.popup.width.val()&&(t+="width="+this.src.popup.width.val()+","),this.src.popup.height.val()&&(t+="height="+this.src.popup.height.val()+","),this.src.popup.left.val()&&(t+="left="+this.src.popup.left.val()+","),this.src.popup.top.val()&&(t+="top="+this.src.popup.top.val()+","),t.length>0&&(t=t.substring(0,t.length-1)),u=this.src.popup.retfalse.attr("checked")?"return false;":"",f="window.open('"+r+"', '"+n.trim(this.src.popup.name.val())+"', '"+t+"'); "+u,this.src.events.onclick.val(f),this.src.main.href.val()||this.src.main.href.val("#")):(i=this.src.events.onclick.val(),i=i.replace(/window\.open\([^\)]+\)\s*;?\s*return\s*false\s*;?/i,""),this.src.events.onclick.val(i))},this.set=function(){var i,u,e,r,t,f;if(this.updateOnclick(),this.rte.selection.moveToBookmark(this.bm),this.rte.history.add(),i=this.rte.utils.absoluteURL(this.src.main.href.val()),i){this.img&&this.img.parentNode?(this.link=n(this.rte.dom.create("a")).attr("href",i),this.rte.dom.wrap(this.img,this.link[0])):this.link[0].parentNode||(u="#--el-editor---"+Math.random(),this.rte.doc.execCommand("createLink",!1,u),this.link=n('a[href="'+u+'"]',this.rte.doc),this.link.each(function(){var t=n(this);n.trim(t.html())||n.trim(t.text())||t.replaceWith(t.text())})),this.src.main.href.val(i);for(r in this.src)if(r!="popup")for(t in this.src[r])t!="anchors"&&(f=n.trim(this.src[r][t].val()),f?this.link.attr(t,f):this.link.removeAttr(t));this.img&&this.rte.selection.select(this.img)}else e=this.rte.selection.getBookmark(),this.rte.dom.unwrap(this.link[0]),this.rte.selection.moveToBookmark(e);this.rte.ui.update(!0)}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.nbsp=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){this.rte.history.add(),this.rte.selection.insertHtml("&nbsp;",!0),this.rte.window.focus(),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.outdent=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.find();t.node&&(this.rte.history.add(),n(t.node).css(t.type,(t.val>40?t.val-40:0)+"px"),this.rte.ui.update())},this.find=function(t){function u(t){var i={type:"",val:0},u;return(u=r.rte.dom.attr(t,"style"))&&(i.type=u.indexOf("padding-left")!=-1?"padding-left":u.indexOf("margin-left")!=-1?"margin-left":"",i.val=i.type?parseInt(n(t).css(i.type))||0:0),i}var t=this.rte.selection.getNode(),i=u(t);return i.val?i.node=t:n.each(this.rte.dom.parents(t,"*"),function(){return i=u(this),i.val?(i.node=this,i):void 0}),i},this.update=function(){var n=this.find();n.node?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pagebreak=function(t,i){this.constructor.prototype.constructor.call(this,t,i),n(this.rte.doc.body).bind("mousedown",function(t){n(t.target).hasClass("elrte-pagebreak")&&t.preventDefault()}),this.command=function(){this.rte.selection.insertHtml('<img src="'+this.rte.filter.url+'pixel.gif" class="elrte-protected elrte-pagebreak"/>',!1)},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pasteformattext=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.iframe=n(document.createElement("iframe")).addClass("el-rte-paste-input"),this.doc=null;var r=this;this.command=function(){this.rte.selection.saveIERange();var n=this,t={submit:function(t,i){t.stopPropagation(),t.preventDefault(),n.paste(),i.close()},dialog:{width:500,title:this.rte.i18n("Paste formatted text")}},i=new elDialogForm(t);if(i.append(this.iframe).open(),this.doc=this.iframe.get(0).contentWindow.document,html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',html+="<\/head><body> <br /> <\/body><\/html>",this.doc.open(),this.doc.write(html),this.doc.close(),this.rte.browser.msie)this.doc.body.contentEditable=!0;else try{this.doc.designMode="on"}catch(r){}setTimeout(function(){n.iframe[0].contentWindow.focus()},50)},this.paste=function(){n(this.doc.body).find("[class]").removeAttr("class");var t=n.trim(n(this.doc.body).html());t&&(this.rte.history.add(),this.rte.selection.restoreIERange(),this.rte.selection.insertHtml(this.rte.filter.wysiwyg2wysiwyg(this.rte.filter.proccess("paste",t))),this.rte.ui.update(!0))},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pastetext=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.input=n("<textarea />").addClass("el-rte-paste-input");var r=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var n={submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.paste(),t.close()},dialog:{width:500,title:this.rte.i18n("Paste only text")}},t=new elDialogForm(n);t.append(this.input).open()},this.paste=function(){var t=n.trim(this.input.val());t&&(this.rte.history.add(),this.rte.browser.msie&&this.rte.selection.restoreIERange(),this.rte.selection.insertText(t.replace(/\r?\n/g,"<br />"),!0),this.rte.ui.update(!0)),this.input.val("")},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.save=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.active=!0,this.command=function(){this.rte.save()},this.update=function(){}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.smiley=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.img=null,this.url=this.rte.filter.url+"smileys/",this.smileys={smile:"smile.png",happy:"happy.png",tongue:"tongue.png",surprised:"surprised.png",waii:"waii.png",wink:"wink.png",evilgrin:"evilgrin.png",grin:"grin.png",unhappy:"unhappy.png"},this.width=120,this.command=function(){var r=this,u=this.url,t,i;this.rte.browser.msie&&this.rte.selection.saveIERange(),i={dialog:{height:120,width:this.width,title:this.rte.i18n("Smiley"),buttons:{}}},t=new elDialogForm(i),n.each(this.smileys,function(i,f){t.append(n('<img src="'+u+f+'" title="'+i+'" id="'+i+'" class="el-rte-smiley"/>').click(function(){r.set(this.id,t)}))}),t.open()},this.update=function(){this.domElem.removeClass("disabled"),this.domElem.removeClass("active")},this.set=function(t,i){this.rte.browser.msie&&this.rte.selection.restoreIERange(),this.smileys[t]&&(this.img=n(this.rte.doc.createElement("img")),this.img.attr({src:this.url+this.smileys[t],title:t,alt:t}),this.rte.selection.insertNode(this.img.get(0)),this.rte.ui.update()),i.close()}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.stopfloat=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.find=function(){if(this.rte.selection.collapsed()){var t=this.rte.dom.selfOrParent(this.rte.selection.getEnd(),/^DIV$/);if(t&&(this.rte.dom.attr(t,"clear")||n(t).css("clear")!="none"))return t}},this.command=function(){var t;(t=this.find())?(t=n(t),this.rte.history.add(),t.children().length||n.trim(t.text()).length?t.removeAttr("clear").css("clear",""):t.remove()):(this.rte.history.add(),this.rte.selection.insertNode(n(this.rte.dom.create("div")).css("clear","both").get(0),!0)),this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled"),this.find()?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.table=function(t,i){function u(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",summary:"Summary",lang:"Language",href:"URL"},r.src={main:{caption:n('<input type="text" />'),rows:n('<input type="text" />').attr("size",5).val(2),cols:n('<input type="text" />').attr("size",5).val(2),width:n('<input type="text" />').attr("size",5),wunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),height:n('<input type="text" />').attr("size",5),hunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),align:n("<select />").append(n("<option />").val("").text(r.rte.i18n("Not set"))).append(n("<option />").val("left").text(r.rte.i18n("Left"))).append(n("<option />").val("center").text(r.rte.i18n("Center"))).append(n("<option />").val("right").text(r.rte.i18n("Right"))),spacing:n('<input type="text" />').attr("size",5),padding:n('<input type="text" />').attr("size",5),border:n("<div />"),rules:n("<select />").append(n("<option />").val("none").text(r.rte.i18n("No"))).append(n("<option />").val("all").text(r.rte.i18n("Cells"))).append(n("<option />").val("groups").text(r.rte.i18n("Groups"))).append(n("<option />").val("rows").text(r.rte.i18n("Rows"))).append(n("<option />").val("cols").text(r.rte.i18n("Columns"))),margin:n("<div />"),bg:n("<div />"),bgimg:n('<input type="text" />').css("width","90%")},adv:{id:n('<input type="text" />'),summary:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />')},events:{}},n.each(r.src,function(){var n,t;for(n in this)this[n].attr("name",n),t=this[n].get(0).nodeName,t=="INPUT"&&n!="bgimg"?this[n].css(this[n].attr("size")?{"text-align":"right"}:{width:"100%"}):t=="SELECT"&&n!="wunit"&&n!="hunit"&&this[n].css("width","100%")}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />').css("width","100%")}),r.src.main.align.change(function(){var i=n(this).val(),t;i=="center"?r.src.main.margin.val({left:"auto",right:"auto"}):(t=r.src.main.margin.val(),t.left=="auto"&&t.right=="auto"&&r.src.main.margin.val({left:"",right:""}))}),r.src.main.bgimg.change(function(){var t=n(this);t.val(r.rte.utils.absoluteURL(t.val()))})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src=null,this.labels=null,this.command=function(){var l=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/),h,e,o,a,v,c,y,f,t,i,s;this.table=this.name=="table"?n(this.rte.doc.createElement("table")):l?n(l):n(this.rte.doc.createElement("table")),this.src||u(),this.src.main.border.elBorderSelect({styleHeight:117}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.margin.elPaddingInput({type:"margin",value:this.table}),this.table.parents().length?(this.src.main.rows.val("").attr("disabled",!0),this.src.main.cols.val("").attr("disabled",!0)):(this.src.main.rows.val(2).removeAttr("disabled"),this.src.main.cols.val(2).removeAttr("disabled")),h=this.table.css("width")||this.table.attr("width"),this.src.main.width.val(parseInt(h)||""),this.src.main.wunit.val(h.indexOf("px")!=-1?"px":"%"),e=this.table.css("height")||this.table.attr("height"),this.src.main.height.val(parseInt(e)||""),this.src.main.hunit.val(e&&e.indexOf("px")!=-1?"px":"%"),o=this.table.css("float"),this.src.main.align.val(""),o=="left"||o=="right"?this.src.main.align.val(o):(a=this.table.css("margin-left"),v=this.table.css("margin-right"),a=="auto"&&v=="auto"&&this.src.main.align.val("center")),this.src.main.border.val(this.table),this.src.main.rules.val(this.rte.dom.attr(this.table.get(0),"rules")),this.src.main.bg.val(this.table.css("background-color")),c=(this.table.css("background-image")||"").replace(/url\(([^\)]+)\)/i,"$1"),this.src.main.bgimg.val(c!="none"?c:""),y={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{width:530,title:this.rte.i18n("Table")}},f=new elDialogForm(y);for(t in this.src)if(f.tab(t,this.rte.i18n(this.labels[t])),t=="main"){var p=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Rows")+"<\/td>").append(n("<td />").append(this.src.main.rows))).append(n("<tr />").append("<td>"+this.rte.i18n("Columns")+"<\/td>").append(n("<td />").append(this.src.main.cols))),w=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Width")+"<\/td>").append(n("<td />").append(this.src.main.width).append(this.src.main.wunit))).append(n("<tr />").append("<td>"+this.rte.i18n("Height")+"<\/td>").append(n("<td />").append(this.src.main.height).append(this.src.main.hunit))),b=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Spacing")+"<\/td>").append(n("<td />").append(this.src.main.spacing.val(this.table.attr("cellspacing")||"")))).append(n("<tr />").append("<td>"+this.rte.i18n("Padding")+"<\/td>").append(n("<td />").append(this.src.main.padding.val(this.table.attr("cellpadding")||""))));f.append([this.rte.i18n("Caption"),this.src.main.caption.val(this.table.find("caption").eq(0).text()||"")],"main",!0).separator("main").append([p,w,b],"main",!0).separator("main").append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Inner borders"),this.src.main.rules],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Background"),n("<span />").append(n("<span />").css({float:"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0)}else for(i in this.src[t])s=this.rte.dom.attr(this.table,i),t=="events"&&(s=this.rte.utils.trimEventCallback(s)),f.append([this.rte.i18n(this.labels[i]?this.labels[i]:i),this.src[t][i].val(s)],t,!0);f.open()},this.set=function(){var e,o,t,i,s,h,c,u,f,l,a,v,p;if(this.table.parents().length)this.table.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor").removeAttr("cellspacing").removeAttr("cellpadding").removeAttr("frame").removeAttr("rules").removeAttr("style");else{if(e=parseInt(this.src.main.rows.val())||0,o=parseInt(this.src.main.cols.val())||0,e<=0||o<=0)return;for(this.rte.history.add(),t=n(this.rte.doc.createElement("tbody")).appendTo(this.table),i=0;i<e;i++){for(s="<tr>",h=0;h<o;h++)s+="<td>&nbsp;<\/td>";t.append(s+"<\/tr>")}}c=n.trim(this.src.main.caption.val()),c?(this.table.children("caption").length||this.table.prepend("<caption />"),this.table.children("caption").text(c)):this.table.children("caption").remove();for(u in this.src)if(u!="main")for(f in this.src[u])l=n.trim(this.src[u][f].val()),l?this.table.attr(f,l):this.table.removeAttr(f);(a=parseInt(this.src.main.spacing.val()))&&a>=0&&this.table.attr("cellspacing",a),(v=parseInt(this.src.main.padding.val()))&&v>=0&&this.table.attr("cellpadding",v),(p=this.src.main.rules.val())&&this.table.attr("rules",p);var w=parseInt(this.src.main.width.val())||"",b=parseInt(this.src.main.height.val())||"",i=n.trim(this.src.main.bgimg.val()),t=this.src.main.border.val(),r=this.src.main.margin.val(),y=this.src.main.align.val();this.table.css({width:w?w+this.src.main.wunit.val():"",height:b?b+this.src.main.hunit.val():"",border:n.trim(t.width+" "+t.style+" "+t.color),"background-color":this.src.main.bg.val(),"background-image":i?"url("+i+")":""}),r.css?this.table.css("margin",r.css):this.table.css({"margin-top":r.top,"margin-right":r.right,"margin-bottom":r.bottom,"margin-left":r.left}),(y=="left"||y=="right")&&this.table.css("margin-left")!="auto"&&this.table.css("margin-right")!="auto"&&this.table.css("float",y),this.table.attr("style")||this.table.removeAttr("style"),this.table.parents().length||this.rte.selection.insertNode(this.table.get(0),!0),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled"),this.name!="tableprops"||this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/)||this.domElem.addClass("disabled").removeClass("active")}},elRTE.prototype.ui.prototype.buttons.tableprops=elRTE.prototype.ui.prototype.buttons.table}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tablerm=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var t=this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/);t&&(this.rte.history.add(),n(t).remove()),this.rte.ui.update(!0)},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellprops=function(t,i){function u(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language"},r.src={main:{type:n("<select />").css("width","100%").append(n("<option />").val("td").text(r.rte.i18n("Data"))).append(n("<option />").val("th").text(r.rte.i18n("Header"))),width:n('<input type="text" />').attr("size",4),wunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),height:n('<input type="text" />').attr("size",4),hunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),align:n("<select />").css("width","100%").append(n("<option />").val("").text(r.rte.i18n("Not set"))).append(n("<option />").val("left").text(r.rte.i18n("Left"))).append(n("<option />").val("center").text(r.rte.i18n("Center"))).append(n("<option />").val("right").text(r.rte.i18n("Right"))).append(n("<option />").val("justify").text(r.rte.i18n("Justify"))),border:n("<div />"),padding:n("<div />"),bg:n("<div />"),bgimg:n('<input type="text" />').css("width","90%"),apply:n("<select />").css("width","100%").append(n("<option />").val("").text(r.rte.i18n("Current cell"))).append(n("<option />").val("row").text(r.rte.i18n("All cells in row"))).append(n("<option />").val("column").text(r.rte.i18n("All cells in column"))).append(n("<option />").val("table").text(r.rte.i18n("All cells in table")))},adv:{id:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").css("width","100%").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />')},events:{}},n.each(r.src,function(){for(var n in this)this[n].attr("name",n),this[n].attr("type")!="text"||this[n].attr("size")||n=="bgimg"||this[n].css("width","100%")}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />').css("width","100%")})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src=null,this.labels=null,this.command=function(){var s,h,e,c,f,t,i,o;if(this.src||u(),this.cell=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/),this.cell){this.src.main.type.val(this.cell.nodeName.toLowerCase()),this.cell=n(this.cell),this.src.main.border.elBorderSelect({styleHeight:117,value:this.cell}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.padding.elPaddingInput({value:this.cell}),s=this.cell.css("width")||this.cell.attr("width"),this.src.main.width.val(parseInt(s)||""),this.src.main.wunit.val(s.indexOf("px")!=-1?"px":"%"),h=this.cell.css("height")||this.cell.attr("height"),this.src.main.height.val(parseInt(h)||""),this.src.main.hunit.val(h.indexOf("px")!=-1?"px":"%"),this.src.main.align.val(this.cell.attr("align")||this.cell.css("text-align")),this.src.main.bg.val(this.cell.css("background-color")),e=this.cell.css("background-image"),this.src.main.bgimg.val(e&&e!="none"?e.replace(/url\(([^\)]+)\)/i,"$1"):""),this.src.main.apply.val(""),c={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{width:520,title:this.rte.i18n("Table cell properties")}},f=new elDialogForm(c);for(t in this.src)if(f.tab(t,this.rte.i18n(this.labels[t])),t=="main")f.append([this.rte.i18n("Width"),n("<span />").append(this.src.main.width).append(this.src.main.wunit)],"main",!0).append([this.rte.i18n("Height"),n("<span />").append(this.src.main.height).append(this.src.main.hunit)],"main",!0).append([this.rte.i18n("Table cell type"),this.src.main.type],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Paddings"),this.src.main.padding],"main",!0).append([this.rte.i18n("Background"),n("<span />").append(n("<span />").css({float:"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0).append([this.rte.i18n("Apply to"),this.src.main.apply],"main",!0);else for(i in this.src[t])o=this.cell.attr(i)||"",t=="events"&&(o=this.rte.utils.trimEventCallback(o)),f.append([this.rte.i18n(this.labels[i]?this.labels[i]:i),this.src[t][i].val(o)],t,!0);f.open()}},this.set=function(){var t=this.cell,v=this.src.main.apply.val(),f,e,o;switch(this.src.main.apply.val()){case"row":t=this.cell.parent("tr").children("td,th");break;case"column":t=n(this.rte.dom.tableColumn(this.cell.get(0)));break;case"table":t=this.cell.parents("table").find("td,th")}for(f in this.src)if(f!="main")for(e in this.src[f])o=n.trim(this.src[f][e].val()),o?t.attr(e,o):t.removeAttr(e);t.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor");var h=this.src.main.type.val(),c=parseInt(this.src.main.width.val())||"",l=parseInt(this.src.main.height.val())||"",a=n.trim(this.src.main.bgimg.val()),s=this.src.main.border.val(),i={width:c?c+this.src.main.wunit.val():"",height:l?l+this.src.main.hunit.val():"","background-color":this.src.main.bg.val(),"background-image":a?"url("+a+")":"",border:n.trim(s.width+" "+s.style+" "+s.color),"text-align":this.src.main.align.val()||""},u=this.src.main.padding.val();u.css?i.padding=u.css:(i["padding-top"]=u.top,i["padding-right"]=u.right,i["padding-bottom"]=u.bottom,i["padding-left"]=u.left),t=t.get(),n.each(t,function(){var c=this.nodeName.toLowerCase(),t=n(this),f,e,u,o,s;if(c!=h){f={};for(e in r.src.adv)u=t.attr(e),u&&(f[e]=u.toString());for(e in r.src.events)u=t.attr(e),u&&(f[e]=u.toString());o=t.attr("colspan")||1,s=t.attr("rowspan")||1,o>1&&(f.colspan=o),s>1&&(f.rowspan=s),t.replaceWith(n("<"+h+" />").html(t.html()).attr(f).css(i))}else t.css(i)}),this.rte.ui.update()},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellsmerge=function(t,i){function u(){var t=r.rte.dom.selfOrParent(r.rte.selection.getStart(),/^(TD|TH)$/),i=r.rte.dom.selfOrParent(r.rte.selection.getEnd(),/^(TD|TH)$/);return t&&i&&t!=i&&n(t).parents("table").get(0)==n(i).parents("table").get(0)?[t,i]:null}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=u(),w;if(t){var c=this.rte.dom.indexOf(n(t[0]).parent("tr").get(0)),l=this.rte.dom.indexOf(n(t[1]).parent("tr").get(0)),s=Math.min(c,l),h=Math.max(c,l)-s+1,f=this.rte.dom.tableColumn(t[0],!0,!0),e=this.rte.dom.tableColumn(t[1],!0),a=n.inArray(t[0],f.column),v=n.inArray(t[1],e.column),y=f.info.offset[a]<e.info.offset[v]?f:e,p=f.info.offset[a]>=e.info.offset[v]?f:e,o=0,i=null,r="";this.rte.history.add(),w=n(n(t[0]).parents("table").eq(0).find("tr").get().slice(s,s+h)).each(function(t){var f=r.length,u=!1;n(this).children("td,th").each(function(){var f=n(this),h=n.inArray(this,y.column),c=n.inArray(this,p.column),l,s,a,e;h!=-1||c!=-1?(u=h!=-1&&c==-1,l=parseInt(f.attr("colspan")||1),t==0&&(o+=l),h!=-1&&t>0&&(s=y.info.delta[h],s>0&&(f.css("text-align")=="left"?(e=f.clone(!0),f.html("&nbsp;")):e=f.clone().html("&nbsp;"),e.removeAttr("colspan").removeAttr("id").insertBefore(this),s>1&&e.attr("colspan",s))),c!=-1&&(s=p.info.delta[c],l-s>1&&(a=l-s-1,f.css("text-align")=="right"?(e=f.clone(!0),f.html("&nbsp;")):e=f.clone().html("&nbsp;"),e.removeAttr("colspan").removeAttr("id").insertAfter(this),a>1&&e.attr("colspan",a))),i?(r+=f.html(),f.remove()):i=f):u&&(t==0&&(o+=parseInt(f.attr("colspan")||1)),r+=f.html(),f.remove())}),r+=f!=r.length?"<br />":""}),i.removeAttr("colspan").removeAttr("rowspan").html(i.html()+r),o>1&&i.attr("colspan",o),h>1&&i.attr("rowspan",h),this.rte.dom.fixTable(n(t[0]).parents("table").get(0))}},this.update=function(){u()?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellsplit=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/),o,s,r,f,t;if(i&&(this.rte.history.add(),o=parseInt(this.rte.dom.attr(i,"colspan")),s=parseInt(this.rte.dom.attr(i,"rowspan")),o>1||s>1)){var h=o-1,c=s-1,l=this.rte.dom.parent(i,/^TABLE$/),u=this.rte.dom.tableMatrix(l);if(h)for(t=0;t<h;t++)n(this.rte.dom.create(i.nodeName)).html("&nbsp;").insertAfter(i);if(c){var a=this.rte.dom.indexesOfCell(i,u),v=a[0],e=a[1];for(r=v+1;r<v+c+1;r++)if(!u[r][e].nodeName){if(u[r][e-1].nodeName)f=u[r][e-1];else for(t=e-1;t>=0;t--)if(u[r][t].nodeName){f=u[r][t];break}if(f)for(t=0;t<=h;t++)n(this.rte.dom.create(f.nodeName)).html("&nbsp;").insertAfter(f)}}n(i).removeAttr("colspan").removeAttr("rowspan"),this.rte.dom.fixTable(l)}this.rte.ui.update(!0)},this.update=function(){var n=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);n&&(parseInt(this.rte.dom.attr(n,"colspan"))>1||parseInt(this.rte.dom.attr(n,"rowspan"))>1)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcolbefore=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this,i=this.rte.dom.tableColumn(this.rte.selection.getNode(),!1,!0);i.length&&(this.rte.history.add(),n.each(i,function(){var r=n(this),u=parseInt(r.attr("colspan")||1),i;u>1?r.attr("colspan",u+1):(i=n(t.rte.dom.create(this.nodeName)).html("&nbsp;"),t.name=="tbcolbefore"?i.insertBefore(this):i.insertAfter(this))}),this.rte.ui.update())},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbcolafter=elRTE.prototype.ui.prototype.buttons.tbcolbefore}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcolrm=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),r=this.rte.dom.selfOrParent(t,/^(TD|TH)$/),i=n(r).prev("td,th").get(0),u=n(r).next("td,th").get(0),e=this.rte.dom.parent(t,/^TABLE$/),f=this.rte.dom.tableColumn(t,!1,!0);f.length&&(this.rte.history.add(),n.each(f,function(){var t=n(this),i=parseInt(t.attr("colspan")||1);i>1?t.attr("colspan",i-1):t.remove()}),this.rte.dom.fixTable(e),(i||u)&&this.rte.selection.selectContents(i?i:u).collapse(!0),this.rte.ui.update(!0))},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),elRTE.prototype.ui.prototype.buttons.tbrowbefore=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){var l=this.rte.selection.getNode(),e=this.rte.dom.selfOrParent(l,/^(TD|TH)$/),u=this.rte.dom.selfOrParent(e,/^TR$/),t=this.rte.dom.tableMatrix(this.rte.dom.selfOrParent(e,/^TABLE$/)),i,h,f,n;if(e&&u&&t){this.rte.history.add();var c=this.name=="tbrowbefore",r=$(u).prevAll("tr").length,o=0,s=[];function a(n,i){while(i>0)if(i--,t[i]&&t[i][n]&&t[i][n].nodeName)return t[i][n]}for(n=0;n<t[r].length;n++)t[r][n]&&t[r][n].nodeName?(i=$(t[r][n]),h=parseInt(i.attr("colspan")||1),parseInt(i.attr("rowspan")||1)>1?c?o+=h:s.push(i):o+=h):t[r][n]=="-"&&(i=a(n,r),i&&s.push($(i)));for(f=$(this.rte.dom.create("tr")),n=0;n<o;n++)f.append("<td>&nbsp;<\/td>");c?f.insertBefore(u):f.insertAfter(u),$.each(s,function(){$(this).attr("rowspan",parseInt($(this).attr("rowspan")||1)+1)}),this.rte.ui.update()}},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbrowafter=elRTE.prototype.ui.prototype.buttons.tbrowbefore,function(n){elRTE.prototype.ui.prototype.buttons.tbrowrm=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var l=this.rte.selection.getNode(),f=this.rte.dom.selfOrParent(l,/^(TD|TH)$/),e=this.rte.dom.selfOrParent(f,/^TR$/),c=this.rte.dom.selfOrParent(f,/^TABLE$/),t=this.rte.dom.tableMatrix(c),a,i,r,u,o,s,h;if(f&&e&&t.length){if(this.rte.history.add(),t.length==1)return n(c).remove(),this.rte.ui.update();a=[],i=n(e).prevAll("tr").length;function v(n,i){while(i>0)if(i--,t[i]&&t[i][n]&&t[i][n].nodeName)return t[i][n]}function p(r,u){var o,f;if(y=i+1,o=null,t[y]){for(f=0;f<u;f++)t[y][f]&&t[y][f].nodeName&&(o=t[y][f]);r=r.remove(),o?r.insertAfter(o):r.prependTo(n(e).next("tr").eq(0))}}function w(n){for(var t=0;t<n.length;t++)if(n[t]==f)return t<n.length-1?n[t+1]:n[t-1]}for(r=0;r<t[i].length;r++)u=null,o=!1,t[i][r]&&t[i][r].nodeName?(u=t[i][r],o=!0):t[i][r]=="-"&&(u=v(r,i))&&(o=!1),u&&(u=n(u),s=parseInt(u.attr("rowspan")||1),s>1&&(u.attr("rowspan",s-1),o&&p(u,r,i)));h=w(this.rte.dom.tableColumn(f)),h&&this.rte.selection.selectContents(h).collapse(!0),n(e).remove()}this.rte.ui.update()},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.undo=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){this.name=="undo"&&this.rte.history.canBack()?(this.rte.history.back(),this.rte.ui.update()):this.name=="redo"&&this.rte.history.canFwd()&&(this.rte.history.fwd(),this.rte.ui.update())},this.update=function(){this.domElem.toggleClass("disabled",this.name=="undo"?!this.rte.history.canBack():!this.rte.history.canFwd())}},elRTE.prototype.ui.prototype.buttons.redo=elRTE.prototype.ui.prototype.buttons.undo}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.unlink=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){function u(n){return n.nodeName=="A"&&n.href}var f=this.rte.selection.getNode(),i=this.rte.dom.selfOrParentLink(f),t,r;if(!i&&(t=n.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1}),t.length)){for(r=0;r<t.length;r++)if(u(t[r])){i=t[r];break}i||(i=this.rte.dom.parent(t[0],u)||this.rte.dom.parent(t[t.length-1],u))}i&&(this.rte.history.add(),this.rte.selection.select(i),this.rte.doc.execCommand("unlink",!1,null),this.rte.ui.update(!0))},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(n){return n.nodeName=="A"&&n.href})?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active")}}}(jQuery),eli18n.prototype=new function(){this.messages={},this._domain="",this.load=function(n){var t,i,r;if(typeof n=="object")for(t in n)if(i=n[t],typeof i=="object"){this.messages[t]||(this.messages[t]={});for(r in i)typeof i[r]=="string"&&(this.messages[t][r]=i[r])}return this},this.translate=function(n,t){var t=t&&this.messages[t]?t:this._domain;return this.messages[t]&&this.messages[t][n]?this.messages[t][n]:n},this.format=function(n,t,i){if(n=this.translate(n,i),typeof t=="object")for(var r in t)n=n.replace("%"+r,this.translate(t[r],i));return n}},function(n){n.fn.elColorPicker=function(t){function u(n){i.val(n),r.change&&r.change(i.val()),i.palette.slideUp()}function f(){i.palette=n("<div />").addClass(r.paletteClass+" rounded-3");for(var t=0;t<r.colors.length;t++)n("<div />").addClass("color").css("background-color",r.colors[t]).attr({title:r.colors[t],unselectable:"on"}).appendTo(i.palette).mouseenter(function(){var t=n(this).attr("title");i.input.val(t),i.preview.css("background-color",t)}).click(function(t){t.stopPropagation(),u(n(this).attr("title"))});i.input=n('<input type="text" />').addClass("rounded-3").attr("size",8).click(function(t){t.stopPropagation(),n(this).focus()}).keydown(function(t){var r,f;return t.ctrlKey||t.metaKey?!0:(r=t.keyCode,r==27)?i.mouseleave():r!=8&&r!=13&&r!=46&&r!=37&&r!=39&&(r<48||r>57)&&(r<65||r>70)?!1:(f=n(this).val(),(f.length==7||f.length==0)&&(r==13&&(t.stopPropagation(),t.preventDefault(),u(f),i.palette.slideUp()),t.keyCode!=8&&t.keyCode!=46&&r!=37&&r!=39)?!1:void 0)}).keyup(function(){var t=n(this).val();t.length==7&&/^#[0-9abcdef]{6}$/i.test(t)&&i.val(t)}),i.preview=n("<div />").addClass("preview rounded-3").click(function(n){n.stopPropagation(),u(i.input.val())}),i.palette.append(n("<div />").addClass("clearfix")).append(n("<div />").addClass("panel").append(i.input).append(i.preview)),r.palettePosition=="outer"?(i.palette.hide().appendTo(i.parents("body").eq(0)).mouseleave(function(){i.palette.is(":animated")||(n(this).slideUp(),i.val(i.val()))}),i.mouseleave(function(n){n.relatedTarget!=i.palette.get(0)&&(i.palette.is(":animated")||(i.palette.slideUp(),i.val(i.val())))})):i.append(i.palette.hide()).mouseleave(function(){i.palette.slideUp(),i.val(i.val())}),i.val(i.val())}var i=this,r=n.extend({},n.fn.elColorPicker.defaults,t);return this.hidden=n('<input type="hidden" />').attr("name",r.name).val(r.color||"").appendTo(this),this.palette=null,this.preview=null,this.input=null,this.empty().addClass(r["class"]+" rounded-3").css({position:"relative","background-color":r.color||""}).click(function(){if(!i.hasClass("disabled")){if(i.palette||f(),r.palettePosition=="outer"&&i.palette.css("display")=="none"){var t=n(this).offset(),u=i.palette.width(),e=i.parents("body").width()-t.left>=u?t.left:t.left+n(this).outerWidth()-u;i.palette.css({left:e+"px",top:t.top+n(this).height()+1+"px"})}i.palette.slideToggle()}}),this.val=function(n){if(n||n==="")this.hidden.val(n),r.update?r.update(this.hidden.val()):this.css("background-color",n),i.palette&&(i.preview.css("background-color",n),i.input.val(n));else return this.hidden.val();return this},this},n.fn.elColorPicker.defaults={"class":"el-colorpicker",paletteClass:"el-palette",palettePosition:"inner",name:"color",color:"",update:null,change:function(){},colors:["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ffcccc","#cc9999","#996666","#663333","#330000","#ff9999","#cc6666","#cc3333","#993333","#660000","#ff6666","#ff3333","#ff0000","#cc0000","#990000","#ff9966","#ff6633","#ff3300","#cc3300","#993300","#ffcc99","#cc9966","#cc6633","#996633","#663300","#ff9933","#ff6600","#ff9900","#cc6600","#cc9933","#ffcc66","#ffcc33","#ffcc00","#cc9900","#996600","#ffffcc","#cccc99","#999966","#666633","#333300","#ffff99","#cccc66","#cccc33","#999933","#666600","#ffff66","#ffff33","#ffff00","#cccc00","#999900","#ccff66","#ccff33","#ccff00","#99cc00","#669900","#ccff99","#99cc66","#99cc33","#669933","#336600","#99ff33","#99ff00","#66ff00","#66cc00","#66cc33","#99ff66","#66ff33","#33ff00","#33cc00","#339900","#ccffcc","#99cc99","#669966","#336633","#003300","#99ff99","#66cc66","#33cc33","#339933","#006600","#66ff66","#33ff33","#00ff00","#00cc00","#009900","#66ff99","#33ff66","#00ff33","#00cc33","#009933","#99ffcc","#66cc99","#33cc66","#339966","#006633","#33ff99","#00ff66","#00ff99","#00cc66","#33cc99","#66ffcc","#33ffcc","#00ffcc","#00cc99","#009966","#ccffff","#99cccc","#669999","#336666","#003333","#99ffff","#66cccc","#33cccc","#339999","#006666","#66cccc","#33ffff","#00ffff","#00cccc","#009999","#66ccff","#33ccff","#00ccff","#0099cc","#006699","#99ccff","#6699cc","#3399cc","#336699","#003366","#3399ff","#0099ff","#0066ff","#066ccc","#3366cc","#6699ff","#3366ff","#0033ff","#0033cc","#003399","#ccccff","#9999cc","#666699","#333366","#000033","#9999ff","#6666cc","#3333cc","#333399","#000066","#6666ff","#3333ff","#0000ff","#0000cc","#009999","#9966ff","#6633ff","#3300ff","#3300cc","#330099","#cc99ff","#9966cc","#6633cc","#663399","#330066","#9933ff","#6600ff","#9900ff","#6600cc","#9933cc","#cc66ff","#cc33ff","#cc00ff","#9900cc","#660099","#ffccff","#cc99cc","#996699","#663366","#330033","#ff99ff","#cc66cc","#cc33cc","#993399","#660066","#ff66ff","#ff33ff","#ff00ff","#cc00cc","#990099","#ff66cc","#ff33cc","#ff00cc","#cc0099","#990066","#ff99cc","#cc6699","#cc3399","#993366","#660033","#ff3399","#ff0099","#ff0066","#cc0066","#cc3366","#ff6699","#ff3366","#ff0033","#cc0033","#990033"]}}(jQuery),function(n){n.fn.elBorderSelect=function(t){function s(n){function i(n){return hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n?hexDigits[(n-n%16)/16]+hexDigits[n%16]:"00"}var t=(n||"").match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/);return t?"#"+i(t[1])+i(t[2])+i(t[3]):""}function h(t){var i,r;if(!t)return t;if(i=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/),i&&(t=i[1],unit=i[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t),isNaN(t))return"";r=parseInt(n(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*r);case"pt":return parseInt(t*r/12);case"%":return parseInt(t*r/100)}return t}var r=this,o=this.eq(0),i=n.extend({},n.fn.elBorderSelect.defaults,t),u=n('<input type="text" />').attr({name:i.name+"[width]",size:3}).css("text-align","right").change(function(){r.change()}),f=n("<div />").css("position","relative").elColorPicker({"class":"el-colorpicker ui-icon ui-icon-pencil",name:i.name+"[color]",palettePosition:"outer",change:function(){r.change()}}),e=n("<div />").elSelect({tpl:'<div style="border-bottom:4px %val #000;width:100%;margin:7px 0"> <\/div>',tpls:{"":"%label"},maxHeight:i.styleHeight||null,select:function(){r.change()},src:{"":"none",solid:"solid",dashed:"dashed",dotted:"dotted",double:"double",groove:"groove",ridge:"ridge",inset:"inset",outset:"outset"}});return o.empty().addClass(i["class"]).attr("name",i.name||"").append(n("<table />").attr("cellspacing",0).append(n("<tr />").append(n("<td />").append(u).append(" px")).append(n("<td />").append(e)).append(n("<td />").append(f)))),this.change=function(){i.change&&i.change(this.val())},this.val=function(t){var i,o,r,c,l;return t||t===""?(c="",t.nodeName||t.css?(t.css||(t=n(t)),c=t.css("border"),(c=t.css("border"))?i=o=r=c:(i=t.css("border-width"),o=t.css("border-style"),r=t.css("border-color"))):(i=t.width||"",o=t.style||"",r=t.color||""),u.val(h(i)),l=o?o.match(/(solid|dashed|dotted|double|groove|ridge|inset|outset)/i):"",e.val(l?l[1]:""),f.val(r.indexOf("#")===0?r:s(r)),this):(i=parseInt(u.val()),i=isNaN(i)?"":i+"px",o=e.val(),r=f.val(),{width:i,style:o,color:r,css:n.trim(i+" "+o+" "+r)})},this.val(i.value),this},n.fn.elBorderSelect.defaults={name:"el-borderselect","class":"el-borderselect",value:{},change:null}}(jQuery),function(t){t.fn.elPaddingInput=function(i){function f(i){return i=t.trim(i.toString()),i[0]=="."&&(i="0"+i),n=parseFloat(i),isNaN(n)?i=="auto"?i:"":n}function e(){r.change&&r.change(u)}var u=this,r=t.extend({},t.fn.elPaddingInput.defaults,{name:this.attr("name")},i);return this.regexps={main:new RegExp(r.type=="padding"?'paddings*:s*([^;"]+)':'margins*:s*([^;"]+)',"im"),left:new RegExp(r.type=="padding"?'padding-lefts*:s*([^;"]+)':'margin-lefts*:s*([^;"]+)',"im"),top:new RegExp(r.type=="padding"?'padding-tops*:s*([^;"]+)':'margin-tops*:s*([^;"]+)',"im"),right:new RegExp(r.type=="padding"?'padding-rights*:s*([^;"]+)':'margin-rights*:s*([^;"]+)',"im"),bottom:new RegExp(r.type=="padding"?'padding-bottoms*:s*([^;"]+)':'margin-bottoms*:s*([^;"]+)',"im")},t.each(["left","top","right","bottom"],function(){u[this]=t('<input type="text" />').attr("size",3).css("text-align","right").css("border-"+this,"2px solid red").bind("change",function(){t(this).val(f(t(this).val())),e()}).attr("name",r.name+"["+this+"]")}),t.each(["uleft","utop","uright","ubottom"],function(){u[this]=t("<select />").append('<option value="px">px<\/option>').append('<option value="em">em<\/option>').append('<option value="pt">pt<\/option>').bind("change",function(){e()}).attr("name",r.name+"["+this+"]"),r.percents&&u[this].append('<option value="%">%<\/option>')}),this.empty().addClass(r["class"]).append(this.left).append(this.uleft).append(" x ").append(this.top).append(this.utop).append(" x ").append(this.right).append(this.uright).append(" x ").append(this.bottom).append(this.ubottom),this.val=function(n){var e,o,s,r,n;if(n||n==="")return(n.nodeName||n.css)&&(n.css||(n=t(n)),e={left:"",top:"",right:"",bottom:""},o=(n.attr("style")||"").toLowerCase(),o&&(o=t.trim(o),s=o.match(this.regexps.main),s?(r=t.trim(s[1]).replace(/\s+/g," ").split(" ",4),e.top=r[0],e.right=r[1]&&r[1]!==""?r[1]:e.top,e.bottom=r[2]&&r[2]!==""?r[2]:e.top,e.left=r[3]&&r[3]!==""?r[3]:e.right):t.each(["left","top","right","bottom"],function(){var n=this.toString();s=o.match(u.regexps[n]),s&&(e[n]=s[1])})),n=e),t.each(["left","top","right","bottom"],function(){var t=this.toString(),r,i;u[t].val(""),u["u"+t].val(),typeof n[t]!="undefined"&&n[t]!==null&&(n[t]=n[t].toString(),r=f(n[t]),u[t].val(r),i=n[t].match(/(px|em|pt|%)/i),u["u"+t].val(i?i[1]:"px"))}),this;var h=f(this.left.val()),c=f(this.top.val()),l=f(this.right.val()),a=f(this.bottom.val()),i={left:h=="auto"||h==0?h:h!==""?h+this.uleft.val():"",top:c=="auto"||c==0?c:c!==""?c+this.utop.val():"",right:l=="auto"||l==0?l:l!==""?l+this.uright.val():"",bottom:a=="auto"||a==0?a:a!==""?a+this.ubottom.val():"",css:""};return i.left!==""&&i.right!==""&&i.top!==""&&i.bottom!==""&&(i.css=i.left==i.right&&i.top==i.bottom?i.top+" "+i.left:i.top+" "+i.right+" "+i.bottom+" "+i.left),i},this.val(r.value),this},t.fn.elPaddingInput.defaults={name:"el-paddinginput","class":"el-paddinginput",type:"padding",value:{},percents:!0,change:null}}(jQuery),function(n){n.fn.elSelect=function(t){function l(n){var t=i.labelTpl||i.tpls[n]||i.tpl;s.html(t.replace(/%val/g,n).replace(/%label/,i.src[n])).children().attr({unselectable:"on"})}function a(){var t,s,f,h;r=n("<div />").addClass(i.listClass+" rounded-3").hide().appendTo(u.mouseleave(function(){r.slideUp()}));for(t in i.src)s=i.tpls[t]||i.tpl,n("<div />").attr("name",t).append(n(s.replace(/%val/g,t).replace(/%label/g,i.src[t])).attr({unselectable:"on"})).appendTo(r).hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault();var u=n(this).attr("name");o.val(u),i.select(u),r.slideUp()});f=u.outerWidth(),r.width()<f&&r.width(f),h=r.height(),i.maxHeight>0&&h>i.maxHeight&&r.height(i.maxHeight),o.val(e.val())}var o=this,u=this.eq(0),i=n.extend({},n.fn.elSelect.defaults,t),e=n('<input type="hidden" />').attr("name",i.name),s=n("<label />").attr({unselectable:"on"}).addClass("rounded-left-3"),r=null,f=null,h,c;if(u.get(0).nodeName=="SELECT"&&(i.src={},u.children("option").each(function(){i.src[n(this).val()]=n(this).text()}),i.value=u.val(),i.name=u.attr("name"),u.replaceWith(u=n("<div />"))),!i.value||!i.src[i.val]){i.value=null,h=0;for(c in i.src)h++==0&&(i.value=c)}return this.val=function(t){return t||t===""?(i.src[t]&&(e.val(t),l(t),r&&r.children().each(function(){n(this).attr("name")==t?n(this).addClass("active"):n(this).removeClass("active")})),this):e.val()},u.empty().addClass(i["class"]+" rounded-3").attr({unselectable:"on"}).append(e).append(s).hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(){r||a(),r.slideToggle(),n.browser.msie&&!f&&(r.children().each(function(){f=Math.max(f,n(this).width())}),f>r.width()&&r.width(f+40))}),this.val(i.value),this},n.fn.elSelect.defaults={name:"el-select","class":"el-select",listClass:"list",labelTpl:null,tpl:"<%val>%label<\/%val>",tpls:{},value:null,src:{},select:function(n){window.console&&window.console.log&&window.console.log("selected: "+n)},maxHeight:410}}(jQuery),function(n){elRTE=function(t,i){var r,f,u,e,o;if(!t||!t.nodeName)return alert('elRTE: argument "target" is not DOM Element');if(r=this,this.version="1.3",this.build="2011-06-23",this.options=n.extend(!0,{},this.options,i),this.browser=n.browser,this.target=n(t),this.lang=""+this.options.lang,this._i18n=new eli18n({textdomain:"rte",messages:{rte:this.i18Messages[this.lang]||{}}}),this.rtl=!!(/^(ar|fa|he)$/.test(this.lang)&&this.i18Messages[this.lang]),this.rtl&&(this.options.cssClass+=" el-rte-rtl"),this.toolbar=n('<div class="toolbar"/>'),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("frameborder",0),this.workzone=n('<div class="workzone"/>').append(this.iframe).append(this.source),this.statusbar=n('<div class="statusbar"/>'),this.tabsbar=n('<div class="tabsbar"/>'),this.editor=n('<div class="'+this.options.cssClass+'" />').append(this.toolbar).append(this.workzone).append(this.statusbar).append(this.tabsbar),this.doc=null,this.$doc=null,this.window=null,this.utils=new this.utils(this),this.dom=new this.dom(this),this.filter=new this.filter(this),this.updateHeight=function(){r.workzone.add(r.iframe).add(r.source).height(r.workzone.height())},this.resizable=function(t){var i=this;this.options.resizable&&n.fn.resizable&&(t?this.editor.resizable({handles:"se",alsoResize:this.workzone,minWidth:300,minHeight:200}).bind("resize",i.updateHeight):this.editor.resizable("destroy").unbind("resize",i.updateHeight))},this.editor.insertAfter(t),u="",t.nodeName=="TEXTAREA"?(this.source=this.target,this.source.insertAfter(this.iframe).hide(),u=this.target.val()):(this.source=n("<textarea />").insertAfter(this.iframe).hide(),u=this.target.hide().html()),this.source.attr("name",this.target.attr("name")||this.target.attr("id")),u=n.trim(u),u||(u=" "),this.options.allowSource&&this.tabsbar.append('<div class="tab editor rounded-bottom-7 active">'+r.i18n("Editor")+'<\/div><div class="tab source rounded-bottom-7">'+r.i18n("Source")+'<\/div><div class="clearfix" style="clear:both"/>').children(".tab").click(function(){n(this).hasClass("active")||(r.tabsbar.children(".tab").toggleClass("active"),r.workzone.children().toggle(),n(this).hasClass("editor")?(r.updateEditor(),r.window.focus(),r.ui.update(!0)):(r.updateSource(),r.source.focus(),n.browser.msie||r.source[0].setSelectionRange(0,0),r.ui.disable(),r.statusbar.empty()))}),this.window=this.iframe.contentWindow,this.doc=this.iframe.contentWindow.document,this.$doc=n(this.doc),f='<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',n.each(r.options.cssfiles,function(){f+='<link rel="stylesheet" type="text/css" href="'+this+'" />'}),this.doc.open(),e=this.filter.wysiwyg(u),o=this.rtl?' class="el-rte-rtl"':"",this.doc.write(r.options.doctype+f+"<\/head><body"+o+">"+e+"<\/body><\/html>"),this.doc.close(),n.browser.msie)this.doc.body.contentEditable=!0;else{try{this.doc.designMode="on"}catch(s){}this.doc.execCommand("styleWithCSS",!1,this.options.styleWithCSS)}this.options.height>0&&this.workzone.height(this.options.height),this.options.width>0&&this.editor.width(this.options.width),this.updateHeight(),this.resizable(!0),this.window.focus(),this.history=new this.history(this),this.selection=new this.selection(this),this.ui=new this.ui(this),this.target.parents("form").bind("submit.elfinder",function(){r.source.parents("form").find('[name="el-select"]').remove(),r.beforeSave()}),this.source.bind("keydown",function(t){var r,i,u;t.keyCode==9&&(t.preventDefault(),n.browser.msie?(r=document.selection.createRange(),r.text="\t"+r.text,this.focus()):(i=this.value.substr(0,this.selectionStart),u=this.value.substr(this.selectionEnd),this.value=i+"\t"+u,this.setSelectionRange(i.length+1,i.length+1)))}),n(this.doc.body).bind("dragend",function(){setTimeout(function(){try{r.window.focus();var n=r.selection.getBookmark();r.selection.moveToBookmark(n),r.ui.update()}catch(t){}},200)}),this.typing=!1,this.lastKey=null,this.$doc.bind("mouseup",function(){r.typing=!1,r.lastKey=null,r.ui.update()}).bind("keyup",function(n){(n.keyCode>=8&&n.keyCode<=13||n.keyCode>=32&&n.keyCode<=40||n.keyCode==46||n.keyCode>=96&&n.keyCode<=111)&&r.ui.update()}).bind("keydown",function(t){if((t.metaKey||t.ctrlKey)&&t.keyCode==65)r.ui.update();else if(t.keyCode==13){var i=r.selection.getNode();if(r.dom.selfOrParent(i,/^PRE$/))return r.selection.insertNode(r.doc.createTextNode("\r\n")),!1;if(n.browser.safari&&t.shiftKey)return r.selection.insertNode(r.doc.createElement("br")),!1}return t.keyCode>=48&&t.keyCode<=57||t.keyCode==61||t.keyCode==109||t.keyCode>=65&&t.keyCode<=90||t.keyCode==188||t.keyCode==190||t.keyCode==191||t.keyCode>=219&&t.keyCode<=222?(r.typing||r.history.add(!0),r.typing=!0,r.lastKey=null):(t.keyCode==8||t.keyCode==46||t.keyCode==32||t.keyCode==13)&&(t.keyCode!=r.lastKey&&r.history.add(!0),r.lastKey=t.keyCode,r.typing=!1),t.keyCode==32&&n.browser.opera?(r.selection.insertNode(r.doc.createTextNode(" ")),!1):void 0}).bind("paste",function(t){if(r.options.allowPaste){var i=n(r.dom.create("div"))[0],u=r.doc.createTextNode("_");r.history.add(!0),r.typing=!0,r.lastKey=null,i.appendChild(u),r.selection.deleteContents().insertNode(i),r.selection.select(u),setTimeout(function(){i.parentNode?(n(i).html(r.filter.proccess("paste",n(i).html())),u=i.lastChild,r.dom.unwrap(i),u&&(r.selection.select(u),r.selection.collapse(!1))):(i.parentNode&&i.parentNode.removeChild(i),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(n(r.doc.body).html()))),r.selection.select(r.doc.body.firstChild),r.selection.collapse(!0)),n(r.doc.body).mouseup()},15)}else t.stopPropagation(),t.preventDefault()}),n.browser.msie&&this.$doc.bind("keyup",function(t){t.keyCode==86&&(t.metaKey||t.ctrlKey)&&(r.history.add(!0),r.typing=!0,r.lastKey=null,r.selection.saveIERange(),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(n(r.doc.body).html()))),r.selection.restoreIERange(),n(r.doc.body).mouseup(),this.ui.update())}),n.browser.safari&&this.$doc.bind("click",function(t){n(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl"),t.target.nodeName=="IMG"&&n(t.target).addClass("elrte-webkit-hl")}).bind("keyup",function(){n(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl")}),this.window.focus(),this.destroy=function(){this.updateSource(),this.target.is("textarea")?this.target.val(n.trim(this.source.val())):this.target.html(n.trim(this.source.val())),this.editor.remove(),this.target.show().parents("form").unbind("submit.elfinder")}},elRTE.prototype.i18n=function(n){return this._i18n.translate(n)},elRTE.prototype.open=function(){this.editor.show()},elRTE.prototype.close=function(){this.editor.hide()},elRTE.prototype.updateEditor=function(){this.val(this.source.val())},elRTE.prototype.updateSource=function(){this.source.val(this.filter.source(n(this.doc.body).html()))},elRTE.prototype.val=function(t){if(typeof t=="string")t=""+t,this.source.is(":visible")?this.source.val(this.filter.source2source(t)):n.browser.msie?(this.doc.body.innerHTML="<br />"+this.filter.wysiwyg(t),this.doc.body.removeChild(this.doc.body.firstChild)):this.doc.body.innerHTML=this.filter.wysiwyg(t);else return this.source.is(":visible")?this.filter.source2source(this.source.val()).trim():this.filter.source(n(this.doc.body).html()).trim()},elRTE.prototype.beforeSave=function(){this.source.val(n.trim(this.val())||"")},elRTE.prototype.save=function(){this.beforeSave(),this.editor.parents("form").submit()},elRTE.prototype.log=function(n){window.console&&window.console.log&&window.console.log(n)},elRTE.prototype.i18Messages={},n.fn.elrte=function(n,t){var r=typeof n=="string"?n:"",i;return(this.each(function(){this.elrte||(this.elrte=new elRTE(this,typeof n=="object"?n:{}));switch(r){case"open":case"show":this.elrte.open();break;case"close":case"hide":this.elrte.close();break;case"updateSource":this.elrte.updateSource();break;case"destroy":this.elrte.destroy()}}),r=="val")?this.length?this.length==1?t?this[0].elrte.val(t):this[0].elrte.val():(i={},this.each(function(){i[this.elrte.source.attr("name")]=this.elrte.val()}),i):"":this}}(jQuery),function(n){elRTE.prototype.dom=function(t){this.rte=t;var r=this;this.regExp={textNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TD|TH|TT|VAR)$/,textContainsNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DL|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|OL|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|TT|UL|VAR)$/,block:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|UL)$/,selectionBlock:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TD|TH|TR|UL)$/,header:/^H[1-6]$/,formElement:/^(FORM|INPUT|HIDDEN|TEXTAREA|SELECT|BUTTON)$/},this.root=function(){return this.rte.body},this.create=function(n){return this.rte.doc.createElement(n)},this.createBookmark=function(){var t=this.rte.doc.createElement("span");return t.id="elrte-bm-"+Math.random().toString().substr(2),n(t).addClass("elrtebm elrte-protected"),t},this.indexOf=function(t){var i=0;for(t=n(t);(t=t.prev())&&t.length;)i++;return i},this.attr=function(t,i){var r="";return t.nodeType==1&&(r=n(t).attr(i),r&&i!="src"&&i!="href"&&i!="title"&&i!="alt"&&(r=r.toString().toLowerCase())),r||""},this.findCommonAncestor=function(t,i){var r;if(!t||!i)return this.rte.log("dom.findCommonAncestor invalid arguments");if(t==i)return t;if(t.nodeName=="BODY"||i.nodeName=="BODY")return this.rte.doc.body;var u=n(t).parents(),f=n(i).parents(),e=f.length-1,o=f[e];for(r=u.length-1;r>=0;r--,e--)if(u[r]==f[e])o=u[r];else break;return o},this.isEmpty=function(t){return t.nodeType==1?this.regExp.textNodes.test(t.nodeName)?n.trim(n(t).text()).length==0:!1:t.nodeType==3?/^(TABLE|THEAD|TFOOT|TBODY|TR|UL|OL|DL)$/.test(t.parentNode.nodeName)||t.nodeValue==""||n.trim(t.nodeValue).length==0&&!(t.nextSibling&&t.previousSibling&&t.nextSibling.nodeType==1&&t.previousSibling.nodeType==1&&!this.regExp.block.test(t.nextSibling.nodeName)&&!this.regExp.block.test(t.previousSibling.nodeName)):!0},this.next=function(n){while(n.nextSibling&&(n=n.nextSibling))if(n.nodeType==1||n.nodeType==3&&!this.isEmpty(n))return n;return null},this.prev=function(n){while(n.previousSibling&&(n=n.previousSibling))if(n.nodeType==1||n.nodeType==3&&!this.isEmpty(n))return n;return null},this.isPrev=function(n,t){while(n=this.prev(n))if(n==t)return!0;return!1},this.nextAll=function(n){for(var t=[];n=this.next(n);)t.push(n);return t},this.prevAll=function(n){for(var t=[];n=this.prev(n);)t.push(n);return t},this.toLineEnd=function(n){for(var t=[];(n=this.next(n))&&n.nodeName!="BR"&&n.nodeName!="HR"&&this.isInline(n);)t.push(n);return t},this.toLineStart=function(n){for(var t=[];(n=this.prev(n))&&n.nodeName!="BR"&&n.nodeName!="HR"&&this.isInline(n);)t.unshift(n);return t},this.isFirstNotEmpty=function(t){while(t=this.prev(t))if(t.nodeType==1||t.nodeType==3&&n.trim(t.nodeValue)!="")return!1;return!0},this.isLastNotEmpty=function(n){while(n=this.next(n))if(!this.isEmpty(n))return!1;return!0},this.isOnlyNotEmpty=function(n){return this.isFirstNotEmpty(n)&&this.isLastNotEmpty(n)},this.findLastNotEmpty=function(n){if(this.rte.log("findLastNotEmpty Who is here 0_o"),n.nodeType==1&&(l=n.lastChild)){if(!this.isEmpty(l))return l;while(l.previousSibling&&(l=l.previousSibling))if(!this.isEmpty(l))return l}return!1},this.isInline=function(t){if(t.nodeType==3)return!0;if(t.nodeType==1){t=n(t);var i=t.css("display"),r=t.css("float");return i=="inline"||i=="inline-block"||r=="left"||r=="right"}return!0},this.is=function(n,t){if(n&&n.nodeName){if(typeof t=="string"&&(t=this.regExp[t]||/.?/),t instanceof RegExp&&n.nodeName)return t.test(n.nodeName);if(typeof t=="function")return t(n)}return!1},this.filter=function(n,t){var r=[],i;if(!n.push)return this.is(n,t)?n:null;for(i=0;i<n.length;i++)this.is(n[i],t)&&r.push(n[i]);return r},this.parents=function(n,t){for(var i=[];n&&(n=n.parentNode)&&n.nodeName!="BODY"&&n.nodeName!="HTML";)this.is(n,t)&&i.push(n);return i},this.parent=function(n,t){return this.parents(n,t)[0]||null},this.selfOrParent=function(n,t,i){return this.is(n,t)?n:this.parent(n,i||t)},this.selfOrParentLink=function(n){return n=this.selfOrParent(n,/^A$/),n&&n.href?n:null},this.selfOrParentAnchor=function(n){return n=this.selfOrParent(n,/^A$/),n&&!n.href&&n.name?n:null},this.childLinks=function(t){var i=[];return n("a[href]",t).each(function(){i.push(this)}),i},this.selectionHas=function(n){var t=this.rte.selection.cloneContents(),i;if(t&&t.childNodes&&t.childNodes.length)for(i=0;i<t.childNodes.length;i++)if(typeof n=="function"){if(n(t.childNodes[i]))return!0}else if(t instanceof RegExp&&n.test(t.childNodes[i].nodeName))return!0;return!1},this.wrap=function(t,i){return t=n.isArray(t)?t:[t],i=i.nodeName?i:this.create(i),t[0]&&t[0].nodeType&&t[0].parentNode&&(i=t[0].parentNode.insertBefore(i,t[0]),n(t).each(function(){this!=i&&i.appendChild(this)})),i},this.unwrap=function(n){if(n&&n.parentNode){while(n.firstChild)n.parentNode.insertBefore(n.firstChild,n);n.parentNode.removeChild(n)}},this.wrapContents=function(n,t){t=t.nodeName?t:this.create(t);for(var i=0;i<n.childNodes.length;i++)t.appendChild(n.childNodes[i]);return n.appendChild(t),t},this.cleanNode=function(t){if(t.nodeType==1){if(/^(P|LI)$/.test(t.nodeName)&&(l=this.findLastNotEmpty(t))&&l.nodeName=="BR"&&n(l).remove(),$n=n(t),$n.children().each(function(){this.cleanNode(this)}),t.nodeName!="BODY"&&!/^(TABLE|TR|TD)$/.test(t)&&this.isEmpty(t))return $n.remove();$n.attr("style")===""&&$n.removeAttr("style"),this.rte.browser.safari&&$n.hasClass("Apple-span")&&$n.removeClass("Apple-span"),t.nodeName!="SPAN"||$n.attr("style")||$n.attr("class")||$n.attr("id")||$n.replaceWith($n.html())}},this.cleanChildNodes=function(t){var i=this.cleanNode;n(t).children().each(function(){i(this)})},this.tableMatrix=function(t){var i=[],r;if(t&&t.nodeName=="TABLE"){r=0;function u(n){for(var t=0;t<=r;t++)if(!i[n][t])return t}n(t).find("tr").each(function(t){n.isArray(i[t])||(i[t]=[]),n(this).children("td,th").each(function(){for(var h=parseInt(n(this).attr("colspan")||1),c=parseInt(n(this).attr("rowspan")||1),l=u(t),e,o,s,f=0;f<c;f++)for(e=0;e<h;e++)o=t+f,n.isArray(i[o])||(i[o]=[]),s=e==0&&f==0?this:f==0?e:"-",i[o][l+e]=s;r=Math.max(r,i[t].length)})})}return i},this.indexesOfCell=function(n,t){for(var r,i=0;i<t.length;i++)for(r=0;r<t[i].length;r++)if(t[i][r]==n)return[i,r]},this.fixTable=function(t){var r,f,s,h;if(t&&t.nodeName=="TABLE"){var e=n(t),o=this.tableMatrix(t),u=0;if(n.each(o,function(){u=Math.max(u,this.length)}),u==0)return e.remove();for(r=0;r<o.length;r++)if(f=o[r].length,f==0)e.find("tr").eq(r).remove();else if(f<u)for(s=u-f,h=e.find("tr").eq(r),i=0;i<s;i++)h.append("<td>&nbsp;<\/td>")}},this.tableColumn=function(n,t,i){var h,u,c,f,o,r,s,e;if(n=this.selfOrParent(n,/^TD|TH$/),h=this.selfOrParent(n,/^TABLE$/),ret=[],info={offset:[],delta:[]},n&&h){for(i&&this.fixTable(h),u=this.tableMatrix(h),c=!1,r=0;r<u.length;r++){for(o=0;o<u[r].length;o++)if(u[r][o]==n){f=o,c=!0;break}if(c)break}if(f>=0)for(r=0;r<u.length;r++)s=u[r][f]||null,s&&(s.nodeName?(ret.push(s),t&&(info.delta.push(0),info.offset.push(f))):(e=parseInt(s),!isNaN(e)&&u[r][f-e]&&u[r][f-e].nodeName&&(ret.push(u[r][f-e]),t&&(info.delta.push(e),info.offset.push(f)))))}return t?{column:ret,info:info}:ret}}}(jQuery),function(n){elRTE.prototype.filter=function(t){var i=this,r=n("<span/>").addClass("elrtetesturl").appendTo(document.body)[0];this.url=(typeof r.currentStyle!="undefined"?r.currentStyle.backgroundImage:document.defaultView.getComputedStyle(r,null).backgroundImage).replace(/^url\((['"]?)([\s\S]+\/)[\s\S]+\1\)$/i,"$2"),n(r).remove(),this.rte=t,this.xhtml=/xhtml/i.test(t.options.doctype),this.boolAttrs=t.utils.makeObject("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected".split(",")),this.tagRegExp=/<(\/?)([\w:]+)((?:\s+[a-z\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.openTagRegExp=/<([\w:]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.attrRegExp=/(\w+)(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^\s]+))?/g,this.scriptRegExp=/<script([^>]*)>([\s\S]*?)<\/script>/gi,this.styleRegExp=/(<style([^>]*)>[\s\S]*?<\/style>)/gi,this.linkRegExp=/(<link([^>]+)>)/gi,this.cdataRegExp=/<!\[CDATA\[([\s\S]+)\]\]>/g,this.objRegExp=/<object([^>]*)>([\s\S]*?)<\/object>/gi,this.embRegExp=/<(embed)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.paramRegExp=/<(param)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.iframeRegExp=/<iframe([^>]*)>([\s\S]*?)<\/iframe>/gi,this.yMapsRegExp=/<div\s+([^>]*id\s*=\s*('|")?YMapsID[^>]*)>/gi,this.gMapsRegExp=/<iframe\s+([^>]*src\s*=\s*"http:\/\/maps\.google\.\w+[^>]*)>([\s\S]*?)<\/iframe>/gi,this.videoHostRegExp=/^(http:\/\/[\w\.]*)?(youtube|vimeo|rutube).*/i,this.serviceClassRegExp=/<(\w+)([^>]*class\s*=\s*"[^>]*elrte-[^>]*)>\s*(<\/\1>)?/gi,this.pagebreakRegExp=/<(\w+)([^>]*style\s*=\s*"[^>]*page-break[^>]*)>\s*(<\/\1>)?/gi,this.pbRegExp=new RegExp("<!-- pagebreak -->","gi"),this.allowTags=t.options.allowTags.length?t.utils.makeObject(t.options.allowTags):null,this.denyTags=t.options.denyTags.length?t.utils.makeObject(t.options.denyTags):null,this.denyAttr=t.options.denyAttr?t.utils.makeObject(t.options.denyAttr):null,this.pasteDenyAttr=t.options.pasteDenyAttr?t.utils.makeObject(t.options.pasteDenyAttr):null,this.fontSize=["medium","xx-small","small","medium","large","x-large","xx-large"],this.fontFamily={"sans-serif":/^(arial|tahoma|verdana)$/i,serif:/^(times|times new roman)$/i,monospace:/^courier$/i},this.scripts={},this._chains={},n.each(this.chains,function(t){i._chains[t]=[],n.each(this,function(n,r){typeof i.rules[r]=="function"&&i._chains[t].push(i.rules[r])})}),this.proccess=function(t,r){return r=n.trim(r).replace(/^\s*(&nbsp;)+/gi,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""),n.each(this._chains[t]||[],function(){r=this.call(i,r)}),r=r.replace(/\t/g,"  ").replace(/\r/g,"").replace(/\s*\n\s*\n+/g,"\n")+"  ",n.trim(r)?r:" "},this.wysiwyg=function(n){return this.proccess("wysiwyg",n)},this.source=function(n){return this.proccess("source",n)},this.source2source=function(n){return this.proccess("source2source",n)},this.wysiwyg2wysiwyg=function(n){return this.proccess("wysiwyg2wysiwyg",n)},this.parseAttrs=function(t){var i={},o=this.boolAttrs,e=t.match(this.attrRegExp),r,u,f;return e&&n.each(e,function(t,e){r=e.split("="),u=n.trim(r[0]).toLowerCase(),r.length>2?(r.shift(),f=r.join("=")):f=o[u]||r[1]||"",i[u]=n.trim(f).replace(/^('|")(.*)(\1)$/,"$2")}),i.style=this.rte.utils.parseStyle(i.style),i["class"]=this.rte.utils.parseClass(i["class"]||""),i},this.serializeAttrs=function(t,i){var r=[],u=this;return n.each(t,function(n,t){n=="style"?t=u.rte.utils.serializeStyle(t,i):n=="class"&&(t=u.rte.utils.serializeClass(t)),t&&r.push(n+'="'+t+'"')}),r.join(" ")},this.cleanAttrs=function(t,i){function r(n){return n+(/\d$/.test(n)?"px":"")}var f=this,u=this.replaceAttrs;return n.each(t["class"],function(n){/^(Apple-style-span|mso\w+)$/i.test(n)&&delete t["class"][n]}),n.each(t,function(e,o){u[e]&&u[e].call(f,t,i),e=="style"&&n.each(o,function(n,i){switch(n){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":t.style[n.replace(/^mso-|-alt$/g,"")]=r(i),delete t.style[n];break;case"horiz-align":t.style["text-align"]=i,delete t.style[n];break;case"vert-align":t.style["vertical-align"]=i,delete t.style[n];break;case"font-color":case"mso-foreground":t.style.color=i,delete t.style[n];break;case"mso-background":case"mso-highlight":t.style.background=i,delete t.style[n];break;case"mso-default-height":t.style["min-height"]=r(i),delete t.style[n];break;case"mso-default-width":t.style["min-width"]=r(i),delete t.style[n];break;case"mso-padding-between-alt":t.style["border-collapse"]="separate",t.style["border-spacing"]=r(i),delete t.style[n];break;case"text-line-through":i.match(/(single|double)/i)&&(t.style["text-decoration"]="line-through"),delete t.style[n];break;case"mso-zero-height":i=="yes"&&(t.style.display="none"),delete t.style[n];break;case"font-weight":i==700&&(t.style["font-weight"]="bold");break;default:n.match(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/)&&delete t.style[n]}})}),t}},elRTE.prototype.filter.prototype.replaceTags={b:{tag:"strong"},big:{tag:"span",style:{"font-size":"large"}},center:{tag:"div",style:{"text-align":"center"}},i:{tag:"em"},font:{tag:"span"},nobr:{tag:"span",style:{"white-space":"nowrap"}},menu:{tag:"ul"},plaintext:{tag:"pre"},s:{tag:"strike"},small:{tag:"span",style:{"font-size":"small"}},u:{tag:"span",style:{"text-decoration":"underline"}},xmp:{tag:"pre"}},elRTE.prototype.filter.prototype.replaceAttrs={align:function(n,t){switch(t){case"img":n.style[n.align.match(/(left|right)/)?"float":"vertical-align"]=n.align;break;case"table":n.align=="center"?n.style["margin-left"]=n.style["margin-right"]="auto":n.style.float=n.align;break;default:n.style["text-align"]=n.align}delete n.align},border:function(n){n.style["border-width"]||(n.style["border-width"]=(parseInt(n.border)||1)+"px"),n.style["border-style"]||(n.style["border-style"]="solid"),delete n.border},bordercolor:function(n){n.style["border-color"]||(n.style["border-color"]=n.bordercolor),delete n.bordercolor},background:function(n){n.style["background-image"]||(n.style["background-image"]="url("+n.background+")"),delete n.background},bgcolor:function(n){n.style["background-color"]||(n.style["background-color"]=n.bgcolor),delete n.bgcolor},clear:function(n){n.style.clear=n.clear=="all"?"both":n.clear,delete n.clear},color:function(n){n.style.color||(n.style.color=n.color),delete n.color},face:function(t){var i=t.face.toLowerCase();n.each(this.fontFamily,function(n,r){i.match(r)&&(t.style["font-family"]=i+","+n)}),delete t.face},hspace:function(n,t){if(t=="img"){var i=parseInt(n.hspace)||0;n.style["margin-left"]||(n.style["margin-left"]=i+"px"),n.style["margin-right"]||(n.style["margin-right"]=i+"px"),delete n.hspace}},size:function(n,t){t!="input"&&(n.style["font-size"]=this.fontSize[parseInt(n.size)||0]||"medium",delete n.size)},valign:function(n){n.style["vertical-align"]||(n.style["vertical-align"]=n.valign),delete n.valign},vspace:function(n,t){if(t=="img"){var i=parseInt(n.vspace)||0;n.style["margin-top"]||(n.style["margin-top"]=i+"px"),n.style["margin-bottom"]||(n.style["margin-bottom"]=i+"px"),delete n.hspace}}},elRTE.prototype.filter.prototype.rules={allowedTags:function(n){var t=this.allowTags;return t?n.replace(this.tagRegExp,function(n,i,r){return t[r.toLowerCase()]?n:""}):n},deniedTags:function(n){var t=this.denyTags;return t?n.replace(this.tagRegExp,function(n,i,r){return t[r.toLowerCase()]?"":n}):n},clean:function(t){var i=this,r=this.replaceTags,e=this.replaceAttrs,f=this.denyAttr,u;return t=t.replace(/<!DOCTYPE([\s\S]*)>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1<\/strong><\/p>").replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s&nbsp;]*)<\/span>/gi,"$1").replace(/(<p[^>]*>\s*<\/p>|<p[^>]*\/>)/gi,"<br>").replace(/(<\/p>)(?:\s*<br\s*\/?>\s*|\s*&nbsp;\s*)+\s*(<p[^>]*>)/gi,function(n,t,i){return t+"\n"+i}).replace(this.tagRegExp,function(t,u,e,o){return(e=e.toLowerCase(),u)?"<\/"+(r[e]?r[e].tag:e)+">":(o=i.cleanAttrs(i.parseAttrs(o||""),e),r[e]&&(r[e].style&&n.extend(o.style,r[e].style),e=r[e].tag),f&&n.each(o,function(n){f[n]&&delete o[n]}),o=i.serializeAttrs(o),"<"+e+(o?" ":"")+o+">")}),u=n("<div>"+t+"<\/div>"),u.find("span:not([id]):not([class])").each(function(){var t=n(this);t.attr("style")||(n.trim(t.html()).length?i.rte.dom.unwrap(this):t.remove())}).end().find("span span:only-child").each(function(){var r=n(this),t=r.parent().eq(0),o=r.attr("id"),s=t.attr("id"),u,f,e;!i.rte.dom.isOnlyNotEmpty(this)||o&&s||(e=n.trim(t.attr("class")+" "+r.attr("class")),e&&t.attr("class",e),f=i.rte.utils.serializeStyle(n.extend(i.rte.utils.parseStyle(n(this).attr("style")||""),i.rte.utils.parseStyle(n(t).attr("style")||""))),f&&t.attr("style",f),u=o||s,u&&t.attr("id",u),this.firstChild?n(this.firstChild).unwrap():r.remove())}).end().find("a[name]").each(function(){n(this).addClass("elrte-protected elrte-anchor")}),u.html()},cleanPaste:function(t){var i=this,r=this.pasteDenyAttr;return t=t.replace(this.scriptRegExp,"").replace(this.styleRegExp,"").replace(this.linkRegExp,"").replace(this.cdataRegExp,"").replace(/\<\!--[\s\S]*?--\>/g,""),this.rte.options.pasteOnlyText?t=t.replace(this.tagRegExp,function(n,t,i){return/br/i.test(i)||t&&/h[1-6]|p|ol|ul|li|div|blockquote|tr/i?"<br>":""}).replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""):r&&(t=t.replace(this.openTagRegExp,function(t,u,f){return f=i.parseAttrs(f),n.each(f,function(n){r[n]&&delete f[n]}),f=i.serializeAttrs(f,!0),"<"+u+(f?" ":"")+f+">"})),t},replace:function(t){function e(n,t){function c(){if(n.embed&&n.embed.src)return n.embed.src;if(n.params&&n.params.length)for(u=n.params.length;u--;)if(n.params[u].name=="src"||n.params[u].name=="movie")return n.params[u].value}var r=c(),o=r&&i.videoHostRegExp.test(r)?r.replace(i.videoHostRegExp,"$2"):t.replace(/^\w+\/(.+)/,"$1"),s=parseInt((n.obj?n.obj.width||n.obj.style.width:0)||(n.embed?n.embed.width||n.embed.style.width:0))||150,h=parseInt((n.obj?n.obj.height||n.obj.style.height:0)||(n.embed?n.embed.height||n.embed.style.height:0))||100,f="media"+Math.random().toString().substring(2),e="",u;return n.obj&&n.obj.style&&n.obj.style.float&&(e=' style="float:'+n.obj.style.float+'"'),i.scripts[f]=n,'<img src="'+i.url+'pixel.gif" class="elrte-media elrte-media-'+o+' elrte-protected" title="'+(r?i.rte.utils.encode(r):"")+'" rel="'+f+'" width="'+s+'" height="'+h+'"'+e+">"}var i=this,c=this.rte.options.replace||[],u,f;if(c.length&&n.each(c,function(n,r){typeof r=="function"&&(t=r.call(i,t))}),t=t.replace(this.styleRegExp,"<!-- ELRTE_COMMENT$1 -->").replace(this.linkRegExp,"<!-- ELRTE_COMMENT$1-->").replace(this.cdataRegExp,"<!--[CDATA[$1]]-->").replace(this.scriptRegExp,function(n,t,r){var u;return i.denyTags.script?"":(u="script"+Math.random().toString().substring(2),t=i.parseAttrs(t),t.type||(t.type="text/javascript"),i.scripts[u]="<script "+i.serializeAttrs(t)+">"+r+"<\/script>","<!-- ELRTE_SCRIPT:"+u+" -->")}).replace(this.yMapsRegExp,function(n,t){return t=i.parseAttrs(t),t["class"]["elrte-yandex-maps"]="elrte-yandex-maps",t["class"]["elrte-protected"]="elrte-protected","<div "+i.serializeAttrs(t)+">"}).replace(this.gMapsRegExp,function(n,t){var r="gmaps"+Math.random().toString().substring(2),u,f;return t=i.parseAttrs(t),u=parseInt(t.width||t.style.width||100),f=parseInt(t.height||t.style.height||100),i.scripts[r]=n,'<img src="'+i.url+'pixel.gif" class="elrte-google-maps elrte-protected" id="'+r+'" style="width:'+u+"px;height:"+f+'px">'}).replace(this.objRegExp,function(t,r,u){var o=u.match(i.embRegExp),f={obj:i.parseAttrs(r),embed:o&&o.length?i.parseAttrs(o[0].substring(7)):null,params:[]},s=i.rte.utils.mediaInfo(f.embed?f.embed.type||"":"",f.obj.classid||"");return s?((o=u.match(i.paramRegExp))&&n.each(o,function(n,t){f.params.push(i.parseAttrs(t.substring(6)))}),f.obj.classid||(f.obj.classid=s.classid[0]),f.obj.codebase||(f.obj.codebase=s.codebase),f.embed&&!f.embed.type&&(f.embed.type=s.type),f.obj.width=="1"&&delete f.obj.width,f.obj.height=="1"&&delete f.obj.height,f.embed&&(f.embed.width=="1"&&delete f.embed.width,f.embed.height=="1"&&delete f.embed.height),e(f,s.type)):t}).replace(this.embRegExp,function(n,t,r){var r=i.parseAttrs(r),u=i.rte.utils.mediaInfo(r.type||"");return r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,u?e({embed:r},u.type):n}).replace(this.iframeRegExp,function(n,t){var t=i.parseAttrs(t),u=t.style.width||(parseInt(t.width)>1?parseInt(t.width)+"px":"100px"),f=t.style.height||(parseInt(t.height)>1?parseInt(t.height)+"px":"100px"),r="iframe"+Math.random().toString().substring(2);return i.scripts[r]=n,'<img id="'+r+'" src="'+i.url+'pixel.gif" class="elrte-protected elrte-iframe" style="width:'+u+"; height:"+f+'">'}).replace(this.vimeoRegExp,function(n,t,r){return r=i.parseAttrs(r),delete r.frameborder,r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,r.type="application/x-shockwave-flash",e({embed:r},"application/x-shockwave-flash")}).replace(/<\/(embed|param)>/gi,"").replace(this.pbRegExp,function(){return'<img src="'+i.url+'pixel.gif" class="elrte-protected elrte-pagebreak">'}),u=n("<div>"+t+"<\/div>"),!this.rte.options.allowTextNodes){var o=this.rte.dom,s=[],r=[];if(n.browser.msie)for(f=0;f<u[0].childNodes.length;f++)s.push(u[0].childNodes[f]);else s=Array.prototype.slice.call(u[0].childNodes);function h(){r.length&&o.filter(r,"notEmpty").length&&o.wrap(r,document.createElement("p")),r=[]}n.each(s,function(n,t){o.is(t,"block")?h():(r.length&&t.previousSibling!=r[r.length-1]&&h(),r.push(t))}),h()}return u.html()},restore:function(t){var i=this,r=this.rte.options.restore||[];return r.length&&n.each(r,function(n,r){typeof r=="function"&&(t=r.call(i,t))}),t=t.replace(/\<\!--\[CDATA\[([\s\S]*?)\]\]--\>/gi,"<![CDATA[$1]\]>").replace(/\<\!--\s*ELRTE_SCRIPT\:\s*(script\d+)\s*--\>/gi,function(n,t){return i.scripts[t]&&(n=i.scripts[t],delete i.scripts[t]),n||""}).replace(/\<\!-- ELRTE_COMMENT([\s\S]*?) --\>/gi,"$1").replace(this.serviceClassRegExp,function(t,r,u,f){var u=i.parseAttrs(u),e,o="",t;return u["class"]["elrte-google-maps"]?(t="",i.scripts[u.id]&&(t=i.scripts[u.id],delete i.scripts[u.id]),t):u["class"]["elrte-iframe"]?i.scripts[u.id]||"":u["class"].elrtebm?"":u["class"]["elrte-media"]?(e=i.scripts[u.rel]||{},e.params&&n.each(e.params,function(n,t){o+="<param "+i.serializeAttrs(t)+">\n"}),e.embed&&(o+="<embed "+i.serializeAttrs(e.embed)+">"),e.obj&&(o="<object "+i.serializeAttrs(e.obj)+">\n"+o+"\n<\/object>\n"),o||t):u["class"]["elrte-pagebreak"]?"<!-- pagebreak -->":(n.each(u["class"],function(n){/^elrte-\w+/i.test(n)&&delete u["class"][n]}),"<"+r+" "+i.serializeAttrs(u)+">"+(f||""))})},compactStyles:function(n){var t=this;return n.replace(this.tagRegExp,function(n,i,r,u){return u=!i&&u?t.serializeAttrs(t.parseAttrs(u),!0):"","<"+i+r.toLowerCase()+(u?" ":"")+u+">"})},xhtmlTags:function(n){return this.xhtml?n.replace(/<(img|hr|br|embed|param|link|area)([^>]*\/*)>/gi,"<$1$2 />"):n}},elRTE.prototype.filter.prototype.chains={wysiwyg:["replace","clean","allowedTags","deniedTags","compactStyles"],source:["clean","allowedTags","restore","compactStyles","xhtmlTags"],paste:["clean","allowedTags","cleanPaste","replace","deniedTags","compactStyles"],wysiwyg2wysiwyg:["clean","allowedTags","restore","replace","deniedTags","compactStyles"],source2source:["clean","allowedTags","replace","deniedTags","restore","compactStyles","xhtmlTags"]}}(jQuery),function(n){elRTE.prototype.history=function(t){this.rte=t,this._prev=[],this._next=[],this.add=function(){this.rte.options.historyLength>0&&this._prev.length>=this.rte.options.historyLength&&this._prev.slice(this.rte.options.historyLength);var t=this.rte.selection.getBookmark();this._prev.push([n(this.rte.doc.body).html(),t]),this.rte.selection.moveToBookmark(t),this._next=[]},this.back=function(){if(this._prev.length){var i=this.rte.selection.getBookmark(),t=this._prev.pop();this._next.push([n(this.rte.doc.body).html(),i]),n(this.rte.doc.body).html(t[0]),this.rte.selection.moveToBookmark(t[1])}},this.fwd=function(){if(this._next.length){var i=this.rte.selection.getBookmark(),t=this._next.pop();this._prev.push([n(this.rte.doc.body).html(),i]),n(this.rte.doc.body).html(t[0]),this.rte.selection.moveToBookmark(t[1])}},this.canBack=function(){return this._prev.length},this.canFwd=function(){return this._next.length}}}(jQuery),function(){elRTE.prototype.options={doctype:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">',cssClass:"el-rte",cssfiles:[],height:null,resizable:!0,lang:"en",toolbar:"normal",absoluteURLs:!0,allowSource:!0,stripWhiteSpace:!0,styleWithCSS:!1,fmAllow:!0,fmOpen:null,allowTags:[],denyTags:["applet","base","basefont","bgsound","blink","body","col","colgroup","isindex","frameset","html","head","meta","marquee","noframes","noembed","o:p","title","xml"],denyAttr:[],pasteDenyAttr:["id","name","class","style","language","onclick","ondblclick","onhover","onkeup","onkeydown","onkeypress"],allowTextNodes:!0,allowBrowsersSpecStyles:!1,allowPaste:!0,pasteOnlyText:!1,replace:[],restore:[],pagebreak:'<div style="page-break-after: always;"><\/div>',buttons:{save:"Save",copy:"Copy",cut:"Cut",css:"Css style and class",paste:"Paste",pastetext:"Paste only text",pasteformattext:"Paste formatted text",removeformat:"Clean format",undo:"Undo last action",redo:"Redo previous action",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyleft:"Align left",justifyright:"Ailgn right",justifycenter:"Align center",justifyfull:"Align full",indent:"Indent",outdent:"Outdent",rtl:"Right to left",ltr:"Left to right",forecolor:"Font color",hilitecolor:"Background color",formatblock:"Format",fontsize:"Font size",fontname:"Font",insertorderedlist:"Ordered list",insertunorderedlist:"Unordered list",horizontalrule:"Horizontal rule",blockquote:"Blockquote",div:"Block element (DIV)",link:"Link",unlink:"Delete link",anchor:"Bookmark",image:"Image",pagebreak:"Page break",smiley:"Smiley",flash:"Flash",table:"Table",tablerm:"Delete table",tableprops:"Table properties",tbcellprops:"Table cell properties",tbrowbefore:"Insert row before",tbrowafter:"Insert row after",tbrowrm:"Delete row",tbcolbefore:"Insert column before",tbcolafter:"Insert column after",tbcolrm:"Delete column",tbcellsmerge:"Merge table cells",tbcellsplit:"Split table cell",docstructure:"Toggle display document structure",elfinder:"Open file manager",fullscreen:"Toggle full screen mode",nbsp:"Non breakable space",stopfloat:"Stop element floating",about:"About this software"},panels:{eol:[],save:["save"],copypaste:["copy","cut","paste","pastetext","pasteformattext","removeformat","docstructure"],undoredo:["undo","redo"],style:["bold","italic","underline","strikethrough","subscript","superscript"],colors:["forecolor","hilitecolor"],alignment:["justifyleft","justifycenter","justifyright","justifyfull"],indent:["outdent","indent"],format:["formatblock","fontsize","fontname"],lists:["insertorderedlist","insertunorderedlist"],elements:["horizontalrule","blockquote","div","stopfloat","css","nbsp","smiley","pagebreak"],direction:["ltr","rtl"],links:["link","unlink","anchor"],images:["image"],media:["image","flash"],tables:["table","tableprops","tablerm","tbrowbefore","tbrowafter","tbrowrm","tbcolbefore","tbcolafter","tbcolrm","tbcellprops","tbcellsmerge","tbcellsplit"],elfinder:["elfinder"],fullscreen:["fullscreen","about"]},toolbars:{tiny:["style"],compact:["save","undoredo","style","alignment","lists","links","fullscreen"],normal:["save","copypaste","undoredo","style","alignment","colors","indent","lists","links","elements","images","fullscreen"],complete:["save","copypaste","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","fullscreen"],maxi:["save","copypaste","undoredo","elfinder","style","alignment","direction","colors","format","indent","lists","links","elements","media","tables","fullscreen"],eldorado:["save","copypaste","elfinder","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"]},panelNames:{save:"Save",copypaste:"Copy/Pase",undoredo:"Undo/Redo",style:"Text styles",colors:"Colors",alignment:"Alignment",indent:"Indent/Outdent",format:"Text format",lists:"Lists",elements:"Misc elements",direction:"Script direction",links:"Links",images:"Images",media:"Media",tables:"Tables",elfinder:"File manager (elFinder)"}}}(jQuery),function(n){elRTE.prototype.selection=function(t){function u(){return i.rte.window.getSelection?i.rte.window.getSelection():i.rte.window.document.selection}function s(n,t,r){while(n.nodeName!="BODY"&&n.parentNode&&n.parentNode.nodeName!="BODY"&&(t?n!==t&&n.parentNode!=t:1)&&(r=="left"&&i.rte.dom.isFirstNotEmpty(n)||r=="right"&&i.rte.dom.isLastNotEmpty(n)||i.rte.dom.isFirstNotEmpty(n)&&i.rte.dom.isLastNotEmpty(n)))n=n.parentNode;return n}var i,f,r,e,o;this.rte=t,i=this,this.w3cRange=null,n(this.rte.doc).keyup(function(n){(n.ctrlKey||n.metaKey||n.keyCode>=8&&n.keyCode<=13||n.keyCode>=32&&n.keyCode<=40||n.keyCode==46||n.keyCode>=96&&n.keyCode<=111)&&i.cleanCache()}).mousedown(function(n){f=n.target.nodeName=="HTML"?i.rte.doc.body:n.target,r=e=null}).mouseup(function(n){r=n.target.nodeName=="HTML"?i.rte.doc.body:n.target,r=n.target,e=null}).click(),this.collapsed=function(){return this.getRangeAt().isCollapsed()},this.collapse=function(t){var i=u(),r=this.getRangeAt();return r.collapse(t?!0:!1),n.browser.msie||(i.removeAllRanges(),i.addRange(r)),this},this.getRangeAt=function(n){if(this.rte.browser.msie)return this.w3cRange||(this.w3cRange=new this.rte.w3cRange(this.rte)),n&&this.w3cRange.update(),this.w3cRange;var i=u(),t=i.rangeCount>0?i.getRangeAt(0):this.rte.doc.createRange();return t.getStart=function(){return this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(this.startOffset,this.startContainer.childNodes.length-1)]:this.startContainer},t.getEnd=function(){return this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(this.startOffset==this.endOffset?this.endOffset:this.endOffset-1,this.endContainer.childNodes.length-1)]:this.endContainer},t.isCollapsed=function(){return this.collapsed},t},this.saveIERange=function(){n.browser.msie&&(o=this.getRangeAt().getBookmark())},this.restoreIERange=function(){n.browser.msie&&o&&this.getRangeAt().moveToBookmark(o)},this.cloneContents=function(){var i=this.rte.dom.create("div"),r,u,t;if(n.browser.msie){try{r=this.rte.window.document.selection.createRange()}catch(f){r=this.rte.doc.body.createTextRange()}n(i).html(r.htmlText)}else for(u=this.getRangeAt().cloneContents(),t=0;t<u.childNodes.length;t++)i.appendChild(u.childNodes[t].cloneNode(!0));return i},this.select=function(n,t){var r,i;if(t=t||n,this.rte.browser.msie){var i=this.rte.doc.body.createTextRange(),f=i.duplicate(),e=i.duplicate();f.moveToElementText(n),e.moveToElementText(t),i.setEndPoint("StartToStart",f),i.setEndPoint("EndToEnd",e),i.select()}else r=u(),i=this.getRangeAt(),i.setStartBefore(n),i.setEndAfter(t),r.removeAllRanges(),r.addRange(i);return this.cleanCache()},this.selectContents=function(n){var t=this.getRangeAt(),i;if(n&&n.nodeType==1)if(this.rte.browser.msie)t.range(),t.r.moveToElementText(n.parentNode),t.r.select();else{try{t.selectNodeContents(n)}catch(r){return this.rte.log("unable select node contents "+n)}i=u(),i.removeAllRanges(),i.addRange(t)}return this},this.deleteContents=function(){return n.browser.msie||this.getRangeAt().deleteContents(),this},this.insertNode=function(t,i){var e,r,f;return i&&!this.collapsed()&&this.collapse(),this.rte.browser.msie?(e=t.nodeType==3?t.nodeValue:n(this.rte.dom.create("span")).append(n(t)).html(),r=this.getRangeAt(),r.insertNode(e)):(r=this.getRangeAt(),r.insertNode(t),r.setStartAfter(t),r.setEndAfter(t),f=u(),f.removeAllRanges(),f.addRange(r)),this.cleanCache()},this.insertHtml=function(t,i){if(i&&!this.collapsed()&&this.collapse(),this.rte.browser.msie)this.getRangeAt().range().pasteHTML(t);else{var r=n(this.rte.dom.create("span")).html(t||"").get(0);this.insertNode(r),n(r).replaceWith(n(r).html())}return this.cleanCache()},this.insertText=function(n){var t=this.rte.doc.createTextNode(n);return this.insertHtml(t.nodeValue)},this.getBookmark=function(){var i,r,o,s,f,e,c,h,t;if(this.rte.window.focus(),f=this.rte.dom.createBookmark(),e=this.rte.dom.createBookmark(),n.browser.msie){try{t=this.rte.window.document.selection.createRange()}catch(e){t=this.rte.doc.body.createTextRange()}t.item&&(c=t.item(0),t=this.rte.doc.body.createTextRange(),t.moveToElementText(c)),i=t.duplicate(),r=t.duplicate(),o=this.rte.dom.create("span"),s=this.rte.dom.create("span"),o.appendChild(f),s.appendChild(e),i.collapse(!0),i.pasteHTML(o.innerHTML),r.collapse(!1),r.pasteHTML(s.innerHTML)}else h=u(),t=h.rangeCount>0?h.getRangeAt(0):this.rte.doc.createRange(),i=t.cloneRange(),r=t.cloneRange(),r.collapse(!1),r.insertNode(e),i.collapse(!0),i.insertNode(f),this.select(f,e);return[f.id,e.id]},this.moveToBookmark=function(t){if(this.rte.window.focus(),t&&t.length==2){var i=this.rte.doc.getElementById(t[0]),r=this.rte.doc.getElementById(t[1]),f,e;i&&r&&(this.select(i,r),this.rte.dom.next(i)==r&&this.collapse(!0),n.browser.msie||(f=u(),e=f.rangeCount>0?f.getRangeAt(0):this.rte.doc.createRange(),f.removeAllRanges(),f.addRange(e)),i.parentNode.removeChild(i),r.parentNode.removeChild(r))}return this},this.removeBookmark=function(n){if(this.rte.window.focus(),n.length==2){var t=this.rte.doc.getElementById(n[0]),i=this.rte.doc.getElementById(n[1]);t&&i&&(t.parentNode.removeChild(t),i.parentNode.removeChild(i))}},this.cleanCache=function(){return f=r=e=null,this},this.getStart=function(){if(!f){var n=this.getRangeAt();f=n.getStart()}return f},this.getEnd=function(){if(!r){var n=this.getRangeAt();r=n.getEnd()}return r},this.getNode=function(){return e||(e=this.rte.dom.findCommonAncestor(this.getStart(),this.getEnd())),e},this.selected=function(t){function a(){function t(){for(var t=0;t<o.length;t++)if(o[t].nodeType==1&&(i.rte.dom.selfOrParent(o[t],/^P$/)||n(o[t]).find("p").length>0))return!1;return!0}if(o.length>0){var r=u.tag=="p"&&!t()?"div":u.tag,e=i.rte.dom.wrap(o,r);f[h]=e,h=null,o=[]}}function l(t){var e,t,r;if(t.nodeType==1)if(/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(t.nodeName))n(t).find("td,th").each(function(){var t=u.tag=="p"&&n(this).find("p").length>0?"div":u.tag,r=i.rte.dom.wrapContents(this,t);return f.push(r)});else if(/^(CAPTION|TD|TH|LI|DT|DD)$/.test(t.nodeName))return e=u.tag=="p"&&n(t).find("p").length>0?"div":u.tag,t=i.rte.dom.wrapContents(t,e),f.push(t);r=o.length>0?o[o.length-1]:null,r&&r!=i.rte.dom.prev(t)&&a(),o.push(t),h===null&&(h=f.length,f.push("dummy"))}var u={collapsed:!1,blocks:!1,filter:!1,wrap:"text",tag:"span"},c,s,r;if(u=n.extend({},u,t),u.blocks&&(r=this.getNode(),c=null,c=this.rte.dom.selfOrParent(r,"selectionBlock")))return[c];var e=this.selectedRaw(u.collapsed,u.blocks),f=[],o=[],h=null;if(e.nodes.length>0){for(s=0;s<e.nodes.length;s++){r=e.nodes[s],r.nodeType==3&&(s==0||s==e.nodes.length-1)&&n.trim(r.nodeValue).length>0&&(s==0&&e.so>0&&(r=r.splitText(e.so)),s==e.nodes.length-1&&e.eo>0&&r.splitText(s==0&&e.so>0?e.eo-e.so:e.eo));switch(u.wrap){case"text":r.nodeType==1&&r.nodeName=="BR"||r.nodeType==3&&n.trim(r.nodeValue).length>0?l(r):r.nodeType==1&&f.push(r);break;case"inline":this.rte.dom.isInline(r)?l(r):r.nodeType==1&&f.push(r);break;case"all":r.nodeType!=1&&this.rte.dom.isEmpty(r)||l(r);break;default:r.nodeType!=1&&this.rte.dom.isEmpty(r)||f.push(r)}}a()}return f.length&&(this.rte.window.focus(),this.select(f[0],f[f.length-1])),u.filter?this.rte.dom.filter(f,u.filter):f},this.dump=function(n,t,i,r,u){var f=this.getRangeAt();this.rte.log("commonAncestorContainer"),this.rte.log(n||f.commonAncestorContainer),this.rte.log("startContainer"),this.rte.log(t||f.startContainer),this.rte.log("startOffset: "+(r>=0?r:f.startOffset)),this.rte.log("endContainer"),this.rte.log(i||f.endContainer),this.rte.log("endOffset: "+(u>=0?u:f.endOffset))},this.selectedRaw=function(t,r){function b(t,i,r){return t.nodeType==3?(r=r>=0?r:t.nodeValue.length,i==0&&r==t.nodeValue.length||n.trim(t.nodeValue).length==n.trim(t.nodeValue.substring(i,r)).length):!0}function k(t,r,u){return t.nodeType==1?i.rte.dom.isEmpty(t):t.nodeType==3?n.trim(t.nodeValue.substring(r||0,u>=0?u:t.nodeValue.length)).length==0:!0}var u={so:null,eo:null,nodes:[]},o=this.getRangeAt(!0),v=o.commonAncestorContainer,f,e,p=!1,w=!1,l,a,h,y,c;if(o.startContainer.nodeType==1?o.startOffset<o.startContainer.childNodes.length?(f=o.startContainer.childNodes[o.startOffset],u.so=f.nodeType==1?null:0):(f=o.startContainer.childNodes[o.startOffset-1],u.so=f.nodeType==1?null:f.nodeValue.length):(f=o.startContainer,u.so=o.startOffset),o.collapsed)return t&&(r?(f=s(f),(!this.rte.dom.isEmpty(f)||(f=this.rte.dom.next(f)))&&(u.nodes=[f]),this.rte.dom.isInline(f)&&(u.nodes=this.rte.dom.toLineStart(f).concat(u.nodes,this.rte.dom.toLineEnd(f))),u.nodes.length>0&&(u.so=u.nodes[0].nodeType==1?null:0,u.eo=u.nodes[u.nodes.length-1].nodeType==1?null:u.nodes[u.nodes.length-1].nodeValue.length)):this.rte.dom.isEmpty(f)||(u.nodes=[f])),u;if(o.endContainer.nodeType==1?(e=o.endContainer.childNodes[o.endOffset-1],u.eo=e.nodeType==1?null:e.nodeValue.length):(e=o.endContainer,u.eo=o.endOffset),(f.nodeType==1||r||b(f,u.so,f.nodeValue.length))&&(f=s(f,v,"left"),p=!0,u.so=f.nodeType==1?null:0),(e.nodeType==1||r||b(e,0,u.eo))&&(e=s(e,v,"right"),w=!0,u.eo=e.nodeType==1?null:e.nodeValue.length),r&&(f.nodeType!=1&&f.parentNode!=v&&f.parentNode.nodeName!="BODY"&&(f=f.parentNode,u.so=null),e.nodeType!=1&&e.parentNode!=v&&e.parentNode.nodeName!="BODY"&&(e=e.parentNode,u.eo=null)),f.parentNode==e.parentNode&&f.parentNode.nodeName!="BODY"&&p&&this.rte.dom.isFirstNotEmpty(f)&&w&&this.rte.dom.isLastNotEmpty(e)&&(f=e=f.parentNode,u.so=f.nodeType==1?null:0,u.eo=e.nodeType==1?null:e.nodeValue.length),f==e)return this.rte.dom.isEmpty(f)||u.nodes.push(f),u;for(l=f;l.nodeName!="BODY"&&l.parentNode!==v&&l.parentNode.nodeName!="BODY";)l=l.parentNode;for(a=e;a.nodeName!="BODY"&&a.parentNode!==v&&a.parentNode.nodeName!="BODY";)a=a.parentNode;for(k(f,u.so,f.nodeType==3?f.nodeValue.length:null)||u.nodes.push(f),h=f;h!==l;){for(c=h;c=this.rte.dom.next(c);)u.nodes.push(c);h=h.parentNode}for(h=l;(h=this.rte.dom.next(h))&&h!=a;)u.nodes.push(h);for(y=[],h=e;h!==a;){for(c=h;c=this.rte.dom.prev(c);)y.push(c);h=h.parentNode}return y.length&&(u.nodes=u.nodes.concat(y.reverse())),k(e,0,e.nodeType==3?u.eo:null)||u.nodes.push(e),r&&(this.rte.dom.isInline(f)&&(u.nodes=this.rte.dom.toLineStart(f).concat(u.nodes),u.so=u.nodes[0].nodeType==1?null:0),this.rte.dom.isInline(e)&&(u.nodes=u.nodes.concat(this.rte.dom.toLineEnd(e)),u.eo=u.nodes[u.nodes.length-1].nodeType==1?null:u.nodes[u.nodes.length-1].nodeValue.length)),u}}}(jQuery),function(n){elRTE.prototype.ui=function(t){this.rte=t,this._buttons=[];var l=this,f=this.rte.options.toolbars[t.options.toolbar&&t.options.toolbars[t.options.toolbar]?t.options.toolbar:"normal"],r=f.length,e,i,o,s,h,c,u;for(u in this.buttons)this.buttons.hasOwnProperty(u)&&u!="button"&&(this.buttons[u].prototype=this.buttons.button.prototype);while(r--){if(first=r==0?!0:!1,f[r-1]=="eol"&&(first=!0),i=f[r],i=="eol"){n(this.rte.doc.createElement("br")).prependTo(this.rte.toolbar);continue}for(e=n('<ul class="panel-'+i+(first?" first":"")+'" />').prependTo(this.rte.toolbar),e.bind("mousedown",function(n){n.preventDefault()}),o=this.rte.options.panels[i].length;o--;)s=this.rte.options.panels[i][o],h=this.buttons[s]||this.buttons.button,this._buttons.push(c=new h(this.rte,s)),e.prepend(c.domElem)}this.update(),this.disable=function(){n.each(l._buttons,function(){this.active||this.domElem.addClass("disabled")})}},elRTE.prototype.ui.prototype.update=function(t){function s(t){var i=t.nodeName.toLowerCase();return t=n(t),i=="img"&&(t.hasClass("elrte-media")?i="media":t.hasClass("elrte-google-maps")?i="google map":t.hasClass("elrte-yandex-maps")?i="yandex map":t.hasClass("elrte-pagebreak")&&(i="pagebreak")),i}t&&this.rte.selection.cleanCache();var i=this.rte.selection.getNode(),r=this.rte.dom.parents(i,"*"),f=this.rte.rtl,o=f?" &laquo; ":" &raquo; ",e="",u;for(i&&i.nodeType==1&&i.nodeName!="BODY"&&r.unshift(i),f||(r=r.reverse()),u=0;u<r.length;u++)e+=(u>0?o:"")+s(r[u]);this.rte.statusbar.html(e),n.each(this._buttons,function(){this.update()}),this.rte.window.focus()},elRTE.prototype.ui.prototype.buttons={button:function(t,i){var r=this;this.rte=t,this.active=!1,this.name=i,this.val=null,this.domElem=n('<li style="-moz-user-select:-moz-none" class="'+i+' rounded-3" name="'+i+'" title="'+this.rte.i18n(this.rte.options.buttons[i]||i)+'" unselectable="on" />').hover(function(){n(this).addClass("hover")},function(){n(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault(),n(this).hasClass("disabled")||r.command(),r.rte.window.focus()})}},elRTE.prototype.ui.prototype.buttons.button.prototype.command=function(){this.rte.history.add();try{this.rte.doc.execCommand(this.name,!1,this.val)}catch(n){return this.rte.log("commands failed: "+this.name)}this.rte.ui.update(!0)},elRTE.prototype.ui.prototype.buttons.button.prototype.update=function(){try{if(this.rte.doc.queryCommandEnabled(this.name))this.domElem.removeClass("disabled");else return this.domElem.addClass("disabled")}catch(n){return}try{this.rte.doc.queryCommandState(this.name)?this.domElem.addClass("active"):this.domElem.removeClass("active")}catch(n){}}}(jQuery),function(n){elRTE.prototype.utils=function(t){this.rte=t,this.url=null,this.reg=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,this.baseURL="",this.path="",this.entities={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},this.entitiesRegExp=/[<>&\"]/g,this.media=[{type:"application/x-shockwave-flash",classid:["clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"},{type:"application/x-director",classid:["clsid:166b1bca-3f9c-11cf-8075-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0"},{type:"application/x-mplayer2",classid:["clsid:6bf52a52-394a-11d3-b153-00c04f79faa6","clsid:22d6f312-b0f6-11d0-94ab-0080c74c7e95","clsid:05589fa1-c356-11ce-bf01-00aa0055595a"],codebase:"http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"},{type:"video/quicktime",classid:["clsid:02bf25d5-8c17-4b23-bc80-d3488abddc6b"],codebase:"http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"},{type:"audio/x-pn-realaudio-plugin",classid:["clsid:cfcdaa03-8be4-11cf-b84b-0020afbbccfa"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"}],this.rgbRegExp=/\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*/i,this.colorsRegExp=/aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\s*\([^\)]+\)/i,this.colors={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#fffffff",yellow:"#ffff00"};var i=this;this.rgb2hex=function(n){return this.color2Hex(""+n)},this.toPixels=function(t){var r=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/),i;if(r&&(t=r[1],unit=r[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t),isNaN(t))return"";i=parseInt(n(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*i);case"pt":return parseInt(t*i/12);case"%":return parseInt(t*i/100)}return t},this.absoluteURL=function(t){if(this.url||this._url(),t=n.trim(t),!t)return"";if(t[0]=="#")return t;var i=this.parseURL(t);return!i.host&&!i.path&&!i.anchor?"":this.rte.options.absoluteURLs?i.protocol?t:i.host&&(i.host.indexOf(".")!=-1||i.host=="localhost")?this.url.protocol+"://"+t:(t[0]=="/"?t=this.baseURL+t:(t.indexOf("./")==0&&(t=t.substring(2)),t=this.baseURL+this.path+t),t):t},this.parseURL=function(t){var r=t.match(this.reg),i={};return n.each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(n){i[this]=r[n]}),i.host.match(/[a-z0-9]/i)||(i.host=""),i},this.trimEventCallback=function(t){return t=t?t.toString():"",n.trim(t.replace(/\r*\n/mg,"").replace(/^function\s*on[a-z]+\s*\(\s*event\s*\)\s*\{(.+)\}$/igm,"$1"))},this._url=function(){this.url=this.parseURL(window.location.href),this.baseURL=this.url.protocol+"://"+(this.url.userInfo?parts.userInfo+"@":"")+this.url.host+(this.url.port?":"+this.url.port:""),this.path=this.url.file?this.url.path.substring(0,this.url.path.length-this.url.file.length):this.url.path},this.makeObject=function(t){var i={};return n.each(t,function(n,t){i[t]=t}),i},this.encode=function(n){var t=this.entities;return(""+n).replace(this.entitiesRegExp,function(n){return t[n]})},this.decode=function(t){return n("<div/>").html(t||"").text()},this.parseStyle=function(t){var f={},e=this.rte.options.allowBrowsersSpecStyles,i,r,u;return typeof t=="string"&&t.length&&n.each(t.replace(/&quot;/gi,"'").split(";"),function(t,o){(u=o.indexOf(":"))!==-1&&(i=n.trim(o.substr(0,u)),r=n.trim(o.substr(u+1)),(i=="color"||i=="background-color")&&(r=r.toLowerCase()),i&&r&&(e||i.substring(0,1)!="-")&&(f[i]=r))}),f},this.compactStyle=function(t){var i=this;return t.border=="medium none"&&delete t.border,n.each(t,function(n,r){/color$/i.test(n)?t[n]=i.color2Hex(r):/^(border|background)$/i.test(n)&&(t[n]=r.replace(i.colorsRegExp,function(n){return i.color2Hex(n)}))}),t["border-width"]&&(t.border=t["border-width"]+" "+(t["border-style"]||"solid")+" "+(t["border-color"]||"#000"),delete t["border-width"],delete t["border-style"],delete t["border-color"]),t["background-image"]&&(t.background=t["background-color"]+" "||""+t["background-image"]+" "+t["background-position"]||"0 0 "+t["background-repeat"]||"repeat",delete t["background-image"],delete["background-image"],delete["background-position"],delete["background-repeat"]),t["margin-top"]&&t["margin-right"]&&t["margin-bottom"]&&t["margin-left"]&&(t.margin=t["margin-top"]+" "+t["margin-right"]+" "+t["margin-bottom"]+" "+t["margin-left"],delete t["margin-top"],delete t["margin-right"],delete t["margin-bottom"],delete t["margin-left"]),t["padding-top"]&&t["padding-right"]&&t["padding-bottom"]&&t["padding-left"]&&(t.padding=t["padding-top"]+" "+t["padding-right"]+" "+t["padding-bottom"]+" "+t["padding-left"],delete t["padding-top"],delete t["padding-right"],delete t["padding-bottom"],delete t["padding-left"]),(t["list-style-type"]||t["list-style-position"]||t["list-style-image"])&&(t["list-style"]=n.trim(t["list-style-type"]||" "+t["list-style-position"]||""+t["list-style-image"]||""),delete t["list-style-type"],delete t["list-style-position"],delete t["list-style-image"]),t},this.serializeStyle=function(t,i){var r=[];return n.each(i?this.compactStyle(t):t,function(n,t){t&&r.push(n+":"+t)}),r.join(";")},this.parseClass=function(t){return t=n.trim(t),t.length?this.makeObject(t.split(/\s+/)):{}},this.serializeClass=function(t){var i=[],r=this.rte;return n.each(t,function(n){i.push(n)}),i.join(" ")},this.mediaInfo=function(t,i){for(var r=this.media.length;r--;)if(t===this.media[r].type||i&&n.inArray(i,this.media[r].classid)!=-1)return this.media[r]},this.color2Hex=function(n){function i(n){return n=parseInt(n).toString(16),n.length>1?n:"0"+n}var t;return(n=n||"",n.indexOf("#")===0)?n:this.colors[n]?this.colors[n]:(t=n.match(this.rgbRegExp))?"#"+i(t[1])+i(t[2])+i(t[3]):""}}}(jQuery),function(){elRTE.prototype.w3cRange=function(n){var t=this;this.rte=n,this.r=null,this.collapsed=!0,this.startContainer=null,this.endContainer=null,this.startOffset=0,this.endOffset=0,this.commonAncestorContainer=null,this.range=function(){try{this.r=this.rte.window.document.selection.createRange()}catch(n){this.r=this.rte.doc.body.createTextRange()}return this.r},this.insertNode=function(n){this.range(),t.r.collapse(!1);var i=t.r.duplicate();i.pasteHTML(n)},this.getBookmark=function(){if(this.range(),this.r.item){var n=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(n)}return this.r.getBookmark()},this.moveToBookmark=function(n){this.rte.window.focus(),this.range().moveToBookmark(n),this.r.select()},this.update=function(){function u(n){var s="﻿",e=offset=0,u=t.r.duplicate(),i,r,f,o;if(u.collapse(n),i=u.parentElement(),!i||i.nodeName=="HTML")return{parent:t.rte.doc.body,ndx:e,offset:offset};for(u.pasteHTML(s),childs=i.childNodes,r=0;r<childs.length;r++)if(f=childs[r],r>0&&(f.nodeType!==3||childs[r-1].nodeType!==3)&&e++,f.nodeType!==3)offset=0;else{if(o=f.nodeValue.indexOf(s),o!==-1){offset+=o;break}offset+=f.nodeValue.length}return u.moveStart("character",-1),u.text="",{parent:i,ndx:Math.min(e,i.childNodes.length-1),offset:offset}}var r,n,i;return this.range(),this.startContainer=this.endContainer=null,this.r.item?(this.collapsed=!1,r=this.r.item(0),this.setStart(r.parentNode,this.rte.dom.indexOf(r)),this.setEnd(r.parentNode,this.startOffset+1)):(this.collapsed=this.r.boundingWidth==0,n=u(!0),i=u(!1),n.parent.normalize(),i.parent.normalize(),n.ndx=Math.min(n.ndx,n.parent.childNodes.length-1),i.ndx=Math.min(i.ndx,i.parent.childNodes.length-1),n.parent.childNodes[n.ndx].nodeType&&n.parent.childNodes[n.ndx].nodeType==1?this.setStart(n.parent,n.ndx):this.setStart(n.parent.childNodes[n.ndx],n.offset),i.parent.childNodes[i.ndx].nodeType&&i.parent.childNodes[i.ndx].nodeType==1?this.setEnd(i.parent,i.ndx):this.setEnd(i.parent.childNodes[i.ndx],i.offset),this.select()),this},this.isCollapsed=function(){return this.range(),this.collapsed=this.r.item?!1:this.r.boundingWidth==0,this.collapsed},this.collapse=function(n){if(this.range(),this.r.item){var t=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(t)}this.r.collapse(n),this.r.select(),this.collapsed=!0},this.getStart=function(){var t,n;return(this.range(),this.r.item)?this.r.item(0):(t=this.r.duplicate(),t.collapse(!0),n=t.parentElement(),n&&n.nodeName=="BODY"?n.firstChild:n)},this.getEnd=function(){var t,n;return(this.range(),this.r.item)?this.r.item(0):(t=this.r.duplicate(),t.collapse(!1),n=t.parentElement(),n&&n.nodeName=="BODY"?n.lastChild:n)},this.setStart=function(n,t){this.startContainer=n,this.startOffset=t,this.endContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setEnd=function(n,t){this.endContainer=n,this.endOffset=t,this.startContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setStartBefore=function(n){n.parentNode&&this.setStart(n.parentNode,this.rte.dom.indexOf(n))},this.setStartAfter=function(n){n.parentNode&&this.setStart(n.parentNode,this.rte.dom.indexOf(n)+1)},this.setEndBefore=function(n){n.parentNode&&this.setEnd(n.parentNode,this.rte.dom.indexOf(n))},this.setEndAfter=function(n){n.parentNode&&this.setEnd(n.parentNode,this.rte.dom.indexOf(n)+1)},this.select=function(){function f(n,i){var e;if(n.nodeType!=3)return-1;var f="﻿",r=n.nodeValue,u=t.rte.doc.body.createTextRange();return n.nodeValue=r.substring(0,i)+f+r.substring(i),u.moveToElementText(n.parentNode),u.findText(f),e=Math.abs(u.moveStart("character",-1048575)),n.nodeValue=r,e}var o;this.r=this.rte.doc.body.createTextRange();var r=this.startOffset,u=this.endOffset,n=this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(r,this.startContainer.childNodes.length-1)]:this.startContainer,e=this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(r==u?u:u-1,this.endContainer.childNodes.length-1)]:this.endContainer;if(this.collapsed)n.nodeType==3?(o=f(n,r),this.r.move("character",o)):(this.r.moveToElementText(n),this.r.collapse(!0));else{var i=this.rte.doc.body.createTextRange(),s=f(n,r),h=f(e,u);n.nodeType==3?this.r.move("character",s):this.r.moveToElementText(n),e.nodeType==3?i.move("character",h):i.moveToElementText(e),this.r.setEndPoint("EndToEnd",i)}try{this.r.select()}catch(e){}i&&(i=null)},this.dump=function(){this.rte.log("collapsed: "+this.collapsed),this.rte.log("startContainer: "+(this.startContainer?this.startContainer.nodeName:"non")),this.rte.log("startOffset: "+this.startOffset),this.rte.log("endContainer: "+(this.endContainer?this.endContainer.nodeName:"none")),this.rte.log("endOffset: "+this.endOffset)}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.about=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.active=!0,this.command=function(){var r,i,u;r={rtl:t.rtl,submit:function(n,t){t.close()},dialog:{width:560,title:this.rte.i18n("About this software"),buttons:{Ok:function(){n(this).dialog("destroy")}}}},u='<div class="elrte-logo"><\/div><h3>'+this.rte.i18n("About elRTE")+'<\/h3><br clear="all"/><div class="elrte-ver">'+this.rte.i18n("Version")+": "+this.rte.version+" ("+this.rte.build+')<\/div><div class="elrte-ver">jQuery: '+n("<div/>").jquery+'<\/div><div class="elrte-ver">jQueryUI: '+n.ui.version+'<\/div><div class="elrte-ver">'+this.rte.i18n("Licence")+": BSD Licence<\/div><p>"+this.rte.i18n("elRTE is an open-source JavaScript based WYSIWYG HTML-editor.")+"<br/>"+this.rte.i18n("Main goal of the editor - simplify work with text and formating (HTML) on sites, blogs, forums and other online services.")+"<br/>"+this.rte.i18n("You can use it in any commercial or non-commercial projects.")+"<\/p><h4>"+this.rte.i18n("Authors")+'<\/h4><table class="elrte-authors"><tr><td>Dmitry (dio) Levashov &lt;dio@std42.ru&gt;<\/td><td>'+this.rte.i18n("Chief developer")+"<\/td><\/tr><tr><td>Troex Nevelin &lt;troex@fury.scancode.ru&gt;<\/td><td>"+this.rte.i18n("Developer, tech support")+"<\/td><\/tr><tr><td>Valentin Razumnyh &lt;content@std42.ru&gt;<\/td><td>"+this.rte.i18n("Interface designer")+"<\/td><\/tr><tr><td>Tawfek Daghistani &lt;tawfekov@gmail.com&gt;<\/td><td>"+this.rte.i18n("RTL support")+"<\/td><\/tr>"+(this.rte.options.lang!="en"?"<tr><td>"+this.rte.i18n("_translator")+"<\/td><td>"+this.rte.i18n("_translation")+"<\/td><\/tr>":"")+'<\/table><div class="elrte-copy">Copyright &copy; 2009-2011, <a href="http://www.std42.ru">Studio 42<\/a><\/div><div class="elrte-copy">'+this.rte.i18n("For more information about this software visit the")+' <a href="http://elrte.org">'+this.rte.i18n("elRTE website")+'.<\/a><\/div><div class="elrte-copy">Twitter: <a href="http://twitter.com/elrte_elfinder">elrte_elfinder<\/a><\/div>',i=new elDialogForm(r),i.append(u),i.open()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.anchor=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.input=n('<input type="text" />').attr("name","anchor").attr("size","16");var r=this;this.command=function(){var u={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Bookmark")}},i;this.anchor=this.rte.dom.selfOrParentAnchor(this.rte.selection.getEnd())||t.dom.create("a"),this.rte.selection.collapsed()||this.rte.selection.collapse(!1),this.input.val(n(this.anchor).addClass("elrte-anchor").attr("name")),this.rte.selection.saveIERange(),i=new elDialogForm(u),i.append([this.rte.i18n("Bookmark name"),this.input],null,!0).open(),setTimeout(function(){r.input.focus()},20)},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.addClass("disabled"):this.rte.dom.selfOrParentAnchor(n)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.removeClass("disabled").removeClass("active")},this.set=function(){var t=n.trim(this.input.val());t?(this.rte.history.add(),this.anchor.parentNode?(this.anchor.name=t,this.anchor.title=this.rte.i18n("Bookmark")+": "+t):this.rte.selection.insertHtml('<a name="'+t+'" title="'+this.rte.i18n("Bookmark")+": "+t+'" class="elrte-anchor"><\/a>')):this.anchor.parentNode&&(this.rte.history.add(),this.anchor.parentNode.removeChild(this.anchor))}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.blockquote=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i,t;this.rte.history.add(),this.rte.selection.collapsed()&&(i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/))?n(i).replaceWith(n(i).html()):(t=this.rte.selection.selected({wrap:"all",tag:"blockquote"}),t.length&&this.rte.selection.select(t[0],t[t.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.copy=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var t,i,r;if(this.rte.browser.mozilla)try{this.rte.doc.execCommand(this.name,!1,null)}catch(u){t=" Ctl + C",this.name=="cut"?t=" Ctl + X":this.name=="paste"&&(t=" Ctl + V"),i={dialog:{title:this.rte.i18n("Warning"),buttons:{Ok:function(){n(this).dialog("close")}}}},r=new elDialogForm(i),r.append(this.rte.i18n("This operation is disabled in your browser on security reason. Use shortcut instead.")+": "+t).open()}else this.constructor.prototype.command.call(this)}},elRTE.prototype.ui.prototype.buttons.cut=elRTE.prototype.ui.prototype.buttons.copy,elRTE.prototype.ui.prototype.buttons.paste=elRTE.prototype.ui.prototype.buttons.copy}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.css=function(t,i){var r=this;this.constructor.prototype.constructor.call(this,t,i),this.cssStyle=n('<input type="text" size="42" name="style" />'),this.cssClass=n('<input type="text" size="42" name="class" />'),this.elementID=n('<input type="text" size="42" name="id" />'),this.command=function(){var i=this.node(),u,t;this.rte.selection.saveIERange(),i&&(u={submit:function(n,t){n.stopPropagation(),n.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Style"),width:450,resizable:!0,modal:!0}},this.cssStyle.val(n(i).attr("style")),this.cssClass.val(n(i).attr("class")),this.elementID.val(n(i).attr("id")),t=new elDialogForm(u),t.append([this.rte.i18n("Css style"),this.cssStyle],null,!0),t.append([this.rte.i18n("Css class"),this.cssClass],null,!0),t.append([this.rte.i18n("ID"),this.elementID],null,!0),t.open(),setTimeout(function(){r.cssStyle.focus()},20))},this.set=function(){var t=this.node();this.rte.selection.restoreIERange(),t&&(n(t).attr("style",this.cssStyle.val()),n(t).attr("class",this.cssClass.val()),n(t).attr("id",this.elementID.val()),this.rte.ui.update())},this.node=function(){var n=this.rte.selection.getNode();return n.nodeType==3&&(n=n.parentNode),n.nodeType==1&&n.nodeName!="BODY"?n:null},this.update=function(){this.domElem.toggleClass("disabled",this.node()?!1:!0)}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.rtl=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),i=this;n(t).attr("dir")=="rtl"||n(t).parents('[dir="rtl"]').length||n(t).find('[dir="rtl"]').length?(n(t).removeAttr("dir"),n(t).parents('[dir="rtl"]').removeAttr("dir"),n(t).find('[dir="rtl"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?n(t).attr("dir","rtl"):n.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(i.rte.dom.is(r,"block"))return n(r).attr("dir","rtl"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),n(t).attr("dir")=="rtl"||n(t).parents('[dir="rtl"]').length||n(t).find('[dir="rtl"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}},elRTE.prototype.ui.prototype.buttons.ltr=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),i=this;n(t).attr("dir")=="ltr"||n(t).parents('[dir="ltr"]').length||n(t).find('[dir="ltr"]').length?(n(t).removeAttr("dir"),n(t).parents('[dir="ltr"]').removeAttr("dir"),n(t).find('[dir="ltr"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?n(t).attr("dir","ltr"):n.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(i.rte.dom.is(r,"block"))return n(r).attr("dir","ltr"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),n(t).attr("dir")=="ltr"||n(t).parents('[dir="ltr"]').length||n(t).find('[dir="ltr"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.div=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i,t;this.rte.history.add(),this.rte.selection.collapsed()?(i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/),i&&n(i).replaceWith(n(i).html())):(t=this.rte.selection.selected({wrap:"all",tag:"div"}),t.length&&this.rte.selection.select(t[0],t[t.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.docstructure=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){this.domElem.toggleClass("active"),n(this.rte.doc.body).toggleClass("el-rte-structure")},this.command(),this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.elfinder=function(n,t){this.constructor.prototype.constructor.call(this,n,t);var i=this,n=this.rte;this.command=function(){i.rte.options.fmAllow&&typeof i.rte.options.fmOpen=="function"&&i.rte.options.fmOpen(function(t){var i=decodeURIComponent(t.split("/").pop().replace(/\+/g," "));n.selection.collapsed()?n.selection.insertHtml('<a href="'+t+'" >'+i+"<\/a>"):n.doc.execCommand("createLink",!1,t)})},this.update=function(){i.rte.options.fmAllow&&typeof i.rte.options.fmOpen=="function"?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.flash=function(t,r){this.constructor.prototype.constructor.call(this,t,r);var u=this;this.swf=null,this.placeholder=null,this.src={url:n('<input type="text" name="url" />').css("width","99%"),type:n('<select name="type"/>').append('<option value="application/x-shockwave-flash">Flash<\/option>').append('<option value="video/quicktime">Quicktime movie<\/option>').append('<option value="application/x-mplayer2">Windows media<\/option>'),width:n('<input type="text" />').attr("size",5).css("text-align","right"),height:n('<input type="text" />').attr("size",5).css("text-align","right"),wmode:n("<select />").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("transparent").text(this.rte.i18n("Transparent"))),align:n("<select />").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("left").text(this.rte.i18n("Left"))).append(n("<option />").val("right").text(this.rte.i18n("Right"))).append(n("<option />").val("top").text(this.rte.i18n("Top"))).append(n("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(n("<option />").val("middle").text(this.rte.i18n("middle"))).append(n("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(n("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(n("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))),margin:n("<div />")},this.command=function(){var i=this.rte.selection.getEnd(),e="",o="",s="",h,c,v,t,y,a,r,p,w,f;if(this.rte.selection.saveIERange(),this.src.margin.elPaddingInput({type:"margin"}),this.placeholder=null,this.swf=null,n(i).hasClass("elrte-media")&&(v=n(i).attr("rel"))&&this.rte.filter.scripts[v]){if(this.placeholder=n(i),t=this.rte.filter.scripts[v],e="",t.embed&&t.embed.src&&(e=t.embed.src),t.params&&t.params.length)for(l=t.params.length;l--;)(t.params[l].name=="src"||t.params[l].name=="movie")&&(e=t.params[l].value);t.embed?(o=t.embed.width||parseInt(t.embed.style.width)||"",s=t.embed.height||parseInt(t.embed.style.height)||"",y=t.embed.wmode||""):t.obj&&(o=t.obj.width||parseInt(t.obj.style.width)||"",s=t.obj.height||parseInt(t.obj.style.height)||"",y=t.obj.wmode||""),t.obj?(h=t.obj.style.float||"",c=t.obj.style["vertical-align"]||""):t.embed&&(h=t.embed.style.float||"",c=t.embed.style["vertical-align"]||""),this.src.margin.val(i),this.src.type.val(t.embed?t.embed.type:"")}n(i).hasClass("elrte-swf-placeholder")&&(this.placeholder=n(i),e=n(i).attr("rel"),o=parseInt(n(i).css("width"))||"",s=parseInt(n(i).css("height"))||"",h=n(i).css("float"),c=n(i).css("vertical-align"),this.src.margin.val(i),this.src.wmode.val(n(i).attr("wmode"))),this.src.url.val(e),this.src.width.val(o),this.src.height.val(s),this.src.align.val(h||c),this.src.wmode.val(y),a={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),u.set(),t.close()},dialog:{width:580,position:"top",title:this.rte.i18n("Flash")}},r=new elDialogForm(a),p=this.rte.options.fmAllow&&this.rte.options.fmOpen?n("<span />").append(this.src.url.css("width","85%")).append(n("<span />").addClass("ui-state-default ui-corner-all").css({float:"right","margin-right":"3px"}).attr("title",u.rte.i18n("Open file manger")).append(n("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){u.rte.options.fmOpen(function(n){u.src.url.val(n).change()})}).hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")})):this.src.url,r.append([this.rte.i18n("URL"),p],null,!0),r.append([this.rte.i18n("Type"),this.src.type],null,!0),r.append([this.rte.i18n("Size"),n("<span />").append(this.src.width).append(" x ").append(this.src.height).append(" px")],null,!0),r.append([this.rte.i18n("Wmode"),this.src.wmode],null,!0),r.append([this.rte.i18n("Alignment"),this.src.align],null,!0),r.append([this.rte.i18n("Margins"),this.src.margin],null,!0),r.open(),w=n("<fieldset />").append(n("<legend />").text(this.rte.i18n("Preview"))),r.append(w,"main"),f=document.createElement("iframe"),n(f).attr("src","#").addClass("el-rte-preview").appendTo(w),html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><\/head><body style="padding:0;margin:0;font-size:9px"> Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin<\/body><\/html>',f.contentWindow.document.open(),f.contentWindow.document.write(html),f.contentWindow.document.close(),this.frame=f.contentWindow.document,this.preview=n(f.contentWindow.document.body),this.src.type.change(function(){u.src.url.change()}),this.src.width.change(function(){if(u.swf){var t=parseInt(n(this).val())||"";n(this).val(t),u.swf.css("width",t),u.swf.children("embed").css("width",t)}else n(this).val("")}),this.src.height.change(function(){if(u.swf){var t=parseInt(n(this).val())||"";n(this).val(t),u.swf.css("height",t),u.swf.children("embed").css("height",t)}else n(this).val("")}),this.src.wmode.change(function(){if(u.swf){var t=n(this).val();t?(u.swf.attr("wmode",t),u.swf.children("embed").attr("wmode",t)):(u.swf.removeAttr("wmode"),u.swf.children("embed").removeAttr("wmode"))}}),this.src.align.change(function(){var t=n(this).val(),i=t=="left"||t=="right";u.swf?u.swf.css({float:i?t:"","vertical-align":i?"":t}):n(this).val("")}),this.src.margin.change(function(){if(u.swf){var n=u.src.margin.val();n.css?u.swf.css("margin",n.css):(u.swf.css("margin-top",n.top),u.swf.css("margin-right",n.right),u.swf.css("margin-bottom",n.bottom),u.swf.css("margin-left",n.left))}}),this.src.url.change(function(){var i=u.rte.utils.absoluteURL(n(this).val()),t,r;i?(t=u.rte.utils.mediaInfo(u.src.type.val()),t||(t=u.rte.util.mediaInfo("application/x-shockwave-flash")),r='<object classid="'+t.classid+'" codebase="'+t.codebase+'"><param name="src" value="'+i+'" /><embed quality="high" src="'+i+'" type="'+t.type+'"><\/object>',u.preview.children("object").remove().end().prepend(r),u.swf=u.preview.children("object").eq(0)):u.swf&&(u.swf.remove(),u.swf=null),u.src.width.trigger("change"),u.src.height.trigger("change"),u.src.align.trigger("change")}).trigger("change")},this.set=function(){var l,p;u.swf=null;var f=this.rte.utils.absoluteURL(this.src.url.val()),o=parseInt(this.src.width.val())||"",s=parseInt(this.src.height.val())||"",w=this.src.wmode.val(),r=this.src.align.val(),h=r=="left"||r=="right"?r:"",c=this.placeholder?this.placeholder.attr("rel"):"",t,a,v,e=this.src.margin.val(),y;f?(i=u.rte.utils.mediaInfo(u.src.type.val()),i||(i=u.rte.util.mediaInfo("application/x-shockwave-flash")),v=this.rte.filter.videoHostRegExp.test(f)?f.replace(this.rte.filter.videoHostRegExp,"$2"):i.type.replace(/^\w+\/(.+)/,"$1"),t={obj:{classid:i.classid[0],codebase:i.codebase,style:{}},params:[{name:"src",value:f}],embed:{src:f,type:i.type,quality:"high",wmode:w,style:{}}},o&&(t.obj.width=o,t.embed.width=o),s&&(t.obj.height=s,t.embed.height=s),h?t.obj.style.float=h:r&&(t.obj.style["vertical-align"]=r),y=e.css?{margin:e.css}:{"margin-top":e.top,"margin-right":e.right,"margin-bottom":e.bottom,"margin-left":e.left},t.obj.style=n.extend({},t.obj.style,y),this.placeholder&&c?(a=this.rte.filter.scripts[c]||{},t=n.extend(!0,a,t),delete t.obj.style.width,delete t.obj.style.height,delete t.embed.style.width,delete t.embed.style.height,this.rte.filter.scripts[c]=t,this.placeholder.removeAttr("class")):(l="media"+Math.random().toString().substring(2),this.rte.filter.scripts[l]=t,this.placeholder=n(this.rte.dom.create("img")).attr("rel",l).attr("src",this.rte.filter.url+"pixel.gif"),p=!0),this.placeholder.attr("title",this.rte.utils.encode(f)).attr("width",o||150).attr("height",s||100).addClass("elrte-protected elrte-media elrte-media-"+v).css(t.obj.style),h?this.placeholder.css("float",h).css("vertical-align",""):r?this.placeholder.css("float","").css("vertical-align",r):this.placeholder.css("float","").css("vertical-align",""),p&&(this.rte.window.focus(),this.rte.selection.restoreIERange(),this.rte.selection.insertNode(this.placeholder.get(0)))):this.placeholder&&(this.placeholder.remove(),delete this.rte.filter.scripts[c])},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.domElem.toggleClass("active",t&&t.nodeName=="IMG"&&n(t).hasClass("elrte-media"))}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fontname=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var u=this,r={tpl:'<span style="font-family:%val">%label<\/span>',select:function(n){u.set(n)},src:{"":this.rte.i18n("Font"),"andale mono,sans-serif":"Andale Mono","arial,helvetica,sans-serif":"Arial","arial black,gadget,sans-serif":"Arial Black","book antiqua,palatino,sans-serif":"Book Antiqua","comic sans ms,cursive":"Comic Sans MS","courier new,courier,monospace":"Courier New","georgia,palatino,serif":"Georgia","helvetica,sans-serif":"Helvetica","impact,sans-serif":"Impact","lucida console,monaco,monospace":"Lucida console","lucida sans unicode,lucida grande,sans-serif":"Lucida grande","tahoma,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,lucida grande,verdana,sans-serif":"Trebuchet MS","verdana,geneva,sans-serif":"Verdana"}};this.select=this.domElem.elSelect(r),this.command=function(){},this.set=function(t){this.rte.history.add();var i=this.rte.selection.selected({filter:"textContainsNodes"});n.each(i,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?n(this).find("td,th"):n(this),n(this).css("font-family",t).find("[style]").css("font-family","")}),this.rte.ui.update()},this.update=function(){var i,t;this.domElem.removeClass("disabled"),i=this.rte.selection.getNode(),i.nodeType!=1&&(i=i.parentNode),t=n(i).css("font-family"),t=t?t.toString().toLowerCase().replace(/,\s+/g,",").replace(/'|"/g,""):"",this.select.val(r.src[t]?t:"")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fontsize=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this,u={labelTpl:"%label",tpl:'<span style="font-size:%val;line-height:1.2em">%label<\/span>',select:function(n){r.set(n)},src:{"":this.rte.i18n("Font size"),"xx-small":this.rte.i18n("Small (8pt)"),"x-small":this.rte.i18n("Small (10px)"),small:this.rte.i18n("Small (12pt)"),medium:this.rte.i18n("Normal (14pt)"),large:this.rte.i18n("Large (18pt)"),"x-large":this.rte.i18n("Large (24pt)"),"xx-large":this.rte.i18n("Large (36pt)")}};this.select=this.domElem.elSelect(u),this.command=function(){},this.set=function(t){this.rte.history.add();var i=this.rte.selection.selected({filter:"textContainsNodes"});n.each(i,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?n(this).find("td,th"):n(this),$this.css("font-size",t).find("[style]").css("font-size","")}),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var n=this.rte.selection.getNode();this.select.val((m=this.rte.dom.attr(n,"style").match(/font-size:\s*([^;]+)/i))?m[1]:"")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.forecolor=function(t,i){var r=this,u;this.constructor.prototype.constructor.call(this,t,i),u={"class":"",palettePosition:"outer",color:this.defaultColor,update:function(n){r.indicator.css("background-color",n)},change:function(n){r.set(n)}},this.defaultColor=this.name=="forecolor"?"#000000":"#ffffff",this.picker=this.domElem.elColorPicker(u),this.indicator=n("<div />").addClass("color-indicator").prependTo(this.domElem),this.command=function(){},this.set=function(t){if(!this.rte.selection.collapsed()){this.rte.history.add();var r=this.rte.selection.selected({collapse:!1,wrap:"text"}),i=this.name=="forecolor"?"color":"background-color";n.each(r,function(){/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)?n(this).find("td,th").each(function(){n(this).css(i,t).find("*").css(i,"")}):n(this).css(i,t).find("*").css(i,"")}),this.rte.ui.update(!0)}},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.picker.val(this.rte.utils.rgb2hex(n(t.nodeType!=1?t.parentNode:t).css(this.name=="forecolor"?"color":"background-color"))||this.defaultColor)}},elRTE.prototype.ui.prototype.buttons.hilitecolor=elRTE.prototype.ui.prototype.buttons.forecolor}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.formatblock=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var f=this.rte.browser.msie?function(n){r.val=n,r.constructor.prototype.command.call(r)}:function(n){r.ieCommand(n)},r=this,u={labelTpl:"%label",tpls:{"":"%label"},select:function(n){r.formatBlock(n)},src:{span:this.rte.i18n("Format"),h1:this.rte.i18n("Heading 1"),h2:this.rte.i18n("Heading 2"),h3:this.rte.i18n("Heading 3"),h4:this.rte.i18n("Heading 4"),h5:this.rte.i18n("Heading 5"),h6:this.rte.i18n("Heading 6"),p:this.rte.i18n("Paragraph"),address:this.rte.i18n("Address"),pre:this.rte.i18n("Preformatted"),div:this.rte.i18n("Normal (DIV)")}};this.select=this.domElem.elSelect(u),this.command=function(){},this.formatBlock=function(t){function h(t,i){function u(t){return n(t).find("h1,h2,h3,h4,h5,h6,p,address,pre").each(function(){n(this).replaceWith(n(this).html())}),t}/^(LI|DT|DD|TD|TH|CAPTION)$/.test(t.nodeName)?r.rte.dom.isEmpty(t)||r.rte.dom.wrapContents(u(t),i):/^(UL|OL|DL|TABLE)$/.test(t.nodeName)?r.rte.dom.wrap(t,i):r.rte.dom.isEmpty(t)||n(u(t)).replaceWith(n(r.rte.dom.create(i)).html(n(t).html()))}this.rte.history.add();var u=t.toUpperCase(),i,o,a=this.rte.selection.collapsed(),c=this.rte.selection.getBookmark(),f=this.rte.selection.selected({collapsed:!0,blocks:!0,filter:"textContainsNodes",wrap:"inline",tag:"span"});for(l=f.length,s=n(f[0]).prev(),e=n(f[f.length-1]).next();l--;)i=f[l],o=n(i),u=="DIV"||u=="SPAN"?/^(H[1-6]|P|ADDRESS|PRE)$/.test(i.nodeName)&&o.replaceWith(n(this.rte.dom.create("div")).html(o.html()||"")):/^(THEAD|TBODY|TFOOT|TR)$/.test(i.nodeName)?o.find("td,th").each(function(){h(this,u)}):i.nodeName!=u&&h(i,u);this.rte.selection.moveToBookmark(c),this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled");var n=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(H[1-6]|P|ADDRESS|PRE)$/);this.select.val(n?n.nodeName.toLowerCase():"span")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.fullscreen=function(t,i){function u(){r.wz.height(n(window).height()-r.delta),r.rte.updateHeight()}var r=this;this.constructor.prototype.constructor.call(this,t,i),this.active=!0,this.editor=t.editor,this.wz=t.workzone,this.height=0,this.delta=0,this._class="el-fullscreen",setTimeout(function(){r.height=r.wz.height(),r.delta=r.editor.outerHeight()-r.height},50),this.command=function(){function v(){c&&(l=h.getBookmark())}function y(){c&&(r.wz.children().toggle(),r.rte.source.focus(),r.wz.children().toggle(),h.moveToBookmark(l))}var i=n(window),t=this.editor,a=t.parents().filter(function(t,i){return!/^(html|body)$/i.test(i.nodeName)&&n(i).css("position")=="relative"}),o=this.wz,f=this._class,e=t.hasClass(f),s=this.rte,h=this.rte.selection,c=n.browser.mozilla,l;v(),a.css("position",e?"relative":"static"),e?(t.removeClass(f),o.height(this.height),i.unbind("resize",u),this.domElem.removeClass("active")):(t.addClass(f).removeAttr("style"),o.height(i.height()-this.delta).css("width","100%"),i.bind("resize",u),this.domElem.addClass("active")),s.updateHeight(),s.resizable(e),y()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.horizontalrule=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src={width:n('<input type="text" />').attr({name:"width",size:4}).css("text-align","right"),wunit:n("<select />").attr("name","wunit").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")).val("%"),height:n('<input type="text" />').attr({name:"height",size:4}).css("text-align","right"),bg:n("<div />"),border:n("<div />"),"class":n('<input type="text" />').css("width","100%"),style:n('<input type="text" />').css("width","100%")},this.command=function(){var i,u,f,e;this.src.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),i=this.rte.selection.getEnd(),this.hr=i.nodeName=="HR"?n(i):n(t.doc.createElement("hr")).css({width:"100%",height:"1px"}),this.src.border.elBorderSelect({styleHeight:73,value:this.hr}),u=this.hr.css("width")||this.hr.attr("width"),this.src.width.val(parseInt(u)||100),this.src.wunit.val(u.indexOf("px")!=-1?"px":"%"),this.src.height.val(this.rte.utils.toPixels(this.hr.css("height")||this.hr.attr("height"))||1),this.src.bg.val(this.rte.utils.color2Hex(this.hr.css("background-color"))),this.src["class"].val(this.rte.dom.attr(this.hr,"class")),this.src.style.val(this.rte.dom.attr(this.hr,"style")),f={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{title:this.rte.i18n("Horizontal rule")}},e=new elDialogForm(f),e.append([this.rte.i18n("Width"),n("<span />").append(this.src.width).append(this.src.wunit)],null,!0).append([this.rte.i18n("Height"),n("<span />").append(this.src.height).append(" px")],null,!0).append([this.rte.i18n("Border"),this.src.border],null,!0).append([this.rte.i18n("Background"),this.src.bg],null,!0).append([this.rte.i18n("Css class"),this.src["class"]],null,!0).append([this.rte.i18n("Css style"),this.src.style],null,!0).open()},this.update=function(){this.domElem.removeClass("disabled"),this.rte.selection.getEnd().nodeName=="HR"?this.domElem.addClass("active"):this.domElem.removeClass("active")},this.set=function(){this.rte.history.add(),this.hr.parentNode||this.rte.selection.insertNode(this.hr.get(0));var t={noshade:!0,style:this.src.style.val()},n=this.src.border.val(),i={width:(parseInt(this.src.width.val())||100)+this.src.wunit.val(),height:parseInt(this.src.height.val())||1,"background-color":this.src.bg.val(),border:n.width&&n.style?n.width+" "+n.style+" "+n.color:""};this.hr.removeAttr("class").removeAttr("style").removeAttr("width").removeAttr("height").removeAttr("align").attr(t).css(i),this.src["class"].val()&&this.hr.attr("class",this.src["class"].val()),this.rte.ui.update()}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.image=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this,t=r.rte,o=0,u=0,f=0,e=null,s=function(t){n.each(r.src,function(i,r){n.each(r,function(n,i){n=="src"&&t||i.val("")})})},h=function(i){n.each(r.src,function(r,u){n.each(u,function(n,u){var f,o,s,e;n=="width"?f=i.width():n=="height"?f=i.height():n=="border"?(f="",e=i.css("border")||t.utils.parseStyle(i.attr("style")).border||"",e&&(o=e.match(/(\d(px|em|%))/),s=e.match(/(#[a-z0-9]+)/),f={width:o?o[1]:e,style:e,color:t.utils.color2Hex(s?s[1]:e)})):n=="margin"?f=i:n=="align"?(f=i.css("float"),f!="left"&&f!="right"&&(f=i.css("vertical-align"))):f=i.attr(n)||"",r=="events"&&(f=t.utils.trimEventCallback(f)),u.val(f)})})},l=function(){var t=r.src.main.src.val();s(!0),t?(r.prevImg?(r.prevImg.removeAttr("src").removeAttr("style").removeAttr("class").removeAttr("id").removeAttr("title").removeAttr("alt").removeAttr("longdesc"),n.each(r.src.events,function(n){r.prevImg.removeAttr(n)})):r.prevImg=n("<img/>").prependTo(r.preview),r.prevImg.load(function(){r.prevImg.unbind("load"),setTimeout(function(){u=r.prevImg.width(),f=r.prevImg.height(),o=(u/f).toFixed(2),r.src.main.width.val(u),r.src.main.height.val(f)},100)}).attr("src",t)):(r.preview.children("img").remove(),r.prevImg=null)},c=function(n){var t=parseInt(r.src.main.width.val())||0,i=parseInt(r.src.main.height.val())||0;r.prevImg&&(t&&i?n.target===r.src.main.width[0]?i=parseInt(t/o):t=parseInt(i*o):(t=u,i=f),r.src.main.height.val(i),r.src.main.width.val(t),r.prevImg.width(t).height(i),r.src.adv.style.val(r.prevImg.attr("style")))};this.img=null,this.prevImg=null,this.preview=n('<div class="elrte-image-preview"/>').text("Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin"),this.init=function(){this.labels={main:"Properies",link:"Link",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",longdesc:"Detail description URL",href:"URL",target:"Open in",title:"Title"},this.src={main:{src:n('<input type="text" />').css("width","100%").change(l),title:n('<input type="text" />').css("width","100%"),alt:n('<input type="text" />').css("width","100%"),width:n('<input type="text" />').attr("size",5).css("text-align","right").change(c),height:n('<input type="text" />').attr("size",5).css("text-align","right").change(c),margin:n("<div />").elPaddingInput({type:"margin",change:function(){var n=r.src.main.margin.val();r.prevImg&&(n.css?r.prevImg.css("margin",n.css):r.prevImg.css({"margin-left":n.left,"margin-top":n.top,"margin-right":n.right,"margin-bottom":n.bottom}))}}),align:n("<select />").css("width","100%").append(n("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(n("<option />").val("left").text(this.rte.i18n("Left"))).append(n("<option />").val("right").text(this.rte.i18n("Right"))).append(n("<option />").val("top").text(this.rte.i18n("Top"))).append(n("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(n("<option />").val("middle").text(this.rte.i18n("middle"))).append(n("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(n("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(n("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))).change(function(){var t=n(this).val(),i={float:"","vertical-align":""};r.prevImg&&(t=="left"||t=="right"?(i.float=t,i["vertical-align"]=""):t&&(i.float="",i["vertical-align"]=t),r.prevImg.css(i))}),border:n("<div />").elBorderSelect({name:"border",change:function(){var n=r.src.main.border.val();r.prevImg&&r.prevImg.css("border",n.width?n.width+" "+n.style+" "+n.color:"")}})},adv:{},events:{}},n.each(["id","class","style","longdesc"],function(t,i){r.src.adv[i]=n('<input type="text" style="width:100%" />')}),this.src.adv["class"].change(function(){r.prevImg&&r.prevImg.attr("class",n(this).val())}),this.src.adv.style.change(function(){r.prevImg&&(r.prevImg.attr("style",n(this).val()),h(r.prevImg))}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text"  style="width:100%"/>')})},this.command=function(){this.src||this.init();var c,v={rtl:t.rtl,submit:function(n){n.stopPropagation(),n.preventDefault(),r.set(),i.close()},close:function(){e&&t.selection.moveToBookmark(e)},dialog:{autoOpen:!1,width:500,position:"top",title:t.i18n("Image"),resizable:!0,open:function(){n.fn.resizable&&n(this).parents(".ui-dialog:first").resizable("option","alsoResize",".elrte-image-preview")}}},i=new elDialogForm(v),l=!!t.options.fmOpen,a=l?n('<div class="elrte-image-src-fm"><span class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-folder-open"/><\/span><\/div>').append(this.src.main.src.css("width","87%")):this.src.main.src;s(),this.preview.children("img").remove(),this.prevImg=null,c=t.selection.getEnd(),this.img=c.nodeName=="IMG"&&!n(c).is(".elrte-protected")?n(c):n("<img/>"),e=t.selection.getBookmark(),l&&a.children(".ui-state-default").click(function(){t.options.fmOpen(function(n){r.src.main.src.val(n).change()})}).hover(function(){n(this).toggleClass("ui-state-hover")}),i.tab("main",this.rte.i18n("Properies")).append([this.rte.i18n("Image URL"),a],"main",!0).append([this.rte.i18n("Title"),this.src.main.title],"main",!0).append([this.rte.i18n("Alt text"),this.src.main.alt],"main",!0).append([this.rte.i18n("Size"),n("<span />").append(this.src.main.width).append(" x ").append(this.src.main.height).append(" px")],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0),i.append(n("<fieldset><legend>"+this.rte.i18n("Preview")+"<\/legend><\/fieldset>").append(this.preview),"main"),n.each(this.src,function(u,f){u!="main"&&(i.tab(u,t.i18n(r.labels[u])),n.each(f,function(n){r.src[u][n].val(u=="events"?t.utils.trimEventCallback(r.img.attr(n)):r.img.attr(n)||""),i.append([t.i18n(r.labels[n]||n),r.src[u][n]],u,!0)}))}),i.open(),this.img.attr("src")&&(h(this.img),this.prevImg=this.img.clone().prependTo(this.preview),o=(this.img.width()/this.img.height()).toFixed(2),u=parseInt(this.img.width()),f=parseInt(this.img.height()))},this.set=function(){var u=this.src.main.src.val(),i;if(this.rte.history.add(),e&&t.selection.moveToBookmark(e),!u)return i=t.dom.selfOrParentLink(this.img[0]),i&&i.remove(),this.img.remove();this.img[0].parentNode||(this.img=n(this.rte.doc.createElement("img"))),this.img.attr("src",u).attr("style",this.src.adv.style.val()),n.each(this.src,function(t,i){n.each(i,function(t,i){var u=i.val();switch(t){case"width":r.img.css("width",u);break;case"height":r.img.css("height",u);break;case"align":r.img.css(u=="left"||u=="right"?"float":"vertical-align",u);break;case"margin":u.css?r.img.css("margin",u.css):r.img.css({"margin-left":u.left,"margin-top":u.top,"margin-right":u.right,"margin-bottom":u.bottom});break;case"border":if(u.width){u="border:"+u.css+";"+n.trim((r.img.attr("style")||"").replace(/border\-[^;]+;?/ig,"")),t="style",r.img.attr("style",u);return}u="";break;case"src":case"style":return;default:u?r.img.attr(t,u):r.img.removeAttr(t)}})}),this.img[0].parentNode||t.selection.insertNode(this.img[0]),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getEnd(),i=n(t);t.nodeName!="IMG"||i.hasClass("elrte-protected")?this.domElem.removeClass("active"):this.domElem.addClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.indent=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){function f(t){var i=/(IMG|HR|TABLE|EMBED|OBJECT)/.test(t.nodeName)?"margin-left":"padding-left",u=r.rte.dom.attr(t,"style").indexOf(i)!=-1?parseInt(n(t).css(i))||0:0;n(t).css(i,u+40+"px")}var i,t,u;for(this.rte.history.add(),i=this.rte.selection.selected({collapsed:!0,blocks:!0,wrap:"inline",tag:"p"}),t=0;t<i.length;t++)/^(TABLE|THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(i[t].nodeName)?n(i[t]).find("td,th").each(function(){f(this)}):/^LI$/.test(i[t].nodeName)?(u=n(i[t]),n(this.rte.dom.create(i[t].parentNode.nodeName)).append(n(this.rte.dom.create("li")).html(u.html()||"")).appendTo(u.html("&nbsp;"))):f(i[t]);this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.justifyleft=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.align=this.name=="justifyfull"?"justify":this.name.replace("justify",""),this.command=function(){var i=this.rte.selection.selected({collapsed:!0,blocks:!0,tag:"div"}),t=i.length;for(t&&this.rte.history.add();t--;)this.rte.dom.filter(i[t],"textNodes")&&n(i[t]).css("text-align",this.align);this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode(),i=t.nodeName=="BODY"?t:this.rte.dom.selfOrParent(t,"textNodes")||(t.parentNode&&t.parentNode.nodeName=="BODY"?t.parentNode:null);i?this.domElem.removeClass("disabled").toggleClass("active",n(i).css("text-align")==this.align):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.justifycenter=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyright=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyfull=elRTE.prototype.ui.prototype.buttons.justifyleft}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.link=function(t,i){function u(){r.labels={id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language",charset:"Charset",type:"Target MIME type",rel:"Relationship page to target (rel)",rev:"Relationship target to page (rev)",tabindex:"Tab index",accesskey:"Access key"},r.src={main:{href:n('<input type="text" />'),title:n('<input type="text" />'),anchor:n("<select />").attr("name","anchor"),target:n("<select />").append(n("<option />").text(r.rte.i18n("In this window")).val("")).append(n("<option />").text(r.rte.i18n("In new window (_blank)")).val("_blank"))},popup:{use:n('<input type="checkbox" />'),url:n('<input type="text" />').val("http://"),name:n('<input type="text" />'),width:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Width")}).css("text-align","right"),height:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Height")}).css("text-align","right"),left:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Left")}).css("text-align","right"),top:n('<input type="text" />').attr({size:6,title:r.rte.i18n("Top")}).css("text-align","right"),location:n('<input type="checkbox" />'),menubar:n('<input type="checkbox" />'),toolbar:n('<input type="checkbox" />'),scrollbars:n('<input type="checkbox" />'),status:n('<input type="checkbox" />'),resizable:n('<input type="checkbox" />'),dependent:n('<input type="checkbox" />'),retfalse:n('<input type="checkbox" />').attr("checked",!0)},adv:{id:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />'),charset:n('<input type="text" />'),type:n('<input type="text" />'),rel:n('<input type="text" />'),rev:n('<input type="text" />'),tabindex:n('<input type="text" />'),accesskey:n('<input type="text" />')},events:{}},n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />')}),n.each(r.src,function(){var n,t;for(n in this)t=this[n].attr("type"),t&&(t!="text"||this[n].attr("size"))||this[n].css("width","100%")})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.img=!1,this.bm,this.command=function(){function c(n){return n.nodeName=="A"&&n.href}var t=this.rte.selection.getNode(),i,f,l,a,v,e,s,h,o;if(this.src||u(),this.bm=this.rte.selection.getBookmark(),this.link=this.rte.dom.selfOrParentLink(t),!this.link&&(i=n.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1}),i.length)){for(f=0;f<i.length;f++)if(c(i[f])){this.link=i[f];break}this.link||(this.link=this.rte.dom.parent(i[0],c)||this.rte.dom.parent(i[i.length-1],c))}this.link=this.link?n(this.link):n(this.rte.doc.createElement("a")),this.img=t.nodeName=="IMG"?t:null,this.updatePopup(),this.src.main.anchor.empty(),n('a[href!=""][name]',this.rte.doc).each(function(){var t=n(this).attr("name");r.src.main.anchor.append(n("<option />").val(t).text(t))}),this.src.main.anchor.children().length&&this.src.main.anchor.prepend(n("<option />").val("").text(this.rte.i18n("Select bookmark"))).change(function(){var t=n(this).val();t&&r.src.main.href.val("#"+t)}),l={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},tabs:{show:function(n,t){t.index==3&&r.updateOnclick()}},close:function(){r.rte.browser.msie&&r.rte.selection.restoreIERange()},dialog:{width:"auto",width:430,title:this.rte.i18n("Link")}},d=new elDialogForm(l),a=n("<div />").append(n("<label />").append(this.src.popup.location).append(this.rte.i18n("Location bar"))).append(n("<label />").append(this.src.popup.menubar).append(this.rte.i18n("Menu bar"))).append(n("<label />").append(this.src.popup.toolbar).append(this.rte.i18n("Toolbar"))).append(n("<label />").append(this.src.popup.scrollbars).append(this.rte.i18n("Scrollbars"))),v=n("<div />").append(n("<label />").append(this.src.popup.status).append(this.rte.i18n("Status bar"))).append(n("<label />").append(this.src.popup.resizable).append(this.rte.i18n("Resizable"))).append(n("<label />").append(this.src.popup.dependent).append(this.rte.i18n("Depedent"))).append(n("<label />").append(this.src.popup.retfalse).append(this.rte.i18n("Add return false"))),d.tab("main",this.rte.i18n("Properies")).tab("popup",this.rte.i18n("Popup")).tab("adv",this.rte.i18n("Advanced")).tab("events",this.rte.i18n("Events")).append(n("<label />").append(this.src.popup.use).append(this.rte.i18n("Open link in popup window")),"popup").separator("popup").append([this.rte.i18n("URL"),this.src.popup.url],"popup",!0).append([this.rte.i18n("Window name"),this.src.popup.name],"popup",!0).append([this.rte.i18n("Window size"),n("<span />").append(this.src.popup.width).append(" x ").append(this.src.popup.height).append(" px")],"popup",!0).append([this.rte.i18n("Window position"),n("<span />").append(this.src.popup.left).append(" x ").append(this.src.popup.top).append(" px")],"popup",!0).separator("popup").append([a,v],"popup",!0),e=this.link.get(0),s=this.rte.dom.attr(e,"href"),this.src.main.href.val(s).change(function(){n(this).val(r.rte.utils.absoluteURL(n(this).val()))}),this.rte.options.fmAllow&&this.rte.options.fmOpen?(h=n("<span />").append(this.src.main.href.css("width","87%")).append(n("<span />").addClass("ui-state-default ui-corner-all").css({float:"right","margin-right":"3px"}).attr("title",r.rte.i18n("Open file manger")).append(n("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){r.rte.options.fmOpen(function(n){r.src.main.href.val(n).change()})}).hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")})),d.append([this.rte.i18n("Link URL"),h],"main",!0)):d.append([this.rte.i18n("Link URL"),this.src.main.href],"main",!0),this.src.main.href.change(),d.append([this.rte.i18n("Title"),this.src.main.title.val(this.rte.dom.attr(e,"title"))],"main",!0),this.src.main.anchor.children().length&&d.append([this.rte.i18n("Bookmark"),this.src.main.anchor.val(s)],"main",!0),this.rte.options.doctype.match(/xhtml/)&&this.rte.options.doctype.match(/strict/)||d.append([this.rte.i18n("Target"),this.src.main.target.val(this.link.attr("target")||"")],"main",!0);for(t in this.src.adv)this.src.adv[t].val(this.rte.dom.attr(e,t)),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.adv[t]],"adv",!0);for(t in this.src.events)o=this.rte.utils.trimEventCallback(this.rte.dom.attr(e,t)),this.src.events[t].val(o),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.events[t]],"events",!0);this.src.popup.use.change(function(){var t=n(this).attr("checked");n.each(r.src.popup,function(){n(this).attr("name")!="use"&&(t?n(this).removeAttr("disabled"):n(this).attr("disabled",!0))})}),this.src.popup.use.change(),d.open()},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(n){return n.nodeName=="A"&&n.href})?this.domElem.removeClass("disabled").addClass("active"):this.rte.selection.collapsed()&&n.nodeName!="IMG"?this.domElem.addClass("disabled").removeClass("active"):this.domElem.removeClass("disabled active")},this.updatePopup=function(){var t=""+this.link.attr("onclick");t.length>0&&(m=t.match(/window.open\('([^']+)',\s*'([^']*)',\s*'([^']*)'\s*.*\);\s*(return\s+false)?/))?(this.src.popup.use.attr("checked","on"),this.src.popup.url.val(m[1]),this.src.popup.name.val(m[2]),/location=yes/.test(m[3])&&this.src.popup.location.attr("checked",!0),/menubar=yes/.test(m[3])&&this.src.popup.menubar.attr("checked",!0),/toolbar=yes/.test(m[3])&&this.src.popup.toolbar.attr("checked",!0),/scrollbars=yes/.test(m[3])&&this.src.popup.scrollbars.attr("checked",!0),/status=yes/.test(m[3])&&this.src.popup.status.attr("checked",!0),/resizable=yes/.test(m[3])&&this.src.popup.resizable.attr("checked",!0),/dependent=yes/.test(m[3])&&this.src.popup.dependent.attr("checked",!0),(_m=m[3].match(/width=([^,]+)/))&&this.src.popup.width.val(_m[1]),(_m=m[3].match(/height=([^,]+)/))&&this.src.popup.height.val(_m[1]),(_m=m[3].match(/left=([^,]+)/))&&this.src.popup.left.val(_m[1]),(_m=m[3].match(/top=([^,]+)/))&&this.src.popup.top.val(_m[1]),m[4]&&this.src.popup.retfalse.attr("checked",!0)):n.each(this.src.popup,function(){var t=n(this);t.attr("type")=="text"?t.val(t.attr("name")=="url"?"http://":""):t.attr("name")=="retfalse"?this.attr("checked",!0):t.removeAttr("checked")})},this.updateOnclick=function(){var r=this.src.popup.url.val(),t,u,f,i;this.src.popup.use.attr("checked")&&r?(t="",this.src.popup.location.attr("checked")&&(t+="location=yes,"),this.src.popup.menubar.attr("checked")&&(t+="menubar=yes,"),this.src.popup.toolbar.attr("checked")&&(t+="toolbar=yes,"),this.src.popup.scrollbars.attr("checked")&&(t+="scrollbars=yes,"),this.src.popup.status.attr("checked")&&(t+="status=yes,"),this.src.popup.resizable.attr("checked")&&(t+="resizable=yes,"),this.src.popup.dependent.attr("checked")&&(t+="dependent=yes,"),this.src.popup.width.val()&&(t+="width="+this.src.popup.width.val()+","),this.src.popup.height.val()&&(t+="height="+this.src.popup.height.val()+","),this.src.popup.left.val()&&(t+="left="+this.src.popup.left.val()+","),this.src.popup.top.val()&&(t+="top="+this.src.popup.top.val()+","),t.length>0&&(t=t.substring(0,t.length-1)),u=this.src.popup.retfalse.attr("checked")?"return false;":"",f="window.open('"+r+"', '"+n.trim(this.src.popup.name.val())+"', '"+t+"'); "+u,this.src.events.onclick.val(f),this.src.main.href.val()||this.src.main.href.val("#")):(i=this.src.events.onclick.val(),i=i.replace(/window\.open\([^\)]+\)\s*;?\s*return\s*false\s*;?/i,""),this.src.events.onclick.val(i))},this.set=function(){var i,u,e,r,t,f;if(this.updateOnclick(),this.rte.selection.moveToBookmark(this.bm),this.rte.history.add(),i=this.rte.utils.absoluteURL(this.src.main.href.val()),i){this.img&&this.img.parentNode?(this.link=n(this.rte.dom.create("a")).attr("href",i),this.rte.dom.wrap(this.img,this.link[0])):this.link[0].parentNode||(u="#--el-editor---"+Math.random(),this.rte.doc.execCommand("createLink",!1,u),this.link=n('a[href="'+u+'"]',this.rte.doc),this.link.each(function(){var t=n(this);n.trim(t.html())||n.trim(t.text())||t.replaceWith(t.text())})),this.src.main.href.val(i);for(r in this.src)if(r!="popup")for(t in this.src[r])t!="anchors"&&(f=n.trim(this.src[r][t].val()),f?this.link.attr(t,f):this.link.removeAttr(t));this.img&&this.rte.selection.select(this.img)}else e=this.rte.selection.getBookmark(),this.rte.dom.unwrap(this.link[0]),this.rte.selection.moveToBookmark(e);this.rte.ui.update(!0)}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.nbsp=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){this.rte.history.add(),this.rte.selection.insertHtml("&nbsp;",!0),this.rte.window.focus(),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.outdent=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.find();t.node&&(this.rte.history.add(),n(t.node).css(t.type,(t.val>40?t.val-40:0)+"px"),this.rte.ui.update())},this.find=function(t){function u(t){var i={type:"",val:0},u;return(u=r.rte.dom.attr(t,"style"))&&(i.type=u.indexOf("padding-left")!=-1?"padding-left":u.indexOf("margin-left")!=-1?"margin-left":"",i.val=i.type?parseInt(n(t).css(i.type))||0:0),i}var t=this.rte.selection.getNode(),i=u(t);return i.val?i.node=t:n.each(this.rte.dom.parents(t,"*"),function(){return i=u(this),i.val?(i.node=this,i):void 0}),i},this.update=function(){var n=this.find();n.node?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pagebreak=function(t,i){this.constructor.prototype.constructor.call(this,t,i),n(this.rte.doc.body).bind("mousedown",function(t){n(t.target).hasClass("elrte-pagebreak")&&t.preventDefault()}),this.command=function(){this.rte.selection.insertHtml('<img src="'+this.rte.filter.url+'pixel.gif" class="elrte-protected elrte-pagebreak"/>',!1)},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pasteformattext=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.iframe=n(document.createElement("iframe")).addClass("el-rte-paste-input"),this.doc=null;var r=this;this.command=function(){this.rte.selection.saveIERange();var n=this,t={submit:function(t,i){t.stopPropagation(),t.preventDefault(),n.paste(),i.close()},dialog:{width:500,title:this.rte.i18n("Paste formatted text")}},i=new elDialogForm(t);if(i.append(this.iframe).open(),this.doc=this.iframe.get(0).contentWindow.document,html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',html+="<\/head><body> <br /> <\/body><\/html>",this.doc.open(),this.doc.write(html),this.doc.close(),this.rte.browser.msie)this.doc.body.contentEditable=!0;else try{this.doc.designMode="on"}catch(r){}setTimeout(function(){n.iframe[0].contentWindow.focus()},50)},this.paste=function(){n(this.doc.body).find("[class]").removeAttr("class");var t=n.trim(n(this.doc.body).html());t&&(this.rte.history.add(),this.rte.selection.restoreIERange(),this.rte.selection.insertHtml(this.rte.filter.wysiwyg2wysiwyg(this.rte.filter.proccess("paste",t))),this.rte.ui.update(!0))},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.pastetext=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.input=n("<textarea />").addClass("el-rte-paste-input");var r=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var n={submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.paste(),t.close()},dialog:{width:500,title:this.rte.i18n("Paste only text")}},t=new elDialogForm(n);t.append(this.input).open()},this.paste=function(){var t=n.trim(this.input.val());t&&(this.rte.history.add(),this.rte.browser.msie&&this.rte.selection.restoreIERange(),this.rte.selection.insertText(t.replace(/\r?\n/g,"<br />"),!0),this.rte.ui.update(!0)),this.input.val("")},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.save=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.active=!0,this.command=function(){this.rte.save()},this.update=function(){}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.smiley=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.img=null,this.url=this.rte.filter.url+"smileys/",this.smileys={smile:"smile.png",happy:"happy.png",tongue:"tongue.png",surprised:"surprised.png",waii:"waii.png",wink:"wink.png",evilgrin:"evilgrin.png",grin:"grin.png",unhappy:"unhappy.png"},this.width=120,this.command=function(){var r=this,u=this.url,t,i;this.rte.browser.msie&&this.rte.selection.saveIERange(),i={dialog:{height:120,width:this.width,title:this.rte.i18n("Smiley"),buttons:{}}},t=new elDialogForm(i),n.each(this.smileys,function(i,f){t.append(n('<img src="'+u+f+'" title="'+i+'" id="'+i+'" class="el-rte-smiley"/>').click(function(){r.set(this.id,t)}))}),t.open()},this.update=function(){this.domElem.removeClass("disabled"),this.domElem.removeClass("active")},this.set=function(t,i){this.rte.browser.msie&&this.rte.selection.restoreIERange(),this.smileys[t]&&(this.img=n(this.rte.doc.createElement("img")),this.img.attr({src:this.url+this.smileys[t],title:t,alt:t}),this.rte.selection.insertNode(this.img.get(0)),this.rte.ui.update()),i.close()}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.stopfloat=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.find=function(){if(this.rte.selection.collapsed()){var t=this.rte.dom.selfOrParent(this.rte.selection.getEnd(),/^DIV$/);if(t&&(this.rte.dom.attr(t,"clear")||n(t).css("clear")!="none"))return t}},this.command=function(){var t;(t=this.find())?(t=n(t),this.rte.history.add(),t.children().length||n.trim(t.text()).length?t.removeAttr("clear").css("clear",""):t.remove()):(this.rte.history.add(),this.rte.selection.insertNode(n(this.rte.dom.create("div")).css("clear","both").get(0),!0)),this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled"),this.find()?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.table=function(t,i){function u(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",summary:"Summary",lang:"Language",href:"URL"},r.src={main:{caption:n('<input type="text" />'),rows:n('<input type="text" />').attr("size",5).val(2),cols:n('<input type="text" />').attr("size",5).val(2),width:n('<input type="text" />').attr("size",5),wunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),height:n('<input type="text" />').attr("size",5),hunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),align:n("<select />").append(n("<option />").val("").text(r.rte.i18n("Not set"))).append(n("<option />").val("left").text(r.rte.i18n("Left"))).append(n("<option />").val("center").text(r.rte.i18n("Center"))).append(n("<option />").val("right").text(r.rte.i18n("Right"))),spacing:n('<input type="text" />').attr("size",5),padding:n('<input type="text" />').attr("size",5),border:n("<div />"),rules:n("<select />").append(n("<option />").val("none").text(r.rte.i18n("No"))).append(n("<option />").val("all").text(r.rte.i18n("Cells"))).append(n("<option />").val("groups").text(r.rte.i18n("Groups"))).append(n("<option />").val("rows").text(r.rte.i18n("Rows"))).append(n("<option />").val("cols").text(r.rte.i18n("Columns"))),margin:n("<div />"),bg:n("<div />"),bgimg:n('<input type="text" />').css("width","90%")},adv:{id:n('<input type="text" />'),summary:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />')},events:{}},n.each(r.src,function(){var n,t;for(n in this)this[n].attr("name",n),t=this[n].get(0).nodeName,t=="INPUT"&&n!="bgimg"?this[n].css(this[n].attr("size")?{"text-align":"right"}:{width:"100%"}):t=="SELECT"&&n!="wunit"&&n!="hunit"&&this[n].css("width","100%")}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />').css("width","100%")}),r.src.main.align.change(function(){var i=n(this).val(),t;i=="center"?r.src.main.margin.val({left:"auto",right:"auto"}):(t=r.src.main.margin.val(),t.left=="auto"&&t.right=="auto"&&r.src.main.margin.val({left:"",right:""}))}),r.src.main.bgimg.change(function(){var t=n(this);t.val(r.rte.utils.absoluteURL(t.val()))})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src=null,this.labels=null,this.command=function(){var l=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/),h,e,o,a,v,c,y,f,t,i,s;this.table=this.name=="table"?n(this.rte.doc.createElement("table")):l?n(l):n(this.rte.doc.createElement("table")),this.src||u(),this.src.main.border.elBorderSelect({styleHeight:117}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.margin.elPaddingInput({type:"margin",value:this.table}),this.table.parents().length?(this.src.main.rows.val("").attr("disabled",!0),this.src.main.cols.val("").attr("disabled",!0)):(this.src.main.rows.val(2).removeAttr("disabled"),this.src.main.cols.val(2).removeAttr("disabled")),h=this.table.css("width")||this.table.attr("width"),this.src.main.width.val(parseInt(h)||""),this.src.main.wunit.val(h.indexOf("px")!=-1?"px":"%"),e=this.table.css("height")||this.table.attr("height"),this.src.main.height.val(parseInt(e)||""),this.src.main.hunit.val(e&&e.indexOf("px")!=-1?"px":"%"),o=this.table.css("float"),this.src.main.align.val(""),o=="left"||o=="right"?this.src.main.align.val(o):(a=this.table.css("margin-left"),v=this.table.css("margin-right"),a=="auto"&&v=="auto"&&this.src.main.align.val("center")),this.src.main.border.val(this.table),this.src.main.rules.val(this.rte.dom.attr(this.table.get(0),"rules")),this.src.main.bg.val(this.table.css("background-color")),c=(this.table.css("background-image")||"").replace(/url\(([^\)]+)\)/i,"$1"),this.src.main.bgimg.val(c!="none"?c:""),y={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{width:530,title:this.rte.i18n("Table")}},f=new elDialogForm(y);for(t in this.src)if(f.tab(t,this.rte.i18n(this.labels[t])),t=="main"){var p=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Rows")+"<\/td>").append(n("<td />").append(this.src.main.rows))).append(n("<tr />").append("<td>"+this.rte.i18n("Columns")+"<\/td>").append(n("<td />").append(this.src.main.cols))),w=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Width")+"<\/td>").append(n("<td />").append(this.src.main.width).append(this.src.main.wunit))).append(n("<tr />").append("<td>"+this.rte.i18n("Height")+"<\/td>").append(n("<td />").append(this.src.main.height).append(this.src.main.hunit))),b=n("<table />").append(n("<tr />").append("<td>"+this.rte.i18n("Spacing")+"<\/td>").append(n("<td />").append(this.src.main.spacing.val(this.table.attr("cellspacing")||"")))).append(n("<tr />").append("<td>"+this.rte.i18n("Padding")+"<\/td>").append(n("<td />").append(this.src.main.padding.val(this.table.attr("cellpadding")||""))));f.append([this.rte.i18n("Caption"),this.src.main.caption.val(this.table.find("caption").eq(0).text()||"")],"main",!0).separator("main").append([p,w,b],"main",!0).separator("main").append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Inner borders"),this.src.main.rules],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Background"),n("<span />").append(n("<span />").css({float:"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0)}else for(i in this.src[t])s=this.rte.dom.attr(this.table,i),t=="events"&&(s=this.rte.utils.trimEventCallback(s)),f.append([this.rte.i18n(this.labels[i]?this.labels[i]:i),this.src[t][i].val(s)],t,!0);f.open()},this.set=function(){var e,o,t,i,s,h,c,u,f,l,a,v,p;if(this.table.parents().length)this.table.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor").removeAttr("cellspacing").removeAttr("cellpadding").removeAttr("frame").removeAttr("rules").removeAttr("style");else{if(e=parseInt(this.src.main.rows.val())||0,o=parseInt(this.src.main.cols.val())||0,e<=0||o<=0)return;for(this.rte.history.add(),t=n(this.rte.doc.createElement("tbody")).appendTo(this.table),i=0;i<e;i++){for(s="<tr>",h=0;h<o;h++)s+="<td>&nbsp;<\/td>";t.append(s+"<\/tr>")}}c=n.trim(this.src.main.caption.val()),c?(this.table.children("caption").length||this.table.prepend("<caption />"),this.table.children("caption").text(c)):this.table.children("caption").remove();for(u in this.src)if(u!="main")for(f in this.src[u])l=n.trim(this.src[u][f].val()),l?this.table.attr(f,l):this.table.removeAttr(f);(a=parseInt(this.src.main.spacing.val()))&&a>=0&&this.table.attr("cellspacing",a),(v=parseInt(this.src.main.padding.val()))&&v>=0&&this.table.attr("cellpadding",v),(p=this.src.main.rules.val())&&this.table.attr("rules",p);var w=parseInt(this.src.main.width.val())||"",b=parseInt(this.src.main.height.val())||"",i=n.trim(this.src.main.bgimg.val()),t=this.src.main.border.val(),r=this.src.main.margin.val(),y=this.src.main.align.val();this.table.css({width:w?w+this.src.main.wunit.val():"",height:b?b+this.src.main.hunit.val():"",border:n.trim(t.width+" "+t.style+" "+t.color),"background-color":this.src.main.bg.val(),"background-image":i?"url("+i+")":""}),r.css?this.table.css("margin",r.css):this.table.css({"margin-top":r.top,"margin-right":r.right,"margin-bottom":r.bottom,"margin-left":r.left}),(y=="left"||y=="right")&&this.table.css("margin-left")!="auto"&&this.table.css("margin-right")!="auto"&&this.table.css("float",y),this.table.attr("style")||this.table.removeAttr("style"),this.table.parents().length||this.rte.selection.insertNode(this.table.get(0),!0),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled"),this.name!="tableprops"||this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/)||this.domElem.addClass("disabled").removeClass("active")}},elRTE.prototype.ui.prototype.buttons.tableprops=elRTE.prototype.ui.prototype.buttons.table}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tablerm=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var t=this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/);t&&(this.rte.history.add(),n(t).remove()),this.rte.ui.update(!0)},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellprops=function(t,i){function u(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language"},r.src={main:{type:n("<select />").css("width","100%").append(n("<option />").val("td").text(r.rte.i18n("Data"))).append(n("<option />").val("th").text(r.rte.i18n("Header"))),width:n('<input type="text" />').attr("size",4),wunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),height:n('<input type="text" />').attr("size",4),hunit:n("<select />").append(n("<option />").val("%").text("%")).append(n("<option />").val("px").text("px")),align:n("<select />").css("width","100%").append(n("<option />").val("").text(r.rte.i18n("Not set"))).append(n("<option />").val("left").text(r.rte.i18n("Left"))).append(n("<option />").val("center").text(r.rte.i18n("Center"))).append(n("<option />").val("right").text(r.rte.i18n("Right"))).append(n("<option />").val("justify").text(r.rte.i18n("Justify"))),border:n("<div />"),padding:n("<div />"),bg:n("<div />"),bgimg:n('<input type="text" />').css("width","90%"),apply:n("<select />").css("width","100%").append(n("<option />").val("").text(r.rte.i18n("Current cell"))).append(n("<option />").val("row").text(r.rte.i18n("All cells in row"))).append(n("<option />").val("column").text(r.rte.i18n("All cells in column"))).append(n("<option />").val("table").text(r.rte.i18n("All cells in table")))},adv:{id:n('<input type="text" />'),"class":n('<input type="text" />'),style:n('<input type="text" />'),dir:n("<select />").css("width","100%").append(n("<option />").text(r.rte.i18n("Not set")).val("")).append(n("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(n("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:n('<input type="text" />')},events:{}},n.each(r.src,function(){for(var n in this)this[n].attr("name",n),this[n].attr("type")!="text"||this[n].attr("size")||n=="bgimg"||this[n].css("width","100%")}),n.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=n('<input type="text" />').css("width","100%")})}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.src=null,this.labels=null,this.command=function(){var s,h,e,c,f,t,i,o;if(this.src||u(),this.cell=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/),this.cell){this.src.main.type.val(this.cell.nodeName.toLowerCase()),this.cell=n(this.cell),this.src.main.border.elBorderSelect({styleHeight:117,value:this.cell}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.padding.elPaddingInput({value:this.cell}),s=this.cell.css("width")||this.cell.attr("width"),this.src.main.width.val(parseInt(s)||""),this.src.main.wunit.val(s.indexOf("px")!=-1?"px":"%"),h=this.cell.css("height")||this.cell.attr("height"),this.src.main.height.val(parseInt(h)||""),this.src.main.hunit.val(h.indexOf("px")!=-1?"px":"%"),this.src.main.align.val(this.cell.attr("align")||this.cell.css("text-align")),this.src.main.bg.val(this.cell.css("background-color")),e=this.cell.css("background-image"),this.src.main.bgimg.val(e&&e!="none"?e.replace(/url\(([^\)]+)\)/i,"$1"):""),this.src.main.apply.val(""),c={rtl:this.rte.rtl,submit:function(n,t){n.stopPropagation(),n.preventDefault(),r.set(),t.close()},dialog:{width:520,title:this.rte.i18n("Table cell properties")}},f=new elDialogForm(c);for(t in this.src)if(f.tab(t,this.rte.i18n(this.labels[t])),t=="main")f.append([this.rte.i18n("Width"),n("<span />").append(this.src.main.width).append(this.src.main.wunit)],"main",!0).append([this.rte.i18n("Height"),n("<span />").append(this.src.main.height).append(this.src.main.hunit)],"main",!0).append([this.rte.i18n("Table cell type"),this.src.main.type],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Paddings"),this.src.main.padding],"main",!0).append([this.rte.i18n("Background"),n("<span />").append(n("<span />").css({float:"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0).append([this.rte.i18n("Apply to"),this.src.main.apply],"main",!0);else for(i in this.src[t])o=this.cell.attr(i)||"",t=="events"&&(o=this.rte.utils.trimEventCallback(o)),f.append([this.rte.i18n(this.labels[i]?this.labels[i]:i),this.src[t][i].val(o)],t,!0);f.open()}},this.set=function(){var t=this.cell,v=this.src.main.apply.val(),f,e,o;switch(this.src.main.apply.val()){case"row":t=this.cell.parent("tr").children("td,th");break;case"column":t=n(this.rte.dom.tableColumn(this.cell.get(0)));break;case"table":t=this.cell.parents("table").find("td,th")}for(f in this.src)if(f!="main")for(e in this.src[f])o=n.trim(this.src[f][e].val()),o?t.attr(e,o):t.removeAttr(e);t.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor");var h=this.src.main.type.val(),c=parseInt(this.src.main.width.val())||"",l=parseInt(this.src.main.height.val())||"",a=n.trim(this.src.main.bgimg.val()),s=this.src.main.border.val(),i={width:c?c+this.src.main.wunit.val():"",height:l?l+this.src.main.hunit.val():"","background-color":this.src.main.bg.val(),"background-image":a?"url("+a+")":"",border:n.trim(s.width+" "+s.style+" "+s.color),"text-align":this.src.main.align.val()||""},u=this.src.main.padding.val();u.css?i.padding=u.css:(i["padding-top"]=u.top,i["padding-right"]=u.right,i["padding-bottom"]=u.bottom,i["padding-left"]=u.left),t=t.get(),n.each(t,function(){var c=this.nodeName.toLowerCase(),t=n(this),f,e,u,o,s;if(c!=h){f={};for(e in r.src.adv)u=t.attr(e),u&&(f[e]=u.toString());for(e in r.src.events)u=t.attr(e),u&&(f[e]=u.toString());o=t.attr("colspan")||1,s=t.attr("rowspan")||1,o>1&&(f.colspan=o),s>1&&(f.rowspan=s),t.replaceWith(n("<"+h+" />").html(t.html()).attr(f).css(i))}else t.css(i)}),this.rte.ui.update()},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellsmerge=function(t,i){function u(){var t=r.rte.dom.selfOrParent(r.rte.selection.getStart(),/^(TD|TH)$/),i=r.rte.dom.selfOrParent(r.rte.selection.getEnd(),/^(TD|TH)$/);return t&&i&&t!=i&&n(t).parents("table").get(0)==n(i).parents("table").get(0)?[t,i]:null}this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=u(),w;if(t){var c=this.rte.dom.indexOf(n(t[0]).parent("tr").get(0)),l=this.rte.dom.indexOf(n(t[1]).parent("tr").get(0)),s=Math.min(c,l),h=Math.max(c,l)-s+1,f=this.rte.dom.tableColumn(t[0],!0,!0),e=this.rte.dom.tableColumn(t[1],!0),a=n.inArray(t[0],f.column),v=n.inArray(t[1],e.column),y=f.info.offset[a]<e.info.offset[v]?f:e,p=f.info.offset[a]>=e.info.offset[v]?f:e,o=0,i=null,r="";this.rte.history.add(),w=n(n(t[0]).parents("table").eq(0).find("tr").get().slice(s,s+h)).each(function(t){var f=r.length,u=!1;n(this).children("td,th").each(function(){var f=n(this),h=n.inArray(this,y.column),c=n.inArray(this,p.column),l,s,a,e;h!=-1||c!=-1?(u=h!=-1&&c==-1,l=parseInt(f.attr("colspan")||1),t==0&&(o+=l),h!=-1&&t>0&&(s=y.info.delta[h],s>0&&(f.css("text-align")=="left"?(e=f.clone(!0),f.html("&nbsp;")):e=f.clone().html("&nbsp;"),e.removeAttr("colspan").removeAttr("id").insertBefore(this),s>1&&e.attr("colspan",s))),c!=-1&&(s=p.info.delta[c],l-s>1&&(a=l-s-1,f.css("text-align")=="right"?(e=f.clone(!0),f.html("&nbsp;")):e=f.clone().html("&nbsp;"),e.removeAttr("colspan").removeAttr("id").insertAfter(this),a>1&&e.attr("colspan",a))),i?(r+=f.html(),f.remove()):i=f):u&&(t==0&&(o+=parseInt(f.attr("colspan")||1)),r+=f.html(),f.remove())}),r+=f!=r.length?"<br />":""}),i.removeAttr("colspan").removeAttr("rowspan").html(i.html()+r),o>1&&i.attr("colspan",o),h>1&&i.attr("rowspan",h),this.rte.dom.fixTable(n(t[0]).parents("table").get(0))}},this.update=function(){u()?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcellsplit=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){var i=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/),o,s,r,f,t;if(i&&(this.rte.history.add(),o=parseInt(this.rte.dom.attr(i,"colspan")),s=parseInt(this.rte.dom.attr(i,"rowspan")),o>1||s>1)){var h=o-1,c=s-1,l=this.rte.dom.parent(i,/^TABLE$/),u=this.rte.dom.tableMatrix(l);if(h)for(t=0;t<h;t++)n(this.rte.dom.create(i.nodeName)).html("&nbsp;").insertAfter(i);if(c){var a=this.rte.dom.indexesOfCell(i,u),v=a[0],e=a[1];for(r=v+1;r<v+c+1;r++)if(!u[r][e].nodeName){if(u[r][e-1].nodeName)f=u[r][e-1];else for(t=e-1;t>=0;t--)if(u[r][t].nodeName){f=u[r][t];break}if(f)for(t=0;t<=h;t++)n(this.rte.dom.create(f.nodeName)).html("&nbsp;").insertAfter(f)}}n(i).removeAttr("colspan").removeAttr("rowspan"),this.rte.dom.fixTable(l)}this.rte.ui.update(!0)},this.update=function(){var n=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);n&&(parseInt(this.rte.dom.attr(n,"colspan"))>1||parseInt(this.rte.dom.attr(n,"rowspan"))>1)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcolbefore=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this,i=this.rte.dom.tableColumn(this.rte.selection.getNode(),!1,!0);i.length&&(this.rte.history.add(),n.each(i,function(){var r=n(this),u=parseInt(r.attr("colspan")||1),i;u>1?r.attr("colspan",u+1):(i=n(t.rte.dom.create(this.nodeName)).html("&nbsp;"),t.name=="tbcolbefore"?i.insertBefore(this):i.insertAfter(this))}),this.rte.ui.update())},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbcolafter=elRTE.prototype.ui.prototype.buttons.tbcolbefore}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.tbcolrm=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var t=this.rte.selection.getNode(),r=this.rte.dom.selfOrParent(t,/^(TD|TH)$/),i=n(r).prev("td,th").get(0),u=n(r).next("td,th").get(0),e=this.rte.dom.parent(t,/^TABLE$/),f=this.rte.dom.tableColumn(t,!1,!0);f.length&&(this.rte.history.add(),n.each(f,function(){var t=n(this),i=parseInt(t.attr("colspan")||1);i>1?t.attr("colspan",i-1):t.remove()}),this.rte.dom.fixTable(e),(i||u)&&this.rte.selection.selectContents(i?i:u).collapse(!0),this.rte.ui.update(!0))},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),elRTE.prototype.ui.prototype.buttons.tbrowbefore=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){var l=this.rte.selection.getNode(),e=this.rte.dom.selfOrParent(l,/^(TD|TH)$/),u=this.rte.dom.selfOrParent(e,/^TR$/),t=this.rte.dom.tableMatrix(this.rte.dom.selfOrParent(e,/^TABLE$/)),i,h,f,n;if(e&&u&&t){this.rte.history.add();var c=this.name=="tbrowbefore",r=$(u).prevAll("tr").length,o=0,s=[];function a(n,i){while(i>0)if(i--,t[i]&&t[i][n]&&t[i][n].nodeName)return t[i][n]}for(n=0;n<t[r].length;n++)t[r][n]&&t[r][n].nodeName?(i=$(t[r][n]),h=parseInt(i.attr("colspan")||1),parseInt(i.attr("rowspan")||1)>1?c?o+=h:s.push(i):o+=h):t[r][n]=="-"&&(i=a(n,r),i&&s.push($(i)));for(f=$(this.rte.dom.create("tr")),n=0;n<o;n++)f.append("<td>&nbsp;<\/td>");c?f.insertBefore(u):f.insertAfter(u),$.each(s,function(){$(this).attr("rowspan",parseInt($(this).attr("rowspan")||1)+1)}),this.rte.ui.update()}},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbrowafter=elRTE.prototype.ui.prototype.buttons.tbrowbefore,function(n){elRTE.prototype.ui.prototype.buttons.tbrowrm=function(t,i){this.constructor.prototype.constructor.call(this,t,i);var r=this;this.command=function(){var l=this.rte.selection.getNode(),f=this.rte.dom.selfOrParent(l,/^(TD|TH)$/),e=this.rte.dom.selfOrParent(f,/^TR$/),c=this.rte.dom.selfOrParent(f,/^TABLE$/),t=this.rte.dom.tableMatrix(c),a,i,r,u,o,s,h;if(f&&e&&t.length){if(this.rte.history.add(),t.length==1)return n(c).remove(),this.rte.ui.update();a=[],i=n(e).prevAll("tr").length;function v(n,i){while(i>0)if(i--,t[i]&&t[i][n]&&t[i][n].nodeName)return t[i][n]}function p(r,u){var o,f;if(y=i+1,o=null,t[y]){for(f=0;f<u;f++)t[y][f]&&t[y][f].nodeName&&(o=t[y][f]);r=r.remove(),o?r.insertAfter(o):r.prependTo(n(e).next("tr").eq(0))}}function w(n){for(var t=0;t<n.length;t++)if(n[t]==f)return t<n.length-1?n[t+1]:n[t-1]}for(r=0;r<t[i].length;r++)u=null,o=!1,t[i][r]&&t[i][r].nodeName?(u=t[i][r],o=!0):t[i][r]=="-"&&(u=v(r,i))&&(o=!1),u&&(u=n(u),s=parseInt(u.attr("rowspan")||1),s>1&&(u.attr("rowspan",s-1),o&&p(u,r,i)));h=w(this.rte.dom.tableColumn(f)),h&&this.rte.selection.selectContents(h).collapse(!0),n(e).remove()}this.rte.ui.update()},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(){elRTE.prototype.ui.prototype.buttons.undo=function(n,t){this.constructor.prototype.constructor.call(this,n,t),this.command=function(){this.name=="undo"&&this.rte.history.canBack()?(this.rte.history.back(),this.rte.ui.update()):this.name=="redo"&&this.rte.history.canFwd()&&(this.rte.history.fwd(),this.rte.ui.update())},this.update=function(){this.domElem.toggleClass("disabled",this.name=="undo"?!this.rte.history.canBack():!this.rte.history.canFwd())}},elRTE.prototype.ui.prototype.buttons.redo=elRTE.prototype.ui.prototype.buttons.undo}(jQuery),function(n){elRTE.prototype.ui.prototype.buttons.unlink=function(t,i){this.constructor.prototype.constructor.call(this,t,i),this.command=function(){function u(n){return n.nodeName=="A"&&n.href}var f=this.rte.selection.getNode(),i=this.rte.dom.selfOrParentLink(f),t,r;if(!i&&(t=n.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1}),t.length)){for(r=0;r<t.length;r++)if(u(t[r])){i=t[r];break}i||(i=this.rte.dom.parent(t[0],u)||this.rte.dom.parent(t[t.length-1],u))}i&&(this.rte.history.add(),this.rte.selection.select(i),this.rte.doc.execCommand("unlink",!1,null),this.rte.ui.update(!0))},this.update=function(){var n=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(n)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(n){return n.nodeName=="A"&&n.href})?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active")}}}(jQuery)